{"version":3,"sources":["../../src/ir/builder.ts","../../src/ir/serialize.ts"],"names":[],"mappings":"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","file":"index.js","sourcesContent":["/**\n * IR Builder - Fluent API for constructing IR structures\n * @see research/2026-01-02_autogen-refined-plan.md Section 9\n */\nimport type {\n  IRJourney,\n  IRStep,\n  IRPrimitive,\n  LocatorSpec,\n  ValueSpec,\n  JourneyTier,\n  ModuleDependencies,\n  CompletionSignal,\n  JourneyDataConfig,\n  LocatorStrategy,\n} from './types.js';\n\n/**\n * Builder for constructing LocatorSpec\n */\nexport class LocatorBuilder {\n  private spec: Partial<LocatorSpec> = {};\n\n  static role(role: string, name?: string): LocatorBuilder {\n    const builder = new LocatorBuilder();\n    builder.spec.strategy = 'role';\n    builder.spec.value = role;\n    if (name) {\n      builder.spec.options = { ...builder.spec.options, name };\n    }\n    return builder;\n  }\n\n  static label(label: string): LocatorBuilder {\n    const builder = new LocatorBuilder();\n    builder.spec.strategy = 'label';\n    builder.spec.value = label;\n    return builder;\n  }\n\n  static placeholder(placeholder: string): LocatorBuilder {\n    const builder = new LocatorBuilder();\n    builder.spec.strategy = 'placeholder';\n    builder.spec.value = placeholder;\n    return builder;\n  }\n\n  static text(text: string): LocatorBuilder {\n    const builder = new LocatorBuilder();\n    builder.spec.strategy = 'text';\n    builder.spec.value = text;\n    return builder;\n  }\n\n  static testId(testId: string): LocatorBuilder {\n    const builder = new LocatorBuilder();\n    builder.spec.strategy = 'testid';\n    builder.spec.value = testId;\n    return builder;\n  }\n\n  static css(selector: string): LocatorBuilder {\n    const builder = new LocatorBuilder();\n    builder.spec.strategy = 'css';\n    builder.spec.value = selector;\n    return builder;\n  }\n\n  static fromSpec(strategy: LocatorStrategy, value: string): LocatorBuilder {\n    const builder = new LocatorBuilder();\n    builder.spec.strategy = strategy;\n    builder.spec.value = value;\n    return builder;\n  }\n\n  exact(exact = true): LocatorBuilder {\n    this.spec.options = { ...this.spec.options, exact };\n    return this;\n  }\n\n  level(level: number): LocatorBuilder {\n    this.spec.options = { ...this.spec.options, level };\n    return this;\n  }\n\n  strict(strict = true): LocatorBuilder {\n    this.spec.options = { ...this.spec.options, strict };\n    return this;\n  }\n\n  name(name: string): LocatorBuilder {\n    this.spec.options = { ...this.spec.options, name };\n    return this;\n  }\n\n  build(): LocatorSpec {\n    if (!this.spec.strategy || !this.spec.value) {\n      throw new Error('LocatorSpec requires strategy and value');\n    }\n    return this.spec as LocatorSpec;\n  }\n}\n\n/**\n * Builder for constructing ValueSpec\n */\nexport class ValueBuilder {\n  static literal(value: string): ValueSpec {\n    return { type: 'literal', value };\n  }\n\n  static actor(path: string): ValueSpec {\n    return { type: 'actor', value: path };\n  }\n\n  static runId(): ValueSpec {\n    return { type: 'runId', value: 'runId' };\n  }\n\n  static generated(template: string): ValueSpec {\n    return { type: 'generated', value: template };\n  }\n\n  static testData(path: string): ValueSpec {\n    return { type: 'testData', value: path };\n  }\n}\n\n/**\n * Builder for constructing IRStep\n */\nexport class StepBuilder {\n  private step: Partial<IRStep> = {\n    actions: [],\n    assertions: [],\n    notes: [],\n  };\n\n  constructor(id: string, description: string) {\n    this.step.id = id;\n    this.step.description = description;\n  }\n\n  sourceText(text: string): StepBuilder {\n    this.step.sourceText = text;\n    return this;\n  }\n\n  note(note: string): StepBuilder {\n    this.step.notes!.push(note);\n    return this;\n  }\n\n  // Navigation actions\n  goto(url: string, waitForLoad = true): StepBuilder {\n    this.step.actions!.push({ type: 'goto', url, waitForLoad });\n    return this;\n  }\n\n  waitForURL(pattern: string | RegExp): StepBuilder {\n    this.step.actions!.push({ type: 'waitForURL', pattern });\n    return this;\n  }\n\n  // Interaction actions\n  click(locator: LocatorSpec | LocatorBuilder): StepBuilder {\n    const spec = locator instanceof LocatorBuilder ? locator.build() : locator;\n    this.step.actions!.push({ type: 'click', locator: spec });\n    return this;\n  }\n\n  fill(locator: LocatorSpec | LocatorBuilder, value: ValueSpec | string): StepBuilder {\n    const spec = locator instanceof LocatorBuilder ? locator.build() : locator;\n    const valueSpec = typeof value === 'string' ? ValueBuilder.literal(value) : value;\n    this.step.actions!.push({ type: 'fill', locator: spec, value: valueSpec });\n    return this;\n  }\n\n  select(locator: LocatorSpec | LocatorBuilder, option: string): StepBuilder {\n    const spec = locator instanceof LocatorBuilder ? locator.build() : locator;\n    this.step.actions!.push({ type: 'select', locator: spec, option });\n    return this;\n  }\n\n  check(locator: LocatorSpec | LocatorBuilder): StepBuilder {\n    const spec = locator instanceof LocatorBuilder ? locator.build() : locator;\n    this.step.actions!.push({ type: 'check', locator: spec });\n    return this;\n  }\n\n  press(key: string, locator?: LocatorSpec | LocatorBuilder): StepBuilder {\n    const spec = locator\n      ? locator instanceof LocatorBuilder\n        ? locator.build()\n        : locator\n      : undefined;\n    this.step.actions!.push({ type: 'press', key, locator: spec });\n    return this;\n  }\n\n  // Assertions\n  expectVisible(\n    locator: LocatorSpec | LocatorBuilder,\n    timeout?: number\n  ): StepBuilder {\n    const spec = locator instanceof LocatorBuilder ? locator.build() : locator;\n    this.step.assertions!.push({ type: 'expectVisible', locator: spec, timeout });\n    return this;\n  }\n\n  expectNotVisible(\n    locator: LocatorSpec | LocatorBuilder,\n    timeout?: number\n  ): StepBuilder {\n    const spec = locator instanceof LocatorBuilder ? locator.build() : locator;\n    this.step.assertions!.push({ type: 'expectNotVisible', locator: spec, timeout });\n    return this;\n  }\n\n  expectText(\n    locator: LocatorSpec | LocatorBuilder,\n    text: string | RegExp,\n    timeout?: number\n  ): StepBuilder {\n    const spec = locator instanceof LocatorBuilder ? locator.build() : locator;\n    this.step.assertions!.push({ type: 'expectText', locator: spec, text, timeout });\n    return this;\n  }\n\n  expectURL(pattern: string | RegExp): StepBuilder {\n    this.step.assertions!.push({ type: 'expectURL', pattern });\n    return this;\n  }\n\n  expectTitle(title: string | RegExp): StepBuilder {\n    this.step.assertions!.push({ type: 'expectTitle', title });\n    return this;\n  }\n\n  expectToast(\n    toastType: 'success' | 'error' | 'info' | 'warning',\n    message?: string\n  ): StepBuilder {\n    this.step.assertions!.push({ type: 'expectToast', toastType, message });\n    return this;\n  }\n\n  // Module calls\n  callModule(module: string, method: string, args?: unknown[]): StepBuilder {\n    this.step.actions!.push({ type: 'callModule', module, method, args });\n    return this;\n  }\n\n  // Blocked step\n  blocked(reason: string, sourceText: string): StepBuilder {\n    this.step.actions!.push({ type: 'blocked', reason, sourceText });\n    return this;\n  }\n\n  // Raw primitive\n  action(primitive: IRPrimitive): StepBuilder {\n    this.step.actions!.push(primitive);\n    return this;\n  }\n\n  assertion(primitive: IRPrimitive): StepBuilder {\n    this.step.assertions!.push(primitive);\n    return this;\n  }\n\n  build(): IRStep {\n    if (!this.step.id || !this.step.description) {\n      throw new Error('IRStep requires id and description');\n    }\n    return this.step as IRStep;\n  }\n}\n\n/**\n * Builder for constructing IRJourney\n */\nexport class JourneyBuilder {\n  private journey: Partial<IRJourney> = {\n    tags: [],\n    steps: [],\n    moduleDependencies: { foundation: [], feature: [] },\n  };\n\n  constructor(id: string, title: string) {\n    this.journey.id = id;\n    this.journey.title = title;\n  }\n\n  tier(tier: JourneyTier): JourneyBuilder {\n    this.journey.tier = tier;\n    return this;\n  }\n\n  scope(scope: string): JourneyBuilder {\n    this.journey.scope = scope;\n    return this;\n  }\n\n  actor(actor: string): JourneyBuilder {\n    this.journey.actor = actor;\n    return this;\n  }\n\n  tag(tag: string): JourneyBuilder {\n    this.journey.tags!.push(tag);\n    return this;\n  }\n\n  tags(tags: string[]): JourneyBuilder {\n    this.journey.tags!.push(...tags);\n    return this;\n  }\n\n  foundationModule(module: string): JourneyBuilder {\n    this.journey.moduleDependencies!.foundation.push(module);\n    return this;\n  }\n\n  featureModule(module: string): JourneyBuilder {\n    this.journey.moduleDependencies!.feature.push(module);\n    return this;\n  }\n\n  modules(deps: ModuleDependencies): JourneyBuilder {\n    this.journey.moduleDependencies = deps;\n    return this;\n  }\n\n  data(config: JourneyDataConfig): JourneyBuilder {\n    this.journey.data = config;\n    return this;\n  }\n\n  completion(signals: CompletionSignal[]): JourneyBuilder {\n    this.journey.completion = signals;\n    return this;\n  }\n\n  setup(primitives: IRPrimitive[]): JourneyBuilder {\n    this.journey.setup = primitives;\n    return this;\n  }\n\n  step(step: IRStep | StepBuilder): JourneyBuilder {\n    const builtStep = step instanceof StepBuilder ? step.build() : step;\n    this.journey.steps!.push(builtStep);\n    return this;\n  }\n\n  cleanup(primitives: IRPrimitive[]): JourneyBuilder {\n    this.journey.cleanup = primitives;\n    return this;\n  }\n\n  revision(rev: number): JourneyBuilder {\n    this.journey.revision = rev;\n    return this;\n  }\n\n  sourcePath(path: string): JourneyBuilder {\n    this.journey.sourcePath = path;\n    return this;\n  }\n\n  build(): IRJourney {\n    if (\n      !this.journey.id ||\n      !this.journey.title ||\n      !this.journey.tier ||\n      !this.journey.scope ||\n      !this.journey.actor\n    ) {\n      throw new Error('IRJourney requires id, title, tier, scope, and actor');\n    }\n\n    // Add standard tags\n    const standardTags = [\n      '@artk',\n      '@journey',\n      `@${this.journey.id}`,\n      `@tier-${this.journey.tier}`,\n      `@scope-${this.journey.scope}`,\n    ];\n\n    const allTags = [...new Set([...standardTags, ...this.journey.tags!])];\n    this.journey.tags = allTags;\n\n    return this.journey as IRJourney;\n  }\n}\n\n/**\n * Convenience factory functions\n */\nexport const IR = {\n  journey: (id: string, title: string) => new JourneyBuilder(id, title),\n  step: (id: string, description: string) => new StepBuilder(id, description),\n  locator: {\n    role: LocatorBuilder.role,\n    label: LocatorBuilder.label,\n    placeholder: LocatorBuilder.placeholder,\n    text: LocatorBuilder.text,\n    testId: LocatorBuilder.testId,\n    css: LocatorBuilder.css,\n  },\n  value: ValueBuilder,\n};\n","/**\n * IR Serializer - Convert IR to JSON for debugging and analysis\n * @see research/2026-01-02_autogen-refined-plan.md Section 9\n */\nimport type { IRJourney, IRStep, IRPrimitive, LocatorSpec } from './types.js';\n\n/**\n * Options for IR serialization\n */\nexport interface SerializeOptions {\n  /** Include null/undefined values */\n  includeEmpty?: boolean;\n  /** Pretty print with indentation */\n  pretty?: boolean;\n  /** Indent size for pretty printing */\n  indent?: number;\n}\n\n/**\n * Serialize an IR Journey to JSON string\n */\nexport function serializeJourney(\n  journey: IRJourney,\n  options: SerializeOptions = {}\n): string {\n  const { pretty = true, indent = 2 } = options;\n\n  const cleaned = cleanObject(journey, options.includeEmpty ?? false);\n\n  return pretty\n    ? JSON.stringify(cleaned, null, indent)\n    : JSON.stringify(cleaned);\n}\n\n/**\n * Serialize an IR Step to JSON string\n */\nexport function serializeStep(\n  step: IRStep,\n  options: SerializeOptions = {}\n): string {\n  const { pretty = true, indent = 2 } = options;\n\n  const cleaned = cleanObject(step, options.includeEmpty ?? false);\n\n  return pretty\n    ? JSON.stringify(cleaned, null, indent)\n    : JSON.stringify(cleaned);\n}\n\n/**\n * Serialize an IR Primitive to JSON string\n */\nexport function serializePrimitive(\n  primitive: IRPrimitive,\n  options: SerializeOptions = {}\n): string {\n  const { pretty = true, indent = 2 } = options;\n\n  const cleaned = cleanObject(primitive, options.includeEmpty ?? false);\n\n  return pretty\n    ? JSON.stringify(cleaned, null, indent)\n    : JSON.stringify(cleaned);\n}\n\n/**\n * Convert a LocatorSpec to a human-readable description\n */\nexport function describeLocator(locator: LocatorSpec): string {\n  const { strategy, value, options } = locator;\n\n  switch (strategy) {\n    case 'role': {\n      let desc = `getByRole('${value}'`;\n      if (options?.name) {\n        desc += `, { name: '${options.name}'`;\n        if (options.exact) desc += ', exact: true';\n        if (options.level) desc += `, level: ${options.level}`;\n        desc += ' }';\n      }\n      desc += ')';\n      return desc;\n    }\n    case 'label':\n      return `getByLabel('${value}'${options?.exact ? ', { exact: true }' : ''})`;\n    case 'placeholder':\n      return `getByPlaceholder('${value}'${options?.exact ? ', { exact: true }' : ''})`;\n    case 'text':\n      return `getByText('${value}'${options?.exact ? ', { exact: true }' : ''})`;\n    case 'testid':\n      return `getByTestId('${value}')`;\n    case 'css':\n      return `locator('${value}')`;\n    default:\n      return `unknown('${value}')`;\n  }\n}\n\n/**\n * Convert an IR Primitive to a human-readable description\n */\nexport function describePrimitive(primitive: IRPrimitive): string {\n  switch (primitive.type) {\n    case 'goto':\n      return `Navigate to ${primitive.url}`;\n    case 'click':\n      return `Click ${describeLocator(primitive.locator)}`;\n    case 'fill':\n      return `Fill ${describeLocator(primitive.locator)} with \"${primitive.value.value}\"`;\n    case 'select':\n      return `Select \"${primitive.option}\" in ${describeLocator(primitive.locator)}`;\n    case 'check':\n      return `Check ${describeLocator(primitive.locator)}`;\n    case 'uncheck':\n      return `Uncheck ${describeLocator(primitive.locator)}`;\n    case 'press':\n      return `Press \"${primitive.key}\"`;\n    case 'hover':\n      return `Hover ${describeLocator(primitive.locator)}`;\n    case 'expectVisible':\n      return `Expect ${describeLocator(primitive.locator)} to be visible`;\n    case 'expectNotVisible':\n      return `Expect ${describeLocator(primitive.locator)} to be hidden`;\n    case 'expectText':\n      return `Expect ${describeLocator(primitive.locator)} to have text \"${primitive.text}\"`;\n    case 'expectURL':\n      return `Expect URL to match ${primitive.pattern}`;\n    case 'expectTitle':\n      return `Expect title to be \"${primitive.title}\"`;\n    case 'expectToast':\n      return `Expect ${primitive.toastType} toast${primitive.message ? `: \"${primitive.message}\"` : ''}`;\n    case 'callModule':\n      return `Call ${primitive.module}.${primitive.method}()`;\n    case 'blocked':\n      return `BLOCKED: ${primitive.reason}`;\n    case 'waitForURL':\n      return `Wait for URL to match ${primitive.pattern}`;\n    case 'waitForResponse':\n      return `Wait for response matching ${primitive.urlPattern}`;\n    case 'waitForLoadingComplete':\n      return `Wait for loading to complete`;\n    default:\n      return `Unknown primitive: ${(primitive as { type: string }).type}`;\n  }\n}\n\n/**\n * Generate a summary of an IR Journey\n */\nexport function summarizeJourney(journey: IRJourney): string {\n  const lines: string[] = [\n    `Journey: ${journey.id} - ${journey.title}`,\n    `  Tier: ${journey.tier}`,\n    `  Scope: ${journey.scope}`,\n    `  Actor: ${journey.actor}`,\n    `  Tags: ${journey.tags.join(', ')}`,\n    '',\n    `  Steps (${journey.steps.length}):`,\n  ];\n\n  for (const step of journey.steps) {\n    lines.push(`    ${step.id}: ${step.description}`);\n    lines.push(`      Actions: ${step.actions.length}`);\n    lines.push(`      Assertions: ${step.assertions.length}`);\n  }\n\n  if (journey.moduleDependencies.foundation.length > 0) {\n    lines.push('');\n    lines.push(`  Foundation Modules: ${journey.moduleDependencies.foundation.join(', ')}`);\n  }\n\n  if (journey.moduleDependencies.feature.length > 0) {\n    lines.push(`  Feature Modules: ${journey.moduleDependencies.feature.join(', ')}`);\n  }\n\n  return lines.join('\\n');\n}\n\n/**\n * Remove null/undefined values from an object recursively\n */\nfunction cleanObject(obj: unknown, includeEmpty: boolean): unknown {\n  if (obj === null || obj === undefined) {\n    return includeEmpty ? obj : undefined;\n  }\n\n  if (Array.isArray(obj)) {\n    const cleaned = obj\n      .map((item) => cleanObject(item, includeEmpty))\n      .filter((item) => includeEmpty || item !== undefined);\n    return cleaned.length > 0 || includeEmpty ? cleaned : undefined;\n  }\n\n  if (typeof obj === 'object') {\n    const cleaned: Record<string, unknown> = {};\n    for (const [key, value] of Object.entries(obj)) {\n      const cleanedValue = cleanObject(value, includeEmpty);\n      if (includeEmpty || cleanedValue !== undefined) {\n        cleaned[key] = cleanedValue;\n      }\n    }\n    return Object.keys(cleaned).length > 0 || includeEmpty ? cleaned : undefined;\n  }\n\n  return obj;\n}\n"]}