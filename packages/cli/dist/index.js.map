{"version":3,"sources":["../src/lib/logger.ts","../src/lib/environment.ts","../src/lib/browser-resolver.ts","../src/lib/bootstrap.ts","../src/lib/prerequisites.ts","../src/lib/version.ts"],"names":["path","execSync","logger","path2","fs2","resolve","__filename","__dirname","fs","spawn","fs4","getBrowserPaths","fileURLToPath","path4","fs5"],"mappings":"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","file":"index.js","sourcesContent":["/**\n * Logger - Colorful console output utilities\n */\n\nimport chalk from 'chalk';\nimport ora, { type Ora } from 'ora';\n\nexport class Logger {\n  private spinner: Ora | null = null;\n  private verbose: boolean;\n\n  constructor(options: { verbose?: boolean } = {}) {\n    this.verbose = options.verbose ?? false;\n  }\n\n  header(text: string): void {\n    console.log('');\n    console.log(chalk.green('╔' + '═'.repeat(text.length + 6) + '╗'));\n    console.log(chalk.green('║   ') + chalk.bold.green(text) + chalk.green('   ║'));\n    console.log(chalk.green('╚' + '═'.repeat(text.length + 6) + '╝'));\n    console.log('');\n  }\n\n  step(current: number, total: number, message: string): void {\n    this.stopSpinner();\n    console.log(chalk.yellow(`[${current}/${total}]`) + ' ' + message);\n  }\n\n  startSpinner(message: string): void {\n    this.stopSpinner();\n    this.spinner = ora(message).start();\n  }\n\n  updateSpinner(message: string): void {\n    if (this.spinner) {\n      this.spinner.text = message;\n    }\n  }\n\n  succeedSpinner(message?: string): void {\n    if (this.spinner) {\n      this.spinner.succeed(message);\n      this.spinner = null;\n    }\n  }\n\n  failSpinner(message?: string): void {\n    if (this.spinner) {\n      this.spinner.fail(message);\n      this.spinner = null;\n    }\n  }\n\n  stopSpinner(): void {\n    if (this.spinner) {\n      this.spinner.stop();\n      this.spinner = null;\n    }\n  }\n\n  info(message: string): void {\n    console.log(chalk.cyan('ℹ') + ' ' + message);\n  }\n\n  success(message: string): void {\n    console.log(chalk.green('✓') + ' ' + message);\n  }\n\n  warning(message: string): void {\n    console.log(chalk.yellow('⚠') + ' ' + chalk.yellow(message));\n  }\n\n  error(message: string): void {\n    console.log(chalk.red('✗') + ' ' + chalk.red(message));\n  }\n\n  debug(message: string): void {\n    if (this.verbose) {\n      console.log(chalk.gray('  ' + message));\n    }\n  }\n\n  list(items: string[], indent: number = 2): void {\n    const prefix = ' '.repeat(indent);\n    for (const item of items) {\n      console.log(prefix + chalk.dim('•') + ' ' + item);\n    }\n  }\n\n  table(rows: Array<{ label: string; value: string }>): void {\n    const maxLabelLength = Math.max(...rows.map((r) => r.label.length));\n    for (const row of rows) {\n      const paddedLabel = row.label.padEnd(maxLabelLength);\n      console.log('  ' + chalk.dim(paddedLabel) + '  ' + row.value);\n    }\n  }\n\n  nextSteps(steps: string[]): void {\n    console.log('');\n    console.log(chalk.cyan('Next steps:'));\n    steps.forEach((step, i) => {\n      console.log(chalk.dim(`  ${i + 1}.`) + ' ' + step);\n    });\n    console.log('');\n  }\n\n  blank(): void {\n    console.log('');\n  }\n\n  divider(): void {\n    console.log(chalk.dim('─'.repeat(50)));\n  }\n}\n\n// Singleton instance for simple usage\nexport const logger = new Logger();\n","/**\n * Environment detection utilities\n *\n * Detects the target project's module system (ESM vs CommonJS)\n * and other environment characteristics.\n */\n\nimport * as fs from 'fs';\nimport * as path from 'path';\n\nexport interface EnvironmentInfo {\n  moduleSystem: 'esm' | 'commonjs' | 'unknown';\n  nodeVersion: string;\n  npmVersion: string | null;\n  hasGit: boolean;\n  hasPlaywright: boolean;\n  hasArtkCore: boolean;\n  platform: NodeJS.Platform;\n  arch: string;\n  isCI: boolean;\n}\n\n/**\n * Detect the target project's environment\n */\nexport async function detectEnvironment(projectPath: string): Promise<EnvironmentInfo> {\n  const resolvedPath = path.resolve(projectPath);\n\n  return {\n    moduleSystem: detectModuleSystem(resolvedPath),\n    nodeVersion: process.version,\n    npmVersion: await detectNpmVersion(),\n    hasGit: await detectGit(resolvedPath),\n    hasPlaywright: detectPlaywright(resolvedPath),\n    hasArtkCore: detectArtkCore(resolvedPath),\n    platform: process.platform,\n    arch: process.arch,\n    isCI: detectCI(),\n  };\n}\n\n/**\n * Detect the module system from package.json and file extensions\n */\nfunction detectModuleSystem(projectPath: string): 'esm' | 'commonjs' | 'unknown' {\n  const packageJsonPath = path.join(projectPath, 'package.json');\n\n  // Check package.json \"type\" field\n  if (fs.existsSync(packageJsonPath)) {\n    try {\n      const pkg = JSON.parse(fs.readFileSync(packageJsonPath, 'utf8'));\n      if (pkg.type === 'module') {\n        return 'esm';\n      }\n      if (pkg.type === 'commonjs' || !pkg.type) {\n        // Check for ESM indicators even without \"type\": \"module\"\n        const hasEsmConfig = fs.existsSync(path.join(projectPath, 'tsconfig.json'));\n        if (hasEsmConfig) {\n          try {\n            const tsconfig = JSON.parse(fs.readFileSync(path.join(projectPath, 'tsconfig.json'), 'utf8'));\n            const module = tsconfig.compilerOptions?.module?.toLowerCase();\n            if (module && (module.includes('esnext') || module.includes('es20') || module === 'nodenext')) {\n              return 'esm';\n            }\n          } catch {\n            // Ignore tsconfig parse errors\n          }\n        }\n        return 'commonjs';\n      }\n    } catch {\n      // Ignore parse errors\n    }\n  }\n\n  // Check for .mjs files (strong ESM indicator)\n  const srcDir = path.join(projectPath, 'src');\n  if (fs.existsSync(srcDir)) {\n    try {\n      const files = fs.readdirSync(srcDir, { recursive: true }) as string[];\n      const hasMjs = files.some((f) => f.endsWith('.mjs'));\n      const hasCjs = files.some((f) => f.endsWith('.cjs'));\n      if (hasMjs && !hasCjs) return 'esm';\n      if (hasCjs && !hasMjs) return 'commonjs';\n    } catch {\n      // Ignore read errors\n    }\n  }\n\n  return 'unknown';\n}\n\n/**\n * Get npm version\n */\nasync function detectNpmVersion(): Promise<string | null> {\n  try {\n    const { execSync } = await import('child_process');\n    const version = execSync('npm --version', { encoding: 'utf8' }).trim();\n    return version;\n  } catch {\n    return null;\n  }\n}\n\n/**\n * Check if the project is a git repository\n */\nasync function detectGit(projectPath: string): Promise<boolean> {\n  // Check for .git directory\n  if (fs.existsSync(path.join(projectPath, '.git'))) {\n    return true;\n  }\n\n  // Check if we're in a subdirectory of a git repo\n  try {\n    const { execSync } = await import('child_process');\n    execSync('git rev-parse --git-dir', { cwd: projectPath, encoding: 'utf8', stdio: 'pipe' });\n    return true;\n  } catch {\n    return false;\n  }\n}\n\n/**\n * Check if Playwright is installed\n */\nfunction detectPlaywright(projectPath: string): boolean {\n  const playwrightPath = path.join(projectPath, 'node_modules', '@playwright', 'test');\n  return fs.existsSync(playwrightPath);\n}\n\n/**\n * Check if @artk/core is installed\n */\nfunction detectArtkCore(projectPath: string): boolean {\n  // Check vendor location\n  const vendorPath = path.join(projectPath, 'artk-e2e', 'vendor', 'artk-core');\n  if (fs.existsSync(vendorPath)) return true;\n\n  // Check node_modules\n  const nodeModulesPath = path.join(projectPath, 'node_modules', '@artk', 'core');\n  return fs.existsSync(nodeModulesPath);\n}\n\n/**\n * Detect CI environment\n */\nfunction detectCI(): boolean {\n  return !!(\n    process.env.CI ||\n    process.env.GITHUB_ACTIONS ||\n    process.env.GITLAB_CI ||\n    process.env.JENKINS_HOME ||\n    process.env.CIRCLECI ||\n    process.env.TRAVIS ||\n    process.env.TF_BUILD\n  );\n}\n\n/**\n * Get OS and architecture for browser downloads\n */\nexport function getOsArch(): { os: string; arch: string } {\n  let os: string;\n  switch (process.platform) {\n    case 'darwin':\n      os = 'macos';\n      break;\n    case 'win32':\n      os = 'windows';\n      break;\n    case 'linux':\n      os = 'linux';\n      break;\n    default:\n      os = 'unknown';\n  }\n\n  let arch: string;\n  switch (process.arch) {\n    case 'x64':\n      arch = 'x64';\n      break;\n    case 'arm64':\n      arch = 'arm64';\n      break;\n    case 'ia32':\n      arch = 'x86';\n      break;\n    default:\n      arch = 'unknown';\n  }\n\n  return { os, arch };\n}\n","/**\n * Browser resolver\n *\n * Handles browser detection and installation for Playwright tests.\n * Implements a fallback chain: release cache → bundled install → system browsers\n */\n\nimport { execSync, spawn } from 'child_process';\nimport * as fs from 'fs';\nimport * as path from 'path';\nimport * as https from 'https';\nimport { getOsArch } from './environment.js';\nimport { Logger } from './logger.js';\n\nexport interface BrowserInfo {\n  channel: 'bundled' | 'msedge' | 'chrome' | 'chrome-beta' | 'chrome-dev';\n  version: string | null;\n  path: string | null;\n  strategy: 'release-cache' | 'bundled-install' | 'system' | 'auto';\n}\n\nexport interface BrowserResolverOptions {\n  artkE2ePath: string;\n  browsersCachePath: string;\n  logger: Logger;\n  skipInstall?: boolean;\n}\n\n/**\n * Resolve and configure browsers for Playwright\n */\nexport async function resolveBrowser(targetPath: string, logger?: Logger): Promise<BrowserInfo> {\n  const log = logger || new Logger();\n  const artkE2ePath = path.join(targetPath, 'artk-e2e');\n  const browsersCachePath = path.join(targetPath, '.artk', 'browsers');\n\n  // Ensure browsers cache directory exists\n  fs.mkdirSync(browsersCachePath, { recursive: true });\n\n  // Set environment for Playwright\n  process.env.PLAYWRIGHT_BROWSERS_PATH = browsersCachePath;\n\n  // Try release cache first (fastest)\n  log.debug('Attempting to download pre-built browsers from release cache...');\n  const releaseCacheResult = await tryReleaseCacheBrowsers(artkE2ePath, browsersCachePath, log);\n  if (releaseCacheResult) {\n    return releaseCacheResult;\n  }\n\n  // Try bundled Playwright install\n  log.debug('Attempting bundled Playwright browser install...');\n  const bundledResult = await tryBundledInstall(artkE2ePath, browsersCachePath, log);\n  if (bundledResult) {\n    return bundledResult;\n  }\n\n  // Fall back to system browsers\n  log.debug('Detecting system browsers...');\n  const systemResult = await detectSystemBrowser(log);\n  if (systemResult.channel !== 'bundled') {\n    return systemResult;\n  }\n\n  // No browsers available\n  log.warning('No browsers available. Tests may not run until browsers are installed.');\n  return {\n    channel: 'bundled',\n    version: null,\n    path: null,\n    strategy: 'auto',\n  };\n}\n\n/**\n * Try to download pre-built browsers from GitHub release\n */\nasync function tryReleaseCacheBrowsers(\n  artkE2ePath: string,\n  browsersCachePath: string,\n  logger: Logger\n): Promise<BrowserInfo | null> {\n  // Get Chromium revision from Playwright\n  const browsersJsonPath = path.join(artkE2ePath, 'node_modules', 'playwright-core', 'browsers.json');\n  if (!fs.existsSync(browsersJsonPath)) {\n    logger.debug('browsers.json not found, skipping release cache');\n    return null;\n  }\n\n  try {\n    const browsersJson = JSON.parse(fs.readFileSync(browsersJsonPath, 'utf8'));\n    const chromium = browsersJson.browsers?.find((b: any) => b.name === 'chromium');\n    if (!chromium?.revision) {\n      logger.debug('Chromium revision not found in browsers.json');\n      return null;\n    }\n\n    const { os, arch } = getOsArch();\n    if (os === 'unknown' || arch === 'unknown') {\n      logger.debug(`Unsupported OS/arch: ${os}/${arch}`);\n      return null;\n    }\n\n    // Check if already cached\n    const cachedPath = path.join(browsersCachePath, `chromium-${chromium.revision}`);\n    if (fs.existsSync(cachedPath)) {\n      logger.debug(`Browsers already cached: ${cachedPath}`);\n      return {\n        channel: 'bundled',\n        version: chromium.revision,\n        path: cachedPath,\n        strategy: 'release-cache',\n      };\n    }\n\n    // Get Playwright version for tag\n    const playwrightPkgPath = path.join(artkE2ePath, 'node_modules', '@playwright', 'test', 'package.json');\n    let playwrightVersion = '1.57.0';\n    if (fs.existsSync(playwrightPkgPath)) {\n      const pkg = JSON.parse(fs.readFileSync(playwrightPkgPath, 'utf8'));\n      playwrightVersion = pkg.version;\n    }\n\n    // Try to download from release\n    const repo = process.env.ARTK_PLAYWRIGHT_BROWSERS_REPO;\n    if (!repo) {\n      logger.debug('ARTK_PLAYWRIGHT_BROWSERS_REPO not set, skipping release cache');\n      return null;\n    }\n\n    const tag = process.env.ARTK_PLAYWRIGHT_BROWSERS_TAG || `playwright-browsers-${playwrightVersion}`;\n    const asset = `chromium-${chromium.revision}-${os}-${arch}.zip`;\n    const url = `https://github.com/${repo}/releases/download/${tag}/${asset}`;\n\n    logger.debug(`Downloading from: ${url}`);\n    // Download implementation would go here\n    // For now, return null to fall back to bundled install\n    return null;\n  } catch (error) {\n    logger.debug(`Release cache check failed: ${error}`);\n    return null;\n  }\n}\n\n/**\n * Try to install bundled Playwright browsers\n */\nasync function tryBundledInstall(\n  artkE2ePath: string,\n  browsersCachePath: string,\n  logger: Logger\n): Promise<BrowserInfo | null> {\n  return new Promise((resolve) => {\n    logger.startSpinner('Installing Playwright browsers...');\n\n    const child = spawn('npx', ['playwright', 'install', 'chromium'], {\n      cwd: artkE2ePath,\n      env: {\n        ...process.env,\n        PLAYWRIGHT_BROWSERS_PATH: browsersCachePath,\n      },\n      shell: true,\n      stdio: 'pipe',\n    });\n\n    let stdout = '';\n    let stderr = '';\n\n    child.stdout?.on('data', (data) => {\n      stdout += data.toString();\n    });\n\n    child.stderr?.on('data', (data) => {\n      stderr += data.toString();\n    });\n\n    child.on('close', (code) => {\n      if (code === 0) {\n        logger.succeedSpinner('Playwright browsers installed');\n        resolve({\n          channel: 'bundled',\n          version: null,\n          path: browsersCachePath,\n          strategy: 'bundled-install',\n        });\n      } else {\n        logger.failSpinner('Failed to install Playwright browsers');\n        logger.debug(`Exit code: ${code}`);\n        logger.debug(`stderr: ${stderr}`);\n        resolve(null);\n      }\n    });\n\n    child.on('error', (error) => {\n      logger.failSpinner('Failed to install Playwright browsers');\n      logger.debug(`Error: ${error.message}`);\n      resolve(null);\n    });\n\n    // Timeout after 5 minutes\n    setTimeout(() => {\n      child.kill();\n      logger.failSpinner('Browser installation timed out');\n      resolve(null);\n    }, 300000);\n  });\n}\n\n/**\n * Detect system browsers (Edge, Chrome)\n */\nasync function detectSystemBrowser(logger: Logger): Promise<BrowserInfo> {\n  // Try Microsoft Edge first\n  const edgeInfo = await tryDetectBrowser('msedge', logger);\n  if (edgeInfo) {\n    logger.success(`Detected Microsoft Edge: ${edgeInfo.version || 'unknown version'}`);\n    return edgeInfo;\n  }\n\n  // Try Google Chrome\n  const chromeInfo = await tryDetectBrowser('chrome', logger);\n  if (chromeInfo) {\n    logger.success(`Detected Google Chrome: ${chromeInfo.version || 'unknown version'}`);\n    return chromeInfo;\n  }\n\n  return {\n    channel: 'bundled',\n    version: null,\n    path: null,\n    strategy: 'auto',\n  };\n}\n\n/**\n * Try to detect a specific browser\n */\nasync function tryDetectBrowser(\n  browser: 'msedge' | 'chrome',\n  logger: Logger\n): Promise<BrowserInfo | null> {\n  const paths = getBrowserPaths(browser);\n\n  for (const browserPath of paths) {\n    if (fs.existsSync(browserPath)) {\n      const version = await getBrowserVersion(browserPath);\n      return {\n        channel: browser,\n        version,\n        path: browserPath,\n        strategy: 'system',\n      };\n    }\n  }\n\n  // Try command-line detection\n  const commands =\n    browser === 'msedge'\n      ? ['microsoft-edge', 'microsoft-edge-stable']\n      : ['google-chrome', 'google-chrome-stable'];\n\n  for (const cmd of commands) {\n    try {\n      const output = execSync(`${cmd} --version`, { encoding: 'utf8', stdio: 'pipe', timeout: 5000 });\n      const versionMatch = output.match(/(\\d+\\.\\d+\\.\\d+\\.\\d+)/);\n      return {\n        channel: browser,\n        version: versionMatch ? versionMatch[1] : null,\n        path: cmd,\n        strategy: 'system',\n      };\n    } catch {\n      // Try next command\n    }\n  }\n\n  return null;\n}\n\n/**\n * Get browser version from executable path\n */\nasync function getBrowserVersion(browserPath: string): Promise<string | null> {\n  try {\n    const output = execSync(`\"${browserPath}\" --version`, { encoding: 'utf8', stdio: 'pipe', timeout: 5000 });\n    const versionMatch = output.match(/(\\d+\\.\\d+\\.\\d+\\.\\d+)/);\n    return versionMatch ? versionMatch[1] : null;\n  } catch {\n    return null;\n  }\n}\n\n/**\n * Get browser executable paths for the current platform\n */\nfunction getBrowserPaths(browser: 'msedge' | 'chrome'): string[] {\n  const paths: string[] = [];\n\n  if (process.platform === 'win32') {\n    const programFiles = process.env['ProgramFiles'] || 'C:\\\\Program Files';\n    const programFilesX86 = process.env['ProgramFiles(x86)'] || 'C:\\\\Program Files (x86)';\n    const localAppData = process.env['LOCALAPPDATA'] || '';\n\n    if (browser === 'msedge') {\n      paths.push(\n        `${programFilesX86}\\\\Microsoft\\\\Edge\\\\Application\\\\msedge.exe`,\n        `${programFiles}\\\\Microsoft\\\\Edge\\\\Application\\\\msedge.exe`,\n        `${localAppData}\\\\Microsoft\\\\Edge\\\\Application\\\\msedge.exe`\n      );\n    } else {\n      paths.push(\n        `${programFiles}\\\\Google\\\\Chrome\\\\Application\\\\chrome.exe`,\n        `${programFilesX86}\\\\Google\\\\Chrome\\\\Application\\\\chrome.exe`,\n        `${localAppData}\\\\Google\\\\Chrome\\\\Application\\\\chrome.exe`\n      );\n    }\n  } else if (process.platform === 'darwin') {\n    if (browser === 'msedge') {\n      paths.push('/Applications/Microsoft Edge.app/Contents/MacOS/Microsoft Edge');\n    } else {\n      paths.push('/Applications/Google Chrome.app/Contents/MacOS/Google Chrome');\n    }\n  } else {\n    // Linux\n    if (browser === 'msedge') {\n      paths.push('/usr/bin/microsoft-edge', '/usr/bin/microsoft-edge-stable', '/snap/bin/microsoft-edge');\n    } else {\n      paths.push(\n        '/usr/bin/google-chrome',\n        '/usr/bin/google-chrome-stable',\n        '/snap/bin/chromium',\n        '/usr/bin/chromium-browser'\n      );\n    }\n  }\n\n  return paths;\n}\n\n/**\n * Update artk.config.yml with browser configuration\n */\nexport function updateArtkConfigBrowser(configPath: string, browserInfo: BrowserInfo): void {\n  if (!fs.existsSync(configPath)) {\n    return;\n  }\n\n  let content = fs.readFileSync(configPath, 'utf8');\n\n  // Check if browsers section exists\n  if (!/^\\s*browsers\\s*:/m.test(content)) {\n    // Add browsers section\n    content += `\nbrowsers:\n  enabled:\n    - chromium\n  channel: ${browserInfo.channel}\n  strategy: ${browserInfo.strategy}\n  viewport:\n    width: 1280\n    height: 720\n  headless: true\n`;\n  } else {\n    // Update channel in existing section\n    content = content.replace(\n      /^(\\s*channel\\s*:\\s*).*$/m,\n      `$1${browserInfo.channel}`\n    );\n    content = content.replace(\n      /^(\\s*strategy\\s*:\\s*).*$/m,\n      `$1${browserInfo.strategy}`\n    );\n  }\n\n  fs.writeFileSync(configPath, content);\n}\n","/**\n * Bootstrap - Core installation logic\n *\n * This module implements the complete ARTK bootstrap process,\n * replacing the shell scripts (bootstrap.sh/bootstrap.ps1) with\n * a unified TypeScript implementation.\n */\n\nimport { execSync, spawn, SpawnOptions } from 'child_process';\nimport fs from 'fs-extra';\nimport * as path from 'path';\nimport { fileURLToPath } from 'url';\nimport { Logger } from './logger.js';\nimport { detectEnvironment, type EnvironmentInfo } from './environment.js';\nimport { resolveBrowser, updateArtkConfigBrowser, type BrowserInfo } from './browser-resolver.js';\n\nconst __filename = fileURLToPath(import.meta.url);\nconst __dirname = path.dirname(__filename);\n\nexport interface BootstrapOptions {\n  skipNpm?: boolean;\n  skipBrowsers?: boolean;\n  force?: boolean;\n  variant?: 'commonjs' | 'esm' | 'auto';\n  prompts?: boolean;\n  verbose?: boolean;\n}\n\nexport interface BootstrapResult {\n  success: boolean;\n  projectPath: string;\n  artkE2ePath: string;\n  browserInfo?: BrowserInfo;\n  environment?: EnvironmentInfo;\n  errors: string[];\n}\n\n/**\n * Bootstrap ARTK in a target project\n */\nexport async function bootstrap(\n  targetPath: string,\n  options: BootstrapOptions = {}\n): Promise<BootstrapResult> {\n  const logger = new Logger({ verbose: options.verbose });\n  const errors: string[] = [];\n\n  const resolvedPath = path.resolve(targetPath);\n  const artkE2ePath = path.join(resolvedPath, 'artk-e2e');\n  const artkDir = path.join(resolvedPath, '.artk');\n\n  logger.header('ARTK Bootstrap Installation');\n  logger.table([\n    { label: 'Target', value: resolvedPath },\n    { label: 'ARTK E2E', value: artkE2ePath },\n  ]);\n\n  // Validate target directory\n  if (!fs.existsSync(resolvedPath)) {\n    logger.error(`Target directory does not exist: ${resolvedPath}`);\n    return { success: false, projectPath: resolvedPath, artkE2ePath, errors: ['Target directory does not exist'] };\n  }\n\n  // Check for existing installation\n  if (fs.existsSync(artkE2ePath) && !options.force) {\n    logger.error('ARTK is already installed in this project. Use --force to overwrite.');\n    return { success: false, projectPath: resolvedPath, artkE2ePath, errors: ['Already installed'] };\n  }\n\n  try {\n    // Step 1: Detect environment\n    logger.step(1, 7, 'Detecting environment...');\n    const environment = await detectEnvironment(resolvedPath);\n    const variant = options.variant === 'auto' || !options.variant\n      ? (environment.moduleSystem === 'unknown' ? 'commonjs' : environment.moduleSystem)\n      : options.variant;\n    logger.success(`Module system: ${variant}`);\n    logger.debug(`Node.js: ${environment.nodeVersion}`);\n    logger.debug(`Platform: ${environment.platform}/${environment.arch}`);\n\n    // Step 2: Create directory structure\n    logger.step(2, 7, 'Creating artk-e2e/ structure...');\n    await createDirectoryStructure(artkE2ePath);\n    logger.success('Directory structure created');\n\n    // Step 3: Install @artk/core to vendor\n    logger.step(3, 7, 'Installing @artk/core to vendor/...');\n    await installVendorPackages(artkE2ePath, logger);\n    logger.success('@artk/core installed to vendor/');\n\n    // Step 4: Install prompts\n    if (options.prompts !== false) {\n      logger.step(4, 7, 'Installing prompts to .github/prompts/...');\n      await installPrompts(resolvedPath, logger);\n      logger.success('Prompts installed');\n    } else {\n      logger.step(4, 7, 'Skipping prompts installation (--no-prompts)');\n    }\n\n    // Step 5: Create configuration files\n    logger.step(5, 7, 'Creating configuration files...');\n    const projectName = path.basename(resolvedPath);\n    await createConfigurationFiles(artkE2ePath, artkDir, resolvedPath, {\n      projectName,\n      variant,\n    });\n    logger.success('Configuration files created');\n\n    // Step 6: npm install\n    if (!options.skipNpm) {\n      logger.step(6, 7, 'Running npm install...');\n      await runNpmInstall(artkE2ePath, logger);\n      logger.success('npm install completed');\n    } else {\n      logger.step(6, 7, 'Skipping npm install (--skip-npm)');\n    }\n\n    // Step 7: Browser configuration\n    let browserInfo: BrowserInfo | undefined;\n    if (!options.skipBrowsers && !options.skipNpm) {\n      logger.step(7, 7, 'Configuring browsers...');\n      browserInfo = await resolveBrowser(resolvedPath, logger);\n\n      // Update config with browser info\n      const configPath = path.join(artkE2ePath, 'artk.config.yml');\n      updateArtkConfigBrowser(configPath, browserInfo);\n\n      // Update context.json with browser metadata\n      await updateContextJson(artkDir, { browser: browserInfo });\n      logger.success(`Browser configured: ${browserInfo.channel} (${browserInfo.strategy})`);\n    } else {\n      logger.step(7, 7, 'Skipping browser configuration');\n    }\n\n    // Success!\n    printSuccessSummary(logger, resolvedPath, artkE2ePath, browserInfo);\n\n    return {\n      success: true,\n      projectPath: resolvedPath,\n      artkE2ePath,\n      browserInfo,\n      environment,\n      errors: [],\n    };\n  } catch (error) {\n    const errorMessage = error instanceof Error ? error.message : String(error);\n    logger.error(`Bootstrap failed: ${errorMessage}`);\n    errors.push(errorMessage);\n\n    return {\n      success: false,\n      projectPath: resolvedPath,\n      artkE2ePath,\n      errors,\n    };\n  }\n}\n\n/**\n * Create the artk-e2e directory structure\n */\nasync function createDirectoryStructure(artkE2ePath: string): Promise<void> {\n  const directories = [\n    'vendor/artk-core',\n    'vendor/artk-core-autogen',\n    'src/modules/foundation/auth',\n    'src/modules/foundation/navigation',\n    'src/modules/foundation/selectors',\n    'src/modules/foundation/data',\n    'src/modules/features',\n    'config',\n    'tests/setup',\n    'tests/foundation',\n    'tests/smoke',\n    'tests/release',\n    'tests/regression',\n    'tests/journeys',\n    'docs',\n    'journeys',\n    '.auth-states',\n  ];\n\n  for (const dir of directories) {\n    await fs.ensureDir(path.join(artkE2ePath, dir));\n  }\n}\n\n/**\n * Install @artk/core and @artk/core-autogen to vendor directory\n */\nasync function installVendorPackages(artkE2ePath: string, logger: Logger): Promise<void> {\n  // Get the assets directory (bundled with CLI)\n  const assetsDir = getAssetsDir();\n\n  // Copy @artk/core\n  const coreSource = path.join(assetsDir, 'core');\n  const coreTarget = path.join(artkE2ePath, 'vendor', 'artk-core');\n\n  if (fs.existsSync(coreSource)) {\n    await fs.copy(coreSource, coreTarget, { overwrite: true });\n    logger.debug(`Copied @artk/core from bundled assets`);\n  } else {\n    logger.warning(`@artk/core assets not found at ${coreSource}`);\n    // Create minimal package.json for development\n    await fs.writeJson(path.join(coreTarget, 'package.json'), {\n      name: '@artk/core',\n      version: '1.0.0',\n      main: './dist/index.js',\n    });\n  }\n\n  // Copy @artk/core-autogen\n  const autogenSource = path.join(assetsDir, 'autogen');\n  const autogenTarget = path.join(artkE2ePath, 'vendor', 'artk-core-autogen');\n\n  if (fs.existsSync(autogenSource)) {\n    await fs.copy(autogenSource, autogenTarget, { overwrite: true });\n    logger.debug(`Copied @artk/core-autogen from bundled assets`);\n  } else {\n    logger.warning(`@artk/core-autogen assets not found at ${autogenSource}`);\n    await fs.writeJson(path.join(autogenTarget, 'package.json'), {\n      name: '@artk/core-autogen',\n      version: '0.1.0',\n      main: './dist/index.js',\n    });\n  }\n}\n\n/**\n * Install prompts to .github/prompts/\n */\nasync function installPrompts(projectPath: string, logger: Logger): Promise<void> {\n  const assetsDir = getAssetsDir();\n  const promptsSource = path.join(assetsDir, 'prompts');\n  const promptsTarget = path.join(projectPath, '.github', 'prompts');\n\n  await fs.ensureDir(promptsTarget);\n\n  if (fs.existsSync(promptsSource)) {\n    const promptFiles = await fs.readdir(promptsSource);\n    let installed = 0;\n\n    for (const file of promptFiles) {\n      if (file.endsWith('.md') && file.startsWith('artk.')) {\n        const source = path.join(promptsSource, file);\n        // Rename artk.*.md to artk.*.prompt.md\n        const targetName = file.replace(/\\.md$/, '.prompt.md');\n        const target = path.join(promptsTarget, targetName);\n\n        await fs.copy(source, target, { overwrite: true });\n        installed++;\n        logger.debug(`Installed prompt: ${targetName}`);\n      }\n    }\n\n    logger.debug(`Installed ${installed} prompt files`);\n  } else {\n    logger.warning(`Prompts assets not found at ${promptsSource}`);\n  }\n}\n\n/**\n * Create configuration files (package.json, playwright.config.ts, etc.)\n */\nasync function createConfigurationFiles(\n  artkE2ePath: string,\n  artkDir: string,\n  projectPath: string,\n  options: { projectName: string; variant: 'commonjs' | 'esm' }\n): Promise<void> {\n  // package.json\n  await fs.writeJson(\n    path.join(artkE2ePath, 'package.json'),\n    {\n      name: 'artk-e2e',\n      version: '1.0.0',\n      private: true,\n      scripts: {\n        test: 'playwright test',\n        'test:smoke': 'playwright test --grep @smoke',\n        'test:release': 'playwright test --grep @release',\n        'test:regression': 'playwright test --grep @regression',\n        'test:validation': 'playwright test --project=validation',\n        'test:ui': 'playwright test --ui',\n        report: 'playwright show-report',\n        typecheck: 'tsc --noEmit',\n      },\n      dependencies: {\n        yaml: '^2.3.4',\n      },\n      devDependencies: {\n        '@artk/core': 'file:./vendor/artk-core',\n        '@artk/core-autogen': 'file:./vendor/artk-core-autogen',\n        '@playwright/test': '^1.57.0',\n        '@types/node': '^20.10.0',\n        typescript: '^5.3.0',\n      },\n    },\n    { spaces: 2 }\n  );\n\n  // playwright.config.ts\n  await fs.writeFile(\n    path.join(artkE2ePath, 'playwright.config.ts'),\n    getPlaywrightConfigTemplate()\n  );\n\n  // tsconfig.json\n  await fs.writeJson(\n    path.join(artkE2ePath, 'tsconfig.json'),\n    {\n      compilerOptions: {\n        target: 'ES2022',\n        module: 'CommonJS',\n        moduleResolution: 'Node',\n        lib: ['ES2022', 'DOM'],\n        strict: true,\n        esModuleInterop: true,\n        allowSyntheticDefaultImports: true,\n        skipLibCheck: true,\n        forceConsistentCasingInFileNames: true,\n        outDir: './dist',\n        rootDir: '.',\n        declaration: true,\n        resolveJsonModule: true,\n        baseUrl: '.',\n        paths: {\n          '@artk/core': ['./vendor/artk-core/dist'],\n          '@artk/core/*': ['./vendor/artk-core/dist/*'],\n        },\n      },\n      include: ['tests/**/*', 'src/**/*', 'config/**/*', '*.ts'],\n      exclude: ['node_modules', 'dist', 'vendor'],\n    },\n    { spaces: 2 }\n  );\n\n  // artk.config.yml\n  await fs.writeFile(\n    path.join(artkE2ePath, 'artk.config.yml'),\n    getArtkConfigTemplate(options.projectName)\n  );\n\n  // .gitignore\n  await fs.writeFile(\n    path.join(artkE2ePath, '.gitignore'),\n    `node_modules/\ndist/\ntest-results/\nplaywright-report/\n.auth-states/\n*.local\n`\n  );\n\n  // Foundation module stubs\n  await createFoundationStubs(artkE2ePath);\n\n  // .artk/context.json\n  await fs.ensureDir(artkDir);\n  await fs.writeJson(\n    path.join(artkDir, 'context.json'),\n    {\n      version: '1.0',\n      projectRoot: projectPath,\n      artkRoot: artkE2ePath,\n      initialized_at: new Date().toISOString(),\n      templateVariant: options.variant,\n      next_suggested: '/artk.init-playbook',\n    },\n    { spaces: 2 }\n  );\n\n  // .artk/.gitignore\n  await fs.writeFile(\n    path.join(artkDir, '.gitignore'),\n    `# ARTK temporary files\nbrowsers/\nheal-logs/\nlogs/\n*.heal.json\nselector-catalog.local.json\n`\n  );\n}\n\n/**\n * Create foundation module stubs\n */\nasync function createFoundationStubs(artkE2ePath: string): Promise<void> {\n  const foundationPath = path.join(artkE2ePath, 'src', 'modules', 'foundation');\n\n  // Main index\n  await fs.writeFile(\n    path.join(foundationPath, 'index.ts'),\n    `/**\n * Foundation Modules - Core testing infrastructure\n *\n * These modules are populated by /artk.discover-foundation and provide:\n * - Auth: Login flows and storage state management\n * - Navigation: Route helpers and URL builders\n * - Selectors: Locator utilities and data-testid helpers\n * - Data: Test data builders and cleanup\n */\n\nexport * from './auth';\nexport * from './navigation';\nexport * from './selectors';\nexport * from './data';\n`\n  );\n\n  // Module stubs\n  const modules = ['auth', 'navigation', 'selectors', 'data'];\n  for (const module of modules) {\n    await fs.writeFile(\n      path.join(foundationPath, module, 'index.ts'),\n      `/**\n * Foundation Module: ${module}\n *\n * This file will be populated by /artk.discover-foundation\n */\n\n// Placeholder export to prevent import errors\nexport {};\n`\n    );\n  }\n\n  // Features index\n  await fs.writeFile(\n    path.join(artkE2ePath, 'src', 'modules', 'features', 'index.ts'),\n    `/**\n * Feature Modules - Journey-specific page objects\n *\n * These modules are created as Journeys are implemented and provide\n * page objects and flows for specific feature areas.\n */\n\nexport {};\n`\n  );\n\n  // Config env stub\n  await fs.writeFile(\n    path.join(artkE2ePath, 'config', 'env.ts'),\n    `/**\n * Environment Configuration Loader\n *\n * Loads environment-specific config from artk.config.yml\n */\nimport * as fs from 'fs';\nimport * as path from 'path';\n\nexport interface EnvironmentConfig {\n  name: string;\n  baseUrl: string;\n}\n\nexport function getBaseUrl(env?: string): string {\n  const targetEnv = env || process.env.ARTK_ENV || 'local';\n\n  // Try to load from artk.config.yml\n  const configPath = path.join(__dirname, '..', 'artk.config.yml');\n  if (fs.existsSync(configPath)) {\n    const yaml = require('yaml');\n    const config = yaml.parse(fs.readFileSync(configPath, 'utf8'));\n    return config.environments?.[targetEnv]?.baseUrl || 'http://localhost:3000';\n  }\n\n  // Fallback defaults\n  const defaults: Record<string, string> = {\n    local: 'http://localhost:3000',\n    intg: 'https://intg.example.com',\n    ctlq: 'https://ctlq.example.com',\n    prod: 'https://example.com',\n  };\n\n  return defaults[targetEnv] || defaults.local;\n}\n\nexport function getCurrentEnv(): string {\n  return process.env.ARTK_ENV || 'local';\n}\n`\n  );\n}\n\n/**\n * Run npm install in artk-e2e directory\n */\nasync function runNpmInstall(artkE2ePath: string, logger: Logger): Promise<void> {\n  return new Promise((resolve, reject) => {\n    logger.startSpinner('Installing dependencies...');\n\n    const child = spawn('npm', ['install', '--legacy-peer-deps'], {\n      cwd: artkE2ePath,\n      env: {\n        ...process.env,\n        PLAYWRIGHT_SKIP_BROWSER_DOWNLOAD: '1',\n      },\n      shell: true,\n      stdio: 'pipe',\n    });\n\n    let stderr = '';\n\n    child.stderr?.on('data', (data) => {\n      stderr += data.toString();\n    });\n\n    child.on('close', (code) => {\n      if (code === 0) {\n        logger.succeedSpinner('Dependencies installed');\n        resolve();\n      } else {\n        logger.failSpinner('npm install failed');\n        logger.debug(`stderr: ${stderr}`);\n        reject(new Error(`npm install failed with code ${code}`));\n      }\n    });\n\n    child.on('error', (error) => {\n      logger.failSpinner('npm install failed');\n      reject(error);\n    });\n\n    // Timeout after 5 minutes\n    setTimeout(() => {\n      child.kill();\n      logger.failSpinner('npm install timed out');\n      reject(new Error('npm install timed out'));\n    }, 300000);\n  });\n}\n\n/**\n * Update context.json with additional metadata\n */\nasync function updateContextJson(artkDir: string, updates: Record<string, any>): Promise<void> {\n  const contextPath = path.join(artkDir, 'context.json');\n\n  let context: Record<string, any> = {};\n  if (fs.existsSync(contextPath)) {\n    context = await fs.readJson(contextPath);\n  }\n\n  Object.assign(context, updates);\n  await fs.writeJson(contextPath, context, { spaces: 2 });\n}\n\n/**\n * Get the assets directory path\n */\nfunction getAssetsDir(): string {\n  // Try relative to the built CLI\n  const possiblePaths = [\n    path.join(__dirname, '..', '..', 'assets'),\n    path.join(__dirname, '..', 'assets'),\n    path.join(__dirname, 'assets'),\n  ];\n\n  for (const p of possiblePaths) {\n    if (fs.existsSync(p)) {\n      return p;\n    }\n  }\n\n  // Fallback to development path\n  return path.join(__dirname, '..', '..', 'assets');\n}\n\n/**\n * Print success summary\n */\nfunction printSuccessSummary(\n  logger: Logger,\n  projectPath: string,\n  artkE2ePath: string,\n  browserInfo?: BrowserInfo\n): void {\n  logger.blank();\n  logger.header('ARTK Installation Complete!');\n  logger.blank();\n\n  logger.info('Installed:');\n  logger.list([\n    'artk-e2e/                             - E2E test workspace',\n    'artk-e2e/vendor/artk-core/            - @artk/core (vendored)',\n    'artk-e2e/vendor/artk-core-autogen/    - @artk/core-autogen (vendored)',\n    'artk-e2e/package.json                 - Test workspace dependencies',\n    'artk-e2e/playwright.config.ts         - Playwright configuration',\n    'artk-e2e/tsconfig.json                - TypeScript configuration',\n    'artk-e2e/artk.config.yml              - ARTK configuration',\n    '.github/prompts/                      - Copilot prompts',\n    '.artk/context.json                    - ARTK context',\n    '.artk/browsers/                       - Playwright browsers cache',\n  ]);\n\n  if (browserInfo) {\n    logger.blank();\n    logger.info('Browser configuration:');\n    logger.table([\n      { label: 'channel', value: browserInfo.channel },\n      { label: 'strategy', value: browserInfo.strategy },\n      ...(browserInfo.path ? [{ label: 'path', value: browserInfo.path }] : []),\n    ]);\n  }\n\n  logger.nextSteps([\n    'cd artk-e2e',\n    'Open VS Code and use /artk.init-playbook in Copilot Chat',\n  ]);\n\n  logger.info('Run tests:');\n  logger.list(['cd artk-e2e && npm test']);\n}\n\n/**\n * Playwright config template\n */\nfunction getPlaywrightConfigTemplate(): string {\n  return `/**\n * Playwright Configuration for ARTK E2E Tests\n *\n * Note: Uses inline config loading to avoid ESM/CommonJS resolution issues\n * with vendored @artk/core packages.\n */\nimport { defineConfig, devices } from '@playwright/test';\nimport * as fs from 'fs';\nimport * as path from 'path';\n\n// Load ARTK config from artk.config.yml\nfunction loadArtkConfig(): Record<string, any> {\n  const configPath = path.join(__dirname, 'artk.config.yml');\n  if (!fs.existsSync(configPath)) {\n    console.warn(\\`ARTK config not found: \\${configPath}, using defaults\\`);\n    return { environments: { local: { baseUrl: 'http://localhost:3000' } } };\n  }\n\n  const yaml = require('yaml');\n  return yaml.parse(fs.readFileSync(configPath, 'utf8'));\n}\n\nconst artkConfig = loadArtkConfig();\nconst env = process.env.ARTK_ENV || 'local';\nconst baseURL = artkConfig.environments?.[env]?.baseUrl || 'http://localhost:3000';\nconst browserChannel = artkConfig.browsers?.channel;\n\n// Build browser use config\nconst browserUse: Record<string, any> = { ...devices['Desktop Chrome'] };\nif (browserChannel && browserChannel !== 'bundled') {\n  browserUse.channel = browserChannel;\n}\n\nexport default defineConfig({\n  testDir: './tests',\n  fullyParallel: true,\n  forbidOnly: !!process.env.CI,\n  retries: process.env.CI ? 2 : 0,\n  workers: process.env.CI ? 1 : undefined,\n  reporter: [['html', { open: 'never' }]],\n  timeout: artkConfig.settings?.timeout || 30000,\n\n  use: {\n    baseURL,\n    trace: 'on-first-retry',\n    screenshot: 'only-on-failure',\n  },\n\n  projects: [\n    // Auth setup project - runs first to create storage states\n    {\n      name: 'setup',\n      testMatch: /.*\\\\.setup\\\\.ts/,\n    },\n    // Main browser project with auth dependency\n    {\n      name: 'chromium',\n      use: browserUse,\n      dependencies: ['setup'],\n    },\n    // Validation project - no auth needed\n    {\n      name: 'validation',\n      testMatch: /foundation\\\\.validation\\\\.spec\\\\.ts/,\n      use: browserUse,\n    },\n  ],\n});\n`;\n}\n\n/**\n * ARTK config template\n */\nfunction getArtkConfigTemplate(projectName: string): string {\n  return `# ARTK Configuration\n# Generated by @artk/cli on ${new Date().toISOString()}\n\nversion: \"1.0\"\n\napp:\n  name: \"${projectName}\"\n  type: web\n  description: \"E2E tests for ${projectName}\"\n\nenvironments:\n  local:\n    baseUrl: \\${ARTK_BASE_URL:-http://localhost:3000}\n  intg:\n    baseUrl: \\${ARTK_INTG_URL:-https://intg.example.com}\n  ctlq:\n    baseUrl: \\${ARTK_CTLQ_URL:-https://ctlq.example.com}\n  prod:\n    baseUrl: \\${ARTK_PROD_URL:-https://example.com}\n\nauth:\n  provider: oidc\n  storageStateDir: ./.auth-states\n  # roles:\n  #   admin:\n  #     username: \\${ADMIN_USER}\n  #     password: \\${ADMIN_PASS}\n\nsettings:\n  parallel: true\n  retries: 2\n  timeout: 30000\n  traceOnFailure: true\n\nbrowsers:\n  enabled:\n    - chromium\n  channel: bundled\n  strategy: auto\n  viewport:\n    width: 1280\n    height: 720\n  headless: true\n`;\n}\n","/**\n * Prerequisites checker\n *\n * Verifies that all required tools are installed and configured.\n */\n\nimport { execSync } from 'child_process';\nimport * as fs from 'fs';\nimport * as semver from 'semver';\nimport { Logger } from './logger.js';\n\nexport interface PrerequisiteResult {\n  name: string;\n  status: 'pass' | 'fail' | 'warn';\n  version?: string;\n  required?: string;\n  message: string;\n  fix?: string;\n}\n\nexport interface PrerequisiteCheckResult {\n  passed: boolean;\n  results: PrerequisiteResult[];\n}\n\nconst MIN_NODE_VERSION = '18.0.0';\nconst MIN_NPM_VERSION = '8.0.0';\n\n/**\n * Check all prerequisites\n */\nexport async function checkPrerequisites(): Promise<PrerequisiteCheckResult> {\n  const results: PrerequisiteResult[] = [];\n\n  // Check Node.js version\n  results.push(checkNodeVersion());\n\n  // Check npm version\n  results.push(checkNpmVersion());\n\n  // Check git\n  results.push(checkGit());\n\n  // Check for browsers\n  results.push(await checkBrowsers());\n\n  const passed = results.every((r) => r.status !== 'fail');\n\n  return { passed, results };\n}\n\n/**\n * Check Node.js version\n */\nfunction checkNodeVersion(): PrerequisiteResult {\n  const version = process.version.replace(/^v/, '');\n\n  if (semver.gte(version, MIN_NODE_VERSION)) {\n    return {\n      name: 'Node.js',\n      status: 'pass',\n      version,\n      required: `>= ${MIN_NODE_VERSION}`,\n      message: `Node.js ${version} is installed`,\n    };\n  }\n\n  return {\n    name: 'Node.js',\n    status: 'fail',\n    version,\n    required: `>= ${MIN_NODE_VERSION}`,\n    message: `Node.js ${version} is too old`,\n    fix: `Upgrade to Node.js ${MIN_NODE_VERSION} or later: https://nodejs.org`,\n  };\n}\n\n/**\n * Check npm version\n */\nfunction checkNpmVersion(): PrerequisiteResult {\n  try {\n    const version = execSync('npm --version', { encoding: 'utf8' }).trim();\n\n    if (semver.gte(version, MIN_NPM_VERSION)) {\n      return {\n        name: 'npm',\n        status: 'pass',\n        version,\n        required: `>= ${MIN_NPM_VERSION}`,\n        message: `npm ${version} is installed`,\n      };\n    }\n\n    return {\n      name: 'npm',\n      status: 'fail',\n      version,\n      required: `>= ${MIN_NPM_VERSION}`,\n      message: `npm ${version} is too old`,\n      fix: `Upgrade npm: npm install -g npm@latest`,\n    };\n  } catch {\n    return {\n      name: 'npm',\n      status: 'fail',\n      message: 'npm is not installed or not in PATH',\n      fix: 'Install Node.js which includes npm: https://nodejs.org',\n    };\n  }\n}\n\n/**\n * Check git installation\n */\nfunction checkGit(): PrerequisiteResult {\n  try {\n    const version = execSync('git --version', { encoding: 'utf8' }).trim();\n    const match = version.match(/(\\d+\\.\\d+\\.\\d+)/);\n    const versionNum = match ? match[1] : 'unknown';\n\n    return {\n      name: 'Git',\n      status: 'pass',\n      version: versionNum,\n      message: `Git ${versionNum} is installed`,\n    };\n  } catch {\n    return {\n      name: 'Git',\n      status: 'warn',\n      message: 'Git is not installed or not in PATH',\n      fix: 'Install Git: https://git-scm.com',\n    };\n  }\n}\n\n/**\n * Check for available browsers\n */\nasync function checkBrowsers(): Promise<PrerequisiteResult> {\n  const browsers: string[] = [];\n\n  // Check for system browsers\n  if (await checkSystemBrowser('msedge')) {\n    browsers.push('Microsoft Edge');\n  }\n  if (await checkSystemBrowser('chrome')) {\n    browsers.push('Google Chrome');\n  }\n\n  // Check for Playwright bundled browsers\n  const playwrightBrowsersPath = getPlaywrightBrowsersPath();\n  if (playwrightBrowsersPath && fs.existsSync(playwrightBrowsersPath)) {\n    const entries = fs.readdirSync(playwrightBrowsersPath);\n    if (entries.some((e) => e.startsWith('chromium-'))) {\n      browsers.push('Playwright Chromium');\n    }\n  }\n\n  if (browsers.length > 0) {\n    return {\n      name: 'Browsers',\n      status: 'pass',\n      message: `Available: ${browsers.join(', ')}`,\n    };\n  }\n\n  return {\n    name: 'Browsers',\n    status: 'warn',\n    message: 'No browsers detected (will be installed during init)',\n    fix: 'Run: npx playwright install chromium',\n  };\n}\n\n/**\n * Check if a system browser is available\n */\nasync function checkSystemBrowser(browser: 'msedge' | 'chrome'): Promise<boolean> {\n  const paths = getBrowserPaths(browser);\n\n  for (const browserPath of paths) {\n    if (fs.existsSync(browserPath)) {\n      return true;\n    }\n  }\n\n  // Try running with --version\n  try {\n    const commands =\n      browser === 'msedge'\n        ? ['microsoft-edge', 'microsoft-edge-stable', 'msedge']\n        : ['google-chrome', 'google-chrome-stable', 'chrome'];\n\n    for (const cmd of commands) {\n      try {\n        execSync(`${cmd} --version`, { encoding: 'utf8', stdio: 'pipe' });\n        return true;\n      } catch {\n        // Try next command\n      }\n    }\n  } catch {\n    // Not found\n  }\n\n  return false;\n}\n\n/**\n * Get browser executable paths for the current platform\n */\nfunction getBrowserPaths(browser: 'msedge' | 'chrome'): string[] {\n  const paths: string[] = [];\n\n  if (process.platform === 'win32') {\n    const programFiles = process.env['ProgramFiles'] || 'C:\\\\Program Files';\n    const programFilesX86 = process.env['ProgramFiles(x86)'] || 'C:\\\\Program Files (x86)';\n    const localAppData = process.env['LOCALAPPDATA'] || '';\n\n    if (browser === 'msedge') {\n      paths.push(\n        `${programFilesX86}\\\\Microsoft\\\\Edge\\\\Application\\\\msedge.exe`,\n        `${programFiles}\\\\Microsoft\\\\Edge\\\\Application\\\\msedge.exe`,\n        `${localAppData}\\\\Microsoft\\\\Edge\\\\Application\\\\msedge.exe`\n      );\n    } else {\n      paths.push(\n        `${programFiles}\\\\Google\\\\Chrome\\\\Application\\\\chrome.exe`,\n        `${programFilesX86}\\\\Google\\\\Chrome\\\\Application\\\\chrome.exe`,\n        `${localAppData}\\\\Google\\\\Chrome\\\\Application\\\\chrome.exe`\n      );\n    }\n  } else if (process.platform === 'darwin') {\n    if (browser === 'msedge') {\n      paths.push('/Applications/Microsoft Edge.app/Contents/MacOS/Microsoft Edge');\n    } else {\n      paths.push('/Applications/Google Chrome.app/Contents/MacOS/Google Chrome');\n    }\n  } else {\n    // Linux\n    if (browser === 'msedge') {\n      paths.push(\n        '/usr/bin/microsoft-edge',\n        '/usr/bin/microsoft-edge-stable',\n        '/snap/bin/microsoft-edge'\n      );\n    } else {\n      paths.push(\n        '/usr/bin/google-chrome',\n        '/usr/bin/google-chrome-stable',\n        '/snap/bin/chromium',\n        '/usr/bin/chromium-browser'\n      );\n    }\n  }\n\n  return paths;\n}\n\n/**\n * Get Playwright browsers cache path\n */\nfunction getPlaywrightBrowsersPath(): string | null {\n  // Check environment variable first\n  if (process.env.PLAYWRIGHT_BROWSERS_PATH) {\n    return process.env.PLAYWRIGHT_BROWSERS_PATH;\n  }\n\n  // Default paths by platform\n  if (process.platform === 'win32') {\n    const localAppData = process.env.LOCALAPPDATA;\n    if (localAppData) {\n      return `${localAppData}\\\\ms-playwright`;\n    }\n  } else if (process.platform === 'darwin') {\n    const home = process.env.HOME;\n    if (home) {\n      return `${home}/Library/Caches/ms-playwright`;\n    }\n  } else {\n    const home = process.env.HOME;\n    if (home) {\n      return `${home}/.cache/ms-playwright`;\n    }\n  }\n\n  return null;\n}\n\n/**\n * Print prerequisites check results\n */\nexport function printPrerequisitesReport(result: PrerequisiteCheckResult, logger: Logger): void {\n  logger.blank();\n\n  for (const check of result.results) {\n    const icon = check.status === 'pass' ? '✓' : check.status === 'fail' ? '✗' : '⚠';\n    const color = check.status === 'pass' ? 'green' : check.status === 'fail' ? 'red' : 'yellow';\n\n    if (check.status === 'pass') {\n      logger.success(`${check.name}: ${check.message}`);\n    } else if (check.status === 'fail') {\n      logger.error(`${check.name}: ${check.message}`);\n      if (check.fix) {\n        logger.info(`  Fix: ${check.fix}`);\n      }\n    } else {\n      logger.warning(`${check.name}: ${check.message}`);\n      if (check.fix) {\n        logger.info(`  Fix: ${check.fix}`);\n      }\n    }\n  }\n\n  logger.blank();\n\n  if (result.passed) {\n    logger.success('All prerequisites satisfied!');\n  } else {\n    logger.error('Some prerequisites are not met. Please fix the issues above.');\n  }\n}\n","/**\n * Version utilities\n */\n\nimport * as fs from 'fs';\nimport * as path from 'path';\nimport { fileURLToPath } from 'url';\n\nconst __filename = fileURLToPath(import.meta.url);\nconst __dirname = path.dirname(__filename);\n\n/**\n * Get the CLI version from package.json\n */\nexport function getVersion(): string {\n  try {\n    // Try to find package.json relative to the built file\n    const possiblePaths = [\n      path.join(__dirname, '..', '..', 'package.json'),\n      path.join(__dirname, '..', 'package.json'),\n      path.join(__dirname, 'package.json'),\n    ];\n\n    for (const pkgPath of possiblePaths) {\n      if (fs.existsSync(pkgPath)) {\n        const pkg = JSON.parse(fs.readFileSync(pkgPath, 'utf8'));\n        return pkg.version || '0.0.0';\n      }\n    }\n\n    return '0.0.0';\n  } catch {\n    return '0.0.0';\n  }\n}\n\n/**\n * Get the @artk/core version from bundled assets\n */\nexport function getCoreVersion(): string {\n  try {\n    const possiblePaths = [\n      path.join(__dirname, '..', '..', 'assets', 'core', 'package.json'),\n      path.join(__dirname, '..', 'assets', 'core', 'package.json'),\n    ];\n\n    for (const pkgPath of possiblePaths) {\n      if (fs.existsSync(pkgPath)) {\n        const pkg = JSON.parse(fs.readFileSync(pkgPath, 'utf8'));\n        return pkg.version || '0.0.0';\n      }\n    }\n\n    return '0.0.0';\n  } catch {\n    return '0.0.0';\n  }\n}\n"]}