{"version":3,"sources":["../../errors/config-error.ts","../../utils/logger.ts","../../errors/auth-error.ts","../../auth/credentials.ts","../../config/env.ts","../../config/timeouts.ts","../../config/defaults.ts","../../config/schema.ts","../../config/migrate.ts","../../config/loader.ts"],"names":["logger","z","join","existsSync","readFileSync","parseYaml","envName","envConfig","resolve","dirname"],"mappings":";;;;;;;;;;;;AAeO,IAAM,eAAA,GAAN,MAAM,gBAAA,SAAwB,KAAA,CAAM;AAAA,EAWzC,WAAA,CAAY,OAAA,EAAiB,KAAA,EAAe,UAAA,EAAqB;AAC/D,IAAA,KAAA,CAAM,OAAO,CAAA;AARf;AAAA;AAAA;AAAA,IAAA,aAAA,CAAA,IAAA,EAAgB,OAAA,CAAA;AAKhB;AAAA;AAAA;AAAA,IAAA,aAAA,CAAA,IAAA,EAAgB,YAAA,CAAA;AAId,IAAA,IAAA,CAAK,IAAA,GAAO,iBAAA;AACZ,IAAA,IAAA,CAAK,KAAA,GAAQ,KAAA;AACb,IAAA,IAAA,CAAK,UAAA,GAAa,UAAA;AAGlB,IAAA,IAAI,MAAM,iBAAA,EAAmB;AAC3B,MAAA,KAAA,CAAM,iBAAA,CAAkB,MAAM,gBAAe,CAAA;AAAA,IAC/C;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKgB,QAAA,GAAmB;AACjC,IAAA,IAAI,MAAA,GAAS,GAAG,IAAA,CAAK,IAAI,KAAK,IAAA,CAAK,OAAO,CAAA,SAAA,EAAY,IAAA,CAAK,KAAK,CAAA,CAAA,CAAA;AAChE,IAAA,IAAI,KAAK,UAAA,EAAY;AACnB,MAAA,MAAA,IAAU;AAAA,cAAA,EAAmB,KAAK,UAAU,CAAA,CAAA;AAAA,IAC9C;AACA,IAAA,OAAO,MAAA;AAAA,EACT;AACF,CAAA;;;ACIA,IAAM,UAAA,GAAuC;AAAA,EAC3C,KAAA,EAAO,CAAA;AAAA,EACP,IAAA,EAAM,CAAA;AAAA,EACN,IAAA,EAAM,CAAA;AAAA,EACN,KAAA,EAAO;AACT,CAAA;AAwBA,IAAI,YAAA,GAA6B;AAAA,EAC/B,QAAA,EAAU,MAAA;AAAA,EACV,MAAA,EAAQ,MAAA;AAAA,EACR,MAAA,EAAQ,CAAC,KAAA,KAA0B;AAEjC,IAAA,MAAM,SAAS,KAAA,CAAM,KAAA,KAAU,OAAA,GAAU,OAAA,CAAQ,QAAQ,OAAA,CAAQ,GAAA;AAEjE,IAEO;AACL,MAAA,MAAA,CAAO,IAAA,CAAK,SAAA,CAAU,KAAK,CAAC,CAAA;AAAA,IAC9B;AAAA,EACF;AACF,CAAA;AA6DO,SAAS,YAAA,CAAa,QAAgB,SAAA,EAA2B;AACtE,EAAA,MAAM,GAAA,GAAM,CAAC,KAAA,EAAiB,OAAA,EAAiB,OAAA,KAA4C;AAEzF,IAAA,IAAI,WAAW,KAAK,CAAA,GAAI,UAAA,CAAW,YAAA,CAAa,QAAQ,CAAA,EAAG;AACzD,MAAA;AAAA,IACF;AAEA,IAAA,MAAM,KAAA,GAAkB;AAAA,MACtB,KAAA;AAAA,MACA,MAAA;AAAA,MACA,SAAA;AAAA,MACA,SAAA,EAAA,iBAAW,IAAI,IAAA,EAAK,EAAE,WAAA,EAAY;AAAA,MAClC,OAAA;AAAA,MACA;AAAA,KACF;AAEA,IAAA,YAAA,CAAa,OAAO,KAAK,CAAA;AAAA,EAC3B,CAAA;AAEA,EAAA,OAAO;AAAA,IACL,OAAO,CAAC,OAAA,EAAiB,YAA4C,GAAA,CAAI,OAAA,EAAS,SAAS,OAAO,CAAA;AAAA,IAClG,MAAM,CAAC,OAAA,EAAiB,YAA4C,GAAA,CAAI,MAAA,EAAQ,SAAS,OAAO,CAAA;AAAA,IAChG,MAAM,CAAC,OAAA,EAAiB,YAA4C,GAAA,CAAI,MAAA,EAAQ,SAAS,OAAO,CAAA;AAAA,IAChG,OAAO,CAAC,OAAA,EAAiB,YAA4C,GAAA,CAAI,OAAA,EAAS,SAAS,OAAO;AAAA,GACpG;AACF;;;ACnKO,IAAM,aAAA,GAAN,MAAM,cAAA,SAAsB,KAAA,CAAM;AAAA,EAqBvC,WAAA,CACE,OAAA,EACA,IAAA,EACA,KAAA,EACA,aACA,WAAA,EACA;AACA,IAAA,KAAA,CAAM,OAAO,CAAA;AAxBf;AAAA;AAAA;AAAA,IAAA,aAAA,CAAA,IAAA,EAAgB,MAAA,CAAA;AAKhB;AAAA;AAAA;AAAA,IAAA,aAAA,CAAA,IAAA,EAAgB,OAAA,CAAA;AAKhB;AAAA;AAAA;AAAA,IAAA,aAAA,CAAA,IAAA,EAAgB,aAAA,CAAA;AAKhB;AAAA;AAAA;AAAA,IAAA,aAAA,CAAA,IAAA,EAAgB,aAAA,CAAA;AAUd,IAAA,IAAA,CAAK,IAAA,GAAO,eAAA;AACZ,IAAA,IAAA,CAAK,IAAA,GAAO,IAAA;AACZ,IAAA,IAAA,CAAK,KAAA,GAAQ,KAAA;AACb,IAAA,IAAA,CAAK,WAAA,GAAc,WAAA;AACnB,IAAA,IAAA,CAAK,WAAA,GAAc,WAAA;AAGnB,IAAA,IAAI,MAAM,iBAAA,EAAmB;AAC3B,MAAA,KAAA,CAAM,iBAAA,CAAkB,MAAM,cAAa,CAAA;AAAA,IAC7C;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKgB,QAAA,GAAmB;AACjC,IAAA,IAAI,SAAS,CAAA,EAAG,IAAA,CAAK,IAAI,CAAA,EAAA,EAAK,KAAK,OAAO;AAAA,CAAA;AAC1C,IAAA,MAAA,IAAU,CAAA,QAAA,EAAW,KAAK,IAAI;AAAA,CAAA;AAC9B,IAAA,MAAA,IAAU,CAAA,SAAA,EAAY,KAAK,KAAK,CAAA,CAAA;AAEhC,IAAA,IAAI,KAAK,WAAA,EAAa;AACpB,MAAA,MAAA,IAAU;AAAA,gBAAA,EAAqB,KAAK,WAAW,CAAA,CAAA;AAAA,IACjD;AAEA,IAAA,IAAI,KAAK,WAAA,EAAa;AACpB,MAAA,MAAA,IAAU;AAAA,eAAA,EAAoB,KAAK,WAAW,CAAA,CAAA;AAAA,IAChD;AAEA,IAAA,OAAO,MAAA;AAAA,EACT;AACF,CAAA;;;ACrDA,IAAM,MAAA,GAAS,YAAA,CAAa,MAAA,EAAQ,aAAa,CAAA;AAmV1C,SAAS,yBAAA,CACd,KAAA,EACA,GAAA,GAA0C,OAAA,CAAQ,GAAA,EAC5C;AACN,EAAA,MAAM,cAAwB,EAAC;AAE/B,EAAA,KAAA,MAAW,CAAC,QAAA,EAAU,UAAU,KAAK,MAAA,CAAO,OAAA,CAAQ,KAAK,CAAA,EAAG;AAC1D,IAAA,MAAM,EAAE,QAAA,EAAU,QAAA,EAAS,GAAI,UAAA,CAAW,cAAA;AAE1C,IAAA,IAAI,CAAC,GAAA,CAAI,QAAQ,CAAA,EAAG;AAClB,MAAA,WAAA,CAAY,IAAA,CAAK,CAAA,EAAG,QAAQ,CAAA,YAAA,EAAe,QAAQ,CAAA,EAAA,CAAI,CAAA;AAAA,IACzD;AACA,IAAA,IAAI,CAAC,GAAA,CAAI,QAAQ,CAAA,EAAG;AAClB,MAAA,WAAA,CAAY,IAAA,CAAK,CAAA,EAAG,QAAQ,CAAA,YAAA,EAAe,QAAQ,CAAA,EAAA,CAAI,CAAA;AAAA,IACzD;AAAA,EACF;AAEA,EAAA,IAAI,WAAA,CAAY,SAAS,CAAA,EAAG;AAC1B,IAAA,MAAM,IAAI,aAAA;AAAA,MACR,CAAA;AAAA,CAAA,GACA,WAAA,CAAY,IAAI,CAAA,CAAA,KAAK,CAAA,IAAA,EAAO,CAAC,CAAA,CAAE,CAAA,CAAE,IAAA,CAAK,IAAI,CAAA,GAC1C;;AAAA,yCAAA,CAAA;AAAA,MACA,aAAA;AAAA,MACA,aAAA;AAAA,MACA,MAAA;AAAA,MACA;AAAA,KACF;AAAA,EACF;AAEA,EAAA,MAAA,CAAO,MAAM,gDAAA,EAAkD;AAAA,IAC7D,SAAA,EAAW,MAAA,CAAO,IAAA,CAAK,KAAK,CAAA,CAAE;AAAA,GAC/B,CAAA;AACH;;;AC3XA,IAAMA,OAAAA,GAAS,YAAA,CAAa,QAAA,EAAU,aAAa,CAAA;AAkB5C,IAAM,mBAAA,GAAN,MAAM,oBAAA,SAA4B,KAAA,CAAM;AAAA,EAC7C,WAAA,CACkB,SACA,SAAA,EAChB;AACA,IAAA,KAAA,CAAM,CAAA,sBAAA,EAAyB,OAAO,CAAA,gBAAA,CAAkB,CAAA;AAHxC,IAAA,IAAA,CAAA,OAAA,GAAA,OAAA;AACA,IAAA,IAAA,CAAA,SAAA,GAAA,SAAA;AAGhB,IAAA,IAAA,CAAK,IAAA,GAAO,qBAAA;AAEZ,IAAA,IAAI,MAAM,iBAAA,EAAmB;AAC3B,MAAA,KAAA,CAAM,iBAAA,CAAkB,MAAM,oBAAmB,CAAA;AAAA,IACnD;AAAA,EACF;AACF;AAkCO,SAAS,eAAe,GAAA,EAAoC;AACjE,EAAA,MAAM,WAAA,GAAc,yCAAA,CAA0C,IAAA,CAAK,GAAG,CAAA;AAEtE,EAAA,IAAI,CAAC,WAAA,EAAa;AAChB,IAAA,OAAO,MAAA;AAAA,EACT;AAEA,EAAA,MAAM,OAAA,GAAU,YAAY,CAAC,CAAA;AAC7B,EAAA,MAAM,YAAA,GAAe,YAAY,CAAC,CAAA;AAElC,EAAA,IAAI,YAAY,MAAA,EAAW;AACzB,IAAA,OAAO,MAAA;AAAA,EACT;AAEA,EAAA,OAAO;AAAA,IACL,KAAA,EAAO,GAAA;AAAA,IACP,OAAA;AAAA,IACA,YAAA;AAAA,IACA,UAAA,EAAY,WAAA,CAAY,CAAC,CAAA,KAAM;AAAA,GACjC;AACF;AAiBO,SAAS,eAAe,KAAA,EAAqC;AAClE,EAAA,MAAM,OAAoB,EAAC;AAC3B,EAAA,MAAM,OAAA,GAAU,wCAAA;AAEhB,EAAA,IAAI,KAAA;AACJ,EAAA,OAAA,CAAQ,KAAA,GAAQ,OAAA,CAAQ,IAAA,CAAK,KAAK,OAAO,IAAA,EAAM;AAC7C,IAAA,MAAM,OAAA,GAAU,MAAM,CAAC,CAAA;AAEvB,IAAA,IAAI,YAAY,MAAA,EAAW;AACzB,MAAA;AAAA,IACF;AAEA,IAAA,IAAA,CAAK,IAAA,CAAK;AAAA,MACR,KAAA,EAAO,MAAM,CAAC,CAAA;AAAA,MACd,OAAA;AAAA,MACA,YAAA,EAAc,MAAM,CAAC,CAAA;AAAA,MACrB,UAAA,EAAY,KAAA,CAAM,CAAC,CAAA,KAAM;AAAA,KAC1B,CAAA;AAAA,EACH;AAEA,EAAA,OAAO,IAAA;AACT;AA0CO,SAAS,gBAAA,CACd,GAAA,EACA,OAAA,GAA0B,EAAC,EACnB;AACR,EAAA,MAAM,EAAE,GAAA,GAAM,OAAA,CAAQ,KAAK,SAAA,EAAW,cAAA,GAAiB,MAAK,GAAI,OAAA;AAChE,EAAA,MAAM,KAAA,GAAQ,GAAA,CAAI,GAAA,CAAI,OAAO,CAAA;AAE7B,EAAA,IAAI,KAAA,KAAU,MAAA,IAAa,KAAA,KAAU,EAAA,EAAI;AACvC,IAAAA,OAAAA,CAAO,KAAA,CAAM,CAAA,iBAAA,EAAoB,GAAA,CAAI,OAAO,CAAA,CAAA,EAAI;AAAA,MAC9C,SAAA;AAAA,MACA,QAAA,EAAU;AAAA,KACX,CAAA;AACD,IAAA,OAAO,KAAA;AAAA,EACT;AAEA,EAAA,IAAI,GAAA,CAAI,UAAA,IAAc,GAAA,CAAI,YAAA,KAAiB,MAAA,EAAW;AACpD,IAAAA,OAAAA,CAAO,KAAA,CAAM,CAAA,kBAAA,EAAqB,GAAA,CAAI,OAAO,CAAA,CAAA,EAAI;AAAA,MAC/C,SAAA;AAAA,MACA,cAAc,GAAA,CAAI;AAAA,KACnB,CAAA;AACD,IAAA,OAAO,GAAA,CAAI,YAAA;AAAA,EACb;AAEA,EAAA,IAAI,cAAA,EAAgB;AAClB,IAAA,MAAM,IAAI,mBAAA,CAAoB,GAAA,CAAI,OAAA,EAAS,SAAS,CAAA;AAAA,EACtD;AAEA,EAAA,OAAO,GAAA,CAAI,KAAA;AACb;AAuBO,SAAS,cAAA,CACd,KAAA,EACA,OAAA,GAA0B,EAAC,EACnB;AACR,EAAA,MAAM,IAAA,GAAO,eAAe,KAAK,CAAA;AAEjC,EAAA,IAAI,IAAA,CAAK,WAAW,CAAA,EAAG;AACrB,IAAA,OAAO,KAAA;AAAA,EACT;AAEA,EAAA,IAAI,MAAA,GAAS,KAAA;AAEb,EAAA,KAAA,MAAW,OAAO,IAAA,EAAM;AACtB,IAAA,MAAM,QAAA,GAAW,gBAAA,CAAiB,GAAA,EAAK,OAAO,CAAA;AAC9C,IAAA,MAAA,GAAS,MAAA,CAAO,OAAA,CAAQ,GAAA,CAAI,KAAA,EAAO,QAAQ,CAAA;AAAA,EAC7C;AAEA,EAAA,OAAO,MAAA;AACT;AAcO,SAAS,cAAc,KAAA,EAAwB;AAEpD,EAAA,MAAM,OAAA,GAAU,mCAAA;AAChB,EAAA,OAAO,OAAA,CAAQ,KAAK,KAAK,CAAA;AAC3B;AA8BO,SAAS,uBACd,GAAA,EACA,OAAA,GAA0B,EAAC,EAC3B,cAAsB,EAAA,EACnB;AACH,EAAA,IAAI,GAAA,KAAQ,IAAA,IAAQ,GAAA,KAAQ,MAAA,EAAW;AACrC,IAAA,OAAO,GAAA;AAAA,EACT;AAEA,EAAA,IAAI,OAAO,QAAQ,QAAA,EAAU;AAC3B,IAAA,OAAO,eAAe,GAAA,EAAK;AAAA,MACzB,GAAG,OAAA;AAAA,MACH,SAAA,EAAW,eAAe,OAAA,CAAQ;AAAA,KACnC,CAAA;AAAA,EACH;AAEA,EAAA,IAAI,KAAA,CAAM,OAAA,CAAQ,GAAG,CAAA,EAAG;AACtB,IAAA,MAAM,WAAsB,GAAA,CAAI,GAAA;AAAA,MAAI,CAAC,IAAA,EAAe,KAAA,KAClD,sBAAA,CAAuB,IAAA,EAAM,SAAS,CAAA,EAAG,WAAW,CAAA,CAAA,EAAI,KAAK,CAAA,CAAA,CAAG;AAAA,KAClE;AACA,IAAA,OAAO,QAAA;AAAA,EACT;AAEA,EAAA,IAAI,OAAO,QAAQ,QAAA,EAAU;AAC3B,IAAA,MAAM,SAAkC,EAAC;AAEzC,IAAA,KAAA,MAAW,CAAC,GAAA,EAAK,KAAK,KAAK,MAAA,CAAO,OAAA,CAAQ,GAA8B,CAAA,EAAG;AACzE,MAAA,MAAM,OAAO,WAAA,GAAc,CAAA,EAAG,WAAW,CAAA,CAAA,EAAI,GAAG,CAAA,CAAA,GAAK,GAAA;AACrD,MAAA,MAAA,CAAO,GAAG,CAAA,GAAI,sBAAA,CAAuB,KAAA,EAAO,SAAS,IAAI,CAAA;AAAA,IAC3D;AAEA,IAAA,OAAO,MAAA;AAAA,EACT;AAEA,EAAA,OAAO,GAAA;AACT;AAqBO,SAAS,iBAAA,CACd,KAAA,EACA,GAAA,GAA0C,OAAA,CAAQ,GAAA,EACC;AACnD,EAAA,MAAM,UAAoD,EAAC;AAE3D,EAAA,SAAS,KAAA,CAAM,KAAc,IAAA,EAAoB;AAC/C,IAAA,IAAI,OAAO,QAAQ,QAAA,EAAU;AAC3B,MAAA,MAAM,IAAA,GAAO,eAAe,GAAG,CAAA;AAC/B,MAAA,KAAA,MAAW,OAAO,IAAA,EAAM;AACtB,QAAA,IAAI,CAAC,GAAA,CAAI,UAAA,KAAe,GAAA,CAAI,GAAA,CAAI,OAAO,CAAA,KAAM,MAAA,IAAa,GAAA,CAAI,GAAA,CAAI,OAAO,CAAA,KAAM,EAAA,CAAA,EAAK;AAClF,UAAA,OAAA,CAAQ,KAAK,EAAE,OAAA,EAAS,IAAI,OAAA,EAAS,SAAA,EAAW,MAAM,CAAA;AAAA,QACxD;AAAA,MACF;AAAA,IACF,CAAA,MAAA,IAAW,KAAA,CAAM,OAAA,CAAQ,GAAG,CAAA,EAAG;AAC7B,MAAA,GAAA,CAAI,OAAA,CAAQ,CAAC,IAAA,EAAM,KAAA,KAAU,KAAA,CAAM,IAAA,EAAM,CAAA,EAAG,IAAI,CAAA,CAAA,EAAI,KAAK,CAAA,CAAA,CAAG,CAAC,CAAA;AAAA,IAC/D,CAAA,MAAA,IAAW,GAAA,KAAQ,IAAA,IAAQ,OAAO,QAAQ,QAAA,EAAU;AAClD,MAAA,KAAA,MAAW,CAAC,GAAA,EAAK,QAAQ,KAAK,MAAA,CAAO,OAAA,CAAQ,GAAG,CAAA,EAAG;AACjD,QAAA,KAAA,CAAM,UAAU,IAAA,GAAO,CAAA,EAAG,IAAI,CAAA,CAAA,EAAI,GAAG,KAAK,GAAG,CAAA;AAAA,MAC/C;AAAA,IACF;AAAA,EACF;AAEA,EAAA,KAAA,CAAM,OAAO,EAAE,CAAA;AACf,EAAA,OAAO,OAAA;AACT;AAQO,SAAS,0BACd,OAAA,EACiB;AACjB,EAAA,MAAM,QAAA,GAAW,CAAC,GAAG,IAAI,GAAA,CAAI,OAAA,CAAQ,GAAA,CAAI,CAAC,CAAA,KAAM,CAAA,CAAE,OAAO,CAAC,CAAC,CAAA;AAC3D,EAAA,MAAM,aAAa,OAAA,CAAQ,GAAA,CAAI,CAAC,CAAA,KAAM,EAAE,SAAS,CAAA;AAEjD,EAAA,MAAM,YAAA,GAAe,QAAQ,CAAC,CAAA;AAC9B,EAAA,MAAM,OAAA,GACJ,OAAA,CAAQ,MAAA,KAAW,CAAA,IAAK,YAAA,GACpB,CAAA,uCAAA,EAA0C,YAAA,CAAa,OAAO,CAAA,CAAA,GAC9D,CAAA,wCAAA,EAA2C,QAAA,CAAS,IAAA,CAAK,IAAI,CAAC,CAAA,CAAA;AAEpE,EAAA,MAAM,UAAA,GACJ,OAAA,CAAQ,MAAA,KAAW,CAAA,IAAK,YAAA,GACpB,CAAA,QAAA,EAAW,YAAA,CAAa,OAAO,CAAA,0DAAA,EAA6D,YAAA,CAAa,OAAO,CAAA,UAAA,CAAA,GAChH,CAAA,uFAAA,CAAA;AAEN,EAAA,OAAO,IAAI,eAAA,CAAgB,OAAA,EAAS,WAAW,IAAA,CAAK,IAAI,GAAG,UAAU,CAAA;AACvE;;;ACvYO,IAAM,QAAA,GAAW;AAAA,EAYL;AAAA,EAGjB,gBAAA,EAAkB,GAAA;AAAA;AAAA,EAGlB,kBAAA,EAAoB,GAAA;AAAA;AAAA,EAGpB,oBAAA,EAAsB,GAAA;AAAA;AAAA,EAGtB,gBAAA,EAAkB,GAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAOlB,eAAA,EAAiB,GAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAOjB,gBAAA,EAAkB,GAAA;AAAA;AAAA,EAGlB,kBAAA,EAAoB,GActB,CAAA;;;AClCO,IAAM,gBAAA,GAA4B;AAOlC,IAAM,qBAAA,GAA4C;AAAA,EACvD,SAAA,EAAW,cAAA;AAAA,EACX,aAAA,EAAe,EAAA;AAAA,EACf,WAAA,EAAa;AACf;AAOO,IAAM,+BAA+B,QAAA,CAAS;AAG9C,IAAM,gBAAA,GAA4B;AAGlC,IAAM,mBAAA,GAAsB;AAG5B,IAAM,0BAA0B,QAAA,CAAS;AAGzC,IAAM,wBAAwB,QAAA,CAAS;AAGvC,IAAM,0BAA0B,QAAA,CAAS;AAGzC,IAAM,sBAAsB,QAAA,CAAS;AAOrC,IAAM,wBAAA,GAAuD;AAAA,EAClE,MAAA;AAAA,EACA,OAAA;AAAA,EACA,aAAA;AAAA,EACA,QAAA;AAAA,EACA,MAAA;AAAA,EACA;AACF;AAGO,IAAM,yBAAA,GAA4B;AAGlC,IAAM,iBAAA,GAAqC;AAAA,EAChD,eAAA,EAAiB,yBAAA;AAAA,EACjB,QAAA,EAAU;AACZ;AAOO,IAAM,wBAAwB,QAAA,CAAS;AAGvC,IAAM,0BAA0B,QAAA,CAAS;AAGzC,IAAM,kBAAA,GAAuC;AAAA,EAClD,KAAA,EAAO;AAAA,IACL,iBAAA,EAAmB,uCAAA;AAAA,IACnB,eAAA,EAAiB,uCAAA;AAAA,IACjB,aAAA,EAAe,WAAA;AAAA,IACf,OAAA,EAAS;AAAA,GACX;AAAA,EACA,OAAA,EAAS;AAAA,IACP,SAAA,EAAW,CAAC,UAAA,EAAY,UAAA,EAAY,uBAAuB,CAAA;AAAA,IAC3D,OAAA,EAAS;AAAA,GACX;AAAA,EACA,IAAA,EAAM;AAAA,IACJ,aAAA,EAAe,4DAAA;AAAA,IACf,iBAAA,EAAmB;AAAA;AAEvB;AAOO,IAAM,wBAAA,GAA2B;AAGjC,IAAM,wBAAA,GAA2B;AAGjC,IAAM,YAAA,GAA2B;AAAA,EACtC,SAAA,EAAW;AAAA,IACT,MAAA,EAAQ,wBAAA;AAAA,IACR,MAAA,EAAQ;AAAA,GACV;AAAA,EACA,OAAA,EAAS;AAAA,IACP,OAAA,EAAS,IAAA;AAAA,IACT,SAAA,EAAW,IAAA;AAAA,IACX,QAAA,EAAU;AAAA;AAEd;AAOO,IAAM,aAAA,GAAsD;AAAA,EACjE,KAAA,EAAO;AAAA,IACL,OAAA,EAAS,CAAA;AAAA,IACT,OAAA,EAAS,CAAA;AAAA,IACT,OAAA,EAAS,GAAA;AAAA,IACT,GAAA,EAAK;AAAA,GACP;AAAA,EACA,OAAA,EAAS;AAAA,IACP,OAAA,EAAS,CAAA;AAAA,IACT,OAAA,EAAS,CAAA;AAAA,IACT,OAAA,EAAS,GAAA;AAAA,IACT,GAAA,EAAK;AAAA,GACP;AAAA,EACA,UAAA,EAAY;AAAA,IACV,OAAA,EAAS,CAAA;AAAA,IACT,OAAA,EAAS,CAAA;AAAA,IACT,OAAA,EAAS,IAAA;AAAA,IACT,GAAA,EAAK;AAAA;AAET;AAOO,IAAM,qBAAA,GAA0C;AAGhD,IAAM,iBAAA,GAAqC;AAAA,EAChD,IAAA,EAAM;AAAA,IACJ,OAAA,EAAS,IAAA;AAAA,IACT,YAAA,EAAc,mBAAA;AAAA,IACd,IAAA,EAAM;AAAA,GACR;AAAA,EACA,IAAA,EAAM;AAAA,IACJ,OAAA,EAAS,KAAA;AAAA,IACT,UAAA,EAAY;AAAA,GACd;AAAA,EACA,KAAA,EAAO;AAAA,IACL,OAAA,EAAS,KAAA;AAAA,IACT,UAAA,EAAY;AAAA,GACd;AAAA,EACA,IAAA,EAAM;AAAA,IACJ,OAAA,EAAS,IAAA;AAAA,IACT,UAAA,EAAY,kBAAA;AAAA,IACZ,qBAAA,EAAuB;AAAA;AAE3B;AAOO,IAAM,uBAAA,GAA0C;AAGhD,IAAM,oBAAA,GAAoC;AAG1C,IAAM,iBAAA,GAAqC;AAAA,EAChD,SAAA,EAAW,cAAA;AAAA,EACX,WAAA,EAAa;AAAA,IACX,IAAA,EAAM,uBAAA;AAAA,IACN,QAAA,EAAU,IAAA;AAAA,IACV,OAAA,EAAS,KAAA;AAAA,IACT,YAAA,EAAc;AAAA;AAAA,MAEZ,wBAAA;AAAA,MACA,oBAAA;AAAA,MACA,uBAAA;AAAA,MACA,uBAAA;AAAA,MACA,qBAAA;AAAA,MACA,oBAAA;AAAA,MACA,wBAAA;AAAA,MACA,iCAAA;AAAA,MACA,8BAAA;AAAA;AAAA,MAEA,YAAA;AAAA,MACA,kBAAA;AAAA,MACA,aAAA;AAAA;AAAA,MAEA,YAAA;AAAA,MACA;AAAA;AACF,GACF;AAAA,EACA,KAAA,EAAO;AAAA,IACL,IAAA,EAAM;AAAA,GACR;AAAA,EACA,KAAA,EAAO;AAAA,IACL,IAAA,EAAM,oBAAA;AAAA,IACN,WAAA,EAAa,IAAA;AAAA,IACb,SAAA,EAAW;AAAA;AAEf;AAOO,IAAM,sBAAA,GAAyB;AAG/B,IAAM,uBAAA,GAA0B;AAGhC,IAAM,gBAAA,GAAmC;AAAA,EAC9C,OAAA,EAAS,CAAC,UAAU,CAAA;AAAA,EACpB,OAAA,EAAS,SAAA;AAAA,EACT,QAAA,EAAU,MAAA;AAAA,EACV,QAAA,EAAU;AAAA,IACR,KAAA,EAAO,sBAAA;AAAA,IACP,MAAA,EAAQ;AAAA,GACV;AAAA,EACA,QAAA,EAAU;AACZ;AAOO,IAAM,yBAAA,GAA4B;AAGlC,IAAM,wBAAA,GAA2B;AAGjC,IAAM,gBAAA,GAAmC;AAAA,EAC9C,EAAA,EAAI;AAAA,IACF,MAAA,EAAQ,yBAAA;AAAA,IACR,KAAA,EAAO;AAAA,GACT;AAAA,EACA,MAAA,EAAQ,MAAA;AAAA,EACR,OAAA,EAAS;AAAA,IACP,OAAA,EAAS;AAAA;AAEb;AAOO,IAAM,wBAAA,GAA2B;;;ACxPjC,IAAM,sBAAA,GAAyB,wBAAA;AAOtC,IAAM,iBAAiBC,KAAA,CAAE,MAAA,EAAO,CAAE,GAAA,CAAI,GAAG,mBAAmB,CAAA;AAG5D,IAAM,cAAcA,KAAA,CAAE,MAAA,EAAO,CAAE,GAAA,GAAM,QAAA,EAAS;AAG9C,IAAM,iBAAiBA,KAAA,CAAE,MAAA,EAAO,CAAE,GAAA,GAAM,WAAA,EAAY;AAGpD,IAAM,cAAA,GAAiBA,KAAA,CAAE,MAAA,EAAO,CAAE,QAAA,EAAS;AAO3C,IAAM,gBAAgBA,KAAA,CAAE,IAAA,CAAK,CAAC,KAAA,EAAO,KAAA,EAAO,QAAQ,CAAC,CAAA;AAG9C,IAAM,eAAA,GAAkBA,MAAE,MAAA,CAAO;AAAA,EACtC,IAAA,EAAM,cAAA,CAAe,QAAA,CAAS,kBAAkB,CAAA;AAAA,EAChD,OAAA,EAAS,cAAA,CAAe,QAAA,CAAS,+BAA+B,CAAA;AAAA,EAChE,IAAA,EAAM,aAAA,CAAc,OAAA,CAAQ,gBAAgB;AAC9C,CAAC;AAOM,IAAM,uBAAA,GAA0BA,MAAE,MAAA,CAAO;AAAA,EAC9C,OAAA,EAAS,cAAA,CAAe,QAAA,CAAS,sBAAsB,CAAA;AAAA,EACvD,MAAA,EAAQA,KAAA,CAAE,MAAA,EAAO,CAAE,QAAA;AACrB,CAAC;AAGM,IAAM,qBAAqBA,KAAA,CAAE,MAAA,CAAOA,KAAA,CAAE,MAAA,IAAU,uBAAuB;AAOvE,IAAM,wBAAA,GAA2BA,MAAE,MAAA,CAAO;AAAA,EAC/C,WAAWA,KAAA,CAAE,MAAA,EAAO,CAAE,OAAA,CAAQ,sBAAsB,SAAS,CAAA;AAAA,EAC7D,aAAA,EAAe,cAAA,CAAe,OAAA,CAAQ,qBAAA,CAAsB,aAAa,CAAA;AAAA,EACzE,WAAA,EAAa,cAAA,CAAe,OAAA,CAAQ,qBAAA,CAAsB,WAAW;AACvE,CAAC;AAOM,IAAM,0BAAA,GAA6BA,MAAE,MAAA,CAAO;AAAA,EACjD,QAAA,EAAU,cAAA,CAAe,QAAA,CAAS,2BAA2B,CAAA;AAAA,EAC7D,QAAA,EAAU,cAAA,CAAe,QAAA,CAAS,2BAA2B;AAC/D,CAAC;AAOD,IAAM,iBAAA,GAAoBA,MAAE,IAAA,CAAK;AAAA,EAC/B,UAAA;AAAA,EACA,UAAA;AAAA,EACA,MAAA;AAAA,EACA,OAAA;AAAA,EACA;AACF,CAAC,CAAA;AAGD,IAAM,aAAA,GAAgBA,MAAE,IAAA,CAAK,CAAC,QAAQ,MAAA,EAAQ,KAAA,EAAO,MAAM,CAAC,CAAA;AAGrD,IAAM,uBAAA,GAA0BA,MACpC,MAAA,CAAO;AAAA,EACN,GAAA,EAAKA,KAAA,CAAE,MAAA,EAAO,CAAE,QAAA,EAAS;AAAA,EACzB,QAAA,EAAUA,KAAA,CAAE,MAAA,EAAO,CAAE,QAAA,EAAS;AAAA,EAC9B,OAAA,EAAS,WAAA,CAAY,OAAA,CAAQ,4BAA4B;AAC3D,CAAC,CAAA,CACA,OAAO,CAAC,IAAA,KAAS,KAAK,GAAA,KAAQ,MAAA,IAAa,IAAA,CAAK,QAAA,KAAa,MAAA,EAAW;AAAA,EACvE,OAAA,EAAS;AACX,CAAC;AAGI,IAAM,sBAAA,GAAyBA,MACnC,MAAA,CAAO;AAAA,EACN,QAAA,EAAUA,KAAA,CAAE,MAAA,EAAO,CAAE,QAAA,EAAS;AAAA,EAC9B,QAAA,EAAUA,KAAA,CAAE,MAAA,EAAO,CAAE,QAAA,EAAS;AAAA,EAC9B,MAAA,EAAQA,KAAA,CAAE,MAAA,EAAO,CAAE,QAAA,EAAS;AAAA,EAC5B,cAAA,EAAgBA,KAAA,CAAE,MAAA,EAAO,CAAE,QAAA;AAC7B,CAAC,EACA,QAAA;AAGI,IAAM,eAAA,GAAkBA,MAC5B,MAAA,CAAO;AAAA,EACN,OAAA,EAASA,KAAA,CAAE,OAAA,EAAQ,CAAE,QAAQ,mBAAmB,CAAA;AAAA,EAChD,IAAA,EAAM,aAAA,CAAc,OAAA,CAAQ,gBAAgB,CAAA;AAAA,EAC5C,aAAA,EAAeA,KAAA,CAAE,MAAA,EAAO,CAAE,QAAA,EAAS;AAAA,EACnC,aAAA,EAAe,WAAA,CAAY,OAAA,CAAQ,uBAAuB;AAC5D,CAAC,EACA,QAAA;AAGI,IAAM,kBAAA,GAAqBA,MAC/B,MAAA,CAAO;AAAA,EACN,WAAA,EAAa,WAAA,CAAY,OAAA,CAAQ,qBAAqB,CAAA;AAAA,EACtD,aAAA,EAAe,WAAA,CAAY,OAAA,CAAQ,uBAAuB,CAAA;AAAA,EAC1D,UAAA,EAAY,WAAA,CAAY,OAAA,CAAQ,mBAAmB;AACrD,CAAC,EACA,QAAA;AAGI,IAAM,sBAAA,GAAyBA,MACnC,MAAA,CAAO;AAAA,EACN,GAAA,EAAKA,KAAA,CAAE,MAAA,EAAO,CAAE,QAAA,EAAS;AAAA,EACzB,SAAA,EAAWA,KAAA,CAAE,OAAA,EAAQ,CAAE,QAAA;AACzB,CAAC,EACA,QAAA;AAGI,IAAM,gBAAA,GAAmBA,MAC7B,MAAA,CAAO;AAAA,EACN,OAAA,EAAS,iBAAA;AAAA,EACT,QAAA,EAAU,cAAA,CAAe,QAAA,CAAS,sBAAsB,CAAA;AAAA,EACxD,WAAA,EAAaA,KAAA,CAAE,MAAA,EAAO,CAAE,QAAA,EAAS;AAAA,EACjC,OAAA,EAAS,uBAAA;AAAA,EACT,YAAA,EAAc,sBAAA;AAAA,EACd,GAAA,EAAK,eAAA;AAAA,EACL,QAAA,EAAU,kBAAA;AAAA,EACV,MAAA,EAAQ;AACV,CAAC,EACA,QAAA;AAOI,IAAM,uBAAA,GAA0BA,MAAE,MAAA,CAAO;AAAA,EAC9C,QAAA,EAAU,cAAA;AAAA,EACV,QAAA,EAAU,cAAA;AAAA,EACV,MAAA,EAAQ;AACV,CAAC;AAGM,IAAM,2BAAA,GAA8BA,MAAE,MAAA,CAAO;AAAA,EAClD,GAAA,EAAKA,KAAA,CAAE,MAAA,EAAO,CAAE,QAAA,EAAS;AAAA,EACzB,QAAA,EAAUA,KAAA,CAAE,MAAA,EAAO,CAAE,QAAA;AACvB,CAAC;AAGM,IAAM,oBAAA,GAAuBA,MACjC,MAAA,CAAO;AAAA,EACN,QAAA,EAAU,cAAA;AAAA,EACV,SAAA,EAAW,uBAAA;AAAA,EACX,OAAA,EAAS;AACX,CAAC,EACA,QAAA;AAOI,IAAM,gBAAA,GAAmBA,MAAE,MAAA,CAAO;AAAA,EACvC,cAAA,EAAgB,0BAAA;AAAA,EAChB,WAAA,EAAaA,KAAA,CAAE,MAAA,EAAO,CAAE,QAAA,EAAS;AAAA,EACjC,aAAA,EAAe,iBAAiB,QAAA;AAClC,CAAC;AAGM,IAAM,cAAcA,KAAA,CAAE,MAAA,CAAOA,KAAA,CAAE,MAAA,IAAU,gBAAgB;AAOhE,IAAM,sBAAA,GAAyBA,MAAE,IAAA,CAAK,CAAC,QAAQ,MAAA,EAAQ,OAAA,EAAS,QAAQ,CAAC,CAAA;AAGzE,IAAM,oBAAA,GAAuBA,MAAE,IAAA,CAAK;AAAA,EAClC,MAAA;AAAA,EACA,cAAA;AAAA,EACA,eAAA;AAAA,EACA;AACF,CAAC,CAAA;AAGM,IAAM,sBAAA,GAAyBA,MAAE,MAAA,CAAO;AAAA,EAC7C,IAAA,EAAM,oBAAA,CAAqB,OAAA,CAAQ,SAAS,CAAA;AAAA,EAC5C,MAAA,EAAQA,KAAA,CAAE,MAAA,EAAO,CAAE,QAAA,EAAS;AAAA,EAC5B,cAAcA,KAAA,CAAE,KAAA,CAAMA,MAAE,MAAA,EAAQ,EAAE,QAAA;AACpC,CAAC,CAAA;AAGM,IAAM,gBAAA,GAAmBA,MAC7B,MAAA,CAAO;AAAA,EACN,QAAA,EAAU,sBAAA;AAAA,EACV,YAAA,EAAc,wBAAA,CAAyB,OAAA,CAAQ,qBAAqB,CAAA;AAAA,EACpE,KAAA,EAAO,WAAA,CAAY,MAAA,CAAO,CAAC,KAAA,KAAU,OAAO,IAAA,CAAK,KAAK,CAAA,CAAE,MAAA,GAAS,CAAA,EAAG;AAAA,IAClE,OAAA,EAAS;AAAA,GACV,CAAA;AAAA,EACD,MAAA,EAAQ,uBAAuB,QAAA,EAAS;AAAA,EACxC,IAAA,EAAM,gBAAA;AAAA,EACN,IAAA,EAAM;AACR,CAAC,CAAA,CACA,WAAA,CAAY,CAAC,IAAA,EAAM,GAAA,KAAQ;AAE1B,EAAA,IAAI,IAAA,CAAK,QAAA,KAAa,MAAA,IAAU,IAAA,CAAK,SAAS,MAAA,EAAW;AACvD,IAAA,GAAA,CAAI,QAAA,CAAS;AAAA,MACX,IAAA,EAAMA,MAAE,YAAA,CAAa,MAAA;AAAA,MACrB,OAAA,EAAS,wDAAA;AAAA,MACT,IAAA,EAAM,CAAC,MAAM;AAAA,KACd,CAAA;AAAA,EACH;AACA,EAAA,IAAI,IAAA,CAAK,QAAA,KAAa,MAAA,IAAU,IAAA,CAAK,SAAS,MAAA,EAAW;AACvD,IAAA,GAAA,CAAI,QAAA,CAAS;AAAA,MACX,IAAA,EAAMA,MAAE,YAAA,CAAa,MAAA;AAAA,MACrB,OAAA,EAAS,wDAAA;AAAA,MACT,IAAA,EAAM,CAAC,MAAM;AAAA,KACd,CAAA;AAAA,EACH;AACF,CAAC;AAOH,IAAM,qBAAA,GAAwBA,MAAE,IAAA,CAAK;AAAA,EACnC,MAAA;AAAA,EACA,OAAA;AAAA,EACA,aAAA;AAAA,EACA,QAAA;AAAA,EACA,MAAA;AAAA,EACA;AACF,CAAC,CAAA;AAGM,IAAM,qBAAA,GAAwBA,MAAE,MAAA,CAAO;AAAA,EAC5C,eAAA,EAAiBA,KAAA,CAAE,MAAA,EAAO,CAAE,QAAQ,yBAAyB,CAAA;AAAA,EAC7D,QAAA,EAAUA,MAAE,KAAA,CAAM,qBAAqB,EAAE,OAAA,CAAQ,CAAC,GAAG,wBAAwB,CAAC,CAAA;AAAA,EAC9E,eAAeA,KAAA,CAAE,KAAA,CAAMA,MAAE,MAAA,EAAQ,EAAE,QAAA;AACrC,CAAC;AAOM,IAAM,0BAAA,GAA6BA,MAAE,MAAA,CAAO;AAAA,EACjD,iBAAA,EAAmB,cAAA;AAAA,EACnB,eAAA,EAAiB,cAAA;AAAA,EACjB,aAAA,EAAe,cAAA;AAAA,EACf,OAAA,EAAS,WAAA,CAAY,OAAA,CAAQ,qBAAqB;AACpD,CAAC;AAGM,IAAM,4BAAA,GAA+BA,MAAE,MAAA,CAAO;AAAA,EACnD,WAAWA,KAAA,CAAE,KAAA,CAAM,cAAc,CAAA,CAAE,GAAA,CAAI,GAAG,wCAAwC,CAAA;AAAA,EAClF,OAAA,EAAS,WAAA,CAAY,OAAA,CAAQ,uBAAuB;AACtD,CAAC;AAGM,IAAM,yBAAA,GAA4BA,MAAE,MAAA,CAAO;AAAA,EAChD,aAAA,EAAe,cAAA;AAAA,EACf,iBAAA,EAAmB;AACrB,CAAC;AAGM,IAAM,sBAAA,GAAyBA,MAAE,MAAA,CAAO;AAAA,EAC7C,KAAA,EAAO,0BAAA,CAA2B,OAAA,CAAQ,kBAAA,CAAmB,KAAK,CAAA;AAAA,EAClE,OAAA,EAAS,4BAAA,CAA6B,OAAA,CAAQ,kBAAA,CAAmB,OAAO,CAAA;AAAA,EACxE,IAAA,EAAM,yBAAA,CAA0B,OAAA,CAAQ,kBAAA,CAAmB,IAAI;AACjE,CAAC;AAOM,IAAM,qBAAA,GAAwBA,MAAE,MAAA,CAAO;AAAA,EAC5C,QAAQA,KAAA,CAAE,MAAA,GAAS,OAAA,CAAQ,YAAA,CAAa,UAAU,MAAM,CAAA;AAAA,EACxD,QAAQA,KAAA,CAAE,MAAA,GAAS,OAAA,CAAQ,YAAA,CAAa,UAAU,MAAM;AAC1D,CAAC;AAGM,IAAM,mBAAA,GAAsBA,MAAE,MAAA,CAAO;AAAA,EAC1C,SAASA,KAAA,CAAE,OAAA,GAAU,OAAA,CAAQ,YAAA,CAAa,QAAQ,OAAO,CAAA;AAAA,EACzD,WAAWA,KAAA,CAAE,OAAA,GAAU,OAAA,CAAQ,YAAA,CAAa,QAAQ,SAAS,CAAA;AAAA,EAC7D,UAAUA,KAAA,CAAE,OAAA,GAAU,OAAA,CAAQ,YAAA,CAAa,QAAQ,QAAQ;AAC7D,CAAC;AAGM,IAAM,mBAAA,GAAsBA,MAChC,MAAA,CAAO;AAAA,EACN,OAAA,EAAS,cAAA;AAAA,EACT,WAAA,EAAaA,KAAA,CAAE,OAAA,EAAQ,CAAE,QAAQ,IAAI;AACvC,CAAC,EACA,QAAA;AAGI,IAAM,gBAAA,GAAmBA,MAAE,MAAA,CAAO;AAAA,EACvC,SAAA,EAAW,qBAAA,CAAsB,OAAA,CAAQ,YAAA,CAAa,SAAS,CAAA;AAAA,EAC/D,OAAA,EAAS,mBAAA,CAAoB,OAAA,CAAQ,YAAA,CAAa,OAAO,CAAA;AAAA,EACzD,GAAA,EAAK;AACP,CAAC;AAOM,IAAM,uBAAA,GAA0BA,MACpC,MAAA,CAAO;AAAA,EACN,OAAA,EAAS,cAAA;AAAA,EACT,gBAAA,EAAkBA,KAAA,CAAE,MAAA,CAAOA,KAAA,CAAE,MAAA,IAAUA,KAAA,CAAE,MAAA,EAAQ,CAAA,CAAE,QAAA;AACrD,CAAC,EACA,QAAA;AAGI,IAAM,oBAAA,GAAuBA,MAAE,MAAA,CAAO;AAAA,EAC3C,WAAA,EAAa,cAAA;AAAA,EACb,cAAcA,KAAA,CAAE,KAAA,CAAM,cAAc,CAAA,CAAE,OAAA,CAAQ,EAAE,CAAA;AAAA,EAChD,GAAA,EAAK;AACP,CAAC;AAOM,IAAM,gBAAA,GAAmBA,MAAE,MAAA,CAAO;AAAA,EACvC,OAAA,EAAS,cAAA;AAAA,EACT,OAAA,EAAS,WAAA;AAAA,EACT,OAAA,EAAS,WAAA;AAAA,EACT,GAAA,EAAK;AACP,CAAC;AAGM,IAAM,cAAcA,KAAA,CAAE,MAAA,CAAOA,KAAA,CAAE,MAAA,IAAU,gBAAgB;AAOhE,IAAM,yBAAyBA,KAAA,CAAE,IAAA,CAAK,CAAC,QAAA,EAAU,OAAA,EAAS,YAAY,CAAC,CAAA;AAGhE,IAAM,wBAAA,GAA2BA,MACrC,MAAA,CAAO;AAAA,EACN,OAAA,EAASA,KAAA,CAAE,OAAA,EAAQ,CAAE,QAAQ,IAAI,CAAA;AAAA,EACjC,YAAA,EAAcA,KAAA,CAAE,MAAA,EAAO,CAAE,QAAQ,mBAAmB,CAAA;AAAA,EACpD,IAAA,EAAM,sBAAA,CAAuB,OAAA,CAAQ,qBAAqB;AAC5D,CAAC,EACA,QAAA;AAGI,IAAM,wBAAA,GAA2BA,MACrC,MAAA,CAAO;AAAA,EACN,OAAA,EAASA,KAAA,CAAE,OAAA,EAAQ,CAAE,QAAQ,KAAK,CAAA;AAAA,EAClC,UAAA,EAAYA,KAAA,CAAE,MAAA,EAAO,CAAE,QAAQ,mBAAmB;AACpD,CAAC,EACA,QAAA;AAGI,IAAM,yBAAA,GAA4BA,MACtC,MAAA,CAAO;AAAA,EACN,OAAA,EAASA,KAAA,CAAE,OAAA,EAAQ,CAAE,QAAQ,KAAK,CAAA;AAAA,EAClC,UAAA,EAAYA,KAAA,CAAE,MAAA,EAAO,CAAE,QAAQ,WAAW;AAC5C,CAAC,EACA,QAAA;AAGI,IAAM,wBAAA,GAA2BA,MACrC,MAAA,CAAO;AAAA,EACN,OAAA,EAASA,KAAA,CAAE,OAAA,EAAQ,CAAE,QAAQ,IAAI,CAAA;AAAA,EACjC,UAAA,EAAYA,KAAA,CAAE,MAAA,EAAO,CAAE,QAAQ,kBAAkB,CAAA;AAAA,EACjD,qBAAA,EAAuBA,KAAA,CAAE,OAAA,EAAQ,CAAE,QAAQ,IAAI;AACjD,CAAC,EACA,QAAA;AAGI,IAAM,qBAAA,GAAwBA,MAAE,MAAA,CAAO;AAAA,EAC5C,IAAA,EAAM,wBAAA;AAAA,EACN,IAAA,EAAM,wBAAA;AAAA,EACN,KAAA,EAAO,yBAAA;AAAA,EACP,IAAA,EAAM;AACR,CAAC;AAOD,IAAM,uBAAuBA,KAAA,CAAE,IAAA,CAAK,CAAC,KAAA,EAAO,IAAA,EAAM,iBAAiB,CAAC,CAAA;AAGpE,IAAM,iBAAA,GAAoBA,MAAE,IAAA,CAAK;AAAA,EAC/B,KAAA;AAAA,EACA,IAAA;AAAA,EACA,mBAAA;AAAA,EACA;AACF,CAAC,CAAA;AAGM,IAAM,eAAA,GAAkBA,MAC5B,MAAA,CAAO;AAAA,EACN,KAAA,EAAO,WAAA;AAAA,EACP,MAAA,EAAQ;AACV,CAAC,EACA,QAAA;AAGI,IAAM,uBAAA,GAA0BA,MAAE,MAAA,CAAO;AAAA,EAC9C,IAAA,EAAM,oBAAA,CAAqB,OAAA,CAAQ,uBAAuB,CAAA;AAAA,EAC1D,UAAUA,KAAA,CAAE,OAAA,GAAU,OAAA,CAAQ,iBAAA,CAAkB,YAAY,QAAQ,CAAA;AAAA,EACpE,SAASA,KAAA,CAAE,OAAA,GAAU,OAAA,CAAQ,iBAAA,CAAkB,YAAY,OAAO,CAAA;AAAA,EAClE,YAAA,EAAcA,MAAE,KAAA,CAAMA,KAAA,CAAE,QAAQ,CAAA,CAAE,OAAA,CAAQ,EAAE;AAC9C,CAAC;AAGM,IAAM,iBAAA,GAAoBA,MAAE,MAAA,CAAO;AAAA,EACxC,IAAA,EAAM,iBAAA,CAAkB,OAAA,CAAQ,oBAAoB,CAAA;AAAA,EACpD,IAAA,EAAM;AACR,CAAC;AAGM,IAAM,iBAAA,GAAoBA,MAAE,MAAA,CAAO;AAAA,EACxC,IAAA,EAAM,iBAAA,CAAkB,OAAA,CAAQ,oBAAoB,CAAA;AAAA,EACpD,WAAA,EAAaA,KAAA,CAAE,OAAA,EAAQ,CAAE,QAAQ,IAAI,CAAA;AAAA,EACrC,SAAA,EAAWA,KAAA,CAAE,OAAA,EAAQ,CAAE,QAAQ,IAAI;AACrC,CAAC;AAGM,IAAM,qBAAA,GAAwBA,MAAE,MAAA,CAAO;AAAA,EAC5C,WAAWA,KAAA,CAAE,MAAA,EAAO,CAAE,OAAA,CAAQ,kBAAkB,SAAS,CAAA;AAAA,EACzD,WAAA,EAAa,uBAAA,CAAwB,OAAA,CAAQ,iBAAA,CAAkB,WAAW,CAAA;AAAA,EAC1E,KAAA,EAAO,iBAAA,CAAkB,OAAA,CAAQ,iBAAA,CAAkB,KAAK,CAAA;AAAA,EACxD,KAAA,EAAO,iBAAA,CAAkB,OAAA,CAAQ,iBAAA,CAAkB,KAAK;AAC1D,CAAC;AAOD,IAAM,oBAAoBA,KAAA,CAAE,IAAA,CAAK,CAAC,UAAA,EAAY,SAAA,EAAW,QAAQ,CAAC,CAAA;AAGlE,IAAM,oBAAA,GAAuBA,MAAE,IAAA,CAAK,CAAC,WAAW,QAAA,EAAU,QAAA,EAAU,aAAA,EAAe,YAAY,CAAC,CAAA;AAGhG,IAAM,qBAAA,GAAwBA,MAAE,IAAA,CAAK;AAAA,EACnC,MAAA;AAAA,EACA,gBAAA;AAAA,EACA,eAAA;AAAA,EACA,cAAA;AAAA,EACA;AACF,CAAC,CAAA;AAGM,IAAM,kBAAA,GAAqBA,MAAE,MAAA,CAAO;AAAA,EACzC,KAAA,EAAO,WAAA;AAAA,EACP,MAAA,EAAQ;AACV,CAAC;AAGM,IAAM,oBAAA,GAAuBA,MACjC,MAAA,CAAO;AAAA,EACN,OAAA,EAASA,KAAA,CAAE,KAAA,CAAM,iBAAiB,CAAA,CAAE,GAAA,CAAI,CAAA,EAAG,+BAA+B,CAAA,CAAE,OAAA,CAAQ,CAAC,UAAU,CAAC,CAAA;AAAA,EAChG,SAAS,oBAAA,CAAqB,QAAA,GAAW,OAAA,CAAQ,gBAAA,CAAiB,WAAW,SAAS,CAAA;AAAA,EACtF,UAAU,qBAAA,CAAsB,QAAA,GAAW,OAAA,CAAQ,gBAAA,CAAiB,YAAY,MAAM,CAAA;AAAA,EACtF,QAAA,EAAU,kBAAA,CAAmB,OAAA,CAAQ,gBAAA,CAAiB,QAAQ,CAAA;AAAA,EAC9D,UAAUA,KAAA,CAAE,OAAA,EAAQ,CAAE,OAAA,CAAQ,iBAAiB,QAAQ,CAAA;AAAA,EACvD,MAAA,EAAQ,YAAY,QAAA;AACtB,CAAC,CAAA,CACA,MAAA;AAAA,EACC,CAAC,MAAA,KAAW;AACV,IAAA,IAAI,OAAO,OAAA,KAAY,QAAA,IAAY,OAAO,OAAA,CAAQ,UAAA,CAAW,QAAQ,CAAA,EAAG;AACtE,MAAA,OAAO,MAAA,CAAO,OAAA,CAAQ,QAAA,CAAS,UAAU,CAAA;AAAA,IAC3C;AACA,IAAA,OAAO,IAAA;AAAA,EACT,CAAA;AAAA,EACA;AAAA,IACE,OAAA,EAAS;AAAA;AAEb;AAOF,IAAM,sBAAsBA,KAAA,CAAE,IAAA,CAAK,CAAC,MAAA,EAAQ,QAAQ,CAAC,CAAA;AAGrD,IAAM,uBAAuBA,KAAA,CAAE,IAAA,CAAK,CAAC,MAAA,EAAQ,QAAA,EAAU,OAAO,CAAC,CAAA;AAGxD,IAAM,qBAAA,GAAwBA,MAAE,MAAA,CAAO;AAAA,EAC5C,QAAQA,KAAA,CAAE,MAAA,GAAS,OAAA,CAAQ,gBAAA,CAAiB,GAAG,MAAM,CAAA;AAAA,EACrD,KAAA,EAAO,WAAA,CAAY,OAAA,CAAQ,gBAAA,CAAiB,GAAG,KAAK;AACtD,CAAC;AAGM,IAAM,0BAAA,GAA6BA,MAAE,MAAA,CAAO;AAAA,EACjD,OAAA,EAAS,oBAAA,CAAqB,OAAA,CAAQ,gBAAA,CAAiB,QAAQ,OAAO,CAAA;AAAA,EACtE,MAAA,EAAQ,qBAAqB,QAAA;AAC/B,CAAC;AAGM,IAAM,oBAAA,GAAuBA,MAAE,MAAA,CAAO;AAAA,EAC3C,EAAA,EAAI,qBAAA,CAAsB,OAAA,CAAQ,gBAAA,CAAiB,EAAE,CAAA;AAAA,EACrD,MAAA,EAAQ,mBAAA,CAAoB,OAAA,CAAQ,gBAAA,CAAiB,MAAM,CAAA;AAAA,EAC3D,OAAA,EAAS,0BAAA,CAA2B,OAAA,CAAQ,gBAAA,CAAiB,OAAO;AACtE,CAAC;AAgBM,IAAM,gBAAA,GAAmBA,MAC7B,MAAA,CAAO;AAAA,EACN,OAAA,EAASA,KAAA,CAAE,MAAA,EAAO,CAAE,GAAA,EAAI,CAAE,GAAA,CAAI,CAAC,CAAA,CAAE,QAAA,EAAS,CAAE,OAAA,CAAQ,wBAAwB,CAAA;AAAA,EAC5E,GAAA,EAAK,eAAA;AAAA,EACL,YAAA,EAAc,kBAAA,CAAmB,OAAA,CAAQ,EAAE,CAAA;AAAA,EAC3C,iBAAA,EAAmBA,KAAA,CAAE,MAAA,EAAO,CAAE,QAAQ,SAAS,CAAA;AAAA,EAC/C,IAAA,EAAM,gBAAA;AAAA,EACN,SAAA,EAAW,sBAAsB,OAAA,CAAQ;AAAA,IACvC,eAAA,EAAiB,yBAAA;AAAA,IACjB,QAAA,EAAU,CAAC,GAAG,wBAAwB;AAAA,GACvC,CAAA;AAAA,EACD,UAAA,EAAY,sBAAA,CAAuB,OAAA,CAAQ,kBAAkB,CAAA;AAAA,EAC7D,IAAA,EAAM,gBAAA,CAAiB,OAAA,CAAQ,YAAY,CAAA;AAAA,EAC3C,QAAA,EAAU,oBAAA;AAAA,EACV,KAAA,EAAO,WAAA,CAAY,OAAA,CAAQ,aAAa,CAAA;AAAA,EACxC,SAAA,EAAW,qBAAA,CAAsB,OAAA,CAAQ,iBAAiB,CAAA;AAAA,EAC1D,SAAA,EAAW,qBAAA,CAAsB,OAAA,CAAQ,iBAAiB,CAAA;AAAA,EAC1D,QAAA,EAAU,oBAAA,CAAqB,OAAA,CAAQ,gBAAgB,CAAA;AAAA,EACvD,QAAA,EAAU,oBAAA,CAAqB,OAAA,CAAQ,gBAAgB;AACzD,CAAC,CAAA,CACA,WAAA,CAAY,CAAC,IAAA,EAAM,GAAA,KAAQ;AAE1B,EAAA,MAAM,gBAAA,GACJ,KAAK,iBAAA,CAAkB,UAAA,CAAW,IAAI,CAAA,IACtC,IAAA,CAAK,iBAAA,CAAkB,QAAA,CAAS,GAAG,CAAA;AACrC,EAAA,MAAM,OAAA,GAAU,MAAA,CAAO,IAAA,CAAK,IAAA,CAAK,YAAY,CAAA;AAK7C,EAAA,IACE,CAAC,gBAAA,IACD,OAAA,CAAQ,MAAA,GAAS,CAAA,IACjB,CAAC,OAAA,CAAQ,QAAA,CAAS,IAAA,CAAK,iBAAiB,CAAA,EACxC;AACA,IAAA,GAAA,CAAI,QAAA,CAAS;AAAA,MACX,IAAA,EAAMA,MAAE,YAAA,CAAa,MAAA;AAAA,MACrB,OAAA,EAAS,sBAAsB,IAAA,CAAK,iBAAiB,wDAAwD,OAAA,CAAQ,IAAA,CAAK,IAAI,CAAC,CAAA,CAAA;AAAA,MAC/H,IAAA,EAAM,CAAC,mBAAmB;AAAA,KAC3B,CAAA;AAAA,EACH;AAGA,EAAA,MAAM,QAAA,GAAW,MAAA,CAAO,IAAA,CAAK,IAAA,CAAK,KAAK,KAAK,CAAA;AAC5C,EAAA,IAAI,CAAC,QAAA,CAAS,QAAA,CAAS,IAAA,CAAK,QAAA,CAAS,WAAW,CAAA,EAAG;AACjD,IAAA,GAAA,CAAI,QAAA,CAAS;AAAA,MACX,IAAA,EAAMA,MAAE,YAAA,CAAa,MAAA;AAAA,MACrB,OAAA,EAAS,yBAAyB,IAAA,CAAK,QAAA,CAAS,WAAW,CAAA,8CAAA,EAAiD,QAAA,CAAS,IAAA,CAAK,IAAI,CAAC,CAAA,CAAA;AAAA,MAC/H,IAAA,EAAM,CAAC,UAAA,EAAY,aAAa;AAAA,KACjC,CAAA;AAAA,EACH;AAGA,EAAA,KAAA,MAAW,WAAA,IAAe,IAAA,CAAK,QAAA,CAAS,YAAA,EAAc;AACpD,IAAA,IAAI,CAAC,QAAA,CAAS,QAAA,CAAS,WAAW,CAAA,EAAG;AACnC,MAAA,GAAA,CAAI,QAAA,CAAS;AAAA,QACX,IAAA,EAAMA,MAAE,YAAA,CAAa,MAAA;AAAA,QACrB,SAAS,CAAA,gCAAA,EAAmC,WAAW,6CAA6C,QAAA,CAAS,IAAA,CAAK,IAAI,CAAC,CAAA,CAAA;AAAA,QACvH,IAAA,EAAM,CAAC,UAAA,EAAY,cAAc;AAAA,OAClC,CAAA;AAAA,IACH;AAAA,EACF;AACF,CAAC;;;ACloBH,IAAMD,OAAAA,GAAS,YAAA,CAAa,QAAA,EAAU,SAAS,CAAA;AA0D/C,IAAM,UAAA,uBAAiB,GAAA,EAAuB;AAQvC,SAAS,kBAAkB,SAAA,EAA4B;AAC5D,EAAA,MAAM,MAAM,CAAA,EAAG,SAAA,CAAU,WAAW,CAAA,CAAA,EAAI,UAAU,SAAS,CAAA,CAAA;AAE3D,EAAA,IAAI,UAAA,CAAW,GAAA,CAAI,GAAG,CAAA,EAAG;AACvB,IAAA,MAAM,IAAI,KAAA;AAAA,MACR,CAAA,gBAAA,EAAmB,SAAA,CAAU,WAAW,CAAA,KAAA,EAAQ,UAAU,SAAS,CAAA,mBAAA;AAAA,KACrE;AAAA,EACF;AAGA,EAAA,IAAI,SAAA,CAAU,SAAA,KAAc,SAAA,CAAU,WAAA,GAAc,CAAA,EAAG;AACrD,IAAA,MAAM,IAAI,KAAA;AAAA,MACR,CAAA,2CAAA,EAA8C,SAAA,CAAU,WAAW,CAAA,QAAA,EAAM,UAAU,SAAS,CAAA,CAAA;AAAA,KAC9F;AAAA,EACF;AAEA,EAAA,UAAA,CAAW,GAAA,CAAI,KAAK,SAAS,CAAA;AAC7B,EAAAA,OAAAA,CAAO,KAAA,CAAM,CAAA,sBAAA,EAAyB,SAAA,CAAU,WAAW,CAAA,CAAA,EAAI;AAAA,IAC7D,aAAa,SAAA,CAAU,WAAA;AAAA,IACvB,WAAW,SAAA,CAAU;AAAA,GACtB,CAAA;AACH;AASO,SAAS,YAAA,CAAa,aAAqB,SAAA,EAA0C;AAC1F,EAAA,MAAM,GAAA,GAAM,CAAA,EAAG,WAAW,CAAA,CAAA,EAAI,SAAS,CAAA,CAAA;AACvC,EAAA,OAAO,UAAA,CAAW,IAAI,GAAG,CAAA;AAC3B;AA8BO,SAAS,eAAe,MAAA,EAA0C;AACvE,EAAA,MAAM,OAAA,GAAW,OAAO,OAAA,IAAkC,CAAA;AAC1D,EAAA,OAAO,OAAA,GAAU,sBAAA;AACnB;AAQO,SAAS,mBAAmB,OAAA,EAA0B;AAE3D,EAAA,OAAO,OAAA,IAAW,KAAK,OAAA,IAAW,sBAAA;AACpC;AAoBO,SAAS,cAAc,MAAA,EAAkD;AAC9E,EAAA,MAAM,WAAA,GAAe,OAAO,OAAA,IAAkC,CAAA;AAC9D,EAAA,IAAI,aAAA,GAAgB,EAAE,GAAG,MAAA,EAAO;AAChC,EAAA,MAAM,oBAA8B,EAAC;AAErC,EAAAA,OAAAA,CAAO,MAAM,oBAAA,EAAsB;AAAA,IACjC,WAAA;AAAA,IACA,aAAA,EAAe;AAAA,GAChB,CAAA;AAGD,EAAA,IAAI,CAAC,kBAAA,CAAmB,WAAW,CAAA,EAAG;AACpC,IAAA,MAAM,IAAI,KAAA;AAAA,MACR,CAAA,eAAA,EAAkB,WAAW,CAAA,yCAAA,EACF,sBAAsB,CAAA;AAAA,KACnD;AAAA,EACF;AAGA,EAAA,IAAI,gBAAgB,sBAAA,EAAwB;AAC1C,IAAAA,OAAAA,CAAO,MAAM,wDAAwD,CAAA;AACrE,IAAA,OAAO;AAAA,MACL,MAAA,EAAQ,aAAA;AAAA,MACR,WAAA;AAAA,MACA,SAAA,EAAW,sBAAA;AAAA,MACX,mBAAmB;AAAC,KACtB;AAAA,EACF;AAGA,EAAA,IAAI,cAAA,GAAiB,WAAA;AAErB,EAAA,OAAO,iBAAiB,sBAAA,EAAwB;AAC9C,IAAA,MAAM,cAAc,cAAA,GAAiB,CAAA;AACrC,IAAA,MAAM,SAAA,GAAY,YAAA,CAAa,cAAA,EAAgB,WAAW,CAAA;AAE1D,IAAA,IAAI,CAAC,SAAA,EAAW;AACd,MAAA,MAAM,IAAI,KAAA;AAAA,QACR,CAAA,yBAAA,EAA4B,cAAc,CAAA,KAAA,EAAQ,WAAW,CAAA,+BAAA;AAAA,OAE/D;AAAA,IACF;AAEA,IAAAA,OAAAA,CAAO,KAAA,CAAM,CAAA,oBAAA,EAAuB,SAAA,CAAU,WAAW,CAAA,CAAA,EAAI;AAAA,MAC3D,WAAA,EAAa,cAAA;AAAA,MACb,SAAA,EAAW;AAAA,KACZ,CAAA;AAGD,IAAA,aAAA,GAAgB,SAAA,CAAU,QAAQ,aAAa,CAAA;AAC/C,IAAA,iBAAA,CAAkB,IAAA,CAAK,UAAU,WAAW,CAAA;AAC5C,IAAA,cAAA,GAAiB,WAAA;AAAA,EACnB;AAGA,EAAA,aAAA,CAAc,OAAA,GAAU,sBAAA;AAExB,EAAAA,OAAAA,CAAO,KAAK,qBAAA,EAAuB;AAAA,IACjC,WAAA;AAAA,IACA,SAAA,EAAW,sBAAA;AAAA,IACX,mBAAmB,iBAAA,CAAkB;AAAA,GACtC,CAAA;AAED,EAAA,OAAO;AAAA,IACL,MAAA,EAAQ,aAAA;AAAA,IACR,WAAA;AAAA,IACA,SAAA,EAAW,sBAAA;AAAA,IACX;AAAA,GACF;AACF;AAYA,iBAAA,CAAkB;AAAA,EAChB,WAAA,EAAa,CAAA;AAAA,EACb,SAAA,EAAW,CAAA;AAAA,EACX,WAAA,EAAa,oCAAA;AAAA,EACb,OAAA,EAAS,CAAC,MAAA,KAAW;AAInB,IAAA,OAAO,EAAE,GAAG,MAAA,EAAO;AAAA,EACrB;AACF,CAAC,CAAA;;;AC7ND,IAAMA,OAAAA,GAAS,YAAA,CAAa,QAAA,EAAU,QAAQ,CAAA;AAS9C,IAAI,YAAA,GAAkC,IAAA;AAKtC,IAAI,cAAA,GAAgC,IAAA;AAS7B,IAAM,mBAAA,GAAsB;AAK5B,IAAM,iBAAA,GAAoB;AAAA,EAC/B,iBAAA;AAAA,EACA,kBAAA;AAAA,EACA;AACF;AAkEO,SAAS,cAAA,CAAe,OAAA,GAAkB,OAAA,CAAQ,GAAA,EAAI,EAAuB;AAElF,EAAA,MAAM,WAAA,GAAcE,SAAA,CAAK,OAAA,EAAS,mBAAmB,CAAA;AACrD,EAAA,IAAIC,aAAA,CAAW,WAAW,CAAA,EAAG;AAC3B,IAAA,OAAO,WAAA;AAAA,EACT;AAGA,EAAA,MAAM,OAAA,GAAUD,SAAA,CAAK,OAAA,EAAS,MAAM,CAAA;AACpC,EAAA,IAAIC,aAAA,CAAW,OAAO,CAAA,EAAG;AACvB,IAAA,KAAA,MAAW,YAAY,iBAAA,EAAmB;AACxC,MAAA,MAAM,QAAA,GAAWD,SAAA,CAAK,OAAA,EAAS,QAAQ,CAAA;AACvC,MAAA,IAAIC,aAAA,CAAW,QAAQ,CAAA,EAAG;AACxB,QAAA,OAAO,QAAA;AAAA,MACT;AAAA,IACF;AAAA,EACF;AAGA,EAAA,KAAA,MAAW,YAAY,iBAAA,EAAmB;AACxC,IAAA,MAAM,QAAA,GAAWD,SAAA,CAAK,OAAA,EAAS,QAAQ,CAAA;AACvC,IAAA,IAAIC,aAAA,CAAW,QAAQ,CAAA,EAAG;AACxB,MAAA,OAAO,QAAA;AAAA,IACT;AAAA,EACF;AAEA,EAAA,OAAO,MAAA;AACT;AASO,SAAS,aAAa,QAAA,EAA2B;AACtD,EAAA,IAAI;AACF,IAAA,MAAM,OAAA,GAAUC,eAAA,CAAa,QAAA,EAAU,OAAO,CAAA;AAC9C,IAAA,OAAOC,WAAU,OAAO,CAAA;AAAA,EAC1B,SAAS,KAAA,EAAO;AACd,IAAA,IAAI,iBAAiB,KAAA,IAAS,MAAA,IAAU,KAAA,IAAS,KAAA,CAAM,SAAS,QAAA,EAAU;AACxE,MAAA,MAAM,IAAI,eAAA;AAAA,QACR,iCAAiC,QAAQ,CAAA,CAAA;AAAA,QACzC,YAAA;AAAA,QACA,sBAAsB,QAAQ,CAAA,4BAAA;AAAA,OAChC;AAAA,IACF;AAEA,IAAA,IAAI,iBAAiB,KAAA,EAAO;AAC1B,MAAA,MAAM,IAAI,eAAA;AAAA,QACR,CAAA,oCAAA,EAAuC,MAAM,OAAO,CAAA,CAAA;AAAA,QACpD,YAAA;AAAA,QACA;AAAA,OACF;AAAA,IACF;AAEA,IAAA,MAAM,KAAA;AAAA,EACR;AACF;AAQO,SAAS,eAAe,KAAA,EAAyB;AACtD,EAAA,MAAM,MAAA,GAAS,KAAA,CAAM,MAAA,CAAO,GAAA,CAAI,CAAC,KAAA,KAAoB;AACnD,IAAA,MAAM,IAAA,GAAO,KAAA,CAAM,IAAA,CAAK,IAAA,CAAK,GAAG,CAAA;AAChC,IAAA,OAAO,CAAA,IAAA,EAAO,IAAA,IAAQ,MAAM,CAAA,EAAA,EAAK,MAAM,OAAO,CAAA,CAAA;AAAA,EAChD,CAAC,CAAA;AAED,EAAA,OAAO,CAAA;AAAA,EAAqC,MAAA,CAAO,IAAA,CAAK,IAAI,CAAC,CAAA,CAAA;AAC/D;AAQO,SAAS,sBAAsB,KAAA,EAAkC;AACtE,EAAA,MAAM,UAAA,GAAa,KAAA,CAAM,MAAA,CAAO,CAAC,CAAA;AACjC,EAAA,MAAM,OAAO,UAAA,GAAa,UAAA,CAAW,IAAA,CAAK,IAAA,CAAK,GAAG,CAAA,GAAI,SAAA;AACtD,EAAA,MAAM,OAAA,GAAU,eAAe,KAAK,CAAA;AAEpC,EAAA,IAAI,UAAA;AACJ,EAAA,IAAI,UAAA,EAAY;AACd,IAAA,QAAQ,WAAW,IAAA;AAAM,MACvB,KAAK,cAAA;AACH,QAAA,UAAA,GAAa,CAAA,SAAA,EAAY,UAAA,CAAW,QAAQ,CAAA,WAAA,EAAc,WAAW,QAAQ,CAAA,CAAA;AAC7E,QAAA;AAAA,MACF,KAAK,oBAAA;AACH,QAAA,UAAA,GAAa,CAAA,cAAA,EAAiB,UAAA,CAAW,OAAA,CAAQ,IAAA,CAAK,IAAI,CAAC,CAAA,CAAA;AAC3D,QAAA;AAAA,MACF,KAAK,WAAA;AACH,QAAA,UAAA,GACE,WAAW,IAAA,KAAS,QAAA,GAChB,uBAAA,GACA,CAAA,iBAAA,EAAoB,WAAW,OAAO,CAAA,CAAA;AAC5C,QAAA;AAAA,MACF,KAAK,QAAA;AACH,QAAA,UAAA,GAAa,UAAA,CAAW,OAAA;AACxB,QAAA;AAAA;AACJ,EACF;AAEA,EAAA,OAAO,IAAI,eAAA,CAAgB,OAAA,EAAS,IAAA,EAAM,UAAU,CAAA;AACtD;AAqBO,SAAS,UAAA,CAAW,OAAA,GAA6B,EAAC,EAAqB;AAC5E,EAAA,MAAM;AAAA,IACJ,OAAA,GAAU,QAAQ,GAAA,EAAI;AAAA,IACtB,MAAM,OAAA,CAAQ,GAAA;AAAA,IACd,WAAA,GAAc,KAAA;AAAA,IACd,iBAAA,EAAmB,WAAA;AAAA,IACnB,yBAAA,GAA4B;AAAA,GAC9B,GAAI,OAAA;AAGJ,EAAA,IAAI,CAAC,WAAA,IAAe,YAAA,KAAiB,IAAA,IAAQ,mBAAmB,IAAA,EAAM;AACpE,IAAA,MAAMC,WAAU,0BAAA,CAA2B,YAAA,EAAc,EAAE,GAAA,EAAK,QAAA,EAAU,aAAa,CAAA;AACvF,IAAA,MAAMC,UAAAA,GAAY,YAAA,CAAa,YAAA,CAAaD,QAAO,CAAA;AAEnD,IAAAN,QAAO,KAAA,CAAM,gCAAA,EAAkC,EAAE,IAAA,EAAM,gBAAgB,CAAA;AAEvE,IAAA,OAAO;AAAA,MACL,MAAA,EAAQ,YAAA;AAAA,MACR,UAAA,EAAY,cAAA;AAAA,MACZ,iBAAA,EAAmBM,QAAAA;AAAA,MACnB,iBAAA,EAAmBC;AAAA,KACrB;AAAA,EACF;AAGA,EAAA,IAAI,YAAA;AACJ,EAAA,IAAI,QAAQ,UAAA,EAAY;AACtB,IAAA,YAAA,GAAeC,YAAA,CAAQ,OAAA,EAAS,OAAA,CAAQ,UAAU,CAAA;AAAA,EACpD,CAAA,MAAO;AACL,IAAA,MAAM,SAAA,GAAY,eAAe,OAAO,CAAA;AACxC,IAAA,IAAI,CAAC,SAAA,EAAW;AACd,MAAA,MAAM,IAAI,eAAA;AAAA,QACR,mCAAmC,OAAO,CAAA,CAAA;AAAA,QAC1C,YAAA;AAAA,QACA,UAAU,mBAAmB,CAAA,yBAAA;AAAA,OAC/B;AAAA,IACF;AACA,IAAA,YAAA,GAAe,SAAA;AAAA,EACjB;AAEA,EAAAR,QAAO,IAAA,CAAK,uBAAA,EAAyB,EAAE,IAAA,EAAM,cAAc,CAAA;AAG3D,EAAA,MAAM,SAAA,GAAY,aAAa,YAAY,CAAA;AAE3C,EAAA,IAAI,OAAO,SAAA,KAAc,QAAA,IAAY,SAAA,KAAc,IAAA,EAAM;AACvD,IAAA,MAAM,IAAI,eAAA;AAAA,MACR,+CAAA;AAAA,MACA,MAAA;AAAA,MACA;AAAA,KACF;AAAA,EACF;AAGA,EAAA,MAAM,cAAA,GAAiC,EAAE,GAAA,EAAK,cAAA,EAAgB,KAAA,EAAM;AACpE,EAAA,MAAM,WAAA,GAAc,iBAAA,CAAkB,SAAA,EAAW,GAAG,CAAA;AAEpD,EAAA,IAAI,WAAA,CAAY,SAAS,CAAA,EAAG;AAC1B,IAAA,MAAM,0BAA0B,WAAW,CAAA;AAAA,EAC7C;AAGA,EAAA,IAAI,cAAA,GAAiB,sBAAA,CAAuB,SAAA,EAAW,cAAc,CAAA;AAGrE,EAAA,MAAM,aAAA,GAAiB,eAAe,OAAA,IAAkC,CAAA;AACxE,EAAA,IAAI,gBAAgB,sBAAA,EAAwB;AAC1C,IAAA,MAAM,IAAI,eAAA;AAAA,MACR,CAAA,sBAAA,EAAyB,aAAa,CAAA,sCAAA,EAAyC,sBAAsB,CAAA,CAAA,CAAA;AAAA,MACrG,SAAA;AAAA,MACA,2CAA2C,sBAAsB,CAAA,sBAAA;AAAA,KACnE;AAAA,EACF;AAGA,EAAA,IAAI,cAAA,CAAe,cAAc,CAAA,EAAG;AAClC,IAAA,MAAM,eAAA,GAAkB,cAAc,cAAc,CAAA;AAEpD,IAAA,IAAI,eAAA,CAAgB,iBAAA,CAAkB,MAAA,GAAS,CAAA,EAAG;AAChD,MAAAA,OAAAA,CAAO,IAAA;AAAA,QACL,CAAA,sBAAA,EAAyB,eAAA,CAAgB,WAAW,CAAA,KAAA,EAAQ,gBAAgB,SAAS,CAAA;AAAA,CAAA,GACrF,eAAA,CAAgB,kBAAkB,GAAA,CAAI,CAAA,CAAA,KAAK,OAAO,CAAC,CAAA,CAAE,CAAA,CAAE,IAAA,CAAK,IAAI;AAAA,OAClE;AAAA,IACF,CAAA,MAAO;AACL,MAAAA,OAAAA,CAAO,IAAA;AAAA,QACL,CAAA,6BAAA,EAAgC,eAAA,CAAgB,WAAW,CAAA,KAAA,EAAQ,gBAAgB,SAAS,CAAA,oBAAA;AAAA,OAC9F;AAAA,IACF;AAEA,IAAA,cAAA,GAAiB,eAAA,CAAgB,MAAA;AAAA,EACnC;AAGA,EAAA,MAAM,WAAA,GAAc,gBAAA,CAAiB,SAAA,CAAU,cAAc,CAAA;AAE7D,EAAA,IAAI,CAAC,YAAY,OAAA,EAAS;AACxB,IAAA,MAAM,qBAAA,CAAsB,YAAY,KAAK,CAAA;AAAA,EAC/C;AAEA,EAAA,MAAM,SAAS,WAAA,CAAY,IAAA;AAG3B,EAAA,IAAI,CAAC,yBAAA,EAA2B;AAC9B,IAAAA,OAAAA,CAAO,MAAM,sCAAsC,CAAA;AACnD,IAAA,yBAAA,CAA0B,MAAA,CAAO,IAAA,CAAK,KAAA,EAAO,GAAG,CAAA;AAAA,EAClD,CAAA,MAAO;AACL,IAAAA,OAAAA,CAAO,MAAM,oEAAoE,CAAA;AAAA,EACnF;AAGA,EAAA,MAAM,UAAU,0BAAA,CAA2B,MAAA,EAAQ,EAAE,GAAA,EAAK,QAAA,EAAU,aAAa,CAAA;AACjF,EAAA,MAAM,SAAA,GAAY,MAAA,CAAO,YAAA,CAAa,OAAO,CAAA;AAG7C,EAAA,YAAA,GAAe,MAAA;AACf,EAAA,cAAA,GAAiB,YAAA;AAEjB,EAAAA,OAAAA,CAAO,KAAK,mCAAA,EAAqC;AAAA,IAC/C,IAAA,EAAM,YAAA;AAAA,IACN,iBAAA,EAAmB,OAAA;AAAA,IACnB,KAAA,EAAO,MAAA,CAAO,IAAA,CAAK,MAAA,CAAO,KAAK,KAAK;AAAA,GACrC,CAAA;AAED,EAAA,OAAO;AAAA,IACL,MAAA;AAAA,IACA,UAAA,EAAY,YAAA;AAAA,IACZ,iBAAA,EAAmB,OAAA;AAAA,IACnB,iBAAA,EAAmB;AAAA,GACrB;AACF;AAyBA,SAAS,0BAAA,CACP,MAAA,EACA,OAAA,GAA+B,EAAC,EACxB;AACR,EAAA,MAAM,EAAE,GAAA,GAAM,OAAA,CAAQ,GAAA,EAAK,UAAS,GAAI,OAAA;AAGxC,EAAA,IAAI,QAAA,EAAU;AACZ,IAAA,OAAO,cAAA,CAAe,QAAA,EAAU,EAAE,GAAA,EAAK,CAAA;AAAA,EACzC;AAGA,EAAA,MAAM,OAAA,GAAU,IAAI,UAAU,CAAA;AAC9B,EAAA,IAAI,OAAA,EAAS;AACX,IAAA,OAAO,OAAA;AAAA,EACT;AAGA,EAAA,OAAO,eAAe,MAAA,CAAO,iBAAA,EAAmB,EAAE,GAAA,EAAK,cAAA,EAAgB,OAAO,CAAA;AAChF;AAWO,SAAS,gBAAA,GAAyB;AACvC,EAAA,YAAA,GAAe,IAAA;AACf,EAAA,cAAA,GAAiB,IAAA;AACjB,EAAAA,OAAAA,CAAO,MAAM,6BAA6B,CAAA;AAC5C;AAYO,SAAS,SAAA,GAAwB;AACtC,EAAA,IAAI,iBAAiB,IAAA,EAAM;AACzB,IAAA,MAAM,IAAI,eAAA;AAAA,MACR,oDAAA;AAAA,MACA,QAAA;AAAA,MACA;AAAA,KACF;AAAA,EACF;AACA,EAAA,OAAO,YAAA;AACT;AAOO,SAAS,cAAA,GAA0B;AACxC,EAAA,OAAO,YAAA,KAAiB,IAAA;AAC1B;AAQO,SAAS,YAAA,GAA0B;AACxC,EAAA,OAAO,WAAU,CAAE,GAAA;AACrB;AAQO,SAAS,aAAA,GAA4B;AAC1C,EAAA,OAAO,WAAU,CAAE,IAAA;AACrB;AAQO,SAAS,kBAAA,GAAsC;AACpD,EAAA,OAAO,WAAU,CAAE,SAAA;AACrB;AAQO,SAAS,mBAAA,GAAwC;AACtD,EAAA,OAAO,WAAU,CAAE,UAAA;AACrB;AAQO,SAAS,aAAA,GAA4B;AAC1C,EAAA,OAAO,WAAU,CAAE,IAAA;AACrB;AAQO,SAAS,iBAAA,GAAoC;AAClD,EAAA,OAAO,WAAU,CAAE,QAAA;AACrB;AASO,SAAS,cAAc,QAAA,EAA0C;AACtE,EAAA,OAAO,SAAA,EAAU,CAAE,KAAA,CAAM,QAAQ,CAAA;AACnC;AAQO,SAAS,cAAA,GAAuD;AACrE,EAAA,OAAO,WAAU,CAAE,KAAA;AACrB;AAQO,SAAS,kBAAA,GAAsC;AACpD,EAAA,OAAO,WAAU,CAAE,SAAA;AACrB;AAQO,SAAS,kBAAA,GAAsC;AACpD,EAAA,OAAO,WAAU,CAAE,SAAA;AACrB;AAQO,SAAS,iBAAA,GAAoC;AAClD,EAAA,OAAO,WAAU,CAAE,QAAA;AACrB;AAQO,SAAS,iBAAA,GAAoC;AAClD,EAAA,OAAO,WAAU,CAAE,QAAA;AACrB;AASO,SAAS,qBAAqB,OAAA,EAAgD;AACnF,EAAA,OAAO,SAAA,EAAU,CAAE,YAAA,CAAa,OAAO,CAAA;AACzC;AAQO,SAAS,qBAAA,GAAqE;AACnF,EAAA,OAAO,WAAU,CAAE,YAAA;AACrB;AAaO,SAAS,WAAW,iBAAA,EAAoC;AAC7D,EAAA,MAAM,SAAS,SAAA,EAAU;AACzB,EAAA,MAAM,OAAA,GAAU,qBAAqB,MAAA,CAAO,iBAAA;AAC5C,EAAA,MAAM,SAAA,GAAY,MAAA,CAAO,YAAA,CAAa,OAAO,CAAA;AAE7C,EAAA,IAAI,WAAW,OAAA,EAAS;AACtB,IAAA,OAAO,SAAA,CAAU,OAAA;AAAA,EACnB;AAEA,EAAA,OAAO,OAAO,GAAA,CAAI,OAAA;AACpB;AASO,SAAS,UAAU,iBAAA,EAAgD;AACxE,EAAA,MAAM,SAAS,SAAA,EAAU;AACzB,EAAA,MAAM,OAAA,GAAU,qBAAqB,MAAA,CAAO,iBAAA;AAC5C,EAAA,MAAM,SAAA,GAAY,MAAA,CAAO,YAAA,CAAa,OAAO,CAAA;AAE7C,EAAA,IAAI,WAAW,MAAA,EAAQ;AACrB,IAAA,OAAO,SAAA,CAAU,MAAA;AAAA,EACnB;AAGA,EAAA,OAAO,MAAA,CAAO,KAAK,GAAA,EAAK,OAAA;AAC1B;AASO,SAAS,mBAAmB,OAAA,EAA0B;AAC3D,EAAA,MAAM,SAAS,SAAA,EAAU;AACzB,EAAA,MAAM,UAAA,GAAa,MAAA,CAAO,IAAA,CAAK,YAAA,CAAa,SAAA;AAG5C,EAAA,MAAM,kBAAkB,OAAA,KAAY,cAAA,GAAiBS,aAAQ,cAAc,CAAA,GAAI,QAAQ,GAAA,EAAI,CAAA;AAE3F,EAAA,OAAOD,YAAA,CAAQ,iBAAiB,UAAU,CAAA;AAC5C;AAWO,SAAS,mBAAA,CACd,IAAA,EACA,GAAA,EACA,OAAA,EACQ;AACR,EAAA,MAAM,SAAS,SAAA,EAAU;AACzB,EAAA,MAAM,OAAA,GAAU,MAAA,CAAO,IAAA,CAAK,YAAA,CAAa,WAAA;AACzC,EAAA,MAAM,OAAA,GAAU,OAAO,MAAA,CAAO,iBAAA;AAG9B,EAAA,MAAM,QAAA,GAAW,QACd,OAAA,CAAQ,QAAA,EAAU,IAAI,CAAA,CACtB,OAAA,CAAQ,SAAS,OAAO,CAAA;AAE3B,EAAA,OAAON,SAAA,CAAK,kBAAA,CAAmB,OAAO,CAAA,EAAG,QAAQ,CAAA;AACnD","file":"index.cjs","sourcesContent":["/**\n * Configuration validation error\n *\n * Thrown when configuration validation fails, providing detailed information\n * about the invalid field and suggested fixes.\n *\n * @example\n * ```typescript\n * throw new ARTKConfigError(\n *   'Invalid auth provider',\n *   'auth.provider',\n *   'Did you mean: oidc, form, token, custom?'\n * );\n * ```\n */\nexport class ARTKConfigError extends Error {\n  /**\n   * JSON path to the invalid field (e.g., 'auth.oidc.idpType')\n   */\n  public readonly field: string;\n\n  /**\n   * Optional suggestion for fixing the error\n   */\n  public readonly suggestion?: string;\n\n  constructor(message: string, field: string, suggestion?: string) {\n    super(message);\n    this.name = 'ARTKConfigError';\n    this.field = field;\n    this.suggestion = suggestion;\n\n    // Maintain proper stack trace for where error was thrown (V8 only)\n    if (Error.captureStackTrace) {\n      Error.captureStackTrace(this, ARTKConfigError);\n    }\n  }\n\n  /**\n   * Format error as a human-readable string with field path and suggestion\n   */\n  public override toString(): string {\n    let result = `${this.name}: ${this.message} (field: ${this.field})`;\n    if (this.suggestion) {\n      result += `\\n  Suggestion: ${this.suggestion}`;\n    }\n    return result;\n  }\n}\n","/**\n * Structured logger utility\n *\n * Provides structured JSON logging with verbosity levels (debug, info, warn, error)\n * as required by NFR-001, NFR-002, and NFR-003.\n *\n * All logs include module, operation, and timestamp for filtering and aggregation.\n *\n * @example\n * ```typescript\n * import { createLogger } from './logger.js';\n *\n * const logger = createLogger('config', 'loadConfig');\n * logger.info('Loading configuration', { path: 'artk.config.yml' });\n * logger.error('Validation failed', { errors: [...] });\n * ```\n */\n\n/**\n * Log levels in order of severity\n */\nexport type LogLevel = 'debug' | 'info' | 'warn' | 'error';\n\n/**\n * Log output format\n */\nexport type LogFormat = 'json' | 'pretty';\n\n/**\n * Structured log entry\n */\nexport interface LogEntry {\n  level: LogLevel;\n  module: string;\n  operation: string;\n  timestamp: string;\n  message: string;\n  context?: Record<string, unknown>;\n}\n\n/**\n * Logger configuration\n */\nexport interface LoggerConfig {\n  minLevel: LogLevel;\n  format: LogFormat;\n  output: (entry: LogEntry) => void;\n}\n\n/**\n * Log level numeric values for comparison\n */\nconst LOG_LEVELS: Record<LogLevel, number> = {\n  debug: 0,\n  info: 1,\n  warn: 2,\n  error: 3,\n};\n\n/**\n * Format log entry as pretty text\n *\n * @param entry - Log entry to format\n * @returns Formatted string\n */\nfunction formatPretty(entry: LogEntry): string {\n  // Extract time from ISO timestamp (HH:MM:SS)\n  const time = entry.timestamp.split('T')[1]?.split('.')[0] || '00:00:00';\n\n  // Format level (uppercase, padded to 5 chars for alignment)\n  const level = entry.level.toUpperCase().padEnd(5);\n\n  // Format context if present\n  const context = entry.context ? ` ${JSON.stringify(entry.context)}` : '';\n\n  return `[${time}] ${level} [${entry.module}] ${entry.message}${context}`;\n}\n\n/**\n * Global logger configuration\n */\nlet globalConfig: LoggerConfig = {\n  minLevel: 'info',\n  format: 'json',\n  output: (entry: LogEntry): void => {\n    // eslint-disable-next-line no-console\n    const target = entry.level === 'error' ? console.error : console.log;\n\n    if (globalConfig.format === 'pretty') {\n      target(formatPretty(entry));\n    } else {\n      target(JSON.stringify(entry));\n    }\n  },\n};\n\n/**\n * Configure global logger settings\n *\n * @param config - Logger configuration\n *\n * @example\n * ```typescript\n * // JSON format (default, for production)\n * configureLogger({\n *   minLevel: 'debug',\n *   format: 'json'\n * });\n *\n * // Pretty format (for local development)\n * configureLogger({\n *   minLevel: 'debug',\n *   format: 'pretty'\n * });\n *\n * // Custom output\n * configureLogger({\n *   output: (entry) => fs.appendFileSync('artk.log', JSON.stringify(entry) + '\\n')\n * });\n * ```\n */\nexport function configureLogger(config: Partial<LoggerConfig>): void {\n  globalConfig = { ...globalConfig, ...config };\n}\n\n/**\n * Get current logger configuration\n */\nexport function getLoggerConfig(): Readonly<LoggerConfig> {\n  return { ...globalConfig };\n}\n\n/**\n * Logger interface\n */\nexport interface Logger {\n  debug(message: string, context?: Record<string, unknown>): void;\n  info(message: string, context?: Record<string, unknown>): void;\n  warn(message: string, context?: Record<string, unknown>): void;\n  error(message: string, context?: Record<string, unknown>): void;\n}\n\n/**\n * Create a logger for a specific module and operation\n *\n * @param module - Module name (e.g., 'config', 'auth', 'fixtures')\n * @param operation - Operation name (e.g., 'loadConfig', 'saveStorageState')\n * @returns Logger instance\n *\n * @example\n * ```typescript\n * const logger = createLogger('auth', 'oidcLogin');\n * logger.info('Starting OIDC login flow', { role: 'admin' });\n * ```\n */\nexport function createLogger(module: string, operation: string): Logger {\n  const log = (level: LogLevel, message: string, context?: Record<string, unknown>): void => {\n    // Check if this log level should be output\n    if (LOG_LEVELS[level] < LOG_LEVELS[globalConfig.minLevel]) {\n      return;\n    }\n\n    const entry: LogEntry = {\n      level,\n      module,\n      operation,\n      timestamp: new Date().toISOString(),\n      message,\n      context,\n    };\n\n    globalConfig.output(entry);\n  };\n\n  return {\n    debug: (message: string, context?: Record<string, unknown>): void => log('debug', message, context),\n    info: (message: string, context?: Record<string, unknown>): void => log('info', message, context),\n    warn: (message: string, context?: Record<string, unknown>): void => log('warn', message, context),\n    error: (message: string, context?: Record<string, unknown>): void => log('error', message, context),\n  };\n}\n\n/**\n * Parse log level from string (case-insensitive)\n *\n * @param level - Log level string\n * @returns Parsed log level or undefined if invalid\n *\n * @example\n * ```typescript\n * const level = parseLogLevel(process.env.LOG_LEVEL);\n * if (level) {\n *   configureLogger({ minLevel: level });\n * }\n * ```\n */\nexport function parseLogLevel(level: string | undefined): LogLevel | undefined {\n  if (!level) {\n    return undefined;\n  }\n\n  const normalized = level.toLowerCase() as LogLevel;\n  if (normalized in LOG_LEVELS) {\n    return normalized;\n  }\n\n  return undefined;\n}\n","/**\n * Authentication failure error\n *\n * Thrown when authentication fails, providing detailed information about\n * the failure phase, role, IdP response, and remediation steps.\n *\n * @example\n * ```typescript\n * throw new ARTKAuthError(\n *   'Failed to authenticate user',\n *   'admin',\n *   'credentials',\n *   'Invalid username or password',\n *   'Verify ADMIN_USERNAME and ADMIN_PASSWORD environment variables are set correctly'\n * );\n * ```\n */\nexport class ARTKAuthError extends Error {\n  /**\n   * Role that failed to authenticate\n   */\n  public readonly role: string;\n\n  /**\n   * Phase where authentication failed\n   */\n  public readonly phase: 'navigation' | 'credentials' | 'mfa' | 'callback';\n\n  /**\n   * Optional IdP response or error message\n   */\n  public readonly idpResponse?: string;\n\n  /**\n   * Optional remediation steps to fix the error\n   */\n  public readonly remediation?: string;\n\n  constructor(\n    message: string,\n    role: string,\n    phase: 'navigation' | 'credentials' | 'mfa' | 'callback',\n    idpResponse?: string,\n    remediation?: string\n  ) {\n    super(message);\n    this.name = 'ARTKAuthError';\n    this.role = role;\n    this.phase = phase;\n    this.idpResponse = idpResponse;\n    this.remediation = remediation;\n\n    // Maintain proper stack trace for where error was thrown (V8 only)\n    if (Error.captureStackTrace) {\n      Error.captureStackTrace(this, ARTKAuthError);\n    }\n  }\n\n  /**\n   * Format error as a human-readable string with context\n   */\n  public override toString(): string {\n    let result = `${this.name}: ${this.message}\\n`;\n    result += `  Role: ${this.role}\\n`;\n    result += `  Phase: ${this.phase}`;\n\n    if (this.idpResponse) {\n      result += `\\n  IdP Response: ${this.idpResponse}`;\n    }\n\n    if (this.remediation) {\n      result += `\\n  Remediation: ${this.remediation}`;\n    }\n\n    return result;\n  }\n}\n","/**\n * Credential management for ARTK Auth\n *\n * Provides secure credential loading from environment variables.\n *\n * FR-011: System MUST read credentials from environment variables (never hardcoded)\n *\n * @module auth/credentials\n * @example\n * ```typescript\n * import { getCredentials } from './credentials.js';\n *\n * // Given config: roles.admin.credentialsEnv = { username: 'ADMIN_USER', password: 'ADMIN_PASS' }\n * const creds = getCredentials('admin', config);\n * // Returns: { username: process.env.ADMIN_USER, password: process.env.ADMIN_PASS }\n * ```\n */\n\nimport type { Credentials } from './types.js';\nimport type { AuthConfig, RoleConfig } from '../config/types.js';\nimport { ARTKAuthError } from '../errors/auth-error.js';\nimport { createLogger } from '../utils/logger.js';\n\nconst logger = createLogger('auth', 'credentials');\n\n// =============================================================================\n// Types\n// =============================================================================\n\n/**\n * Options for credential loading\n */\nexport interface GetCredentialsOptions {\n  /**\n   * Environment variables to read from\n   * @default process.env\n   */\n  readonly env?: Record<string, string | undefined>;\n\n  /**\n   * Whether to mask password in logs\n   * @default true\n   */\n  readonly maskPassword?: boolean;\n}\n\n// =============================================================================\n// Functions\n// =============================================================================\n\n/**\n * Get credentials for a role from environment variables\n *\n * Reads the environment variable names from the role configuration\n * and returns the actual credential values from the environment.\n *\n * @param role - Role name as defined in config (e.g., 'admin', 'standardUser')\n * @param authConfig - Authentication configuration containing role definitions\n * @param options - Optional configuration\n * @returns Credentials object with username and password\n * @throws ARTKAuthError if role is not found or env vars are not set\n *\n * @example\n * ```typescript\n * // Config defines:\n * // auth.roles.admin.credentialsEnv = { username: 'ADMIN_USER', password: 'ADMIN_PASS' }\n *\n * // Environment has:\n * // ADMIN_USER=admin@example.com\n * // ADMIN_PASS=secret123\n *\n * const creds = getCredentials('admin', authConfig);\n * // Returns: { username: 'admin@example.com', password: 'secret123' }\n * ```\n */\nexport function getCredentials(\n  role: string,\n  authConfig: AuthConfig,\n  options: GetCredentialsOptions = {}\n): Credentials {\n  const env = options.env ?? process.env;\n  const maskPassword = options.maskPassword ?? true;\n\n  logger.debug('Getting credentials for role', { role });\n\n  // Get role configuration\n  const roleConfig = authConfig.roles[role];\n  if (!roleConfig) {\n    const availableRoles = Object.keys(authConfig.roles).join(', ');\n    logger.error('Role not found in configuration', { role, availableRoles });\n    throw new ARTKAuthError(\n      `Role \"${role}\" not found in auth configuration. Available roles: ${availableRoles}`,\n      role,\n      'credentials',\n      undefined,\n      `Check that the role \"${role}\" is defined in auth.roles in your artk.config.yml`\n    );\n  }\n\n  // Get environment variable names\n  const { username: usernameEnvVar, password: passwordEnvVar } = roleConfig.credentialsEnv;\n\n  // Read username from environment\n  const username = env[usernameEnvVar];\n  if (!username) {\n    logger.error('Username environment variable not set', {\n      role,\n      envVar: usernameEnvVar,\n    });\n    throw new ARTKAuthError(\n      `Environment variable \"${usernameEnvVar}\" for role \"${role}\" username is not set`,\n      role,\n      'credentials',\n      undefined,\n      `Set the ${usernameEnvVar} environment variable with the username for the \"${role}\" role`\n    );\n  }\n\n  // Read password from environment\n  const password = env[passwordEnvVar];\n  if (!password) {\n    logger.error('Password environment variable not set', {\n      role,\n      envVar: passwordEnvVar,\n    });\n    throw new ARTKAuthError(\n      `Environment variable \"${passwordEnvVar}\" for role \"${role}\" password is not set`,\n      role,\n      'credentials',\n      undefined,\n      `Set the ${passwordEnvVar} environment variable with the password for the \"${role}\" role`\n    );\n  }\n\n  logger.info('Credentials loaded successfully', {\n    role,\n    username,\n    password: maskPassword ? '***' : password,\n  });\n\n  return { username, password };\n}\n\n/**\n * Get credentials for a role using role config directly\n *\n * Lower-level function that takes role config instead of full auth config.\n *\n * @param role - Role name for error messages\n * @param roleConfig - Role configuration with credentialsEnv\n * @param options - Optional configuration\n * @returns Credentials object\n * @throws ARTKAuthError if env vars are not set\n */\nexport function getCredentialsFromRoleConfig(\n  role: string,\n  roleConfig: RoleConfig,\n  options: GetCredentialsOptions = {}\n): Credentials {\n  const env = options.env ?? process.env;\n  const maskPassword = options.maskPassword ?? true;\n\n  const { username: usernameEnvVar, password: passwordEnvVar } = roleConfig.credentialsEnv;\n\n  const username = env[usernameEnvVar];\n  if (!username) {\n    throw new ARTKAuthError(\n      `Environment variable \"${usernameEnvVar}\" for role \"${role}\" username is not set`,\n      role,\n      'credentials',\n      undefined,\n      `Set the ${usernameEnvVar} environment variable`\n    );\n  }\n\n  const password = env[passwordEnvVar];\n  if (!password) {\n    throw new ARTKAuthError(\n      `Environment variable \"${passwordEnvVar}\" for role \"${role}\" password is not set`,\n      role,\n      'credentials',\n      undefined,\n      `Set the ${passwordEnvVar} environment variable`\n    );\n  }\n\n  logger.debug('Credentials loaded from role config', {\n    role,\n    username,\n    password: maskPassword ? '***' : password,\n  });\n\n  return { username, password };\n}\n\n/**\n * Validate that all required credentials are available for a set of roles\n *\n * Checks all roles without throwing, returns list of missing credentials.\n *\n * @param roles - Array of role names to validate\n * @param authConfig - Authentication configuration\n * @param env - Environment variables (defaults to process.env)\n * @returns Array of missing credential info (empty if all valid)\n *\n * @example\n * ```typescript\n * const missing = validateCredentials(['admin', 'user'], authConfig);\n * if (missing.length > 0) {\n *   console.error('Missing credentials:', missing);\n * }\n * ```\n */\nexport function validateCredentials(\n  roles: readonly string[],\n  authConfig: AuthConfig,\n  env: Record<string, string | undefined> = process.env\n): ReadonlyArray<MissingCredential> {\n  const missing: MissingCredential[] = [];\n\n  for (const role of roles) {\n    const roleConfig = authConfig.roles[role];\n    if (!roleConfig) {\n      missing.push({\n        role,\n        type: 'role',\n        message: `Role \"${role}\" not found in configuration`,\n      });\n      continue;\n    }\n\n    const { username: usernameEnvVar, password: passwordEnvVar } = roleConfig.credentialsEnv;\n\n    if (!env[usernameEnvVar]) {\n      missing.push({\n        role,\n        type: 'username',\n        envVar: usernameEnvVar,\n        message: `Environment variable \"${usernameEnvVar}\" not set`,\n      });\n    }\n\n    if (!env[passwordEnvVar]) {\n      missing.push({\n        role,\n        type: 'password',\n        envVar: passwordEnvVar,\n        message: `Environment variable \"${passwordEnvVar}\" not set`,\n      });\n    }\n  }\n\n  return missing;\n}\n\n/**\n * Information about missing credentials\n */\nexport interface MissingCredential {\n  /** Role name */\n  readonly role: string;\n\n  /** Type of missing item */\n  readonly type: 'role' | 'username' | 'password';\n\n  /** Environment variable name (if applicable) */\n  readonly envVar?: string;\n\n  /** Human-readable message */\n  readonly message: string;\n}\n\n/**\n * Create a formatted error message for missing credentials\n *\n * @param missing - Array of missing credentials from validateCredentials\n * @returns Formatted error message\n */\nexport function formatMissingCredentialsError(\n  missing: ReadonlyArray<MissingCredential>\n): string {\n  if (missing.length === 0) {\n    return '';\n  }\n\n  const lines: string[] = ['Missing credentials:'];\n\n  // Group by role\n  const byRole = new Map<string, MissingCredential[]>();\n  for (const m of missing) {\n    const existing = byRole.get(m.role) ?? [];\n    existing.push(m);\n    byRole.set(m.role, existing);\n  }\n\n  for (const [role, items] of byRole) {\n    lines.push(`  Role \"${role}\":`);\n    for (const item of items) {\n      if (item.type === 'role') {\n        lines.push(`    - ${item.message}`);\n      } else {\n        lines.push(`    - ${item.type}: ${item.envVar} (${item.message})`);\n      }\n    }\n  }\n\n  lines.push('');\n  lines.push('To fix, set the required environment variables:');\n\n  const envVars = missing\n    .filter((m) => m.envVar)\n    .map((m) => m.envVar);\n  const uniqueEnvVars = [...new Set(envVars)];\n\n  for (const envVar of uniqueEnvVars) {\n    lines.push(`  export ${envVar}=\"<value>\"`);\n  }\n\n  return lines.join('\\n');\n}\n\n/**\n * Check if credentials are available for a role (without throwing)\n *\n * @param role - Role name\n * @param authConfig - Auth configuration\n * @param env - Environment variables\n * @returns true if credentials are available\n */\nexport function hasCredentials(\n  role: string,\n  authConfig: AuthConfig,\n  env: Record<string, string | undefined> = process.env\n): boolean {\n  const roleConfig = authConfig.roles[role];\n  if (!roleConfig) {\n    return false;\n  }\n\n  const { username: usernameEnvVar, password: passwordEnvVar } = roleConfig.credentialsEnv;\n  return Boolean(env[usernameEnvVar]) && Boolean(env[passwordEnvVar]);\n}\n\n/**\n * Validate that credentials environment variables are set for all roles\n *\n * This function checks that all required environment variables for role credentials\n * are present at config load time, providing early failure with clear error messages.\n *\n * @param roles - Record of role configurations from auth config\n * @param env - Environment variables to check (defaults to process.env)\n * @throws ARTKAuthError if any required environment variables are missing\n *\n * @example\n * ```typescript\n * // Validate all roles from config\n * validateCredentialsConfig(config.auth.roles);\n *\n * // Skip validation (for dry-run scenarios)\n * // Don't call this function\n * ```\n */\nexport function validateCredentialsConfig(\n  roles: Record<string, RoleConfig>,\n  env: Record<string, string | undefined> = process.env\n): void {\n  const missingVars: string[] = [];\n\n  for (const [roleName, roleConfig] of Object.entries(roles)) {\n    const { username, password } = roleConfig.credentialsEnv;\n\n    if (!env[username]) {\n      missingVars.push(`${username} (for role '${roleName}')`);\n    }\n    if (!env[password]) {\n      missingVars.push(`${password} (for role '${roleName}')`);\n    }\n  }\n\n  if (missingVars.length > 0) {\n    throw new ARTKAuthError(\n      `Missing required environment variables:\\n` +\n      missingVars.map(v => `  - ${v}`).join('\\n') +\n      `\\n\\nSet these variables before running tests.`,\n      'credentials',\n      'credentials',\n      undefined,\n      'Export the missing environment variables or set them in your .env file'\n    );\n  }\n\n  logger.debug('All credential environment variables validated', {\n    roleCount: Object.keys(roles).length,\n  });\n}\n","/**\n * Environment variable resolver for ARTK configuration\n *\n * Supports resolving environment variables in configuration values using:\n * - ${VAR_NAME} - Simple variable reference (throws if undefined)\n * - ${VAR_NAME:-default} - Variable with default value\n *\n * This implements FR-003: Resolve env vars using ${VAR_NAME} and ${VAR_NAME:-default} syntax\n *\n * @module config/env\n */\n\nimport { ARTKConfigError } from '../errors/config-error.js';\nimport { createLogger } from '../utils/logger.js';\n\nconst logger = createLogger('config', 'envResolver');\n\n/**\n * Regular expression to match environment variable patterns:\n * - ${VAR_NAME} - Simple reference\n * - ${VAR_NAME:-default} - With default value\n *\n * Groups:\n * - Group 1: Variable name\n * - Group 2: Default value (optional, includes the leading :-)\n *\n * Note: We don't use a global constant regex here because global regexes\n * maintain state (lastIndex) which can cause issues with repeated calls.\n */\n\n/**\n * Error thrown when a required environment variable is not defined\n */\nexport class EnvVarNotFoundError extends Error {\n  constructor(\n    public readonly varName: string,\n    public readonly fieldPath?: string\n  ) {\n    super(`Environment variable \"${varName}\" is not defined`);\n    this.name = 'EnvVarNotFoundError';\n\n    if (Error.captureStackTrace) {\n      Error.captureStackTrace(this, EnvVarNotFoundError);\n    }\n  }\n}\n\n/**\n * Result of parsing an environment variable reference\n */\nexport interface EnvVarRef {\n  /** Original match (e.g., \"${VAR_NAME:-default}\") */\n  readonly match: string;\n\n  /** Variable name */\n  readonly varName: string;\n\n  /** Default value if specified */\n  readonly defaultValue?: string;\n\n  /** Whether a default value was specified */\n  readonly hasDefault: boolean;\n}\n\n/**\n * Parse an environment variable reference string\n *\n * @param ref - The reference string (e.g., \"${VAR_NAME:-default}\")\n * @returns Parsed reference or undefined if not a valid env var reference\n *\n * @example\n * ```typescript\n * parseEnvVarRef(\"${BASE_URL}\")\n * // { match: \"${BASE_URL}\", varName: \"BASE_URL\", hasDefault: false }\n *\n * parseEnvVarRef(\"${PORT:-8080}\")\n * // { match: \"${PORT:-8080}\", varName: \"PORT\", defaultValue: \"8080\", hasDefault: true }\n * ```\n */\nexport function parseEnvVarRef(ref: string): EnvVarRef | undefined {\n  const singleMatch = /^\\$\\{([A-Z_][A-Z0-9_]*)(:-([^}]*))?\\}$/i.exec(ref);\n\n  if (!singleMatch) {\n    return undefined;\n  }\n\n  const varName = singleMatch[1];\n  const defaultValue = singleMatch[3];\n\n  if (varName === undefined) {\n    return undefined;\n  }\n\n  return {\n    match: ref,\n    varName,\n    defaultValue,\n    hasDefault: singleMatch[2] !== undefined,\n  };\n}\n\n/**\n * Find all environment variable references in a string\n *\n * @param value - String to search for env var references\n * @returns Array of parsed references\n *\n * @example\n * ```typescript\n * findEnvVarRefs(\"http://${HOST:-localhost}:${PORT}\")\n * // [\n * //   { match: \"${HOST:-localhost}\", varName: \"HOST\", defaultValue: \"localhost\", hasDefault: true },\n * //   { match: \"${PORT}\", varName: \"PORT\", hasDefault: false }\n * // ]\n * ```\n */\nexport function findEnvVarRefs(value: string): readonly EnvVarRef[] {\n  const refs: EnvVarRef[] = [];\n  const pattern = /\\$\\{([A-Z_][A-Z0-9_]*)(:-([^}]*))?\\}/gi;\n\n  let match: RegExpExecArray | null;\n  while ((match = pattern.exec(value)) !== null) {\n    const varName = match[1];\n\n    if (varName === undefined) {\n      continue;\n    }\n\n    refs.push({\n      match: match[0],\n      varName,\n      defaultValue: match[3],\n      hasDefault: match[2] !== undefined,\n    });\n  }\n\n  return refs;\n}\n\n/**\n * Options for resolving environment variables\n */\nexport interface ResolveOptions {\n  /**\n   * Field path for error messages (e.g., \"auth.oidc.loginUrl\")\n   */\n  fieldPath?: string;\n\n  /**\n   * Custom environment object (defaults to process.env)\n   */\n  env?: Record<string, string | undefined>;\n\n  /**\n   * Whether to throw on missing variables without defaults\n   * @default true\n   */\n  throwOnMissing?: boolean;\n}\n\n/**\n * Resolve a single environment variable reference\n *\n * @param ref - Parsed env var reference\n * @param options - Resolution options\n * @returns Resolved value\n * @throws EnvVarNotFoundError if variable is not defined and has no default\n *\n * @example\n * ```typescript\n * // With env: { PORT: \"3000\" }\n * resolveEnvVarRef({ varName: \"PORT\", hasDefault: false, match: \"${PORT}\" })\n * // \"3000\"\n *\n * // With env: {} (PORT not defined)\n * resolveEnvVarRef({ varName: \"PORT\", hasDefault: true, defaultValue: \"8080\", match: \"${PORT:-8080}\" })\n * // \"8080\"\n * ```\n */\nexport function resolveEnvVarRef(\n  ref: EnvVarRef,\n  options: ResolveOptions = {}\n): string {\n  const { env = process.env, fieldPath, throwOnMissing = true } = options;\n  const value = env[ref.varName];\n\n  if (value !== undefined && value !== '') {\n    logger.debug(`Resolved env var ${ref.varName}`, {\n      fieldPath,\n      hasValue: true,\n    });\n    return value;\n  }\n\n  if (ref.hasDefault && ref.defaultValue !== undefined) {\n    logger.debug(`Using default for ${ref.varName}`, {\n      fieldPath,\n      defaultValue: ref.defaultValue,\n    });\n    return ref.defaultValue;\n  }\n\n  if (throwOnMissing) {\n    throw new EnvVarNotFoundError(ref.varName, fieldPath);\n  }\n\n  return ref.match;\n}\n\n/**\n * Resolve all environment variable references in a string\n *\n * Replaces ${VAR_NAME} and ${VAR_NAME:-default} patterns with their values.\n *\n * @param value - String containing env var references\n * @param options - Resolution options\n * @returns String with all env vars resolved\n * @throws EnvVarNotFoundError if any variable is not defined and has no default\n *\n * @example\n * ```typescript\n * // With env: { HOST: \"api.example.com\", PORT: \"3000\" }\n * resolveEnvVars(\"https://${HOST}:${PORT:-8080}/api\")\n * // \"https://api.example.com:3000/api\"\n *\n * // With env: { HOST: \"api.example.com\" }\n * resolveEnvVars(\"https://${HOST}:${PORT:-8080}/api\")\n * // \"https://api.example.com:8080/api\"\n * ```\n */\nexport function resolveEnvVars(\n  value: string,\n  options: ResolveOptions = {}\n): string {\n  const refs = findEnvVarRefs(value);\n\n  if (refs.length === 0) {\n    return value;\n  }\n\n  let result = value;\n\n  for (const ref of refs) {\n    const resolved = resolveEnvVarRef(ref, options);\n    result = result.replace(ref.match, resolved);\n  }\n\n  return result;\n}\n\n/**\n * Check if a string contains environment variable references\n *\n * @param value - String to check\n * @returns True if the string contains env var references\n *\n * @example\n * ```typescript\n * hasEnvVarRefs(\"${BASE_URL}/api\")  // true\n * hasEnvVarRefs(\"https://example.com\")  // false\n * ```\n */\nexport function hasEnvVarRefs(value: string): boolean {\n  // Create a new regex to avoid global state issues with lastIndex\n  const pattern = /\\$\\{[A-Z_][A-Z0-9_]*(:-[^}]*)?\\}/i;\n  return pattern.test(value);\n}\n\n/**\n * Recursively resolve environment variables in an object\n *\n * Walks through all string values in an object (including nested objects\n * and arrays) and resolves environment variable references.\n *\n * @param obj - Object to resolve\n * @param options - Resolution options\n * @param currentPath - Current path in the object (for error messages)\n * @returns New object with all env vars resolved\n *\n * @example\n * ```typescript\n * // With env: { DB_HOST: \"localhost\", DB_PORT: \"5432\" }\n * resolveEnvVarsInObject({\n *   database: {\n *     host: \"${DB_HOST}\",\n *     port: \"${DB_PORT:-5432}\"\n *   }\n * })\n * // {\n * //   database: {\n * //     host: \"localhost\",\n * //     port: \"5432\"\n * //   }\n * // }\n * ```\n */\nexport function resolveEnvVarsInObject<T>(\n  obj: T,\n  options: ResolveOptions = {},\n  currentPath: string = ''\n): T {\n  if (obj === null || obj === undefined) {\n    return obj;\n  }\n\n  if (typeof obj === 'string') {\n    return resolveEnvVars(obj, {\n      ...options,\n      fieldPath: currentPath || options.fieldPath,\n    }) as T;\n  }\n\n  if (Array.isArray(obj)) {\n    const resolved: unknown[] = obj.map((item: unknown, index: number) =>\n      resolveEnvVarsInObject(item, options, `${currentPath}[${index}]`)\n    );\n    return resolved as T;\n  }\n\n  if (typeof obj === 'object') {\n    const result: Record<string, unknown> = {};\n\n    for (const [key, value] of Object.entries(obj as Record<string, unknown>)) {\n      const path = currentPath ? `${currentPath}.${key}` : key;\n      result[key] = resolveEnvVarsInObject(value, options, path);\n    }\n\n    return result as T;\n  }\n\n  return obj;\n}\n\n/**\n * Get all missing environment variables from a string or object\n *\n * Useful for validation before attempting to load configuration.\n *\n * @param value - String or object to check\n * @param env - Environment object (defaults to process.env)\n * @returns Array of missing variable names with their field paths\n *\n * @example\n * ```typescript\n * // With env: { DB_HOST: \"localhost\" } (DB_PORT not defined)\n * getMissingEnvVars({\n *   host: \"${DB_HOST}\",\n *   port: \"${DB_PORT}\"  // No default\n * })\n * // [{ varName: \"DB_PORT\", fieldPath: \"port\" }]\n * ```\n */\nexport function getMissingEnvVars(\n  value: unknown,\n  env: Record<string, string | undefined> = process.env\n): readonly { varName: string; fieldPath: string }[] {\n  const missing: { varName: string; fieldPath: string }[] = [];\n\n  function check(val: unknown, path: string): void {\n    if (typeof val === 'string') {\n      const refs = findEnvVarRefs(val);\n      for (const ref of refs) {\n        if (!ref.hasDefault && (env[ref.varName] === undefined || env[ref.varName] === '')) {\n          missing.push({ varName: ref.varName, fieldPath: path });\n        }\n      }\n    } else if (Array.isArray(val)) {\n      val.forEach((item, index) => check(item, `${path}[${index}]`));\n    } else if (val !== null && typeof val === 'object') {\n      for (const [key, childVal] of Object.entries(val)) {\n        check(childVal, path ? `${path}.${key}` : key);\n      }\n    }\n  }\n\n  check(value, '');\n  return missing;\n}\n\n/**\n * Convert missing env vars to ARTKConfigError\n *\n * @param missing - Array of missing variables\n * @returns ARTKConfigError with details\n */\nexport function createMissingEnvVarsError(\n  missing: readonly { varName: string; fieldPath: string }[]\n): ARTKConfigError {\n  const varNames = [...new Set(missing.map((m) => m.varName))];\n  const fieldPaths = missing.map((m) => m.fieldPath);\n\n  const firstMissing = missing[0];\n  const message =\n    missing.length === 1 && firstMissing\n      ? `Missing required environment variable: ${firstMissing.varName}`\n      : `Missing required environment variables: ${varNames.join(', ')}`;\n\n  const suggestion =\n    missing.length === 1 && firstMissing\n      ? `Set the ${firstMissing.varName} environment variable or provide a default value using \\${${firstMissing.varName}:-default}`\n      : `Set these environment variables or provide default values using \\${VAR:-default} syntax`;\n\n  return new ARTKConfigError(message, fieldPaths.join(', '), suggestion);\n}\n","/**\n * Centralized timeout constants\n *\n * All timeout values used throughout ARTK Core are defined here\n * for easy auditing and global adjustments.\n *\n * @module config/timeouts\n */\n\n/**\n * Timeout constants in milliseconds\n */\nexport const TIMEOUTS = {\n  // =============================================================================\n  // Authentication Timeouts\n  // =============================================================================\n\n  /** Navigation timeout for auth pages */\n  AUTH_NAVIGATION_MS: 30000,\n\n  /** Timeout for submitting credentials */\n  AUTH_SUBMIT_MS: 10000,\n\n  /** Timeout for detecting successful authentication */\n  AUTH_SUCCESS_MS: 5000,\n\n  /** Timeout for MFA push notification approval */\n  AUTH_MFA_PUSH_MS: 60000,\n\n  /** Total timeout for complete login flow */\n  AUTH_LOGIN_FLOW_MS: 30000,\n\n  /** Timeout for IdP redirect */\n  AUTH_IDP_REDIRECT_MS: 10000,\n\n  /** Timeout for OAuth callback processing */\n  AUTH_CALLBACK_MS: 5000,\n\n  // =============================================================================\n  // OIDC Specific Timeouts\n  // =============================================================================\n\n  /** Timeout for OIDC success URL detection */\n  OIDC_SUCCESS_MS: 5000,\n\n  // =============================================================================\n  // Assertion Timeouts\n  // =============================================================================\n\n  /** Default timeout for toast notifications */\n  TOAST_DEFAULT_MS: 5000,\n\n  /** Default timeout for loading indicators */\n  LOADING_DEFAULT_MS: 30000,\n\n  /** Default timeout for form validation */\n  FORM_VALIDATION_MS: 5000,\n\n  // =============================================================================\n  // API Timeouts\n  // =============================================================================\n\n  /** Timeout for API requests */\n  API_REQUEST_MS: 30000,\n\n  /** Timeout for acquiring tokens */\n  TOKEN_ACQUIRE_MS: 10000,\n} as const;\n\n/**\n * Type-safe timeout keys\n */\nexport type TimeoutKey = keyof typeof TIMEOUTS;\n\n/**\n * Get timeout value by key\n *\n * @param key - Timeout constant key\n * @returns Timeout value in milliseconds\n *\n * @example\n * ```typescript\n * const timeout = getTimeout('AUTH_LOGIN_FLOW_MS');\n * await page.waitForURL('/dashboard', { timeout });\n * ```\n */\nexport function getTimeout(key: TimeoutKey): number {\n  return TIMEOUTS[key];\n}\n","/**\n * Default values for optional configuration fields\n *\n * These defaults are applied when fields are not explicitly specified\n * in the artk.config.yml file.\n *\n * @module config/defaults\n */\n\nimport type {\n  AppType,\n  ArtifactsConfig,\n  AssertionsConfig,\n  BrowsersConfig,\n  CaptureMode,\n  DataConfig,\n  JourneysConfig,\n  LocatorStrategy,\n  MFAType,\n  ReporterOpenMode,\n  ReportersConfig,\n  ScreenshotMode,\n  SelectorsConfig,\n  StorageStateConfig,\n  TierConfig,\n} from './types.js';\nimport { TIMEOUTS } from './timeouts.js';\n\n// =============================================================================\n// Application Defaults\n// =============================================================================\n\n/** Default application type */\nexport const DEFAULT_APP_TYPE: AppType = 'spa';\n\n// =============================================================================\n// Storage State Defaults\n// =============================================================================\n\n/** Default storage state configuration */\nexport const DEFAULT_STORAGE_STATE: StorageStateConfig = {\n  directory: '.auth-states',\n  maxAgeMinutes: 60,\n  filePattern: '{role}.json',\n} as const;\n\n// =============================================================================\n// OIDC Defaults\n// =============================================================================\n\n/** Default OIDC success timeout in ms */\nexport const DEFAULT_OIDC_SUCCESS_TIMEOUT = TIMEOUTS.OIDC_SUCCESS_MS;\n\n/** Default MFA type */\nexport const DEFAULT_MFA_TYPE: MFAType = 'none';\n\n/** Default MFA enabled state */\nexport const DEFAULT_MFA_ENABLED = false;\n\n/** Default push timeout in ms */\nexport const DEFAULT_PUSH_TIMEOUT_MS = TIMEOUTS.AUTH_MFA_PUSH_MS;\n\n/** Default OIDC login flow timeout in ms */\nexport const DEFAULT_LOGIN_FLOW_MS = TIMEOUTS.AUTH_LOGIN_FLOW_MS;\n\n/** Default IdP redirect timeout in ms */\nexport const DEFAULT_IDP_REDIRECT_MS = TIMEOUTS.AUTH_IDP_REDIRECT_MS;\n\n/** Default callback timeout in ms */\nexport const DEFAULT_CALLBACK_MS = TIMEOUTS.AUTH_CALLBACK_MS;\n\n// =============================================================================\n// Selectors Defaults\n// =============================================================================\n\n/** Default locator strategy order */\nexport const DEFAULT_LOCATOR_STRATEGY: readonly LocatorStrategy[] = [\n  'role',\n  'label',\n  'placeholder',\n  'testid',\n  'text',\n  'css',\n] as const;\n\n/** Default test ID attribute */\nexport const DEFAULT_TEST_ID_ATTRIBUTE = 'data-testid';\n\n/** Default selectors configuration */\nexport const DEFAULT_SELECTORS: SelectorsConfig = {\n  testIdAttribute: DEFAULT_TEST_ID_ATTRIBUTE,\n  strategy: DEFAULT_LOCATOR_STRATEGY,\n} as const;\n\n// =============================================================================\n// Assertions Defaults\n// =============================================================================\n\n/** Default toast timeout in ms */\nexport const DEFAULT_TOAST_TIMEOUT = TIMEOUTS.TOAST_DEFAULT_MS;\n\n/** Default loading timeout in ms */\nexport const DEFAULT_LOADING_TIMEOUT = TIMEOUTS.LOADING_DEFAULT_MS;\n\n/** Default assertions configuration */\nexport const DEFAULT_ASSERTIONS: AssertionsConfig = {\n  toast: {\n    containerSelector: '[role=\"alert\"], .toast, .notification',\n    messageSelector: '.toast-message, .notification-message',\n    typeAttribute: 'data-type',\n    timeout: DEFAULT_TOAST_TIMEOUT,\n  },\n  loading: {\n    selectors: ['.loading', '.spinner', '[data-loading=\"true\"]'],\n    timeout: DEFAULT_LOADING_TIMEOUT,\n  },\n  form: {\n    errorSelector: '[data-error=\"{field}\"], .field-error[data-field=\"{field}\"]',\n    formErrorSelector: '.form-error, [role=\"alert\"].form-error',\n  },\n};\n\n// =============================================================================\n// Data Defaults\n// =============================================================================\n\n/** Default namespace prefix */\nexport const DEFAULT_NAMESPACE_PREFIX = '[artk-';\n\n/** Default namespace suffix */\nexport const DEFAULT_NAMESPACE_SUFFIX = ']';\n\n/** Default data configuration */\nexport const DEFAULT_DATA: DataConfig = {\n  namespace: {\n    prefix: DEFAULT_NAMESPACE_PREFIX,\n    suffix: DEFAULT_NAMESPACE_SUFFIX,\n  },\n  cleanup: {\n    enabled: true,\n    onFailure: true,\n    parallel: false,\n  },\n} as const;\n\n// =============================================================================\n// Tier Defaults\n// =============================================================================\n\n/** Default tier configurations */\nexport const DEFAULT_TIERS: Readonly<Record<string, TierConfig>> = {\n  smoke: {\n    retries: 0,\n    workers: 1,\n    timeout: 30000,\n    tag: '@smoke',\n  },\n  release: {\n    retries: 1,\n    workers: 2,\n    timeout: 60000,\n    tag: '@release',\n  },\n  regression: {\n    retries: 2,\n    workers: 4,\n    timeout: 120000,\n    tag: '@regression',\n  },\n} as const;\n\n// =============================================================================\n// Reporters Defaults\n// =============================================================================\n\n/** Default reporter open mode */\nexport const DEFAULT_REPORTER_OPEN: ReporterOpenMode = 'on-failure';\n\n/** Default reporters configuration */\nexport const DEFAULT_REPORTERS: ReportersConfig = {\n  html: {\n    enabled: true,\n    outputFolder: 'playwright-report',\n    open: DEFAULT_REPORTER_OPEN,\n  },\n  json: {\n    enabled: false,\n    outputFile: 'test-results.json',\n  },\n  junit: {\n    enabled: false,\n    outputFile: 'junit.xml',\n  },\n  artk: {\n    enabled: true,\n    outputFile: 'artk-report.json',\n    includeJourneyMapping: true,\n  },\n} as const;\n\n// =============================================================================\n// Artifacts Defaults\n// =============================================================================\n\n/** Default screenshot mode */\nexport const DEFAULT_SCREENSHOT_MODE: ScreenshotMode = 'only-on-failure';\n\n/** Default video/trace capture mode */\nexport const DEFAULT_CAPTURE_MODE: CaptureMode = 'retain-on-failure';\n\n/** Default artifacts configuration */\nexport const DEFAULT_ARTIFACTS: ArtifactsConfig = {\n  outputDir: 'test-results',\n  screenshots: {\n    mode: DEFAULT_SCREENSHOT_MODE,\n    fullPage: true,\n    maskPii: false,\n    piiSelectors: [\n      // Common PII input patterns\n      'input[type=\"password\"]',\n      'input[name*=\"ssn\"]',\n      'input[name*=\"social\"]',\n      'input[name*=\"credit\"]',\n      'input[name*=\"card\"]',\n      'input[name*=\"cvv\"]',\n      'input[name*=\"account\"]',\n      'input[autocomplete=\"cc-number\"]',\n      'input[autocomplete=\"cc-csc\"]',\n      // Data attribute markers\n      '[data-pii]',\n      '[data-sensitive]',\n      '[data-mask]',\n      // Common class patterns\n      '.pii-field',\n      '.sensitive-data',\n    ],\n  },\n  video: {\n    mode: DEFAULT_CAPTURE_MODE,\n  },\n  trace: {\n    mode: DEFAULT_CAPTURE_MODE,\n    screenshots: true,\n    snapshots: true,\n  },\n};\n\n// =============================================================================\n// Browsers Defaults\n// =============================================================================\n\n/** Default viewport width */\nexport const DEFAULT_VIEWPORT_WIDTH = 1280;\n\n/** Default viewport height */\nexport const DEFAULT_VIEWPORT_HEIGHT = 720;\n\n/** Default browsers configuration */\nexport const DEFAULT_BROWSERS: BrowsersConfig = {\n  enabled: ['chromium'],\n  channel: 'bundled',\n  strategy: 'auto',\n  viewport: {\n    width: DEFAULT_VIEWPORT_WIDTH,\n    height: DEFAULT_VIEWPORT_HEIGHT,\n  },\n  headless: true,\n};\n\n// =============================================================================\n// Journeys Defaults\n// =============================================================================\n\n/** Default journey ID prefix */\nexport const DEFAULT_JOURNEY_ID_PREFIX = 'JRN';\n\n/** Default journey ID width */\nexport const DEFAULT_JOURNEY_ID_WIDTH = 4;\n\n/** Default journeys configuration */\nexport const DEFAULT_JOURNEYS: JourneysConfig = {\n  id: {\n    prefix: DEFAULT_JOURNEY_ID_PREFIX,\n    width: DEFAULT_JOURNEY_ID_WIDTH,\n  },\n  layout: 'flat',\n  backlog: {\n    groupBy: 'tier',\n  },\n} as const;\n\n// =============================================================================\n// Config Version\n// =============================================================================\n\n/** Supported configuration schema version */\nexport const SUPPORTED_CONFIG_VERSION = 1;\n","/**\n * Zod validation schemas for ARTK configuration\n *\n * Provides runtime type checking and validation for configuration loaded\n * from artk.config.yml. All validation errors include field paths for\n * easy debugging (FR-002).\n *\n * @module config/schema\n */\n\nimport { z } from 'zod';\nimport {\n  DEFAULT_APP_TYPE,\n  DEFAULT_ARTIFACTS,\n  DEFAULT_ASSERTIONS,\n  DEFAULT_BROWSERS,\n  DEFAULT_CALLBACK_MS,\n  DEFAULT_CAPTURE_MODE,\n  DEFAULT_DATA,\n  DEFAULT_IDP_REDIRECT_MS,\n  DEFAULT_JOURNEYS,\n  DEFAULT_LOADING_TIMEOUT,\n  DEFAULT_LOCATOR_STRATEGY,\n  DEFAULT_LOGIN_FLOW_MS,\n  DEFAULT_MFA_ENABLED,\n  DEFAULT_MFA_TYPE,\n  DEFAULT_OIDC_SUCCESS_TIMEOUT,\n  DEFAULT_PUSH_TIMEOUT_MS,\n  DEFAULT_REPORTER_OPEN,\n  DEFAULT_REPORTERS,\n  DEFAULT_SCREENSHOT_MODE,\n  DEFAULT_STORAGE_STATE,\n  DEFAULT_TEST_ID_ATTRIBUTE,\n  DEFAULT_TIERS,\n  DEFAULT_TOAST_TIMEOUT,\n  SUPPORTED_CONFIG_VERSION,\n} from './defaults.js';\n\n// =============================================================================\n// Version Constants\n// =============================================================================\n\n/**\n * Current configuration version\n *\n * Used for schema migration. When breaking changes are made to the config\n * schema, this version is incremented and a migration is added to migrate.ts.\n */\nexport const CURRENT_CONFIG_VERSION = SUPPORTED_CONFIG_VERSION;\n\n// =============================================================================\n// Primitive Schemas\n// =============================================================================\n\n/** Non-empty string */\nconst nonEmptyString = z.string().min(1, 'Must not be empty');\n\n/** Positive integer */\nconst positiveInt = z.number().int().positive();\n\n/** Non-negative integer */\nconst nonNegativeInt = z.number().int().nonnegative();\n\n/** Positive number */\nconst positiveNumber = z.number().positive();\n\n// =============================================================================\n// Application Schemas\n// =============================================================================\n\n/** Application type schema */\nconst AppTypeSchema = z.enum(['spa', 'ssr', 'hybrid']);\n\n/** Application configuration schema */\nexport const AppConfigSchema = z.object({\n  name: nonEmptyString.describe('Application name'),\n  baseUrl: nonEmptyString.describe('Base URL with env var support'),\n  type: AppTypeSchema.default(DEFAULT_APP_TYPE),\n});\n\n// =============================================================================\n// Environment Schemas\n// =============================================================================\n\n/** Environment configuration schema */\nexport const EnvironmentConfigSchema = z.object({\n  baseUrl: nonEmptyString.describe('Environment base URL'),\n  apiUrl: z.string().optional(),\n});\n\n/** Environments record schema */\nexport const EnvironmentsSchema = z.record(z.string(), EnvironmentConfigSchema);\n\n// =============================================================================\n// Storage State Schemas\n// =============================================================================\n\n/** Storage state configuration schema */\nexport const StorageStateConfigSchema = z.object({\n  directory: z.string().default(DEFAULT_STORAGE_STATE.directory),\n  maxAgeMinutes: positiveNumber.default(DEFAULT_STORAGE_STATE.maxAgeMinutes),\n  filePattern: nonEmptyString.default(DEFAULT_STORAGE_STATE.filePattern),\n});\n\n// =============================================================================\n// Credentials Schemas\n// =============================================================================\n\n/** Credentials environment variable schema */\nexport const CredentialsEnvConfigSchema = z.object({\n  username: nonEmptyString.describe('Env var name for username'),\n  password: nonEmptyString.describe('Env var name for password'),\n});\n\n// =============================================================================\n// OIDC Schemas\n// =============================================================================\n\n/** OIDC IdP type schema */\nconst OIDCIdpTypeSchema = z.enum([\n  'keycloak',\n  'azure-ad',\n  'okta',\n  'auth0',\n  'generic',\n]);\n\n/** MFA type schema */\nconst MFATypeSchema = z.enum(['totp', 'push', 'sms', 'none']);\n\n/** OIDC success configuration schema */\nexport const OIDCSuccessConfigSchema = z\n  .object({\n    url: z.string().optional(),\n    selector: z.string().optional(),\n    timeout: positiveInt.default(DEFAULT_OIDC_SUCCESS_TIMEOUT),\n  })\n  .refine((data) => data.url !== undefined || data.selector !== undefined, {\n    message: 'Either success.url or success.selector is required',\n  });\n\n/** OIDC IdP selectors schema */\nexport const OIDCIdpSelectorsSchema = z\n  .object({\n    username: z.string().optional(),\n    password: z.string().optional(),\n    submit: z.string().optional(),\n    staySignedInNo: z.string().optional(),\n  })\n  .optional();\n\n/** MFA configuration schema */\nexport const MFAConfigSchema = z\n  .object({\n    enabled: z.boolean().default(DEFAULT_MFA_ENABLED),\n    type: MFATypeSchema.default(DEFAULT_MFA_TYPE),\n    totpSecretEnv: z.string().optional(),\n    pushTimeoutMs: positiveInt.default(DEFAULT_PUSH_TIMEOUT_MS),\n  })\n  .optional();\n\n/** OIDC timeouts schema */\nexport const OIDCTimeoutsSchema = z\n  .object({\n    loginFlowMs: positiveInt.default(DEFAULT_LOGIN_FLOW_MS),\n    idpRedirectMs: positiveInt.default(DEFAULT_IDP_REDIRECT_MS),\n    callbackMs: positiveInt.default(DEFAULT_CALLBACK_MS),\n  })\n  .optional();\n\n/** OIDC logout schema */\nexport const OIDCLogoutConfigSchema = z\n  .object({\n    url: z.string().optional(),\n    idpLogout: z.boolean().optional(),\n  })\n  .optional();\n\n/** OIDC configuration schema */\nexport const OIDCConfigSchema = z\n  .object({\n    idpType: OIDCIdpTypeSchema,\n    loginUrl: nonEmptyString.describe('Login initiation URL'),\n    idpLoginUrl: z.string().optional(),\n    success: OIDCSuccessConfigSchema,\n    idpSelectors: OIDCIdpSelectorsSchema,\n    mfa: MFAConfigSchema,\n    timeouts: OIDCTimeoutsSchema,\n    logout: OIDCLogoutConfigSchema,\n  })\n  .optional();\n\n// =============================================================================\n// Form Auth Schemas\n// =============================================================================\n\n/** Form auth selectors schema */\nexport const FormAuthSelectorsSchema = z.object({\n  username: nonEmptyString,\n  password: nonEmptyString,\n  submit: nonEmptyString,\n});\n\n/** Form auth success schema */\nexport const FormAuthSuccessConfigSchema = z.object({\n  url: z.string().optional(),\n  selector: z.string().optional(),\n});\n\n/** Form auth configuration schema */\nexport const FormAuthConfigSchema = z\n  .object({\n    loginUrl: nonEmptyString,\n    selectors: FormAuthSelectorsSchema,\n    success: FormAuthSuccessConfigSchema,\n  })\n  .optional();\n\n// =============================================================================\n// Role Schemas\n// =============================================================================\n\n/** Role configuration schema */\nexport const RoleConfigSchema = z.object({\n  credentialsEnv: CredentialsEnvConfigSchema,\n  description: z.string().optional(),\n  oidcOverrides: OIDCConfigSchema.optional(),\n});\n\n/** Roles record schema */\nexport const RolesSchema = z.record(z.string(), RoleConfigSchema);\n\n// =============================================================================\n// Auth Schemas\n// =============================================================================\n\n/** Auth provider type schema */\nconst AuthProviderTypeSchema = z.enum(['oidc', 'form', 'token', 'custom']);\n\n/** Auth bypass mode schema */\nconst AuthBypassModeSchema = z.enum([\n  'none',\n  'identityless',\n  'mock-identity',\n  'unknown',\n]);\n\n/** Auth bypass configuration schema */\nexport const AuthBypassConfigSchema = z.object({\n  mode: AuthBypassModeSchema.default('unknown'),\n  toggle: z.string().optional(),\n  environments: z.array(z.string()).optional(),\n});\n\n/** Auth configuration schema with provider-specific validation */\nexport const AuthConfigSchema = z\n  .object({\n    provider: AuthProviderTypeSchema,\n    storageState: StorageStateConfigSchema.default(DEFAULT_STORAGE_STATE),\n    roles: RolesSchema.refine((roles) => Object.keys(roles).length > 0, {\n      message: 'At least one role must be defined',\n    }),\n    bypass: AuthBypassConfigSchema.optional(),\n    oidc: OIDCConfigSchema,\n    form: FormAuthConfigSchema,\n  })\n  .superRefine((data, ctx) => {\n    // Validate provider-specific configuration\n    if (data.provider === 'oidc' && data.oidc === undefined) {\n      ctx.addIssue({\n        code: z.ZodIssueCode.custom,\n        message: 'OIDC configuration is required when provider is \"oidc\"',\n        path: ['oidc'],\n      });\n    }\n    if (data.provider === 'form' && data.form === undefined) {\n      ctx.addIssue({\n        code: z.ZodIssueCode.custom,\n        message: 'Form configuration is required when provider is \"form\"',\n        path: ['form'],\n      });\n    }\n  });\n\n// =============================================================================\n// Selectors Schemas\n// =============================================================================\n\n/** Locator strategy schema */\nconst LocatorStrategySchema = z.enum([\n  'role',\n  'label',\n  'placeholder',\n  'testid',\n  'text',\n  'css',\n]);\n\n/** Selectors configuration schema */\nexport const SelectorsConfigSchema = z.object({\n  testIdAttribute: z.string().default(DEFAULT_TEST_ID_ATTRIBUTE),\n  strategy: z.array(LocatorStrategySchema).default([...DEFAULT_LOCATOR_STRATEGY]),\n  customTestIds: z.array(z.string()).optional(),\n});\n\n// =============================================================================\n// Assertions Schemas\n// =============================================================================\n\n/** Toast assertion schema */\nexport const ToastAssertionConfigSchema = z.object({\n  containerSelector: nonEmptyString,\n  messageSelector: nonEmptyString,\n  typeAttribute: nonEmptyString,\n  timeout: positiveInt.default(DEFAULT_TOAST_TIMEOUT),\n});\n\n/** Loading assertion schema */\nexport const LoadingAssertionConfigSchema = z.object({\n  selectors: z.array(nonEmptyString).min(1, 'At least one loading selector required'),\n  timeout: positiveInt.default(DEFAULT_LOADING_TIMEOUT),\n});\n\n/** Form assertion schema */\nexport const FormAssertionConfigSchema = z.object({\n  errorSelector: nonEmptyString,\n  formErrorSelector: nonEmptyString,\n});\n\n/** Assertions configuration schema */\nexport const AssertionsConfigSchema = z.object({\n  toast: ToastAssertionConfigSchema.default(DEFAULT_ASSERTIONS.toast),\n  loading: LoadingAssertionConfigSchema.default(DEFAULT_ASSERTIONS.loading),\n  form: FormAssertionConfigSchema.default(DEFAULT_ASSERTIONS.form),\n});\n\n// =============================================================================\n// Data Schemas\n// =============================================================================\n\n/** Namespace configuration schema */\nexport const NamespaceConfigSchema = z.object({\n  prefix: z.string().default(DEFAULT_DATA.namespace.prefix),\n  suffix: z.string().default(DEFAULT_DATA.namespace.suffix),\n});\n\n/** Cleanup configuration schema */\nexport const CleanupConfigSchema = z.object({\n  enabled: z.boolean().default(DEFAULT_DATA.cleanup.enabled),\n  onFailure: z.boolean().default(DEFAULT_DATA.cleanup.onFailure),\n  parallel: z.boolean().default(DEFAULT_DATA.cleanup.parallel),\n});\n\n/** Data API configuration schema */\nexport const DataApiConfigSchema = z\n  .object({\n    baseUrl: nonEmptyString,\n    useMainAuth: z.boolean().default(true),\n  })\n  .optional();\n\n/** Data configuration schema */\nexport const DataConfigSchema = z.object({\n  namespace: NamespaceConfigSchema.default(DEFAULT_DATA.namespace),\n  cleanup: CleanupConfigSchema.default(DEFAULT_DATA.cleanup),\n  api: DataApiConfigSchema,\n});\n\n// =============================================================================\n// Fixtures Schemas\n// =============================================================================\n\n/** Fixtures API configuration schema */\nexport const FixturesApiConfigSchema = z\n  .object({\n    baseURL: nonEmptyString,\n    extraHTTPHeaders: z.record(z.string(), z.string()).optional(),\n  })\n  .optional();\n\n/** Fixtures configuration schema */\nexport const FixturesConfigSchema = z.object({\n  defaultRole: nonEmptyString,\n  roleFixtures: z.array(nonEmptyString).default([]),\n  api: FixturesApiConfigSchema,\n});\n\n// =============================================================================\n// Tier Schemas\n// =============================================================================\n\n/** Tier configuration schema */\nexport const TierConfigSchema = z.object({\n  retries: nonNegativeInt,\n  workers: positiveInt,\n  timeout: positiveInt,\n  tag: nonEmptyString,\n});\n\n/** Tiers record schema */\nexport const TiersSchema = z.record(z.string(), TierConfigSchema);\n\n// =============================================================================\n// Reporters Schemas\n// =============================================================================\n\n/** Reporter open mode schema */\nconst ReporterOpenModeSchema = z.enum(['always', 'never', 'on-failure']);\n\n/** HTML reporter schema */\nexport const HtmlReporterConfigSchema = z\n  .object({\n    enabled: z.boolean().default(true),\n    outputFolder: z.string().default('playwright-report'),\n    open: ReporterOpenModeSchema.default(DEFAULT_REPORTER_OPEN),\n  })\n  .optional();\n\n/** JSON reporter schema */\nexport const JsonReporterConfigSchema = z\n  .object({\n    enabled: z.boolean().default(false),\n    outputFile: z.string().default('test-results.json'),\n  })\n  .optional();\n\n/** JUnit reporter schema */\nexport const JunitReporterConfigSchema = z\n  .object({\n    enabled: z.boolean().default(false),\n    outputFile: z.string().default('junit.xml'),\n  })\n  .optional();\n\n/** ARTK reporter schema */\nexport const ArtkReporterConfigSchema = z\n  .object({\n    enabled: z.boolean().default(true),\n    outputFile: z.string().default('artk-report.json'),\n    includeJourneyMapping: z.boolean().default(true),\n  })\n  .optional();\n\n/** Reporters configuration schema */\nexport const ReportersConfigSchema = z.object({\n  html: HtmlReporterConfigSchema,\n  json: JsonReporterConfigSchema,\n  junit: JunitReporterConfigSchema,\n  artk: ArtkReporterConfigSchema,\n});\n\n// =============================================================================\n// Artifacts Schemas\n// =============================================================================\n\n/** Screenshot mode schema */\nconst ScreenshotModeSchema = z.enum(['off', 'on', 'only-on-failure']);\n\n/** Capture mode schema */\nconst CaptureModeSchema = z.enum([\n  'off',\n  'on',\n  'retain-on-failure',\n  'on-first-retry',\n]);\n\n/** Video size schema */\nexport const VideoSizeSchema = z\n  .object({\n    width: positiveInt,\n    height: positiveInt,\n  })\n  .optional();\n\n/** Screenshots configuration schema */\nexport const ScreenshotsConfigSchema = z.object({\n  mode: ScreenshotModeSchema.default(DEFAULT_SCREENSHOT_MODE),\n  fullPage: z.boolean().default(DEFAULT_ARTIFACTS.screenshots.fullPage),\n  maskPii: z.boolean().default(DEFAULT_ARTIFACTS.screenshots.maskPii),\n  piiSelectors: z.array(z.string()).default([]),\n});\n\n/** Video configuration schema */\nexport const VideoConfigSchema = z.object({\n  mode: CaptureModeSchema.default(DEFAULT_CAPTURE_MODE),\n  size: VideoSizeSchema,\n});\n\n/** Trace configuration schema */\nexport const TraceConfigSchema = z.object({\n  mode: CaptureModeSchema.default(DEFAULT_CAPTURE_MODE),\n  screenshots: z.boolean().default(true),\n  snapshots: z.boolean().default(true),\n});\n\n/** Artifacts configuration schema */\nexport const ArtifactsConfigSchema = z.object({\n  outputDir: z.string().default(DEFAULT_ARTIFACTS.outputDir),\n  screenshots: ScreenshotsConfigSchema.default(DEFAULT_ARTIFACTS.screenshots),\n  video: VideoConfigSchema.default(DEFAULT_ARTIFACTS.video),\n  trace: TraceConfigSchema.default(DEFAULT_ARTIFACTS.trace),\n});\n\n// =============================================================================\n// Browsers Schemas\n// =============================================================================\n\n/** Browser type schema */\nconst BrowserTypeSchema = z.enum(['chromium', 'firefox', 'webkit']);\n\n/** Browser channel schema */\nconst BrowserChannelSchema = z.enum(['bundled', 'msedge', 'chrome', 'chrome-beta', 'chrome-dev']);\n\n/** Browser strategy schema */\nconst BrowserStrategySchema = z.enum([\n  'auto',\n  'prefer-bundled',\n  'prefer-system',\n  'bundled-only',\n  'system-only',\n]);\n\n/** Viewport size schema */\nexport const ViewportSizeSchema = z.object({\n  width: positiveInt,\n  height: positiveInt,\n});\n\n/** Browsers configuration schema */\nexport const BrowsersConfigSchema = z\n  .object({\n    enabled: z.array(BrowserTypeSchema).min(1, 'At least one browser required').default(['chromium']),\n    channel: BrowserChannelSchema.optional().default(DEFAULT_BROWSERS.channel ?? 'bundled'),\n    strategy: BrowserStrategySchema.optional().default(DEFAULT_BROWSERS.strategy ?? 'auto'),\n    viewport: ViewportSizeSchema.default(DEFAULT_BROWSERS.viewport),\n    headless: z.boolean().default(DEFAULT_BROWSERS.headless),\n    slowMo: positiveInt.optional(),\n  })\n  .refine(\n    (config) => {\n      if (config.channel === 'msedge' || config.channel.startsWith('chrome')) {\n        return config.enabled.includes('chromium');\n      }\n      return true;\n    },\n    {\n      message: \"channel 'msedge' or 'chrome' requires 'chromium' in enabled browsers\",\n    }\n  );\n\n// =============================================================================\n// Journeys Schemas\n// =============================================================================\n\n/** Journey layout schema */\nconst JourneyLayoutSchema = z.enum(['flat', 'staged']);\n\n/** Journey group by schema */\nconst JourneyGroupBySchema = z.enum(['tier', 'status', 'scope']);\n\n/** Journey ID configuration schema */\nexport const JourneyIdConfigSchema = z.object({\n  prefix: z.string().default(DEFAULT_JOURNEYS.id.prefix),\n  width: positiveInt.default(DEFAULT_JOURNEYS.id.width),\n});\n\n/** Journey backlog configuration schema */\nexport const JourneyBacklogConfigSchema = z.object({\n  groupBy: JourneyGroupBySchema.default(DEFAULT_JOURNEYS.backlog.groupBy),\n  thenBy: JourneyGroupBySchema.optional(),\n});\n\n/** Journeys configuration schema */\nexport const JourneysConfigSchema = z.object({\n  id: JourneyIdConfigSchema.default(DEFAULT_JOURNEYS.id),\n  layout: JourneyLayoutSchema.default(DEFAULT_JOURNEYS.layout),\n  backlog: JourneyBacklogConfigSchema.default(DEFAULT_JOURNEYS.backlog),\n});\n\n// =============================================================================\n// Root Configuration Schema\n// =============================================================================\n\n/**\n * Root configuration schema with all validation rules\n *\n * Validates:\n * - version must equal SUPPORTED_CONFIG_VERSION (currently 1)\n * - app.baseUrl must be present (validated after env var resolution)\n * - auth.roles must have at least one role\n * - activeEnvironment must match a key in environments or be env var template\n * - Provider-specific configuration must be present\n */\nexport const ARTKConfigSchema = z\n  .object({\n    version: z.number().int().min(1).optional().default(SUPPORTED_CONFIG_VERSION),\n    app: AppConfigSchema,\n    environments: EnvironmentsSchema.default({}),\n    activeEnvironment: z.string().default('default'),\n    auth: AuthConfigSchema,\n    selectors: SelectorsConfigSchema.default({\n      testIdAttribute: DEFAULT_TEST_ID_ATTRIBUTE,\n      strategy: [...DEFAULT_LOCATOR_STRATEGY],\n    }),\n    assertions: AssertionsConfigSchema.default(DEFAULT_ASSERTIONS),\n    data: DataConfigSchema.default(DEFAULT_DATA),\n    fixtures: FixturesConfigSchema,\n    tiers: TiersSchema.default(DEFAULT_TIERS),\n    reporters: ReportersConfigSchema.default(DEFAULT_REPORTERS),\n    artifacts: ArtifactsConfigSchema.default(DEFAULT_ARTIFACTS),\n    browsers: BrowsersConfigSchema.default(DEFAULT_BROWSERS),\n    journeys: JourneysConfigSchema.default(DEFAULT_JOURNEYS),\n  })\n  .superRefine((data, ctx) => {\n    // Validate activeEnvironment matches an environment key or is env var template\n    const isEnvVarTemplate =\n      data.activeEnvironment.startsWith('${') &&\n      data.activeEnvironment.includes('}');\n    const envKeys = Object.keys(data.environments);\n\n    // Validate activeEnvironment matches defined environments (only when environments is non-empty)\n    // Note: Empty environments with custom activeEnvironment is allowed for backward compatibility\n    // but may indicate misconfiguration - consider logging a warning at runtime\n    if (\n      !isEnvVarTemplate &&\n      envKeys.length > 0 &&\n      !envKeys.includes(data.activeEnvironment)\n    ) {\n      ctx.addIssue({\n        code: z.ZodIssueCode.custom,\n        message: `activeEnvironment \"${data.activeEnvironment}\" does not match any defined environment. Available: ${envKeys.join(', ')}`,\n        path: ['activeEnvironment'],\n      });\n    }\n\n    // Validate fixtures.defaultRole exists in auth.roles\n    const roleKeys = Object.keys(data.auth.roles);\n    if (!roleKeys.includes(data.fixtures.defaultRole)) {\n      ctx.addIssue({\n        code: z.ZodIssueCode.custom,\n        message: `fixtures.defaultRole \"${data.fixtures.defaultRole}\" does not match any defined role. Available: ${roleKeys.join(', ')}`,\n        path: ['fixtures', 'defaultRole'],\n      });\n    }\n\n    // Validate fixtures.roleFixtures all exist in auth.roles\n    for (const roleFixture of data.fixtures.roleFixtures) {\n      if (!roleKeys.includes(roleFixture)) {\n        ctx.addIssue({\n          code: z.ZodIssueCode.custom,\n          message: `fixtures.roleFixtures contains \"${roleFixture}\" which is not a defined role. Available: ${roleKeys.join(', ')}`,\n          path: ['fixtures', 'roleFixtures'],\n        });\n      }\n    }\n  });\n\n// =============================================================================\n// Type Exports\n// =============================================================================\n\n/** Inferred type from ARTKConfigSchema */\nexport type ARTKConfigInput = z.input<typeof ARTKConfigSchema>;\n\n/** Validated ARTKConfig type */\nexport type ARTKConfigOutput = z.output<typeof ARTKConfigSchema>;\n","/**\n * Configuration migration system\n *\n * Provides automatic migration of configuration files from older versions\n * to the current version. Each migration transforms the config object to\n * match the expected schema for the next version.\n *\n * @module config/migrate\n */\n\nimport { createLogger } from '../utils/logger.js';\nimport { CURRENT_CONFIG_VERSION } from './schema.js';\n\nconst logger = createLogger('config', 'migrate');\n\n// Re-export CURRENT_CONFIG_VERSION for use by loader.ts\nexport { CURRENT_CONFIG_VERSION } from './schema.js';\n\n// =============================================================================\n// Migration Types\n// =============================================================================\n\n/**\n * Function that transforms config from one version to the next\n */\nexport type MigrationFn = (config: Record<string, unknown>) => Record<string, unknown>;\n\n/**\n * Migration definition\n */\nexport interface Migration {\n  /** Starting version (config must be exactly this version) */\n  fromVersion: number;\n\n  /** Target version (result will be this version) */\n  toVersion: number;\n\n  /** Human-readable description of what changed */\n  description: string;\n\n  /** Migration function */\n  migrate: MigrationFn;\n}\n\n/**\n * Result of config migration\n */\nexport interface MigrationResult {\n  /** Final migrated configuration */\n  config: Record<string, unknown>;\n\n  /** Starting version number */\n  fromVersion: number;\n\n  /** Final version number */\n  toVersion: number;\n\n  /** List of migration descriptions that were applied */\n  migrationsApplied: string[];\n}\n\n// =============================================================================\n// Migration Registry\n// =============================================================================\n\n/**\n * Registry of all available migrations\n *\n * Migrations must be registered in sequential order (12, 23, etc.)\n * Each migration should be idempotent and defensive about missing fields.\n */\nconst MIGRATIONS = new Map<string, Migration>();\n\n/**\n * Register a migration\n *\n * @param migration - Migration to register\n * @throws Error if migration with same from/to version already exists\n */\nexport function registerMigration(migration: Migration): void {\n  const key = `${migration.fromVersion}-${migration.toVersion}`;\n\n  if (MIGRATIONS.has(key)) {\n    throw new Error(\n      `Migration from v${migration.fromVersion} to v${migration.toVersion} already registered`\n    );\n  }\n\n  // Validate sequential versions\n  if (migration.toVersion !== migration.fromVersion + 1) {\n    throw new Error(\n      `Migration must increment version by 1 (got ${migration.fromVersion}  ${migration.toVersion})`\n    );\n  }\n\n  MIGRATIONS.set(key, migration);\n  logger.debug(`Registered migration: ${migration.description}`, {\n    fromVersion: migration.fromVersion,\n    toVersion: migration.toVersion,\n  });\n}\n\n/**\n * Get migration for a specific version transition\n *\n * @param fromVersion - Starting version\n * @param toVersion - Target version\n * @returns Migration or undefined if not found\n */\nexport function getMigration(fromVersion: number, toVersion: number): Migration | undefined {\n  const key = `${fromVersion}-${toVersion}`;\n  return MIGRATIONS.get(key);\n}\n\n/**\n * Get all registered migrations\n *\n * @returns Array of migrations in registration order\n */\nexport function getAllMigrations(): Migration[] {\n  return Array.from(MIGRATIONS.values());\n}\n\n/**\n * Clear all registered migrations\n *\n * Useful for testing. Should not be used in production code.\n */\nexport function clearMigrations(): void {\n  MIGRATIONS.clear();\n}\n\n// =============================================================================\n// Migration Execution\n// =============================================================================\n\n/**\n * Check if a config needs migration\n *\n * @param config - Raw config object\n * @returns True if config version is less than current version\n */\nexport function needsMigration(config: Record<string, unknown>): boolean {\n  const version = (config.version as number | undefined) ?? 0;\n  return version < CURRENT_CONFIG_VERSION;\n}\n\n/**\n * Check if a version is supported\n *\n * @param version - Version number to check\n * @returns True if version can be migrated to current version\n */\nexport function isVersionSupported(version: number): boolean {\n  // Version 0 is allowed (legacy configs without version field)\n  return version >= 0 && version <= CURRENT_CONFIG_VERSION;\n}\n\n/**\n * Migrate configuration to current version\n *\n * Applies all necessary migrations in sequence to bring the config from\n * its current version to CURRENT_CONFIG_VERSION.\n *\n * @param config - Raw configuration object\n * @returns Migration result with final config and applied migrations\n * @throws Error if migration path is incomplete or version is unsupported\n *\n * @example\n * ```typescript\n * const rawConfig = { version: 0, ...oldSchema };\n * const result = migrateConfig(rawConfig);\n * console.log(`Migrated from v${result.fromVersion} to v${result.toVersion}`);\n * // Use result.config for validation\n * ```\n */\nexport function migrateConfig(config: Record<string, unknown>): MigrationResult {\n  const fromVersion = (config.version as number | undefined) ?? 0;\n  let currentConfig = { ...config };\n  const migrationsApplied: string[] = [];\n\n  logger.debug('Starting migration', {\n    fromVersion,\n    targetVersion: CURRENT_CONFIG_VERSION,\n  });\n\n  // Validate version is supported\n  if (!isVersionSupported(fromVersion)) {\n    throw new Error(\n      `Config version ${fromVersion} is not supported. ` +\n        `Supported versions: 0-${CURRENT_CONFIG_VERSION}`\n    );\n  }\n\n  // No migration needed if already at current version\n  if (fromVersion === CURRENT_CONFIG_VERSION) {\n    logger.debug('Config already at current version, no migration needed');\n    return {\n      config: currentConfig,\n      fromVersion,\n      toVersion: CURRENT_CONFIG_VERSION,\n      migrationsApplied: [],\n    };\n  }\n\n  // Apply migrations sequentially\n  let currentVersion = fromVersion;\n\n  while (currentVersion < CURRENT_CONFIG_VERSION) {\n    const nextVersion = currentVersion + 1;\n    const migration = getMigration(currentVersion, nextVersion);\n\n    if (!migration) {\n      throw new Error(\n        `No migration found from v${currentVersion} to v${nextVersion}. ` +\n          `Migration path is incomplete.`\n      );\n    }\n\n    logger.debug(`Applying migration: ${migration.description}`, {\n      fromVersion: currentVersion,\n      toVersion: nextVersion,\n    });\n\n    // Apply migration\n    currentConfig = migration.migrate(currentConfig);\n    migrationsApplied.push(migration.description);\n    currentVersion = nextVersion;\n  }\n\n  // Update version field to current version\n  currentConfig.version = CURRENT_CONFIG_VERSION;\n\n  logger.info('Migration completed', {\n    fromVersion,\n    toVersion: CURRENT_CONFIG_VERSION,\n    migrationsApplied: migrationsApplied.length,\n  });\n\n  return {\n    config: currentConfig,\n    fromVersion,\n    toVersion: CURRENT_CONFIG_VERSION,\n    migrationsApplied,\n  };\n}\n\n// =============================================================================\n// Built-in Migrations\n// =============================================================================\n\n/**\n * Migration from v0 (no version field) to v1 (first versioned config)\n *\n * This is a no-op migration that simply adds the version field.\n * All v0 configs are assumed to be compatible with v1 schema.\n */\nregisterMigration({\n  fromVersion: 0,\n  toVersion: 1,\n  description: 'Add version field to legacy config',\n  migrate: (config) => {\n    // Version 0 configs have no version field\n    // Version 1 schema is compatible with legacy configs\n    // Just return the config as-is (version will be set by migrateConfig)\n    return { ...config };\n  },\n});\n\n// Future migrations will be added here as the schema evolves\n// Example:\n//\n// registerMigration({\n//   fromVersion: 1,\n//   toVersion: 2,\n//   description: 'Rename selectorPolicy to locatorPolicy',\n//   migrate: (config) => {\n//     const updated = { ...config };\n//     if ('selectorPolicy' in updated) {\n//       updated.locatorPolicy = updated.selectorPolicy;\n//       delete updated.selectorPolicy;\n//     }\n//     return updated;\n//   },\n// });\n","/**\n * YAML configuration loader with validation\n *\n * Implements:\n * - FR-001: Load configuration from artk/artk.config.yml file\n * - FR-002: Validate configuration against defined schema and report all validation errors with field paths\n * - FR-003: Resolve environment variables (via env.ts)\n * - FR-004: Support named environment profiles switchable via ARTK_ENV\n * - FR-005: Provide typed access to all configuration sections\n *\n * @module config/loader\n */\n\nimport { existsSync, readFileSync } from 'node:fs';\nimport { dirname, join, resolve } from 'node:path';\nimport { parse as parseYaml } from 'yaml';\nimport type { ZodError, ZodIssue } from 'zod';\n\nimport { ARTKConfigError } from '../errors/config-error.js';\nimport { createLogger } from '../utils/logger.js';\nimport { validateCredentialsConfig } from '../auth/credentials.js';\nimport {\n  createMissingEnvVarsError,\n  getMissingEnvVars,\n  resolveEnvVars,\n  resolveEnvVarsInObject,\n  type ResolveOptions,\n} from './env.js';\nimport { CURRENT_CONFIG_VERSION, migrateConfig, needsMigration } from './migrate.js';\nimport { ARTKConfigSchema } from './schema.js';\nimport type {\n  AppConfig,\n  ArtifactsConfig,\n  ARTKConfig,\n  AssertionsConfig,\n  AuthConfig,\n  BrowsersConfig,\n  DataConfig,\n  EnvironmentConfig,\n  FixturesConfig,\n  JourneysConfig,\n  ReportersConfig,\n  SelectorsConfig,\n  TierConfig,\n} from './types.js';\n\nconst logger = createLogger('config', 'loader');\n\n// =============================================================================\n// Configuration State\n// =============================================================================\n\n/**\n * Cached configuration instance\n */\nlet cachedConfig: ARTKConfig | null = null;\n\n/**\n * Path to the loaded configuration file\n */\nlet configFilePath: string | null = null;\n\n// =============================================================================\n// Configuration Loading\n// =============================================================================\n\n/**\n * Default configuration file path relative to project root\n */\nexport const DEFAULT_CONFIG_PATH = 'artk/artk.config.yml';\n\n/**\n * Alternative configuration file names\n */\nexport const CONFIG_FILE_NAMES = [\n  'artk.config.yml',\n  'artk.config.yaml',\n  'artk.config.json',\n] as const;\n\n/**\n * Options for loading configuration\n */\nexport interface LoadConfigOptions {\n  /**\n   * Path to the configuration file\n   * @default 'artk/artk.config.yml'\n   */\n  configPath?: string;\n\n  /**\n   * Base directory for resolving relative paths\n   * @default process.cwd()\n   */\n  baseDir?: string;\n\n  /**\n   * Custom environment object for variable resolution\n   * @default process.env\n   */\n  env?: Record<string, string | undefined>;\n\n  /**\n   * Force reload even if configuration is cached\n   * @default false\n   */\n  forceReload?: boolean;\n\n  /**\n   * Active environment name override (defaults to ARTK_ENV or config value)\n   */\n  activeEnvironment?: string;\n\n  /**\n   * Skip credentials validation\n   * Useful for dry-run scenarios or when credentials are not yet set\n   * @default false\n   */\n  skipCredentialsValidation?: boolean;\n}\n\n/**\n * Result of configuration loading\n */\nexport interface LoadConfigResult {\n  /** Loaded and validated configuration */\n  config: ARTKConfig;\n\n  /** Path to the configuration file */\n  configPath: string;\n\n  /** Active environment name */\n  activeEnvironment: string;\n\n  /** Environment configuration (if applicable) */\n  environmentConfig?: EnvironmentConfig;\n}\n\n/**\n * Find the configuration file in standard locations\n *\n * @param baseDir - Base directory to search from\n * @returns Path to the configuration file or undefined if not found\n */\nexport function findConfigFile(baseDir: string = process.cwd()): string | undefined {\n  // First, check the default location\n  const defaultPath = join(baseDir, DEFAULT_CONFIG_PATH);\n  if (existsSync(defaultPath)) {\n    return defaultPath;\n  }\n\n  // Check alternative names in artk/ directory\n  const artkDir = join(baseDir, 'artk');\n  if (existsSync(artkDir)) {\n    for (const fileName of CONFIG_FILE_NAMES) {\n      const filePath = join(artkDir, fileName);\n      if (existsSync(filePath)) {\n        return filePath;\n      }\n    }\n  }\n\n  // Check alternative names in root directory\n  for (const fileName of CONFIG_FILE_NAMES) {\n    const filePath = join(baseDir, fileName);\n    if (existsSync(filePath)) {\n      return filePath;\n    }\n  }\n\n  return undefined;\n}\n\n/**\n * Load raw YAML content from a file\n *\n * @param filePath - Path to the YAML file\n * @returns Parsed YAML content as unknown\n * @throws ARTKConfigError if file cannot be read or parsed\n */\nexport function loadYamlFile(filePath: string): unknown {\n  try {\n    const content = readFileSync(filePath, 'utf-8');\n    return parseYaml(content);\n  } catch (error) {\n    if (error instanceof Error && 'code' in error && error.code === 'ENOENT') {\n      throw new ARTKConfigError(\n        `Configuration file not found: ${filePath}`,\n        'configPath',\n        `Create the file at ${filePath} or specify a different path`\n      );\n    }\n\n    if (error instanceof Error) {\n      throw new ARTKConfigError(\n        `Failed to parse configuration file: ${error.message}`,\n        'configPath',\n        'Check the YAML syntax in your configuration file'\n      );\n    }\n\n    throw error;\n  }\n}\n\n/**\n * Format Zod validation errors into a readable message\n *\n * @param error - Zod validation error\n * @returns Formatted error message with all issues\n */\nexport function formatZodError(error: ZodError): string {\n  const issues = error.issues.map((issue: ZodIssue) => {\n    const path = issue.path.join('.');\n    return `  - ${path || 'root'}: ${issue.message}`;\n  });\n\n  return `Configuration validation failed:\\n${issues.join('\\n')}`;\n}\n\n/**\n * Convert Zod errors to ARTKConfigError\n *\n * @param error - Zod validation error\n * @returns ARTKConfigError with details\n */\nexport function zodErrorToConfigError(error: ZodError): ARTKConfigError {\n  const firstIssue = error.issues[0];\n  const path = firstIssue ? firstIssue.path.join('.') : 'unknown';\n  const message = formatZodError(error);\n\n  let suggestion: string | undefined;\n  if (firstIssue) {\n    switch (firstIssue.code) {\n      case 'invalid_type':\n        suggestion = `Expected ${firstIssue.expected}, received ${firstIssue.received}`;\n        break;\n      case 'invalid_enum_value':\n        suggestion = `Valid values: ${firstIssue.options.join(', ')}`;\n        break;\n      case 'too_small':\n        suggestion =\n          firstIssue.type === 'string'\n            ? 'Value cannot be empty'\n            : `Minimum value is ${firstIssue.minimum}`;\n        break;\n      case 'custom':\n        suggestion = firstIssue.message;\n        break;\n    }\n  }\n\n  return new ARTKConfigError(message, path, suggestion);\n}\n\n/**\n * Load and validate configuration from a YAML file\n *\n * @param options - Loading options\n * @returns Loaded configuration result\n * @throws ARTKConfigError if configuration is invalid or cannot be loaded\n *\n * @example\n * ```typescript\n * // Load from default location\n * const { config, activeEnvironment } = await loadConfig();\n *\n * // Load from custom path\n * const { config } = await loadConfig({ configPath: './custom-config.yml' });\n *\n * // Load with custom environment\n * const { config } = await loadConfig({ activeEnvironment: 'staging' });\n * ```\n */\nexport function loadConfig(options: LoadConfigOptions = {}): LoadConfigResult {\n  const {\n    baseDir = process.cwd(),\n    env = process.env,\n    forceReload = false,\n    activeEnvironment: overrideEnv,\n    skipCredentialsValidation = false,\n  } = options;\n\n  // Return cached config if available and not forcing reload\n  if (!forceReload && cachedConfig !== null && configFilePath !== null) {\n    const envName = determineActiveEnvironment(cachedConfig, { env, override: overrideEnv });\n    const envConfig = cachedConfig.environments[envName];\n\n    logger.debug('Returning cached configuration', { path: configFilePath });\n\n    return {\n      config: cachedConfig,\n      configPath: configFilePath,\n      activeEnvironment: envName,\n      environmentConfig: envConfig,\n    };\n  }\n\n  // Find or use specified config path\n  let resolvedPath: string;\n  if (options.configPath) {\n    resolvedPath = resolve(baseDir, options.configPath);\n  } else {\n    const foundPath = findConfigFile(baseDir);\n    if (!foundPath) {\n      throw new ARTKConfigError(\n        `Configuration file not found in ${baseDir}`,\n        'configPath',\n        `Create ${DEFAULT_CONFIG_PATH} or specify a custom path`\n      );\n    }\n    resolvedPath = foundPath;\n  }\n\n  logger.info('Loading configuration', { path: resolvedPath });\n\n  // Load raw YAML\n  const rawConfig = loadYamlFile(resolvedPath);\n\n  if (typeof rawConfig !== 'object' || rawConfig === null) {\n    throw new ARTKConfigError(\n      'Configuration file must contain a YAML object',\n      'root',\n      'Ensure your configuration file starts with valid YAML'\n    );\n  }\n\n  // Check for missing environment variables before resolution\n  const resolveOptions: ResolveOptions = { env, throwOnMissing: false };\n  const missingVars = getMissingEnvVars(rawConfig, env);\n\n  if (missingVars.length > 0) {\n    throw createMissingEnvVarsError(missingVars);\n  }\n\n  // Resolve environment variables\n  let resolvedConfig = resolveEnvVarsInObject(rawConfig, resolveOptions) as Record<string, unknown>;\n\n  // Validate version is supported (reject future versions)\n  const configVersion = (resolvedConfig.version as number | undefined) ?? 0;\n  if (configVersion > CURRENT_CONFIG_VERSION) {\n    throw new ARTKConfigError(\n      `Configuration version ${configVersion} is not supported. Current version is ${CURRENT_CONFIG_VERSION}.`,\n      'version',\n      `Downgrade your configuration to version ${CURRENT_CONFIG_VERSION} or upgrade @artk/core`\n    );\n  }\n\n  // Check for migration\n  if (needsMigration(resolvedConfig)) {\n    const migrationResult = migrateConfig(resolvedConfig);\n\n    if (migrationResult.migrationsApplied.length > 0) {\n      logger.warn(\n        `Config migrated from v${migrationResult.fromVersion} to v${migrationResult.toVersion}:\\n` +\n        migrationResult.migrationsApplied.map(m => `  - ${m}`).join('\\n')\n      );\n    } else {\n      logger.info(\n        `Config version updated from v${migrationResult.fromVersion} to v${migrationResult.toVersion} (no schema changes)`\n      );\n    }\n\n    resolvedConfig = migrationResult.config;\n  }\n\n  // Validate against schema\n  const parseResult = ARTKConfigSchema.safeParse(resolvedConfig);\n\n  if (!parseResult.success) {\n    throw zodErrorToConfigError(parseResult.error);\n  }\n\n  const config = parseResult.data as ARTKConfig;\n\n  // Validate credentials at config load time (unless explicitly skipped)\n  if (!skipCredentialsValidation) {\n    logger.debug('Validating credentials configuration');\n    validateCredentialsConfig(config.auth.roles, env);\n  } else {\n    logger.debug('Skipping credentials validation (skipCredentialsValidation = true)');\n  }\n\n  // Determine active environment\n  const envName = determineActiveEnvironment(config, { env, override: overrideEnv });\n  const envConfig = config.environments[envName];\n\n  // Cache the loaded configuration\n  cachedConfig = config;\n  configFilePath = resolvedPath;\n\n  logger.info('Configuration loaded successfully', {\n    path: resolvedPath,\n    activeEnvironment: envName,\n    roles: Object.keys(config.auth.roles),\n  });\n\n  return {\n    config,\n    configPath: resolvedPath,\n    activeEnvironment: envName,\n    environmentConfig: envConfig,\n  };\n}\n\n/**\n * Options for determining active environment\n */\ninterface DetermineEnvOptions {\n  /** Custom environment object */\n  env?: Record<string, string | undefined>;\n\n  /** Override value (takes precedence) */\n  override?: string;\n}\n\n/**\n * Determine the active environment name\n *\n * Priority:\n * 1. Override parameter\n * 2. ARTK_ENV environment variable\n * 3. Config's activeEnvironment field\n *\n * @param config - Loaded configuration\n * @param options - Options\n * @returns Active environment name\n */\nfunction determineActiveEnvironment(\n  config: ARTKConfig,\n  options: DetermineEnvOptions = {}\n): string {\n  const { env = process.env, override } = options;\n\n  // 1. Override takes highest precedence\n  if (override) {\n    return resolveEnvVars(override, { env });\n  }\n\n  // 2. ARTK_ENV environment variable\n  const artkEnv = env['ARTK_ENV'];\n  if (artkEnv) {\n    return artkEnv;\n  }\n\n  // 3. Config's activeEnvironment field (may contain env var reference)\n  return resolveEnvVars(config.activeEnvironment, { env, throwOnMissing: false });\n}\n\n// =============================================================================\n// Configuration Clearing\n// =============================================================================\n\n/**\n * Clear the cached configuration\n *\n * Useful for testing or when the configuration file has changed.\n */\nexport function clearConfigCache(): void {\n  cachedConfig = null;\n  configFilePath = null;\n  logger.debug('Configuration cache cleared');\n}\n\n// =============================================================================\n// Configuration Accessors (FR-005)\n// =============================================================================\n\n/**\n * Get the current configuration or throw if not loaded\n *\n * @returns Loaded configuration\n * @throws ARTKConfigError if configuration is not loaded\n */\nexport function getConfig(): ARTKConfig {\n  if (cachedConfig === null) {\n    throw new ARTKConfigError(\n      'Configuration not loaded. Call loadConfig() first.',\n      'config',\n      'Ensure loadConfig() is called before accessing configuration'\n    );\n  }\n  return cachedConfig;\n}\n\n/**\n * Check if configuration is loaded\n *\n * @returns True if configuration is loaded\n */\nexport function isConfigLoaded(): boolean {\n  return cachedConfig !== null;\n}\n\n/**\n * Get application configuration\n *\n * @returns App configuration\n * @throws ARTKConfigError if configuration is not loaded\n */\nexport function getAppConfig(): AppConfig {\n  return getConfig().app;\n}\n\n/**\n * Get authentication configuration\n *\n * @returns Auth configuration\n * @throws ARTKConfigError if configuration is not loaded\n */\nexport function getAuthConfig(): AuthConfig {\n  return getConfig().auth;\n}\n\n/**\n * Get selectors configuration\n *\n * @returns Selectors configuration\n * @throws ARTKConfigError if configuration is not loaded\n */\nexport function getSelectorsConfig(): SelectorsConfig {\n  return getConfig().selectors;\n}\n\n/**\n * Get assertions configuration\n *\n * @returns Assertions configuration\n * @throws ARTKConfigError if configuration is not loaded\n */\nexport function getAssertionsConfig(): AssertionsConfig {\n  return getConfig().assertions;\n}\n\n/**\n * Get data configuration\n *\n * @returns Data configuration\n * @throws ARTKConfigError if configuration is not loaded\n */\nexport function getDataConfig(): DataConfig {\n  return getConfig().data;\n}\n\n/**\n * Get fixtures configuration\n *\n * @returns Fixtures configuration\n * @throws ARTKConfigError if configuration is not loaded\n */\nexport function getFixturesConfig(): FixturesConfig {\n  return getConfig().fixtures;\n}\n\n/**\n * Get tier configuration by name\n *\n * @param tierName - Tier name (e.g., 'smoke', 'release', 'regression')\n * @returns Tier configuration or undefined if not found\n * @throws ARTKConfigError if configuration is not loaded\n */\nexport function getTierConfig(tierName: string): TierConfig | undefined {\n  return getConfig().tiers[tierName];\n}\n\n/**\n * Get all tier configurations\n *\n * @returns Record of tier configurations\n * @throws ARTKConfigError if configuration is not loaded\n */\nexport function getTiersConfig(): Readonly<Record<string, TierConfig>> {\n  return getConfig().tiers;\n}\n\n/**\n * Get reporters configuration\n *\n * @returns Reporters configuration\n * @throws ARTKConfigError if configuration is not loaded\n */\nexport function getReportersConfig(): ReportersConfig {\n  return getConfig().reporters;\n}\n\n/**\n * Get artifacts configuration\n *\n * @returns Artifacts configuration\n * @throws ARTKConfigError if configuration is not loaded\n */\nexport function getArtifactsConfig(): ArtifactsConfig {\n  return getConfig().artifacts;\n}\n\n/**\n * Get browsers configuration\n *\n * @returns Browsers configuration\n * @throws ARTKConfigError if configuration is not loaded\n */\nexport function getBrowsersConfig(): BrowsersConfig {\n  return getConfig().browsers;\n}\n\n/**\n * Get journeys configuration\n *\n * @returns Journeys configuration\n * @throws ARTKConfigError if configuration is not loaded\n */\nexport function getJourneysConfig(): JourneysConfig {\n  return getConfig().journeys;\n}\n\n/**\n * Get environment configuration by name\n *\n * @param envName - Environment name\n * @returns Environment configuration or undefined if not found\n * @throws ARTKConfigError if configuration is not loaded\n */\nexport function getEnvironmentConfig(envName: string): EnvironmentConfig | undefined {\n  return getConfig().environments[envName];\n}\n\n/**\n * Get all environment configurations\n *\n * @returns Record of environment configurations\n * @throws ARTKConfigError if configuration is not loaded\n */\nexport function getEnvironmentsConfig(): Readonly<Record<string, EnvironmentConfig>> {\n  return getConfig().environments;\n}\n\n/**\n * Get the base URL for the current environment\n *\n * Resolves the base URL from:\n * 1. Active environment's baseUrl (if defined)\n * 2. App's baseUrl (fallback)\n *\n * @param activeEnvironment - Active environment name\n * @returns Base URL\n * @throws ARTKConfigError if configuration is not loaded\n */\nexport function getBaseUrl(activeEnvironment?: string): string {\n  const config = getConfig();\n  const envName = activeEnvironment ?? config.activeEnvironment;\n  const envConfig = config.environments[envName];\n\n  if (envConfig?.baseUrl) {\n    return envConfig.baseUrl;\n  }\n\n  return config.app.baseUrl;\n}\n\n/**\n * Get the API URL for the current environment\n *\n * @param activeEnvironment - Active environment name\n * @returns API URL or undefined if not configured\n * @throws ARTKConfigError if configuration is not loaded\n */\nexport function getApiUrl(activeEnvironment?: string): string | undefined {\n  const config = getConfig();\n  const envName = activeEnvironment ?? config.activeEnvironment;\n  const envConfig = config.environments[envName];\n\n  if (envConfig?.apiUrl) {\n    return envConfig.apiUrl;\n  }\n\n  // Fallback to data.api.baseUrl if configured\n  return config.data.api?.baseUrl;\n}\n\n/**\n * Get the storage state directory path\n *\n * @param baseDir - Base directory (defaults to config file directory)\n * @returns Absolute path to storage state directory\n * @throws ARTKConfigError if configuration is not loaded\n */\nexport function getStorageStateDir(baseDir?: string): string {\n  const config = getConfig();\n  const storageDir = config.auth.storageState.directory;\n\n  // If baseDir not provided, use config file directory\n  const resolvedBaseDir = baseDir ?? (configFilePath ? dirname(configFilePath) : process.cwd());\n\n  return resolve(resolvedBaseDir, storageDir);\n}\n\n/**\n * Get the storage state file path for a role\n *\n * @param role - Role name\n * @param env - Environment name (for pattern replacement)\n * @param baseDir - Base directory\n * @returns Absolute path to storage state file\n * @throws ARTKConfigError if configuration is not loaded\n */\nexport function getStorageStatePath(\n  role: string,\n  env?: string,\n  baseDir?: string\n): string {\n  const config = getConfig();\n  const pattern = config.auth.storageState.filePattern;\n  const envName = env ?? config.activeEnvironment;\n\n  // Replace pattern placeholders\n  const fileName = pattern\n    .replace('{role}', role)\n    .replace('{env}', envName);\n\n  return join(getStorageStateDir(baseDir), fileName);\n}\n"]}