{"version":3,"sources":["../../llkb/pluralization.ts","../../llkb/universal-seeds.ts","../../llkb/template-generators.ts","../../llkb/mining-cache.ts","../../llkb/normalize.ts","../../llkb/index.ts","../../llkb/similarity.ts","../../llkb/inference.ts","../../llkb/confidence.ts","../../llkb/file-utils.ts","../../llkb/history.ts","../../llkb/analytics.ts","../../llkb/quality-controls.ts","../../llkb/pattern-generation.ts","../../llkb/loaders.ts","../../llkb/constants.ts","../../llkb/adapter-transforms.ts","../../llkb/adapter.ts","../../llkb/learning.ts","../../llkb/versioning.ts","../../llkb/cli.ts","../../llkb/context.ts","../../llkb/matching.ts","../../llkb/detection.ts","../../llkb/registry.ts","../../llkb/migration.ts","../../llkb/search.ts","../../llkb/result-types.ts","../../llkb/discovery.ts","../../llkb/mining.ts","../../llkb/packs/react.ts","../../llkb/packs/angular.ts","../../llkb/packs/mui.ts","../../llkb/packs/antd.ts","../../llkb/packs/chakra.ts","../../llkb/packs/index.ts","../../llkb/mining/i18n-mining.ts","../../llkb/mining/analytics-mining.ts","../../llkb/mining/feature-flag-mining.ts","../../llkb/pipeline.ts"],"names":["result","generateNavigationPatterns","generatePatternId","randomUUID","MAX_CONFIDENCE","path","DEFAULT_EXTENSIONS","fsp2","path12","resolve","path2","fs2","DEFAULT_LLKB_ROOT","path3","deduplicatePatterns","path4","fs3","join","existsSync","readFileSync","top","mkdirSync","writeFileSync","yamlStringify","path5","path6","fs4","fs5","path7","path8","basename","findTestFiles","fs6","path9","fs7","compareVersions","fs8","path10","createUniversalSeedPatterns","fs9","UI_LIBRARY_PATTERNS","path11","fs10","fsp","MAX_SCAN_DEPTH","MAX_FILES_TO_SCAN","fs11","generateAllPatterns","MAX_REGEX_ITERATIONS","path14","fsp4","path15","path16","durationMs"],"mappings":"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","file":"index.js","sourcesContent":["/**\n * LLKB Pluralization Module\n *\n * Single source of truth for English pluralization rules.\n * Used by mining.ts and template-generators.ts.\n *\n * Merged from both files with comprehensive irregular word coverage.\n *\n * Security: Uses null-prototype objects to prevent prototype pollution.\n *\n * @module llkb/pluralization\n */\n\n// =============================================================================\n// Constants\n// =============================================================================\n\n/** Maximum word length to process (defense against DoS) */\nconst MAX_WORD_LENGTH = 100;\n\n// =============================================================================\n// Helper: Create null-prototype dictionary (prevents prototype pollution)\n// =============================================================================\n\n/**\n * Creates a frozen, null-prototype object from entries.\n * Prevents prototype pollution attacks via __proto__, constructor, etc.\n */\nfunction createSafeDict<T extends Record<string, string>>(entries: T): Readonly<T> {\n  return Object.freeze(Object.assign(Object.create(null), entries)) as Readonly<T>;\n}\n\n// =============================================================================\n// Uncountable Nouns (words that don't have plural forms)\n// =============================================================================\n\n/**\n * Uncountable nouns that should not be pluralized.\n * These words are the same in singular and plural form.\n */\nexport const UNCOUNTABLE_NOUNS: ReadonlySet<string> = Object.freeze(\n  new Set([\n    // Abstract concepts\n    'advice',\n    'information',\n    'knowledge',\n    'wisdom',\n    'intelligence',\n    'evidence',\n    'research',\n    'progress',\n    'happiness',\n    'sadness',\n    'luck',\n    'fun',\n\n    // Materials and substances\n    'water',\n    'air',\n    'oil',\n    // Note: 'gas' removed - it has a plural form 'gases' (e.g., \"noble gases\")\n    'milk',\n    'rice',\n    'bread',\n    'sugar',\n    'salt',\n    'flour',\n    'gold',\n    'silver',\n    'iron',\n    'wood',\n    'paper',\n    'glass',\n    'plastic',\n    'cotton',\n    'wool',\n\n    // Tech/software terms\n    'software',\n    'hardware',\n    'firmware',\n    'malware',\n    'freeware',\n    'shareware',\n    'middleware',\n    // Note: 'data' is in IRREGULAR_PLURALS (datum/data), not here\n    // Note: 'metadata' follows 'data' pattern\n    'feedback',\n    'bandwidth',\n    'traffic',\n    'spam',\n    'code', // Usually uncountable in tech context\n\n    // Other uncountables\n    'equipment',\n    'furniture',\n    'luggage',\n    'baggage',\n    'clothing',\n    'weather',\n    'news',\n    'homework',\n    'housework',\n    'money',\n    'cash',\n    'music',\n    'art',\n    'poetry',\n    'literature',\n    'electricity',\n    'heat',\n    'light',\n    'darkness',\n    'space',\n    'time',\n    'work',\n    'travel',\n    'accommodation',\n    'scenery',\n    'machinery',\n    'jewelry',\n    'rubbish',\n    'garbage',\n    'trash',\n    'stuff',\n\n    // Words same in singular and plural\n    'sheep',\n    'fish',\n    'deer',\n    'moose',\n    'swine',\n    'buffalo',\n    'shrimp',\n    'trout',\n    'salmon',\n    'squid',\n    'aircraft',\n    'spacecraft',\n    'hovercraft',\n    'series',\n    'species',\n    'means',\n    'offspring',\n    'chassis',\n    'corps',\n    'swiss',\n  ])\n);\n\n// =============================================================================\n// Irregular Plurals (merged from mining.ts + template-generators.ts)\n// =============================================================================\n\n/**\n * Complete irregular plurals map (52+ entries)\n * Merged from:\n * - mining.ts: 47 entries\n * - template-generators.ts: 38 entries\n * - Combined unique entries from both\n *\n * Uses null-prototype object to prevent prototype pollution.\n */\nexport const IRREGULAR_PLURALS: Readonly<Record<string, string>> = createSafeDict({\n  // People\n  person: 'people',\n  child: 'children',\n  man: 'men',\n  woman: 'women',\n\n  // Body parts\n  tooth: 'teeth',\n  foot: 'feet',\n\n  // Animals\n  mouse: 'mice',\n  goose: 'geese',\n  ox: 'oxen',\n\n  // -f/-fe to -ves\n  leaf: 'leaves',\n  life: 'lives',\n  knife: 'knives',\n  wife: 'wives',\n  half: 'halves',\n  shelf: 'shelves',\n  self: 'selves', // From template-generators.ts\n  calf: 'calves',\n  loaf: 'loaves',\n\n  // -o to -oes\n  potato: 'potatoes',\n  tomato: 'tomatoes',\n  hero: 'heroes',\n  echo: 'echoes',\n  embargo: 'embargoes', // From mining.ts\n  veto: 'vetoes', // From mining.ts\n  cargo: 'cargoes', // From template-generators.ts\n\n  // Latin/Greek (-is to -es)\n  analysis: 'analyses',\n  basis: 'bases',\n  crisis: 'crises',\n  diagnosis: 'diagnoses', // From mining.ts\n  hypothesis: 'hypotheses', // From mining.ts\n  oasis: 'oases', // From mining.ts\n  parenthesis: 'parentheses', // From mining.ts\n  synopsis: 'synopses', // From mining.ts\n  thesis: 'theses',\n\n  // Latin/Greek (-on/-um to -a)\n  criterion: 'criteria',\n  phenomenon: 'phenomena',\n  datum: 'data',\n  medium: 'media',\n  curriculum: 'curricula', // From mining.ts\n  memorandum: 'memoranda', // From mining.ts\n\n  // Latin (-us to -i)\n  stimulus: 'stimuli', // From mining.ts\n  syllabus: 'syllabi', // From mining.ts\n  focus: 'foci', // From mining.ts\n  fungus: 'fungi', // From mining.ts\n  cactus: 'cacti', // From mining.ts\n\n  // Latin (-ix/-ex to -ices)\n  appendix: 'appendices',\n  index: 'indices',\n  matrix: 'matrices',\n  vertex: 'vertices', // From template-generators.ts\n\n  // Special cases\n  status: 'statuses', // From template-generators.ts\n  quiz: 'quizzes', // From template-generators.ts\n\n  // Singular nouns ending in 's' that need -es (would be caught by \"already plural\" check)\n  bus: 'buses',\n  gas: 'gases',\n  lens: 'lenses',\n  atlas: 'atlases',\n  iris: 'irises',\n  plus: 'pluses',\n  minus: 'minuses',\n  bonus: 'bonuses',\n  campus: 'campuses',\n  caucus: 'caucuses',\n  census: 'censuses',\n  citrus: 'citruses',\n  circus: 'circuses',\n  corpus: 'corpora', // Latin plural\n  genus: 'genera', // Latin plural\n  radius: 'radii', // Latin plural\n  nexus: 'nexuses',\n  sinus: 'sinuses',\n  surplus: 'surpluses',\n  virus: 'viruses',\n});\n\n/**\n * Reverse lookup: plural to singular\n * Uses null-prototype object to prevent prototype pollution.\n */\nexport const IRREGULAR_SINGULARS: Readonly<Record<string, string>> = createSafeDict(\n  Object.fromEntries(\n    Object.entries(IRREGULAR_PLURALS).map(([singular, plural]) => [plural, singular])\n  ) as Record<string, string>\n);\n\n// =============================================================================\n// Pluralization Functions\n// =============================================================================\n\n/** Options for pluralize function */\nexport interface PluralizeOptions {\n  /** Preserve the original case pattern (e.g., 'User' -> 'Users') */\n  preserveCase?: boolean;\n}\n\n/**\n * Apply the original case pattern to the result.\n * Handles: lowercase, UPPERCASE, TitleCase, camelCase\n */\nfunction applyCasePattern(original: string, result: string): string {\n  if (original.length === 0) {return result;}\n\n  // All uppercase: USER -> USERS\n  if (original === original.toUpperCase() && /[A-Z]/.test(original)) {\n    return result.toUpperCase();\n  }\n\n  // Title case (first letter uppercase): User -> Users\n  if (original[0]! === original[0]!.toUpperCase() && original.slice(1) === original.slice(1).toLowerCase()) {\n    return result.charAt(0).toUpperCase() + result.slice(1);\n  }\n\n  // Otherwise return as-is (lowercase)\n  return result;\n}\n\n/**\n * Convert a singular word to its plural form using English grammar rules.\n *\n * @param word - The singular word to pluralize\n * @param options - Optional settings (e.g., preserveCase)\n * @returns The plural form of the word\n *\n * @example\n * pluralize('user')     // 'users'\n * pluralize('person')   // 'people'\n * pluralize('category') // 'categories'\n * pluralize('status')   // 'statuses'\n * pluralize('software') // 'software' (uncountable)\n * pluralize('User', { preserveCase: true })  // 'Users'\n * pluralize('API', { preserveCase: true })   // 'APIS'\n */\nexport function pluralize(word: string, options: PluralizeOptions = {}): string {\n  // Input validation\n  if (typeof word !== 'string') {\n    return String(word);\n  }\n\n  // Handle empty string\n  if (word.length === 0) {\n    return '';\n  }\n\n  // Length limit for DoS prevention\n  if (word.length > MAX_WORD_LENGTH) {\n    return word; // Return unchanged if too long\n  }\n\n  const lower = word.toLowerCase();\n\n  // Check uncountable nouns first (return unchanged)\n  if (UNCOUNTABLE_NOUNS.has(lower)) {\n    return options.preserveCase ? word : lower;\n  }\n\n  // Check irregular plurals (safe lookup - null prototype)\n  if (lower in IRREGULAR_PLURALS) {\n    const result = IRREGULAR_PLURALS[lower]!;\n    return options.preserveCase ? applyCasePattern(word, result) : result;\n  }\n\n  // Already plural check - handles both irregular and regular plurals\n  // 1. Known irregular plurals (e.g., 'people', 'children', 'analyses')\n  if (lower in IRREGULAR_SINGULARS) {\n    return options.preserveCase ? word : lower;\n  }\n\n  // 2. Regular plurals ending in 's' - but NOT singular words ending in 's'\n  // Singular words ending in 's' that need -es (bus, gas, lens) are now in IRREGULAR_PLURALS\n  // so they won't reach this check. Words like 'users', 'items' should not become 'userses'.\n  if (\n    lower.endsWith('s') &&\n    !lower.endsWith('ss') && // 'class' needs -es\n    !(lower in IRREGULAR_PLURALS) // 'bus', 'gas', 'lens' etc. are handled above\n  ) {\n    return options.preserveCase ? word : lower;\n  }\n\n  let result: string;\n\n  // -y preceded by consonant -> -ies\n  if (lower.endsWith('y') && lower.length > 1) {\n    const beforeY = lower[lower.length - 2]!;\n    if (!'aeiou'.includes(beforeY)) {\n      result = lower.slice(0, -1) + 'ies';\n      return options.preserveCase ? applyCasePattern(word, result) : result;\n    }\n  }\n\n  // -s, -x, -z, -ch, -sh -> -es\n  if (\n    lower.endsWith('s') ||\n    lower.endsWith('x') ||\n    lower.endsWith('z') ||\n    lower.endsWith('ch') ||\n    lower.endsWith('sh')\n  ) {\n    result = lower + 'es';\n    return options.preserveCase ? applyCasePattern(word, result) : result;\n  }\n\n  // -f (not -ff, -ief, -oof, -eef) -> -ves\n  if (\n    lower.endsWith('f') &&\n    !lower.endsWith('ff') &&\n    !lower.endsWith('ief') &&\n    !lower.endsWith('oof') &&\n    !lower.endsWith('eef')\n  ) {\n    result = lower.slice(0, -1) + 'ves';\n    return options.preserveCase ? applyCasePattern(word, result) : result;\n  }\n\n  // -fe -> -ves\n  if (lower.endsWith('fe')) {\n    result = lower.slice(0, -2) + 'ves';\n    return options.preserveCase ? applyCasePattern(word, result) : result;\n  }\n\n  // -o preceded by consonant -> -es (common pattern)\n  if (lower.endsWith('o') && lower.length > 1) {\n    const beforeO = lower[lower.length - 2]!;\n    if (!'aeiou'.includes(beforeO)) {\n      result = lower + 'es';\n      return options.preserveCase ? applyCasePattern(word, result) : result;\n    }\n  }\n\n  // Default: add 's'\n  result = lower + 's';\n  return options.preserveCase ? applyCasePattern(word, result) : result;\n}\n\n/** Options for singularize function */\nexport interface SingularizeOptions {\n  /** Preserve the original case pattern (e.g., 'Users' -> 'User') */\n  preserveCase?: boolean;\n}\n\n/**\n * Convert a plural word to its singular form using English grammar rules.\n *\n * @param word - The plural word to singularize\n * @param options - Optional settings (e.g., preserveCase)\n * @returns The singular form of the word\n *\n * @example\n * singularize('users')      // 'user'\n * singularize('people')     // 'person'\n * singularize('categories') // 'category'\n * singularize('statuses')   // 'status'\n * singularize('software')   // 'software' (uncountable)\n * singularize('Users', { preserveCase: true })  // 'User'\n */\nexport function singularize(word: string, options: SingularizeOptions = {}): string {\n  // Input validation\n  if (typeof word !== 'string') {\n    return String(word);\n  }\n\n  // Handle empty string\n  if (word.length === 0) {\n    return '';\n  }\n\n  // Length limit for DoS prevention\n  if (word.length > MAX_WORD_LENGTH) {\n    return word; // Return unchanged if too long\n  }\n\n  const lower = word.toLowerCase();\n\n  // Check uncountable nouns first (return unchanged)\n  if (UNCOUNTABLE_NOUNS.has(lower)) {\n    return options.preserveCase ? word : lower;\n  }\n\n  // Check irregular singulars (safe lookup - null prototype)\n  if (lower in IRREGULAR_SINGULARS) {\n    const result = IRREGULAR_SINGULARS[lower]!;\n    return options.preserveCase ? applyCasePattern(word, result) : result;\n  }\n\n  let result: string;\n\n  // -ies -> -y\n  if (lower.endsWith('ies') && lower.length > 3) {\n    result = lower.slice(0, -3) + 'y';\n    return options.preserveCase ? applyCasePattern(word, result) : result;\n  }\n\n  // -ves -> -f or -fe\n  if (lower.endsWith('ves')) {\n    const stem = lower.slice(0, -3);\n    // Words that take -f (not -fe): leaf, loaf, shelf, etc.\n    if (\n      stem.endsWith('l') ||\n      stem.endsWith('r') ||\n      stem.endsWith('n') ||\n      stem.endsWith('a') ||\n      stem.endsWith('o')\n    ) {\n      result = stem + 'f';\n    } else {\n      result = stem + 'fe';\n    }\n    return options.preserveCase ? applyCasePattern(word, result) : result;\n  }\n\n  // -zzes -> -zz (buzz -> buzzes, fizz -> fizzes)\n  if (lower.endsWith('zzes')) {\n    result = lower.slice(0, -2); // Remove 'es', keep 'zz'\n    return options.preserveCase ? applyCasePattern(word, result) : result;\n  }\n\n  // -es for -ss, -x, -z, -ch, -sh, -o endings\n  if (lower.endsWith('es')) {\n    const stem = lower.slice(0, -2);\n    if (\n      stem.endsWith('ss') || // class -> classes\n      stem.endsWith('x') || // box -> boxes\n      stem.endsWith('z') || // quiz -> quizzes (but handled above for -zz)\n      stem.endsWith('ch') || // watch -> watches\n      stem.endsWith('sh') || // wish -> wishes\n      stem.endsWith('o') // hero -> heroes\n    ) {\n      return options.preserveCase ? applyCasePattern(word, stem) : stem;\n    }\n    // Handle single 's' ending (bus -> buses)\n    if (stem.endsWith('s') && !stem.endsWith('ss')) {\n      return options.preserveCase ? applyCasePattern(word, stem) : stem;\n    }\n  }\n\n  // Default: remove trailing 's' (but not -ss)\n  if (lower.endsWith('s') && lower.length > 1 && !lower.endsWith('ss')) {\n    result = lower.slice(0, -1);\n    return options.preserveCase ? applyCasePattern(word, result) : result;\n  }\n\n  return options.preserveCase ? word : lower;\n}\n\n/**\n * Get both singular and plural forms from any input word.\n *\n * @param word - Any form of the word (singular or plural)\n * @returns Object with both singular and plural forms\n *\n * @example\n * getSingularPlural('user')     // { singular: 'user', plural: 'users' }\n * getSingularPlural('users')    // { singular: 'user', plural: 'users' }\n * getSingularPlural('people')   // { singular: 'person', plural: 'people' }\n * getSingularPlural('software') // { singular: 'software', plural: 'software' }\n */\nexport function getSingularPlural(word: string): { singular: string; plural: string } {\n  // Input validation\n  if (typeof word !== 'string' || word.length === 0) {\n    return { singular: '', plural: '' };\n  }\n\n  const lower = word.toLowerCase();\n\n  // Check uncountable nouns (same in both forms)\n  if (UNCOUNTABLE_NOUNS.has(lower)) {\n    return { singular: lower, plural: lower };\n  }\n\n  // Check if it's a known plural (safe lookup - null prototype)\n  if (lower in IRREGULAR_SINGULARS) {\n    return {\n      singular: IRREGULAR_SINGULARS[lower]!,\n      plural: lower,\n    };\n  }\n\n  // Check if it's a known singular (safe lookup - null prototype)\n  if (lower in IRREGULAR_PLURALS) {\n    return {\n      singular: lower,\n      plural: IRREGULAR_PLURALS[lower]!,\n    };\n  }\n\n  // Heuristic: singularize first, then pluralize\n  const singular = singularize(lower);\n  const plural = pluralize(singular);\n\n  return { singular, plural };\n}\n\n/**\n * Check if a word is uncountable (has no plural form).\n *\n * @param word - The word to check\n * @returns True if the word is uncountable\n *\n * @example\n * isUncountable('software')    // true\n * isUncountable('information') // true\n * isUncountable('user')        // false\n */\nexport function isUncountable(word: string): boolean {\n  if (typeof word !== 'string') {return false;}\n  return UNCOUNTABLE_NOUNS.has(word.toLowerCase());\n}\n","/**\n * Universal Seed Patterns for LLKB Cold Start\n *\n * Provides 39 high-confidence seed patterns covering common web UI actions.\n * These are written to learned-patterns.json during LLKB initialization\n * so that first-run projects start with a useful pattern baseline.\n *\n * All patterns use confidence 0.80 (high but not promotion-eligible),\n * successCount 1 (survives default prune with minSuccess=1),\n * and valid AutoGen IR primitive type names.\n *\n * @module llkb/universal-seeds\n */\n\nimport type { LearnedPattern } from './pattern-generation.js';\n\n/**\n * Valid IR primitive type names from autogen/src/ir/types.ts.\n * Used for documentation and validation only.\n */\nexport const VALID_IR_PRIMITIVES = [\n  // Navigation\n  'goto', 'goBack', 'goForward', 'reload',\n  // Wait\n  'waitForVisible', 'waitForHidden', 'waitForURL', 'waitForNetworkIdle', 'waitForTimeout',\n  'waitForResponse', 'waitForLoadingComplete',\n  // Interactions\n  'click', 'dblclick', 'rightClick', 'fill', 'select', 'check', 'uncheck',\n  'press', 'hover', 'focus', 'clear', 'upload',\n  // Assertions\n  'expectVisible', 'expectNotVisible', 'expectHidden', 'expectText', 'expectValue',\n  'expectChecked', 'expectEnabled', 'expectDisabled', 'expectURL', 'expectTitle',\n  'expectCount', 'expectContainsText',\n  // Signals\n  'expectToast', 'dismissModal', 'acceptAlert', 'dismissAlert',\n] as const;\n\n/** Seed pattern definition (compact form for readability) */\ninterface SeedDef {\n  text: string;\n  primitive: string;\n}\n\n/**\n * 39 universal seed patterns organized by category.\n *\n * Categories:\n * - Navigation (3): goto, goBack, reload\n * - Click (6): button, link, menu item, tab, checkbox, radio\n * - Fill (5): text input, password, search, textarea, email\n * - Form (3): submit, clear, select dropdown\n * - Assert (5): visible, text, URL, title, hidden\n * - Wait (3): element, navigation, network idle\n * - Modal (4): open, close, confirm, dismiss\n * - Toast (3): verify toast, close notification, wait disappear\n * - Table (4): sort, filter, select row, paginate\n * - Keyboard (3): Enter, Escape, Tab\n */\nconst SEED_DEFINITIONS: SeedDef[] = [\n  // Navigation (3)\n  { text: 'navigate to url', primitive: 'goto' },\n  { text: 'go back to previous page', primitive: 'goBack' },\n  { text: 'reload the page', primitive: 'reload' },\n\n  // Click (6)\n  { text: 'click the button', primitive: 'click' },\n  { text: 'click the link', primitive: 'click' },\n  { text: 'click the menu item', primitive: 'click' },\n  { text: 'click the tab', primitive: 'click' },\n  { text: 'check the checkbox', primitive: 'check' },\n  { text: 'click the radio button', primitive: 'click' },\n\n  // Fill (5)\n  { text: 'enter text in the input field', primitive: 'fill' },\n  { text: 'enter the password', primitive: 'fill' },\n  { text: 'type in the search box', primitive: 'fill' },\n  { text: 'enter text in the textarea', primitive: 'fill' },\n  { text: 'enter the email address', primitive: 'fill' },\n\n  // Form (3)\n  { text: 'submit the form', primitive: 'click' },\n  { text: 'clear the form', primitive: 'clear' },\n  { text: 'select option from dropdown', primitive: 'select' },\n\n  // Assert (5)\n  { text: 'verify element is visible', primitive: 'expectVisible' },\n  { text: 'verify text is displayed', primitive: 'expectText' },\n  { text: 'verify the url', primitive: 'expectURL' },\n  { text: 'verify the page title', primitive: 'expectTitle' },\n  { text: 'verify element is hidden', primitive: 'expectHidden' },\n\n  // Wait (3)\n  { text: 'wait for element to appear', primitive: 'waitForVisible' },\n  { text: 'wait for navigation to complete', primitive: 'waitForURL' },\n  { text: 'wait for network idle', primitive: 'waitForNetworkIdle' },\n\n  // Modal (4)\n  { text: 'open the modal dialog', primitive: 'click' },\n  { text: 'close the modal', primitive: 'dismissModal' },\n  { text: 'confirm the dialog', primitive: 'acceptAlert' },\n  { text: 'dismiss the dialog', primitive: 'dismissAlert' },\n\n  // Toast (3)\n  { text: 'verify toast notification appears', primitive: 'expectToast' },\n  { text: 'close the notification', primitive: 'click' },\n  { text: 'wait for toast to disappear', primitive: 'waitForHidden' },\n\n  // Table (4)\n  { text: 'sort the table column', primitive: 'click' },\n  { text: 'filter the table', primitive: 'fill' },\n  { text: 'select the table row', primitive: 'click' },\n  { text: 'click next page in pagination', primitive: 'click' },\n\n  // Keyboard (3)\n  { text: 'press enter', primitive: 'press' },\n  { text: 'press escape', primitive: 'press' },\n  { text: 'press tab', primitive: 'press' },\n];\n\n/** Default confidence for all seed patterns */\nconst SEED_CONFIDENCE = 0.80;\n\n/**\n * Create 39 universal seed patterns for LLKB cold start.\n *\n * These patterns provide immediate value on first run before any\n * app-specific discovery has occurred. They cover the most common\n * web UI interactions that virtually every web app requires.\n *\n * @returns Array of 39 LearnedPattern entries\n */\nexport function createUniversalSeedPatterns(): LearnedPattern[] {\n  const now = new Date().toISOString();\n\n  return SEED_DEFINITIONS.map((def): LearnedPattern => ({\n    normalizedText: def.text,\n    originalText: def.text,\n    irPrimitive: def.primitive,\n    confidence: SEED_CONFIDENCE,\n    successCount: 1,\n    failCount: 0,\n    sourceJourneys: [],\n    lastUpdated: now,\n  }));\n}\n","/**\n * LLKB Template Generators Module\n *\n * Generates patterns by multiplying templates with discovered entities.\n * This is the core feature that enables 300-400 app-specific patterns\n * from discovery results.\n *\n * Template multiplication:\n * - 5 CRUD operations  12 entities = 60 patterns\n * - 5 form operations  15 forms = 75 patterns\n * - 6 table operations  8 tables = 48 patterns\n * - 4 modal operations  12 modals = 48 patterns\n * - 8 navigation operations  5 routes = 40 patterns\n *\n * @module llkb/template-generators\n */\n\nimport type { DiscoveredPattern, SelectorHint } from './pattern-generation.js';\nimport { randomUUID } from 'crypto';\nimport { pluralize, singularize } from './pluralization.js';\n\n// =============================================================================\n// Constants\n// =============================================================================\n\n/** Default confidence for generated patterns */\nconst DEFAULT_GENERATED_CONFIDENCE = 0.70;\n/** Higher confidence for patterns with known selectors */\nconst SELECTOR_CONFIDENCE_BOOST = 0.15;\n/** Maximum confidence cap */\nconst MAX_CONFIDENCE = 0.95;\n/** Maximum generated patterns to prevent unbounded multiplication */\nconst MAX_GENERATED_PATTERNS = 2000;\n\n// =============================================================================\n// Type Definitions\n// =============================================================================\n\n/**\n * A discovered entity that can be used in pattern generation\n */\nexport interface DiscoveredEntity {\n  /** Entity name (e.g., \"user\", \"product\", \"order\") */\n  name: string;\n  /** Singular form of the name */\n  singular: string;\n  /** Plural form of the name */\n  plural: string;\n  /** Source file where entity was discovered */\n  source?: string;\n  /** API endpoint if available */\n  endpoint?: string;\n  /** Known selectors for this entity's UI elements */\n  selectors?: Record<string, string>;\n}\n\n/**\n * A discovered route\n */\nexport interface DiscoveredRoute {\n  /** Route path (e.g., \"/users\", \"/products/:id\") */\n  path: string;\n  /** Human-readable name */\n  name: string;\n  /** Route parameters */\n  params?: string[];\n  /** Associated component file */\n  component?: string;\n}\n\n/**\n * A discovered form\n */\nexport interface DiscoveredForm {\n  /** Form identifier */\n  id: string;\n  /** Human-readable name */\n  name: string;\n  /** Form fields */\n  fields: FormField[];\n  /** Submit button selector */\n  submitSelector?: string;\n  /** Associated schema (Zod, Yup, etc.) */\n  schema?: string;\n}\n\n/**\n * A form field\n */\nexport interface FormField {\n  /** Field name */\n  name: string;\n  /** Field type (text, email, password, select, checkbox, etc.) */\n  type: string;\n  /** Field label */\n  label?: string;\n  /** Known selector */\n  selector?: string;\n  /** Whether field is required */\n  required?: boolean;\n}\n\n/**\n * A discovered table/grid\n */\nexport interface DiscoveredTable {\n  /** Table identifier */\n  id: string;\n  /** Human-readable name */\n  name: string;\n  /** Column names */\n  columns: string[];\n  /** Known selectors */\n  selectors?: {\n    table?: string;\n    row?: string;\n    cell?: string;\n    header?: string;\n    sortButton?: string;\n    filterInput?: string;\n  };\n}\n\n/**\n * A discovered modal/dialog\n */\nexport interface DiscoveredModal {\n  /** Modal identifier */\n  id: string;\n  /** Human-readable name */\n  name: string;\n  /** Trigger selector (button that opens the modal) */\n  triggerSelector?: string;\n  /** Close button selector */\n  closeSelector?: string;\n  /** Confirm/submit button selector */\n  confirmSelector?: string;\n  /** Modal content selector */\n  contentSelector?: string;\n}\n\n/**\n * All discovered elements for pattern generation\n */\nexport interface DiscoveredElements {\n  entities: DiscoveredEntity[];\n  routes: DiscoveredRoute[];\n  forms: DiscoveredForm[];\n  tables: DiscoveredTable[];\n  modals: DiscoveredModal[];\n}\n\n/**\n * A template for pattern generation\n */\nexport interface PatternTemplate {\n  /** Template text with {placeholder} variables */\n  text: string;\n  /** IR primitive to map to */\n  primitive: string;\n  /** Placeholders used in the template */\n  placeholders: string[];\n  /** Category for the generated pattern */\n  category: 'auth' | 'navigation' | 'ui-interaction' | 'data' | 'assertion' | 'timing';\n  /** Template source identifier */\n  templateSource: 'crud' | 'form' | 'table' | 'modal' | 'navigation' | 'auth' | 'static';\n}\n\n/**\n * Result of template generation\n */\nexport interface GenerationResult {\n  patterns: DiscoveredPattern[];\n  stats: {\n    crudPatterns: number;\n    formPatterns: number;\n    tablePatterns: number;\n    modalPatterns: number;\n    navigationPatterns: number;\n    notificationPatterns: number;\n    totalPatterns: number;\n  };\n}\n\n// =============================================================================\n// CRUD Templates\n// =============================================================================\n\n/**\n * CRUD operation templates\n * Each template generates patterns for each discovered entity\n */\nexport const CRUD_TEMPLATES: PatternTemplate[] = [\n  // Create operations\n  { text: 'create new {entity}', primitive: 'click', placeholders: ['entity'], category: 'data', templateSource: 'crud' },\n  { text: 'add {entity}', primitive: 'click', placeholders: ['entity'], category: 'data', templateSource: 'crud' },\n  { text: 'click add {entity} button', primitive: 'click', placeholders: ['entity'], category: 'data', templateSource: 'crud' },\n  { text: 'click create {entity} button', primitive: 'click', placeholders: ['entity'], category: 'data', templateSource: 'crud' },\n  { text: 'open new {entity} form', primitive: 'click', placeholders: ['entity'], category: 'data', templateSource: 'crud' },\n\n  // Read operations\n  { text: 'view {entity} details', primitive: 'click', placeholders: ['entity'], category: 'data', templateSource: 'crud' },\n  { text: 'open {entity}', primitive: 'click', placeholders: ['entity'], category: 'data', templateSource: 'crud' },\n  { text: 'click on {entity}', primitive: 'click', placeholders: ['entity'], category: 'data', templateSource: 'crud' },\n  { text: 'select {entity} from list', primitive: 'click', placeholders: ['entity'], category: 'data', templateSource: 'crud' },\n  { text: 'view {entity} list', primitive: 'navigate', placeholders: ['entity'], category: 'data', templateSource: 'crud' },\n\n  // Update operations\n  { text: 'edit {entity}', primitive: 'click', placeholders: ['entity'], category: 'data', templateSource: 'crud' },\n  { text: 'update {entity}', primitive: 'click', placeholders: ['entity'], category: 'data', templateSource: 'crud' },\n  { text: 'modify {entity}', primitive: 'click', placeholders: ['entity'], category: 'data', templateSource: 'crud' },\n  { text: 'click edit {entity} button', primitive: 'click', placeholders: ['entity'], category: 'data', templateSource: 'crud' },\n  { text: 'save {entity} changes', primitive: 'click', placeholders: ['entity'], category: 'data', templateSource: 'crud' },\n\n  // Delete operations\n  { text: 'delete {entity}', primitive: 'click', placeholders: ['entity'], category: 'data', templateSource: 'crud' },\n  { text: 'remove {entity}', primitive: 'click', placeholders: ['entity'], category: 'data', templateSource: 'crud' },\n  { text: 'click delete {entity} button', primitive: 'click', placeholders: ['entity'], category: 'data', templateSource: 'crud' },\n  { text: 'confirm {entity} deletion', primitive: 'click', placeholders: ['entity'], category: 'data', templateSource: 'crud' },\n  { text: 'cancel {entity} deletion', primitive: 'click', placeholders: ['entity'], category: 'data', templateSource: 'crud' },\n\n  // Search/filter operations\n  { text: 'search for {entity}', primitive: 'fill', placeholders: ['entity'], category: 'data', templateSource: 'crud' },\n  { text: 'filter {entities}', primitive: 'fill', placeholders: ['entities'], category: 'data', templateSource: 'crud' },\n  { text: 'clear {entity} filter', primitive: 'click', placeholders: ['entity'], category: 'data', templateSource: 'crud' },\n];\n\n// =============================================================================\n// Form Templates\n// =============================================================================\n\n/**\n * Form operation templates\n */\nexport const FORM_TEMPLATES: PatternTemplate[] = [\n  // Form interactions\n  { text: 'fill {form} form', primitive: 'fill', placeholders: ['form'], category: 'data', templateSource: 'form' },\n  { text: 'submit {form} form', primitive: 'click', placeholders: ['form'], category: 'data', templateSource: 'form' },\n  { text: 'cancel {form} form', primitive: 'click', placeholders: ['form'], category: 'data', templateSource: 'form' },\n  { text: 'reset {form} form', primitive: 'click', placeholders: ['form'], category: 'data', templateSource: 'form' },\n  { text: 'clear {form} form', primitive: 'click', placeholders: ['form'], category: 'data', templateSource: 'form' },\n\n  // Field operations\n  { text: 'enter {field} in {form}', primitive: 'fill', placeholders: ['field', 'form'], category: 'data', templateSource: 'form' },\n  { text: 'fill in {field}', primitive: 'fill', placeholders: ['field'], category: 'data', templateSource: 'form' },\n  { text: 'select {field} option', primitive: 'click', placeholders: ['field'], category: 'data', templateSource: 'form' },\n  { text: 'check {field} checkbox', primitive: 'check', placeholders: ['field'], category: 'data', templateSource: 'form' },\n  { text: 'uncheck {field} checkbox', primitive: 'uncheck', placeholders: ['field'], category: 'data', templateSource: 'form' },\n  { text: 'toggle {field}', primitive: 'click', placeholders: ['field'], category: 'data', templateSource: 'form' },\n  { text: 'upload file to {field}', primitive: 'upload', placeholders: ['field'], category: 'data', templateSource: 'form' },\n  { text: 'clear {field} field', primitive: 'clear', placeholders: ['field'], category: 'data', templateSource: 'form' },\n\n  // Validation\n  { text: 'verify {field} error message', primitive: 'assert', placeholders: ['field'], category: 'assertion', templateSource: 'form' },\n  { text: 'verify {form} validation error', primitive: 'assert', placeholders: ['form'], category: 'assertion', templateSource: 'form' },\n  { text: 'verify {field} is required', primitive: 'assert', placeholders: ['field'], category: 'assertion', templateSource: 'form' },\n  { text: 'verify {form} submitted successfully', primitive: 'assert', placeholders: ['form'], category: 'assertion', templateSource: 'form' },\n];\n\n// =============================================================================\n// Table Templates\n// =============================================================================\n\n/**\n * Table/grid operation templates\n */\nexport const TABLE_TEMPLATES: PatternTemplate[] = [\n  // Row operations\n  { text: 'click row in {table}', primitive: 'click', placeholders: ['table'], category: 'ui-interaction', templateSource: 'table' },\n  { text: 'select row in {table}', primitive: 'click', placeholders: ['table'], category: 'ui-interaction', templateSource: 'table' },\n  { text: 'double-click row in {table}', primitive: 'dblclick', placeholders: ['table'], category: 'ui-interaction', templateSource: 'table' },\n  { text: 'expand row in {table}', primitive: 'click', placeholders: ['table'], category: 'ui-interaction', templateSource: 'table' },\n  { text: 'collapse row in {table}', primitive: 'click', placeholders: ['table'], category: 'ui-interaction', templateSource: 'table' },\n  { text: 'hover over row in {table}', primitive: 'hover', placeholders: ['table'], category: 'ui-interaction', templateSource: 'table' },\n\n  // Column operations\n  { text: 'sort {column} column in {table}', primitive: 'click', placeholders: ['column', 'table'], category: 'ui-interaction', templateSource: 'table' },\n  { text: 'sort {table} by {column}', primitive: 'click', placeholders: ['table', 'column'], category: 'ui-interaction', templateSource: 'table' },\n  { text: 'filter {column} in {table}', primitive: 'fill', placeholders: ['column', 'table'], category: 'ui-interaction', templateSource: 'table' },\n  { text: 'resize {column} column', primitive: 'drag', placeholders: ['column'], category: 'ui-interaction', templateSource: 'table' },\n  { text: 'hide {column} column', primitive: 'click', placeholders: ['column'], category: 'ui-interaction', templateSource: 'table' },\n  { text: 'show {column} column', primitive: 'click', placeholders: ['column'], category: 'ui-interaction', templateSource: 'table' },\n\n  // Pagination\n  { text: 'go to next page in {table}', primitive: 'click', placeholders: ['table'], category: 'ui-interaction', templateSource: 'table' },\n  { text: 'go to previous page in {table}', primitive: 'click', placeholders: ['table'], category: 'ui-interaction', templateSource: 'table' },\n  { text: 'go to page {page} in {table}', primitive: 'click', placeholders: ['page', 'table'], category: 'ui-interaction', templateSource: 'table' },\n  { text: 'change page size in {table}', primitive: 'click', placeholders: ['table'], category: 'ui-interaction', templateSource: 'table' },\n\n  // Cell operations\n  { text: 'edit cell in {table}', primitive: 'dblclick', placeholders: ['table'], category: 'ui-interaction', templateSource: 'table' },\n  { text: 'click cell in {table}', primitive: 'click', placeholders: ['table'], category: 'ui-interaction', templateSource: 'table' },\n\n  // Selection\n  { text: 'select all rows in {table}', primitive: 'click', placeholders: ['table'], category: 'ui-interaction', templateSource: 'table' },\n  { text: 'deselect all rows in {table}', primitive: 'click', placeholders: ['table'], category: 'ui-interaction', templateSource: 'table' },\n\n  // Assertions\n  { text: 'verify {table} has {count} rows', primitive: 'assert', placeholders: ['table', 'count'], category: 'assertion', templateSource: 'table' },\n  { text: 'verify {table} contains {text}', primitive: 'assert', placeholders: ['table', 'text'], category: 'assertion', templateSource: 'table' },\n  { text: 'verify {table} is empty', primitive: 'assert', placeholders: ['table'], category: 'assertion', templateSource: 'table' },\n  { text: 'verify {column} is sorted', primitive: 'assert', placeholders: ['column'], category: 'assertion', templateSource: 'table' },\n];\n\n// =============================================================================\n// Modal Templates\n// =============================================================================\n\n/**\n * Modal/dialog operation templates\n */\nexport const MODAL_TEMPLATES: PatternTemplate[] = [\n  // Open/close\n  { text: 'open {modal} modal', primitive: 'click', placeholders: ['modal'], category: 'ui-interaction', templateSource: 'modal' },\n  { text: 'open {modal} dialog', primitive: 'click', placeholders: ['modal'], category: 'ui-interaction', templateSource: 'modal' },\n  { text: 'close {modal} modal', primitive: 'click', placeholders: ['modal'], category: 'ui-interaction', templateSource: 'modal' },\n  { text: 'close {modal} dialog', primitive: 'click', placeholders: ['modal'], category: 'ui-interaction', templateSource: 'modal' },\n  { text: 'dismiss {modal}', primitive: 'click', placeholders: ['modal'], category: 'ui-interaction', templateSource: 'modal' },\n\n  // Actions\n  { text: 'confirm {modal}', primitive: 'click', placeholders: ['modal'], category: 'ui-interaction', templateSource: 'modal' },\n  { text: 'cancel {modal}', primitive: 'click', placeholders: ['modal'], category: 'ui-interaction', templateSource: 'modal' },\n  { text: 'click OK in {modal}', primitive: 'click', placeholders: ['modal'], category: 'ui-interaction', templateSource: 'modal' },\n  { text: 'click Cancel in {modal}', primitive: 'click', placeholders: ['modal'], category: 'ui-interaction', templateSource: 'modal' },\n  { text: 'click Yes in {modal}', primitive: 'click', placeholders: ['modal'], category: 'ui-interaction', templateSource: 'modal' },\n  { text: 'click No in {modal}', primitive: 'click', placeholders: ['modal'], category: 'ui-interaction', templateSource: 'modal' },\n  { text: 'submit {modal}', primitive: 'click', placeholders: ['modal'], category: 'ui-interaction', templateSource: 'modal' },\n\n  // Close methods\n  { text: 'press Escape to close {modal}', primitive: 'keyboard', placeholders: ['modal'], category: 'ui-interaction', templateSource: 'modal' },\n  { text: 'click outside {modal} to close', primitive: 'click', placeholders: ['modal'], category: 'ui-interaction', templateSource: 'modal' },\n  { text: 'click backdrop to close {modal}', primitive: 'click', placeholders: ['modal'], category: 'ui-interaction', templateSource: 'modal' },\n\n  // Assertions\n  { text: 'verify {modal} is open', primitive: 'assert', placeholders: ['modal'], category: 'assertion', templateSource: 'modal' },\n  { text: 'verify {modal} is closed', primitive: 'assert', placeholders: ['modal'], category: 'assertion', templateSource: 'modal' },\n  { text: 'verify {modal} contains {text}', primitive: 'assert', placeholders: ['modal', 'text'], category: 'assertion', templateSource: 'modal' },\n  { text: 'verify {modal} title is {title}', primitive: 'assert', placeholders: ['modal', 'title'], category: 'assertion', templateSource: 'modal' },\n];\n\n// =============================================================================\n// Navigation Templates (Extended)\n// =============================================================================\n\n/**\n * Extended navigation templates\n */\nexport const EXTENDED_NAVIGATION_TEMPLATES: PatternTemplate[] = [\n  // Direct navigation\n  { text: 'navigate to {route}', primitive: 'navigate', placeholders: ['route'], category: 'navigation', templateSource: 'navigation' },\n  { text: 'go to {route}', primitive: 'navigate', placeholders: ['route'], category: 'navigation', templateSource: 'navigation' },\n  { text: 'open {route} page', primitive: 'navigate', placeholders: ['route'], category: 'navigation', templateSource: 'navigation' },\n  { text: 'visit {route}', primitive: 'navigate', placeholders: ['route'], category: 'navigation', templateSource: 'navigation' },\n\n  // Menu/sidebar navigation\n  { text: 'click {route} in navigation', primitive: 'click', placeholders: ['route'], category: 'navigation', templateSource: 'navigation' },\n  { text: 'click {route} in sidebar', primitive: 'click', placeholders: ['route'], category: 'navigation', templateSource: 'navigation' },\n  { text: 'click {route} in menu', primitive: 'click', placeholders: ['route'], category: 'navigation', templateSource: 'navigation' },\n  { text: 'select {route} from menu', primitive: 'click', placeholders: ['route'], category: 'navigation', templateSource: 'navigation' },\n  { text: 'expand {route} menu', primitive: 'click', placeholders: ['route'], category: 'navigation', templateSource: 'navigation' },\n  { text: 'collapse {route} menu', primitive: 'click', placeholders: ['route'], category: 'navigation', templateSource: 'navigation' },\n\n  // Breadcrumb navigation\n  { text: 'click {route} in breadcrumb', primitive: 'click', placeholders: ['route'], category: 'navigation', templateSource: 'navigation' },\n  { text: 'navigate via breadcrumb to {route}', primitive: 'click', placeholders: ['route'], category: 'navigation', templateSource: 'navigation' },\n\n  // Tab navigation\n  { text: 'click {route} tab', primitive: 'click', placeholders: ['route'], category: 'navigation', templateSource: 'navigation' },\n  { text: 'switch to {route} tab', primitive: 'click', placeholders: ['route'], category: 'navigation', templateSource: 'navigation' },\n\n  // Header/footer navigation\n  { text: 'click {route} in header', primitive: 'click', placeholders: ['route'], category: 'navigation', templateSource: 'navigation' },\n  { text: 'click {route} in footer', primitive: 'click', placeholders: ['route'], category: 'navigation', templateSource: 'navigation' },\n\n  // Back/forward\n  { text: 'go back', primitive: 'navigate', placeholders: [], category: 'navigation', templateSource: 'navigation' },\n  { text: 'go forward', primitive: 'navigate', placeholders: [], category: 'navigation', templateSource: 'navigation' },\n  { text: 'return to {route}', primitive: 'navigate', placeholders: ['route'], category: 'navigation', templateSource: 'navigation' },\n\n  // Assertions\n  { text: 'verify on {route} page', primitive: 'assert', placeholders: ['route'], category: 'assertion', templateSource: 'navigation' },\n  { text: 'verify URL contains {route}', primitive: 'assert', placeholders: ['route'], category: 'assertion', templateSource: 'navigation' },\n  { text: 'verify {route} is active in navigation', primitive: 'assert', placeholders: ['route'], category: 'assertion', templateSource: 'navigation' },\n];\n\n// =============================================================================\n// Notification/Toast Templates\n// =============================================================================\n\n/**\n * Generic notification/toast operation templates.\n * Covers success, error, warning, info toasts for any app.\n * Framework-specific packs (MUI/Antd/Chakra) supplement these with\n * library-specific selectors.\n */\nexport const NOTIFICATION_TEMPLATES: PatternTemplate[] = [\n  // Toast/notification appearance\n  { text: 'a success notification appears', primitive: 'assert', placeholders: [], category: 'assertion', templateSource: 'static' },\n  { text: 'an error notification appears', primitive: 'assert', placeholders: [], category: 'assertion', templateSource: 'static' },\n  { text: 'a warning notification appears', primitive: 'assert', placeholders: [], category: 'assertion', templateSource: 'static' },\n  { text: 'an info notification appears', primitive: 'assert', placeholders: [], category: 'assertion', templateSource: 'static' },\n  { text: 'a toast message appears', primitive: 'assert', placeholders: [], category: 'assertion', templateSource: 'static' },\n  { text: 'a notification with text {text} appears', primitive: 'assert', placeholders: ['text'], category: 'assertion', templateSource: 'static' },\n\n  // Toast/notification content\n  { text: 'verify success message is displayed', primitive: 'assert', placeholders: [], category: 'assertion', templateSource: 'static' },\n  { text: 'verify error message is displayed', primitive: 'assert', placeholders: [], category: 'assertion', templateSource: 'static' },\n  { text: 'verify notification contains {text}', primitive: 'assert', placeholders: ['text'], category: 'assertion', templateSource: 'static' },\n  { text: 'verify toast shows {text}', primitive: 'assert', placeholders: ['text'], category: 'assertion', templateSource: 'static' },\n\n  // Dismiss/close\n  { text: 'dismiss notification', primitive: 'click', placeholders: [], category: 'ui-interaction', templateSource: 'static' },\n  { text: 'close toast', primitive: 'click', placeholders: [], category: 'ui-interaction', templateSource: 'static' },\n  { text: 'dismiss all notifications', primitive: 'click', placeholders: [], category: 'ui-interaction', templateSource: 'static' },\n\n  // Wait for\n  { text: 'wait for notification to appear', primitive: 'waitForVisible', placeholders: [], category: 'timing', templateSource: 'static' },\n  { text: 'wait for toast to disappear', primitive: 'waitForVisible', placeholders: [], category: 'timing', templateSource: 'static' },\n  { text: 'wait for notification to close', primitive: 'waitForVisible', placeholders: [], category: 'timing', templateSource: 'static' },\n\n  // Alert dialogs\n  { text: 'verify alert message contains {text}', primitive: 'assert', placeholders: ['text'], category: 'assertion', templateSource: 'static' },\n  { text: 'accept alert dialog', primitive: 'click', placeholders: [], category: 'ui-interaction', templateSource: 'static' },\n  { text: 'dismiss alert dialog', primitive: 'click', placeholders: [], category: 'ui-interaction', templateSource: 'static' },\n  { text: 'verify alert is shown', primitive: 'assert', placeholders: [], category: 'assertion', templateSource: 'static' },\n];\n\n// =============================================================================\n// Pattern ID Generation\n// =============================================================================\n\n/**\n * Generate a unique pattern ID\n */\nfunction generatePatternId(): string {\n  return `DP-${randomUUID().slice(0, 8)}`;\n}\n\n// =============================================================================\n// Template Expansion Functions\n// =============================================================================\n\n/**\n * Expand a template with an entity to create patterns\n */\nfunction expandEntityTemplate(\n  template: PatternTemplate,\n  entity: DiscoveredEntity,\n  confidence: number = DEFAULT_GENERATED_CONFIDENCE\n): DiscoveredPattern[] {\n  const patterns: DiscoveredPattern[] = [];\n\n  // Replace {entity} with singular\n  if (template.placeholders.includes('entity')) {\n    const text = template.text.replace('{entity}', entity.singular);\n    patterns.push(createPattern(template, text, entity.singular, confidence));\n  }\n\n  // Replace {entities} with plural\n  if (template.placeholders.includes('entities')) {\n    const text = template.text.replace('{entities}', entity.plural);\n    patterns.push(createPattern(template, text, entity.plural, confidence));\n  }\n\n  return patterns;\n}\n\n/**\n * Expand a template with a form to create patterns\n */\nfunction expandFormTemplate(\n  template: PatternTemplate,\n  form: DiscoveredForm,\n  confidence: number = DEFAULT_GENERATED_CONFIDENCE\n): DiscoveredPattern[] {\n  const patterns: DiscoveredPattern[] = [];\n\n  // Replace {form} placeholder\n  if (template.placeholders.includes('form') && !template.placeholders.includes('field')) {\n    const text = template.text.replace('{form}', form.name);\n    const selectorHints: SelectorHint[] = [];\n\n    if (form.submitSelector && template.text.includes('submit')) {\n      selectorHints.push({\n        strategy: 'css',\n        value: form.submitSelector,\n        confidence: confidence + SELECTOR_CONFIDENCE_BOOST,\n      });\n    }\n\n    patterns.push(createPattern(template, text, form.name, confidence, selectorHints));\n  }\n\n  // Generate field-specific patterns\n  if (template.placeholders.includes('field')) {\n    for (const field of form.fields) {\n      let text = template.text.replace('{field}', field.label || field.name);\n      if (template.placeholders.includes('form')) {\n        text = text.replace('{form}', form.name);\n      }\n\n      const selectorHints: SelectorHint[] = [];\n      if (field.selector) {\n        selectorHints.push({\n          strategy: 'css',\n          value: field.selector,\n          confidence: confidence + SELECTOR_CONFIDENCE_BOOST,\n        });\n      }\n\n      patterns.push(createPattern(template, text, field.name, confidence, selectorHints));\n    }\n  }\n\n  return patterns;\n}\n\n/**\n * Expand a template with a table to create patterns\n */\nfunction expandTableTemplate(\n  template: PatternTemplate,\n  table: DiscoveredTable,\n  confidence: number = DEFAULT_GENERATED_CONFIDENCE\n): DiscoveredPattern[] {\n  const patterns: DiscoveredPattern[] = [];\n\n  // Table-only patterns\n  if (template.placeholders.includes('table') && !template.placeholders.includes('column')) {\n    const text = template.text.replace('{table}', table.name);\n    const selectorHints: SelectorHint[] = [];\n\n    if (table.selectors?.table) {\n      selectorHints.push({\n        strategy: 'css',\n        value: table.selectors.table,\n        confidence: confidence + SELECTOR_CONFIDENCE_BOOST,\n      });\n    }\n\n    patterns.push(createPattern(template, text, table.name, confidence, selectorHints));\n  }\n\n  // Column-specific patterns\n  if (template.placeholders.includes('column')) {\n    for (const column of table.columns) {\n      let text = template.text.replace('{column}', column);\n      if (template.placeholders.includes('table')) {\n        text = text.replace('{table}', table.name);\n      }\n\n      const selectorHints: SelectorHint[] = [];\n      if (table.selectors?.header) {\n        selectorHints.push({\n          strategy: 'css',\n          value: `${table.selectors.header}:has-text(\"${column}\")`,\n          confidence: confidence + SELECTOR_CONFIDENCE_BOOST * 0.5,\n        });\n      }\n\n      patterns.push(createPattern(template, text, column, confidence, selectorHints));\n    }\n  }\n\n  return patterns;\n}\n\n/**\n * Expand a template with a modal to create patterns\n */\nfunction expandModalTemplate(\n  template: PatternTemplate,\n  modal: DiscoveredModal,\n  confidence: number = DEFAULT_GENERATED_CONFIDENCE\n): DiscoveredPattern[] {\n  const patterns: DiscoveredPattern[] = [];\n\n  if (template.placeholders.includes('modal')) {\n    const text = template.text.replace('{modal}', modal.name);\n    const selectorHints: SelectorHint[] = [];\n\n    // Add appropriate selector based on action\n    if (template.text.includes('open') && modal.triggerSelector) {\n      selectorHints.push({\n        strategy: 'css',\n        value: modal.triggerSelector,\n        confidence: confidence + SELECTOR_CONFIDENCE_BOOST,\n      });\n    } else if (template.text.includes('close') && modal.closeSelector) {\n      selectorHints.push({\n        strategy: 'css',\n        value: modal.closeSelector,\n        confidence: confidence + SELECTOR_CONFIDENCE_BOOST,\n      });\n    } else if ((template.text.includes('confirm') || template.text.includes('OK') || template.text.includes('Yes')) && modal.confirmSelector) {\n      selectorHints.push({\n        strategy: 'css',\n        value: modal.confirmSelector,\n        confidence: confidence + SELECTOR_CONFIDENCE_BOOST,\n      });\n    }\n\n    patterns.push(createPattern(template, text, modal.name, confidence, selectorHints));\n  }\n\n  return patterns;\n}\n\n/**\n * Expand a template with a route to create patterns\n * Note: Templates with no placeholders are handled separately in generateNavigationPatterns\n */\nfunction expandRouteTemplate(\n  template: PatternTemplate,\n  route: DiscoveredRoute,\n  confidence: number = DEFAULT_GENERATED_CONFIDENCE\n): DiscoveredPattern[] {\n  const patterns: DiscoveredPattern[] = [];\n\n  if (template.placeholders.includes('route')) {\n    const text = template.text.replace('{route}', route.name);\n    const selectorHints: SelectorHint[] = [];\n\n    // Add navigation hints\n    if (template.primitive === 'navigate') {\n      selectorHints.push({\n        strategy: 'text',\n        value: route.name,\n        confidence: confidence,\n      });\n    }\n\n    patterns.push(createPattern(template, text, route.name, confidence, selectorHints));\n  }\n\n  return patterns;\n}\n\n/**\n * Create a DiscoveredPattern from template data\n */\nfunction createPattern(\n  template: PatternTemplate,\n  text: string,\n  entityName: string,\n  confidence: number,\n  selectorHints: SelectorHint[] = []\n): DiscoveredPattern {\n  return {\n    id: generatePatternId(),\n    normalizedText: text.toLowerCase(),\n    originalText: text,\n    mappedPrimitive: template.primitive,\n    selectorHints,\n    confidence: Math.min(confidence, MAX_CONFIDENCE),\n    layer: 'app-specific',\n    category: template.category,\n    sourceJourneys: [],\n    successCount: 0,\n    failCount: 0,\n    templateSource: template.templateSource,\n    entityName: entityName || undefined,\n  };\n}\n\n// =============================================================================\n// Main Generation Functions\n// =============================================================================\n\n/**\n * Generate CRUD patterns from discovered entities\n */\nexport function generateCrudPatterns(\n  entities: DiscoveredEntity[],\n  confidence: number = DEFAULT_GENERATED_CONFIDENCE\n): DiscoveredPattern[] {\n  const patterns: DiscoveredPattern[] = [];\n\n  for (const entity of entities) {\n    for (const template of CRUD_TEMPLATES) {\n      patterns.push(...expandEntityTemplate(template, entity, confidence));\n    }\n  }\n\n  return patterns;\n}\n\n/**\n * Generate form patterns from discovered forms\n */\nexport function generateFormPatterns(\n  forms: DiscoveredForm[],\n  confidence: number = DEFAULT_GENERATED_CONFIDENCE\n): DiscoveredPattern[] {\n  const patterns: DiscoveredPattern[] = [];\n\n  for (const form of forms) {\n    for (const template of FORM_TEMPLATES) {\n      patterns.push(...expandFormTemplate(template, form, confidence));\n    }\n  }\n\n  return patterns;\n}\n\n/**\n * Generate table patterns from discovered tables\n */\nexport function generateTablePatterns(\n  tables: DiscoveredTable[],\n  confidence: number = DEFAULT_GENERATED_CONFIDENCE\n): DiscoveredPattern[] {\n  const patterns: DiscoveredPattern[] = [];\n\n  for (const table of tables) {\n    for (const template of TABLE_TEMPLATES) {\n      patterns.push(...expandTableTemplate(template, table, confidence));\n    }\n  }\n\n  return patterns;\n}\n\n/**\n * Generate modal patterns from discovered modals\n */\nexport function generateModalPatterns(\n  modals: DiscoveredModal[],\n  confidence: number = DEFAULT_GENERATED_CONFIDENCE\n): DiscoveredPattern[] {\n  const patterns: DiscoveredPattern[] = [];\n\n  for (const modal of modals) {\n    for (const template of MODAL_TEMPLATES) {\n      patterns.push(...expandModalTemplate(template, modal, confidence));\n    }\n  }\n\n  return patterns;\n}\n\n/**\n * Generate navigation patterns from discovered routes\n */\nexport function generateNavigationPatterns(\n  routes: DiscoveredRoute[],\n  confidence: number = DEFAULT_GENERATED_CONFIDENCE\n): DiscoveredPattern[] {\n  const patterns: DiscoveredPattern[] = [];\n  const addedGenericPatterns = new Set<string>();\n\n  for (const route of routes) {\n    for (const template of EXTENDED_NAVIGATION_TEMPLATES) {\n      // For templates with no placeholders (go back, go forward), only add once\n      if (template.placeholders.length === 0) {\n        if (!addedGenericPatterns.has(template.text)) {\n          patterns.push(createPattern(template, template.text, '', confidence, []));\n          addedGenericPatterns.add(template.text);\n        }\n      } else {\n        patterns.push(...expandRouteTemplate(template, route, confidence));\n      }\n    }\n  }\n\n  return patterns;\n}\n\n/**\n * Generate generic notification/toast patterns.\n * These are static templates (no entity multiplication) to cover\n * the spec target of 20 notification patterns.\n */\nexport function generateNotificationPatterns(\n  confidence: number = DEFAULT_GENERATED_CONFIDENCE\n): DiscoveredPattern[] {\n  return NOTIFICATION_TEMPLATES.map(template => createPattern(\n    template,\n    template.text,\n    '',\n    confidence,\n    []\n  ));\n}\n\n/**\n * Generate all patterns from discovered elements\n *\n * This is the main entry point for template multiplication.\n */\nexport function generateAllPatterns(\n  elements: DiscoveredElements,\n  confidence: number = DEFAULT_GENERATED_CONFIDENCE\n): GenerationResult {\n  const crudPatterns = generateCrudPatterns(elements.entities, confidence);\n  const formPatterns = generateFormPatterns(elements.forms, confidence);\n  const tablePatterns = generateTablePatterns(elements.tables, confidence);\n  const modalPatterns = generateModalPatterns(elements.modals, confidence);\n  const navigationPatterns = generateNavigationPatterns(elements.routes, confidence);\n  const notificationPatterns = generateNotificationPatterns(confidence);\n\n  let allPatterns = [\n    ...crudPatterns,\n    ...formPatterns,\n    ...tablePatterns,\n    ...modalPatterns,\n    ...navigationPatterns,\n    ...notificationPatterns,\n  ];\n\n  // Safety cap: truncate by confidence if multiplication produces too many patterns\n  if (allPatterns.length > MAX_GENERATED_PATTERNS) {\n    allPatterns.sort((a, b) => b.confidence - a.confidence);\n    allPatterns = allPatterns.slice(0, MAX_GENERATED_PATTERNS);\n  }\n\n  return {\n    patterns: allPatterns,\n    stats: {\n      crudPatterns: crudPatterns.length,\n      formPatterns: formPatterns.length,\n      tablePatterns: tablePatterns.length,\n      modalPatterns: modalPatterns.length,\n      navigationPatterns: navigationPatterns.length,\n      notificationPatterns: notificationPatterns.length,\n      totalPatterns: allPatterns.length,\n    },\n  };\n}\n\n// =============================================================================\n// Helper Functions for Common Entities\n// =============================================================================\n// ARCH-001 FIX: pluralize and singularize are now imported from './pluralization.js'\n\n/**\n * Create a simple entity from a name\n */\nexport function createEntity(name: string): DiscoveredEntity {\n  const lower = name.toLowerCase();\n\n  // Determine if input is likely singular or plural\n  const likelySingular = singularize(lower);\n  const likelyPlural = pluralize(likelySingular);\n\n  // Use singularized form as the singular\n  const singular = likelySingular;\n  const plural = likelyPlural;\n\n  return {\n    name,\n    singular,\n    plural,\n  };\n}\n\n/**\n * Create a simple form from a name\n */\nexport function createForm(name: string, fields: string[] = []): DiscoveredForm {\n  return {\n    id: `form-${name.toLowerCase().replace(/\\s+/g, '-')}`,\n    name,\n    fields: fields.map(f => ({\n      name: f.toLowerCase().replace(/\\s+/g, '_'),\n      type: 'text',\n      label: f,\n    })),\n  };\n}\n\n/**\n * Create a simple table from a name\n */\nexport function createTable(name: string, columns: string[] = []): DiscoveredTable {\n  return {\n    id: `table-${name.toLowerCase().replace(/\\s+/g, '-')}`,\n    name,\n    columns,\n  };\n}\n\n/**\n * Create a simple modal from a name\n */\nexport function createModal(name: string): DiscoveredModal {\n  return {\n    id: `modal-${name.toLowerCase().replace(/\\s+/g, '-')}`,\n    name,\n  };\n}\n\n/**\n * Create a simple route from a path\n */\nexport function createRoute(path: string, name?: string): DiscoveredRoute {\n  const routeName = name || path.split('/').filter(Boolean).pop() || 'home';\n\n  return {\n    path,\n    name: routeName.charAt(0).toUpperCase() + routeName.slice(1),\n  };\n}\n","/**\n * LLKB Mining Cache Module\n *\n * Provides file content caching and unified directory configuration\n * for mining operations to eliminate redundant file I/O.\n *\n * ARCH-002: File caching reduces I/O by ~5x\n * ARCH-003: Unified directory scanning ensures no elements are missed\n *\n * Security: Validates mtime to prevent stale content, implements memory limits.\n *\n * @module llkb/mining-cache\n */\n\nimport type * as fs from 'fs';\nimport * as fsp from 'fs/promises';\nimport * as path from 'path';\n\n// =============================================================================\n// Constants\n// =============================================================================\n\n/** Maximum file size to cache (5MB) */\nconst MAX_CACHE_FILE_SIZE = 5 * 1024 * 1024;\n\n/** Maximum number of files to cache */\nconst MAX_CACHED_FILES = 5000;\n\n/** Maximum total memory for cache (100MB  fits CI/CD; typical source < 50MB) */\nconst MAX_CACHE_MEMORY = 100 * 1024 * 1024;\n\n/** Percentage of cache to evict when full */\nconst EVICTION_BATCH_PERCENT = 0.1;\n\n/**\n * V8 string memory overhead factor.\n * V8 stores strings as UCS-2 (2 bytes per char), so in-memory size is ~2x the\n * UTF-8 on-disk size for ASCII content. We use content.length * 2 to estimate\n * the actual heap footprint rather than relying on stat.size.\n */\nconst V8_STRING_BYTES_PER_CHAR = 2;\n\n// =============================================================================\n// ARCH-003: Unified Source Directories\n// =============================================================================\n\n/**\n * All source directories to scan for mining.\n * This unified list ensures consistent coverage across all mining functions.\n *\n * Previously each function scanned different directories:\n * - mineEntities: src, app, lib, pages, components, models, entities, types\n * - mineRoutes: src, app, pages, routes, views\n * - mineForms: src, app, components, forms, schemas, validation\n * - mineTables: src, app, components, tables, grids, views\n * - mineModals: src, app, components, modals, dialogs\n *\n * Now all functions scan this unified list.\n */\nexport const SOURCE_DIRECTORIES = [\n  // Core directories (always present in most projects)\n  'src',\n  'app',\n\n  // Component directories\n  'components',\n  'lib',\n\n  // Page/View directories\n  'pages',\n  'views',\n\n  // Model/Type directories\n  'models',\n  'entities',\n  'types',\n\n  // Route directories\n  'routes',\n\n  // Form directories\n  'forms',\n  'schemas',\n  'validation',\n\n  // Table directories\n  'tables',\n  'grids',\n\n  // Modal directories\n  'modals',\n  'dialogs',\n\n  // Additional common directories (expanded coverage)\n  'features', // Feature-sliced design\n  'modules', // NestJS, Angular\n  'services', // Common for service layers\n  'utils', // Utility functions\n  'helpers', // Helper functions\n  'api', // API routes\n  'stores', // Pinia, Vuex, Redux stores\n  'hooks', // React hooks\n  'contexts', // React contexts\n  'providers', // Context providers\n  'layouts', // Layout components\n  'shared', // Shared code\n  'common', // Common utilities\n] as const;\n\n/** Type for source directories */\nexport type SourceDirectory = (typeof SOURCE_DIRECTORIES)[number];\n\n// =============================================================================\n// ARCH-002: File Content Cache (with mtime validation and LRU eviction)\n// =============================================================================\n\n/** Cache statistics for observability */\nexport interface CacheStats {\n  hits: number;\n  misses: number;\n  skipped: number; // Files too large\n  invalidations: number; // Files invalidated due to mtime change\n  evictions: number; // Files evicted by LRU\n  cacheSize: number;\n  memoryUsage: number;\n  totalBytesRead: number;\n}\n\n/** Doubly-linked list node for O(1) LRU eviction */\ninterface LRUNode {\n  key: string;\n  prev: LRUNode | null;\n  next: LRUNode | null;\n}\n\n/** Cache entry with content and metadata */\ninterface CacheEntry {\n  content: string;\n  size: number;\n  mtime: number;\n  lastAccessed: number; // For stats only, LRU uses linked list\n  node: LRUNode; // Reference to position in LRU list\n}\n\n/**\n * In-memory cache for file contents during mining.\n *\n * Features:\n * - mtime validation: Detects and invalidates stale content\n * - LRU eviction: Removes least-recently-used entries when full\n * - Memory limits: Caps total memory usage to prevent OOM\n * - Statistics: Tracks hits, misses, evictions for observability\n *\n * This cache is designed for single mining sessions and should be\n * cleared after use to free memory.\n *\n * @example\n * const cache = new MiningCache();\n * const content = await cache.getContent('/path/to/file.ts');\n * // ... use content multiple times\n * console.log(cache.getStats()); // View cache performance\n * cache.clear(); // Free memory when done\n */\nexport class MiningCache {\n  private cache = new Map<string, CacheEntry>();\n  private currentMemoryUsage = 0;\n  private stats: CacheStats = {\n    hits: 0,\n    misses: 0,\n    skipped: 0,\n    invalidations: 0,\n    evictions: 0,\n    cacheSize: 0,\n    memoryUsage: 0,\n    totalBytesRead: 0,\n  };\n\n  /** Optional: Skip mtime validation for performance (use with caution) */\n  private validateMtime: boolean;\n\n  // LRU doubly-linked list: head is most recently used, tail is least recently used\n  private lruHead: LRUNode | null = null;\n  private lruTail: LRUNode | null = null;\n\n  /**\n   * Create a new MiningCache.\n   *\n   * @param options - Cache configuration options\n   */\n  constructor(options: { validateMtime?: boolean } = {}) {\n    this.validateMtime = options.validateMtime !== false; // Default: true\n  }\n\n  /**\n   * Get file content, using cache if available.\n   * Validates mtime to ensure content freshness.\n   *\n   * @param filePath - Absolute path to the file\n   * @returns File content or null if unreadable/too large\n   */\n  async getContent(filePath: string): Promise<string | null> {\n    const normalizedPath = path.resolve(filePath);\n\n    // Check cache first\n    const cached = this.cache.get(normalizedPath);\n    if (cached) {\n      // Validate freshness if enabled\n      if (this.validateMtime) {\n        try {\n          const currentStat = await fsp.lstat(normalizedPath);\n          // SEC-005: Defense-in-depth - reject symlinks that bypassed scan filtering\n          if (currentStat.isSymbolicLink()) {\n            this.removeEntry(normalizedPath);\n            return null;\n          }\n          if (currentStat.mtimeMs !== cached.mtime) {\n            // File changed - invalidate and re-read\n            this.removeEntry(normalizedPath);\n            this.stats.invalidations++;\n            // Fall through to re-read below\n          } else {\n            // Cache hit - move to head of LRU list (O(1))\n            cached.lastAccessed = Date.now();\n            this.moveToHead(cached.node);\n            this.stats.hits++;\n            return cached.content;\n          }\n        } catch {\n          // File deleted or unreadable - remove from cache\n          this.removeEntry(normalizedPath);\n          return null;\n        }\n      } else {\n        // No validation - direct cache hit, move to head of LRU list (O(1))\n        cached.lastAccessed = Date.now();\n        this.moveToHead(cached.node);\n        this.stats.hits++;\n        return cached.content;\n      }\n    }\n\n    // Read file and potentially cache\n    let stat: fs.Stats;\n    try {\n      stat = await fsp.lstat(normalizedPath);\n    } catch {\n      return null;\n    }\n\n    // SEC-005: Defense-in-depth - reject symlinks\n    if (stat.isSymbolicLink()) {\n      return null;\n    }\n\n    // Skip files that are too large\n    if (stat.size > MAX_CACHE_FILE_SIZE) {\n      this.stats.skipped++;\n      return null;\n    }\n\n    // Read the file\n    let content: string;\n    try {\n      content = await fsp.readFile(normalizedPath, 'utf-8');\n    } catch {\n      return null;\n    }\n\n    // V8 stores strings as UCS-2 (~2 bytes per char), not UTF-8\n    const memorySize = content.length * V8_STRING_BYTES_PER_CHAR;\n    this.stats.totalBytesRead += stat.size;\n    this.stats.misses++;\n\n    // Cache if possible (with LRU eviction)\n    if (this.canCache(memorySize)) {\n      this.ensureCapacity(memorySize);\n      // Create LRU node for O(1) eviction\n      const node: LRUNode = { key: normalizedPath, prev: null, next: null };\n      this.addEntry(normalizedPath, {\n        content,\n        size: memorySize,\n        mtime: stat.mtimeMs,\n        lastAccessed: Date.now(),\n        node,\n      });\n    }\n\n    return content;\n  }\n\n  /**\n   * Check if a file has been cached.\n   *\n   * @param filePath - Absolute path to the file\n   * @returns True if the file is in cache\n   */\n  has(filePath: string): boolean {\n    return this.cache.has(path.resolve(filePath));\n  }\n\n  /**\n   * Manually invalidate a cached file.\n   *\n   * @param filePath - Absolute path to the file\n   * @returns True if the file was in cache and removed\n   */\n  invalidate(filePath: string): boolean {\n    const normalizedPath = path.resolve(filePath);\n    if (this.cache.has(normalizedPath)) {\n      this.removeEntry(normalizedPath);\n      this.stats.invalidations++;\n      return true;\n    }\n    return false;\n  }\n\n  /**\n   * Warm up the cache with pre-read files.\n   * Useful for testing or when files are already in memory.\n   *\n   * @param files - Array of files with path, content, and optional mtime\n   */\n  async warmUp(\n    files: Array<{ path: string; content: string; mtime?: number; size?: number }>\n  ): Promise<void> {\n    for (const file of files) {\n      const normalizedPath = path.resolve(file.path);\n      // Use V8-aware size: provided size, or content.length * 2 for heap estimate\n      const size = file.size ?? file.content.length * V8_STRING_BYTES_PER_CHAR;\n\n      // Skip if too large\n      if (size > MAX_CACHE_FILE_SIZE) {continue;}\n\n      // Skip if would exceed memory\n      if (!this.canCache(size)) {break;}\n\n      // Get mtime if not provided\n      let mtime = file.mtime;\n      if (mtime === undefined) {\n        try {\n          const stat = await fsp.lstat(normalizedPath);\n          if (stat.isSymbolicLink()) {continue;} // SEC-005\n          mtime = stat.mtimeMs;\n        } catch {\n          mtime = Date.now(); // Fallback\n        }\n      }\n\n      // Create LRU node for O(1) eviction\n      const node: LRUNode = { key: normalizedPath, prev: null, next: null };\n      this.addEntry(normalizedPath, {\n        content: file.content,\n        size,\n        mtime,\n        lastAccessed: Date.now(),\n        node,\n      });\n    }\n  }\n\n  /**\n   * Get cache statistics.\n   *\n   * @returns Cache hit/miss statistics\n   */\n  getStats(): Readonly<CacheStats> {\n    return { ...this.stats };\n  }\n\n  /**\n   * Get the hit rate as a percentage.\n   *\n   * @returns Hit rate between 0 and 100\n   */\n  getHitRate(): number {\n    const total = this.stats.hits + this.stats.misses;\n    if (total === 0) {return 0;}\n    return Math.round((this.stats.hits / total) * 100);\n  }\n\n  /**\n   * Clear the cache and reset statistics.\n   * Call this after mining to free memory.\n   */\n  clear(): void {\n    this.cache.clear();\n    this.currentMemoryUsage = 0;\n    this.lruHead = null;\n    this.lruTail = null;\n    this.stats = {\n      hits: 0,\n      misses: 0,\n      skipped: 0,\n      invalidations: 0,\n      evictions: 0,\n      cacheSize: 0,\n      memoryUsage: 0,\n      totalBytesRead: 0,\n    };\n  }\n\n  /**\n   * Get the number of cached files.\n   *\n   * @returns Number of files in cache\n   */\n  get size(): number {\n    return this.cache.size;\n  }\n\n  /**\n   * Get current memory usage in bytes.\n   *\n   * @returns Memory usage in bytes\n   */\n  get memoryUsage(): number {\n    return this.currentMemoryUsage;\n  }\n\n  // =========================================================================\n  // Private methods\n  // =========================================================================\n\n  /**\n   * Check if we can cache a file of the given size.\n   */\n  private canCache(size: number): boolean {\n    return this.currentMemoryUsage + size <= MAX_CACHE_MEMORY;\n  }\n\n  /**\n   * Ensure capacity for a new entry by evicting if necessary.\n   */\n  private ensureCapacity(requiredSize: number): void {\n    // Evict by count limit\n    if (this.cache.size >= MAX_CACHED_FILES) {\n      const evictCount = Math.ceil(MAX_CACHED_FILES * EVICTION_BATCH_PERCENT);\n      this.evictLRU(evictCount);\n    }\n\n    // Evict by memory limit\n    while (!this.canCache(requiredSize) && this.cache.size > 0) {\n      this.evictLRU(1);\n    }\n  }\n\n  /**\n   * Evict least-recently-used entries from the tail of the LRU list.\n   * O(1) per eviction using doubly-linked list.\n   */\n  private evictLRU(count: number): void {\n    for (let i = 0; i < count && this.lruTail; i++) {\n      const keyToRemove = this.lruTail.key;\n      this.removeEntry(keyToRemove);\n      this.stats.evictions++;\n    }\n  }\n\n  /**\n   * Move a node to the head of the LRU list (most recently used).\n   * O(1) operation.\n   */\n  private moveToHead(node: LRUNode): void {\n    if (node === this.lruHead) {return;} // Already at head\n\n    // Remove from current position\n    this.unlinkNode(node);\n\n    // Add to head\n    node.prev = null;\n    node.next = this.lruHead;\n    if (this.lruHead) {\n      this.lruHead.prev = node;\n    }\n    this.lruHead = node;\n    if (!this.lruTail) {\n      this.lruTail = node;\n    }\n  }\n\n  /**\n   * Remove a node from the LRU list without deleting it.\n   * O(1) operation.\n   */\n  private unlinkNode(node: LRUNode): void {\n    if (node.prev) {\n      node.prev.next = node.next;\n    } else {\n      this.lruHead = node.next;\n    }\n    if (node.next) {\n      node.next.prev = node.prev;\n    } else {\n      this.lruTail = node.prev;\n    }\n  }\n\n  /**\n   * Add an entry to the cache and the head of the LRU list.\n   */\n  private addEntry(key: string, entry: CacheEntry): void {\n    this.cache.set(key, entry);\n    this.currentMemoryUsage += entry.size;\n\n    // Add to head of LRU list\n    this.moveToHead(entry.node);\n\n    this.stats.cacheSize = this.cache.size;\n    this.stats.memoryUsage = this.currentMemoryUsage;\n  }\n\n  /**\n   * Remove an entry from the cache and the LRU list.\n   */\n  private removeEntry(key: string): void {\n    const entry = this.cache.get(key);\n    if (entry) {\n      // Remove from LRU list\n      this.unlinkNode(entry.node);\n\n      this.currentMemoryUsage -= entry.size;\n      this.cache.delete(key);\n      this.stats.cacheSize = this.cache.size;\n      this.stats.memoryUsage = this.currentMemoryUsage;\n    }\n  }\n}\n\n// =============================================================================\n// Scanned File Collection\n// =============================================================================\n\n/** A scanned file with its path and content */\nexport interface ScannedFile {\n  path: string;\n  content: string;\n}\n\n/** Options for scanning */\nexport interface ScanOptions {\n  maxDepth?: number;\n  maxFiles?: number;\n  extensions?: string[];\n}\n\n/** Default extensions to scan */\nconst DEFAULT_EXTENSIONS = ['.ts', '.tsx', '.js', '.jsx', '.vue', '.svelte'];\n\n/**\n * Scan a directory and collect source files.\n * Uses the provided cache to avoid redundant reads.\n *\n * @param dir - Directory to scan\n * @param cache - File cache instance\n * @param options - Scan options\n * @returns Array of scanned files with content\n */\nexport async function scanDirectory(\n  dir: string,\n  cache: MiningCache,\n  options: ScanOptions = {}\n): Promise<ScannedFile[]> {\n  const maxDepth = options.maxDepth ?? 15;\n  const maxFiles = options.maxFiles ?? 3000;\n  const extensions = options.extensions ?? DEFAULT_EXTENSIONS;\n\n  const files: ScannedFile[] = [];\n\n  async function scanRecursive(currentDir: string, depth: number): Promise<void> {\n    if (depth > maxDepth || files.length >= maxFiles) {return;}\n\n    let entries: fs.Dirent[];\n    try {\n      entries = await fsp.readdir(currentDir, { withFileTypes: true });\n    } catch {\n      return;\n    }\n\n    for (const entry of entries) {\n      if (files.length >= maxFiles) {break;}\n\n      const fullPath = path.join(currentDir, entry.name);\n\n      if (entry.isDirectory()) {\n        // Skip hidden directories and common non-source directories\n        // Also skip symlinks to prevent infinite loops and security issues\n        if (\n          !entry.name.startsWith('.') &&\n          entry.name !== 'node_modules' &&\n          entry.name !== 'dist' &&\n          entry.name !== 'build' &&\n          entry.name !== 'coverage' &&\n          entry.name !== '__pycache__' &&\n          entry.name !== '.git' &&\n          entry.name !== '.svn' &&\n          !entry.isSymbolicLink()\n        ) {\n          await scanRecursive(fullPath, depth + 1);\n        }\n      } else if (entry.isFile() && extensions.some((ext) => entry.name.endsWith(ext))) {\n        // Also skip symlinks for files (security)\n        if (entry.isSymbolicLink()) {continue;}\n\n        const content = await cache.getContent(fullPath);\n        if (content !== null) {\n          files.push({ path: fullPath, content });\n        }\n      }\n    }\n  }\n\n  await scanRecursive(dir, 0);\n  return files;\n}\n\n/**\n * Scan all source directories in a project.\n * This is the main entry point for unified scanning.\n *\n * @param projectRoot - Project root directory\n * @param cache - File cache instance\n * @param options - Scan options\n * @returns Array of all scanned files with content\n */\nexport async function scanAllSourceDirectories(\n  projectRoot: string,\n  cache: MiningCache,\n  options: ScanOptions = {}\n): Promise<ScannedFile[]> {\n  const resolvedRoot = path.resolve(projectRoot);\n  const allFiles: ScannedFile[] = [];\n  const seenPaths = new Set<string>();\n\n  for (const dir of SOURCE_DIRECTORIES) {\n    const fullPath = path.join(resolvedRoot, dir);\n\n    // Validate path is within project root (security)\n    const resolvedPath = path.resolve(fullPath);\n    if (!resolvedPath.startsWith(resolvedRoot + path.sep) && resolvedPath !== resolvedRoot) {\n      continue;\n    }\n\n    // Check if directory exists (SEC-005: use lstat to detect symlinks)\n    try {\n      const stat = await fsp.lstat(fullPath);\n      if (stat.isSymbolicLink() || !stat.isDirectory()) {continue;}\n    } catch {\n      continue;\n    }\n\n    const files = await scanDirectory(fullPath, cache, options);\n\n    // Deduplicate files (in case directories overlap)\n    for (const file of files) {\n      if (!seenPaths.has(file.path)) {\n        seenPaths.add(file.path);\n        allFiles.push(file);\n      }\n    }\n  }\n\n  return allFiles;\n}\n\n/**\n * Create a pre-populated cache from an array of files.\n * Useful for testing or when files are already in memory.\n *\n * @param files - Array of files to cache\n * @returns Pre-populated cache\n */\nexport async function createCacheFromFiles(files: ScannedFile[]): Promise<MiningCache> {\n  const cache = new MiningCache({ validateMtime: false }); // Skip mtime for pre-populated\n\n  await cache.warmUp(\n    files.map((f) => ({\n      path: f.path,\n      content: f.content,\n    }))\n  );\n\n  return cache;\n}\n","/**\n * Code Normalization for LLKB Pattern Matching\n *\n * Normalizes code strings for comparison by:\n * - Replacing string literals with placeholders\n * - Replacing numbers with placeholders\n * - Replacing variable names with placeholders\n * - Normalizing whitespace\n *\n * @module llkb/normalize\n */\n\n/**\n * Normalize code for pattern comparison\n *\n * This function transforms code into a canonical form that allows\n * comparing the structure of code rather than specific values.\n *\n * @param code - The source code to normalize\n * @returns Normalized code string\n *\n * @example\n * ```typescript\n * const code1 = `const user = \"john\"; const count = 5;`;\n * const code2 = `const admin = \"jane\"; const total = 10;`;\n *\n * normalizeCode(code1) === normalizeCode(code2) // true\n * // Both become: \"const <VAR> = <STRING>; const <VAR> = <NUMBER>;\"\n * ```\n */\nexport function normalizeCode(code: string): string {\n  let normalized = code;\n\n  // Remove single-quoted string literals (replace with <STRING>)\n  normalized = normalized.replace(/'[^']*'/g, '<STRING>');\n\n  // Remove double-quoted string literals (replace with <STRING>)\n  normalized = normalized.replace(/\"[^\"]*\"/g, '<STRING>');\n\n  // Remove template literals (replace with <STRING>)\n  normalized = normalized.replace(/`[^`]*`/g, '<STRING>');\n\n  // Remove numbers (replace with <NUMBER>)\n  // Match integers and decimals, but not numbers in identifiers\n  normalized = normalized.replace(/\\b\\d+(?:\\.\\d+)?\\b/g, '<NUMBER>');\n\n  // Remove variable names in const declarations\n  normalized = normalized.replace(/\\bconst\\s+(\\w+)/g, 'const <VAR>');\n\n  // Remove variable names in let declarations\n  normalized = normalized.replace(/\\blet\\s+(\\w+)/g, 'let <VAR>');\n\n  // Remove variable names in var declarations\n  normalized = normalized.replace(/\\bvar\\s+(\\w+)/g, 'var <VAR>');\n\n  // Normalize whitespace (collapse multiple spaces to single)\n  normalized = normalized.replace(/\\s+/g, ' ');\n\n  // Trim leading/trailing whitespace\n  normalized = normalized.trim();\n\n  return normalized;\n}\n\n/**\n * Generate a simple hash code from a string\n *\n * Uses a variant of the djb2 algorithm for fast hashing.\n * Not cryptographically secure, but good for deduplication.\n *\n * @param str - The string to hash\n * @returns A hash code as a hex string\n *\n * @example\n * ```typescript\n * hashCode(\"hello world\") // \"5e01db3e\"\n * ```\n */\nexport function hashCode(str: string): string {\n  let hash = 5381;\n\n  for (let i = 0; i < str.length; i++) {\n    // hash * 33 + char\n    hash = ((hash << 5) + hash + str.charCodeAt(i)) >>> 0;\n  }\n\n  return hash.toString(16);\n}\n\n/**\n * Tokenize code for Jaccard similarity calculation\n *\n * Splits code into meaningful tokens for comparison.\n *\n * @param code - The code to tokenize\n * @returns Set of tokens\n */\nexport function tokenize(code: string): Set<string> {\n  // Split on whitespace and punctuation, keep meaningful tokens\n  const tokens = code\n    .split(/[\\s.,;:(){}[\\]<>]+/)\n    .filter((token) => token.length > 0);\n\n  return new Set(tokens);\n}\n\n/**\n * Count lines in a code string\n *\n * @param code - The code to count lines in\n * @returns Number of lines\n */\nexport function countLines(code: string): number {\n  if (!code || code.length === 0) {\n    return 0;\n  }\n\n  return code.split('\\n').length;\n}\n","/**\n * LLKB (Lessons Learned Knowledge Base) Library\n *\n * A TypeScript library for managing lessons learned, reusable components,\n * and analytics for the ARTK automated testing framework.\n *\n * @module @artk/llkb\n */\n\n// Types - All public type definitions\nexport type {\n  // Categories and Scopes\n  LLKBCategory,\n  ComponentCategory,\n  LLKBScope,\n\n  // Lesson types\n  Lesson,\n  LessonMetrics,\n  LessonValidation,\n  LessonsFile,\n  ConfidenceHistoryEntry,\n  GlobalRule,\n  AppQuirk,\n\n  // Component types\n  Component,\n  ComponentMetrics,\n  ComponentSource,\n  ComponentsFile,\n\n  // Analytics types\n  AnalyticsFile,\n  AnalyticsOverview,\n  LessonStats,\n  ComponentStats,\n  ImpactMetrics,\n  TopPerformers,\n  TopPerformerLesson,\n  TopPerformerComponent,\n  NeedsReview,\n\n  // Configuration types\n  LLKBConfig,\n  ExtractionConfig,\n  RetentionConfig,\n  HistoryConfig,\n  InjectionConfig,\n  ScopesConfig,\n  OverridesConfig,\n\n  // History event types\n  BaseHistoryEvent,\n  LessonAppliedEvent,\n  ComponentExtractedEvent,\n  ComponentUsedEvent,\n  OverrideEvent,\n  ExtractionDeferredEvent,\n  HistoryEvent,\n\n  // Result types\n  SaveResult,\n  UpdateResult,\n  ExtractionCandidate,\n  TestStep,\n} from './types.js';\n\n// Normalization functions\nexport {\n  normalizeCode,\n  hashCode,\n  tokenize,\n  countLines,\n} from './normalize.js';\n\n// Pluralization functions (ARCH-001: shared module)\nexport type { PluralizeOptions, SingularizeOptions } from './pluralization.js';\nexport {\n  pluralize,\n  singularize,\n  getSingularPlural,\n  isUncountable,\n  IRREGULAR_PLURALS,\n  IRREGULAR_SINGULARS,\n  UNCOUNTABLE_NOUNS,\n} from './pluralization.js';\n\n// Similarity functions\nexport type { SimilarPatternResult } from './similarity.js';\nexport {\n  calculateSimilarity,\n  jaccardSimilarity,\n  lineCountSimilarity,\n  isNearDuplicate,\n  findNearDuplicates,\n  findSimilarPatterns,\n} from './similarity.js';\n\n// Category inference functions\nexport {\n  inferCategory,\n  inferCategoryWithConfidence,\n  isComponentCategory,\n  getAllCategories,\n  getComponentCategories,\n} from './inference.js';\n\n// Confidence calculation functions\nexport {\n  calculateConfidence,\n  detectDecliningConfidence,\n  updateConfidenceHistory,\n  getConfidenceTrend,\n  daysBetween,\n  needsConfidenceReview,\n  MAX_CONFIDENCE_HISTORY_ENTRIES,\n  CONFIDENCE_HISTORY_RETENTION_DAYS,\n} from './confidence.js';\n\n// File utilities\nexport {\n  saveJSONAtomic,\n  saveJSONAtomicSync,\n  updateJSONWithLock,\n  updateJSONWithLockSync,\n  loadJSON,\n  ensureDir,\n  LOCK_MAX_WAIT_MS,\n  STALE_LOCK_THRESHOLD_MS,\n  LOCK_RETRY_INTERVAL_MS,\n} from './file-utils.js';\n\n// History logging functions\nexport {\n  appendToHistory,\n  readHistoryFile,\n  readTodayHistory,\n  countTodayEvents,\n  countPredictiveExtractionsToday,\n  countJourneyExtractionsToday,\n  isDailyRateLimitReached,\n  isJourneyRateLimitReached,\n  getHistoryFilesInRange,\n  cleanupOldHistoryFiles,\n  getHistoryDir,\n  getHistoryFilePath,\n  formatDate,\n  DEFAULT_LLKB_ROOT,\n} from './history.js';\n\n// Analytics functions\nexport {\n  updateAnalytics,\n  updateAnalyticsWithData,\n  createEmptyAnalytics,\n  getAnalyticsSummary,\n} from './analytics.js';\n\n// CLI functions\nexport type {\n  HealthCheckResult,\n  HealthCheck,\n  StatsResult,\n  PruneResult,\n  AutogenExportOptions,\n  LearnOptions,\n  LearningResult,\n  // Versioning CLI types\n  CheckUpdatesOptions,\n  UpdateTestOptions,\n  UpdateTestsOptions,\n  UpdateTestResult,\n  UpdateTestsResult,\n} from './cli.js';\n\nexport {\n  runHealthCheck,\n  getStats,\n  prune,\n  formatHealthCheck,\n  formatStats,\n  formatPruneResult,\n  runExportForAutogen,\n  formatExportResultForConsole,\n  runLearnCommand,\n  formatLearnResult,\n  // Versioning CLI functions\n  runCheckUpdates,\n  formatCheckUpdatesResult,\n  runUpdateTest,\n  formatUpdateTestResult,\n  runUpdateTests,\n  formatUpdateTestsResult,\n  compareTestVersion,\n  extractLlkbVersionFromTest,\n  updateTestLlkbVersion,\n  getCurrentLlkbVersion,\n  formatVersionComparison,\n} from './cli.js';\n\n// Learning functions (learning loop for continuous improvement)\nexport type {\n  LearningInput,\n  PatternLearnedInput,\n  ComponentUsedInput,\n  LessonAppliedInput,\n  BatchLearningEvent,\n  BatchResult,\n} from './learning.js';\n\nexport {\n  recordPatternLearned,\n  recordComponentUsed,\n  recordLessonApplied,\n  recordLearning,\n  formatLearningResult,\n  recordBatch,\n} from './learning.js';\n\n// Adapter types (AutoGen integration)\nexport type {\n  LLKBAdapterConfig,\n  LLKBAdapterResult,\n  ExportStats,\n  PatternSource,\n  AdditionalPattern,\n  SelectorOverride,\n  TimingHint,\n  ModuleMapping,\n  AutogenLLKBConfig,\n  IRPrimitive,\n  GlossaryEntry,\n  GlossaryMeta,\n} from './adapter-types.js';\n\n// Adapter functions (AutoGen integration)\nexport {\n  exportForAutogen,\n  formatExportResult,\n  runAdapterCLI,\n  parseAdapterArgs,\n} from './adapter.js';\n\n// Adapter transform functions\nexport {\n  triggerToRegex,\n  componentNameToTrigger,\n  generateNameVariations,\n  lessonToPattern,\n  lessonToSelectorOverride,\n  lessonToTimingHint,\n  componentToModule,\n  componentToGlossaryEntries,\n  lessonToGlossaryEntries,\n} from './adapter-transforms.js';\n\n// Loaders - Load LLKB data from files\nexport type {\n  LessonFilterOptions,\n  ComponentFilterOptions,\n  LLKBPatterns,\n  LLKBData,\n  AppProfile,\n} from './loaders.js';\n\nexport {\n  loadLLKBConfig,\n  loadAppProfile,\n  loadLessons,\n  loadComponents,\n  loadPatterns,\n  loadLLKBData,\n  isLLKBEnabled,\n  llkbExists,\n} from './loaders.js';\n\n// Context injection - Get relevant context for prompts\nexport type {\n  JourneyContext,\n  RelevantContext,\n} from './context.js';\n\nexport {\n  getRelevantContext,\n  formatContextForPrompt,\n  extractKeywords,\n  getRelevantScopes,\n} from './context.js';\n\n// Matching - Match steps to components and detect extraction opportunities\nexport type {\n  JourneyStep,\n  StepMatchResult,\n  MatchOptions,\n  ExtractionCheckResult,\n  PatternOccurrence,\n} from './matching.js';\n\nexport {\n  matchStepsToComponents,\n  shouldExtractAsComponent,\n  findExtractionCandidates,\n  extractStepKeywords,\n} from './matching.js';\n\n// Detection - Cross-journey duplicate detection\nexport type {\n  DuplicateDetectionResult,\n  DuplicateGroup,\n  DetectionOptions,\n} from './detection.js';\n\nexport {\n  detectDuplicatesAcrossFiles,\n  detectDuplicatesInFile,\n  findUnusedComponentOpportunities,\n} from './detection.js';\n\n// Registry - Module registry management\nexport type {\n  ModuleExport,\n  ModuleEntry,\n  ModuleRegistry,\n  AddToRegistryOptions,\n} from './registry.js';\n\nexport {\n  createEmptyRegistry,\n  loadRegistry,\n  saveRegistry,\n  addComponentToRegistry,\n  removeComponentFromRegistry,\n  updateComponentInRegistry,\n  getModuleForComponent,\n  getImportPath,\n  listModules,\n  findModulesByCategory,\n  validateRegistryConsistency,\n  syncRegistryWithComponents,\n} from './registry.js';\n\n// Migration - Version upgrades and initialization\nexport type {\n  MigrationResult,\n  VersionInfo,\n} from './migration.js';\n\nexport {\n  CURRENT_VERSION,\n  MIN_SUPPORTED_VERSION,\n  parseVersion,\n  compareVersions,\n  isVersionSupported,\n  needsMigration,\n  migrateLLKB,\n  checkMigrationNeeded,\n  initializeLLKB,\n  validateLLKBInstallation,\n} from './migration.js';\n\n// Search and Export - Search LLKB data and export reports\nexport type {\n  SearchQuery,\n  SearchResult,\n  ExportFormat,\n  ExportOptions,\n  ReportSection,\n} from './search.js';\n\nexport {\n  search,\n  findLessonsByPattern,\n  findComponents,\n  getLessonsForJourney,\n  getComponentsForJourney,\n  exportLLKB,\n  generateReport,\n  exportToFile,\n} from './search.js';\n\n// Versioning - Track LLKB versions in generated tests\nexport type {\n  VersionComparison,\n  UpdateCheckResult,\n  UpdateTestSafeOptions,\n  UpdateTestSafeResult,\n} from './versioning.js';\n\nexport {\n  extractLlkbVersionFromTest as extractVersionFromTest,\n  extractLlkbEntriesFromTest,\n  updateTestLlkbVersion as updateVersionInTest,\n  getCurrentLlkbVersion as getLlkbVersion,\n  countNewEntriesSince,\n  compareVersions as compareTestVersions,\n  checkUpdates,\n  formatVersionComparison as formatComparison,\n  formatUpdateCheckResult,\n  updateTestSafe,\n} from './versioning.js';\n\n// Result types - Standardized error handling\nexport type {\n  LLKBResult,\n} from './result-types.js';\n\nexport {\n  ok,\n  fail,\n  tryCatch,\n  mapResult,\n  combineResults,\n  isOk,\n  isFail,\n} from './result-types.js';\n\n// Discovery - App-specific pattern discovery (F12)\nexport type {\n  FrameworkSignal,\n  UiLibrarySignal,\n  SelectorSignals,\n  AuthHints,\n  DiscoveredProfile,\n  DiscoveryResult,\n} from './discovery.js';\n\nexport {\n  FRAMEWORK_PATTERNS,\n  UI_LIBRARY_PATTERNS as DISCOVERY_UI_LIBRARY_PATTERNS,\n  SELECTOR_PATTERNS,\n  detectFrameworks,\n  detectUiLibraries,\n  analyzeSelectorSignals,\n  extractAuthHints,\n  runDiscovery,\n  saveDiscoveredProfile,\n  loadDiscoveredProfile,\n  saveAppProfile, // deprecated alias\n} from './discovery.js';\n\n// Pattern Generation - Generate patterns from discovery\nexport type {\n  SelectorHint,\n  DiscoveredPattern,\n  DiscoveredPatternsFile,\n  LearnedPattern,\n  LearnedPatternEntry,\n} from './pattern-generation.js';\n\nexport {\n  AUTH_PATTERN_TEMPLATES,\n  NAVIGATION_PATTERN_TEMPLATES,\n  UI_LIBRARY_PATTERNS as PATTERN_UI_LIBRARY_PATTERNS,\n  resetPatternIdCounter,\n  generatePatterns,\n  mergeDiscoveredPatterns,\n  createDiscoveredPatternsFile,\n  deduplicatePatterns,\n  saveDiscoveredPatterns,\n  loadDiscoveredPatterns,\n} from './pattern-generation.js';\n\n// Universal Seed Patterns - Cold start solution for first-run projects\nexport {\n  createUniversalSeedPatterns,\n  VALID_IR_PRIMITIVES,\n} from './universal-seeds.js';\n\n// Template Generators - CRUD, Form, Table, Modal, Navigation pattern multiplication\nexport type {\n  DiscoveredEntity,\n  DiscoveredRoute,\n  DiscoveredForm,\n  FormField,\n  DiscoveredTable,\n  DiscoveredModal,\n  DiscoveredElements,\n  PatternTemplate,\n  GenerationResult,\n} from './template-generators.js';\n\nexport {\n  // Main generation functions\n  generateCrudPatterns,\n  generateFormPatterns,\n  generateTablePatterns,\n  generateModalPatterns,\n  generateNavigationPatterns as generateExtendedNavigationPatterns,\n  generateNotificationPatterns,\n  generateAllPatterns,\n  // Helper functions\n  createEntity,\n  createForm,\n  createTable,\n  createModal,\n  createRoute,\n  // Templates\n  CRUD_TEMPLATES,\n  FORM_TEMPLATES,\n  TABLE_TEMPLATES,\n  MODAL_TEMPLATES,\n  EXTENDED_NAVIGATION_TEMPLATES,\n  NOTIFICATION_TEMPLATES,\n} from './template-generators.js';\n\n// Mining - Zero-config element discovery (F12)\nexport type {\n  MiningResult,\n} from './mining.js';\n\nexport {\n  mineEntities,\n  mineRoutes,\n  mineForms,\n  mineTables,\n  mineModals,\n  mineElements,\n  runMiningPipeline,\n} from './mining.js';\n\n// Mining Cache - File caching for performance (ARCH-002, ARCH-003)\nexport type {\n  CacheStats,\n  ScannedFile,\n  ScanOptions,\n  SourceDirectory,\n} from './mining-cache.js';\n\nexport {\n  MiningCache,\n  SOURCE_DIRECTORIES,\n  scanDirectory,\n  scanAllSourceDirectories,\n  createCacheFromFiles,\n} from './mining-cache.js';\n\n// Quality Controls - Pattern quality management\nexport type {\n  UsageStats,\n  QualityControlResult,\n} from './quality-controls.js';\n\nexport {\n  deduplicatePatterns as deduplicatePatternsQC,\n  applyConfidenceThreshold,\n  boostCrossSourcePatterns,\n  pruneUnusedPatterns,\n  applyAllQualityControls,\n  applySignalWeighting,\n} from './quality-controls.js';\n\n// Framework Packs - Lazy-loaded framework-specific patterns (F12)\nexport type {\n  PackPattern,\n  FrameworkPack,\n  PackRegistryEntry,\n} from './packs/index.js';\n\nexport {\n  getPackRegistry,\n  loadPacksForFrameworks,\n  packPatternsToDiscovered,\n  loadDiscoveredPatternsForFrameworks,\n} from './packs/index.js';\n\n// Mining Modules - i18n, analytics, feature flag mining (F12)\nexport type {\n  I18nKey,\n  I18nMiningResult,\n} from './mining/i18n-mining.js';\n\nexport type {\n  AnalyticsEvent,\n  AnalyticsMiningResult,\n} from './mining/analytics-mining.js';\n\nexport type {\n  FeatureFlag,\n  FeatureFlagMiningResult,\n} from './mining/feature-flag-mining.js';\n\nexport {\n  mineI18nKeys,\n  generateI18nPatterns,\n} from './mining/i18n-mining.js';\n\nexport {\n  mineAnalyticsEvents,\n  generateAnalyticsPatterns,\n} from './mining/analytics-mining.js';\n\nexport {\n  mineFeatureFlags,\n  generateFeatureFlagPatterns,\n} from './mining/feature-flag-mining.js';\n\n// Pipeline Orchestrator - Full discovery pipeline (F12)\nexport type {\n  PipelineOptions,\n  PipelineResult,\n  PipelineStats,\n} from './pipeline.js';\n\nexport {\n  runFullDiscoveryPipeline,\n} from './pipeline.js';\n","/**\n * Code Similarity Calculation for LLKB\n *\n * Provides functions to calculate similarity between code patterns\n * using a combination of Jaccard similarity and structural analysis.\n *\n * @module llkb/similarity\n */\n\nimport { normalizeCode, tokenize, countLines } from './normalize.js';\n\n/**\n * Calculate similarity between two code strings\n *\n * Uses a weighted combination of:\n * - Jaccard similarity on tokens (80%)\n * - Line count similarity (20%)\n *\n * @param codeA - First code string\n * @param codeB - Second code string\n * @returns Similarity score between 0.0 and 1.0\n *\n * @example\n * ```typescript\n * const similar = calculateSimilarity(\n *   `await page.click('#submit');`,\n *   `await page.click('#cancel');`\n * );\n * // Returns ~0.9 (very similar structure, different selector)\n * ```\n */\nexport function calculateSimilarity(codeA: string, codeB: string): number {\n  // Normalize both code strings\n  const normA = normalizeCode(codeA);\n  const normB = normalizeCode(codeB);\n\n  // Exact match after normalization\n  if (normA === normB) {\n    return 1.0;\n  }\n\n  // Calculate Jaccard similarity on tokens\n  const tokensA = tokenize(normA);\n  const tokensB = tokenize(normB);\n\n  const jaccardScore = jaccardSimilarity(tokensA, tokensB);\n\n  // Calculate line count similarity\n  const linesA = countLines(codeA);\n  const linesB = countLines(codeB);\n  const lineSimilarity = lineCountSimilarity(linesA, linesB);\n\n  // Weighted combination: 80% Jaccard, 20% line similarity\n  const similarity = jaccardScore * 0.8 + lineSimilarity * 0.2;\n\n  return Math.round(similarity * 100) / 100;\n}\n\n/**\n * Calculate Jaccard similarity between two sets\n *\n * Jaccard index = |A  B| / |A  B|\n *\n * @param setA - First set\n * @param setB - Second set\n * @returns Jaccard similarity (0.0 - 1.0)\n */\nexport function jaccardSimilarity(setA: Set<string>, setB: Set<string>): number {\n  if (setA.size === 0 && setB.size === 0) {\n    return 1.0; // Both empty = identical\n  }\n\n  if (setA.size === 0 || setB.size === 0) {\n    return 0.0; // One empty, one not = no similarity\n  }\n\n  // Calculate intersection\n  const intersection = new Set<string>();\n  for (const item of setA) {\n    if (setB.has(item)) {\n      intersection.add(item);\n    }\n  }\n\n  // Calculate union\n  const union = new Set<string>([...setA, ...setB]);\n\n  return intersection.size / union.size;\n}\n\n/**\n * Calculate similarity based on line counts\n *\n * Uses the formula: 1 - |diff| / max(a, b)\n *\n * @param linesA - Line count of first code\n * @param linesB - Line count of second code\n * @returns Line similarity (0.0 - 1.0)\n */\nexport function lineCountSimilarity(linesA: number, linesB: number): number {\n  if (linesA === 0 && linesB === 0) {\n    return 1.0;\n  }\n\n  const maxLines = Math.max(linesA, linesB);\n  const diff = Math.abs(linesA - linesB);\n\n  return 1 - diff / maxLines;\n}\n\n/**\n * Check if two code strings are near-duplicates\n *\n * Uses the configured similarity threshold (default 0.8)\n *\n * @param codeA - First code string\n * @param codeB - Second code string\n * @param threshold - Similarity threshold (default 0.8)\n * @returns true if similarity >= threshold\n */\nexport function isNearDuplicate(\n  codeA: string,\n  codeB: string,\n  threshold: number = 0.8\n): boolean {\n  return calculateSimilarity(codeA, codeB) >= threshold;\n}\n\n/**\n * Find all near-duplicates of a pattern in a collection\n *\n * @param pattern - The pattern to find duplicates of\n * @param candidates - Array of candidate code strings\n * @param threshold - Similarity threshold (default 0.8)\n * @returns Array of indices of near-duplicate candidates\n */\nexport function findNearDuplicates(\n  pattern: string,\n  candidates: string[],\n  threshold: number = 0.8\n): number[] {\n  const duplicates: number[] = [];\n\n  for (let i = 0; i < candidates.length; i++) {\n    const candidate = candidates[i];\n    if (candidate !== undefined && isNearDuplicate(pattern, candidate, threshold)) {\n      duplicates.push(i);\n    }\n  }\n\n  return duplicates;\n}\n\n/**\n * Result of a pattern similarity search\n */\nexport interface SimilarPatternResult {\n  /** The matched pattern */\n  pattern: string;\n  /** Similarity score (0.0 - 1.0) */\n  similarity: number;\n  /** Index in the original patterns array */\n  index: number;\n}\n\n/**\n * Find similar patterns in a collection with similarity scores\n *\n * Returns all patterns that meet the threshold, sorted by similarity (highest first).\n *\n * @param target - The target code to find similar patterns for\n * @param patterns - Array of patterns to search\n * @param threshold - Minimum similarity threshold (default 0.8)\n * @returns Array of similar patterns with scores, sorted by similarity descending\n *\n * @example\n * ```typescript\n * const results = findSimilarPatterns(\n *   `await page.click('.submit')`,\n *   [`await page.click('.button')`, `await page.goto('/home')`],\n *   0.7\n * );\n * // Returns: [{ pattern: \"await page.click('.button')\", similarity: 0.95, index: 0 }]\n * ```\n */\nexport function findSimilarPatterns(\n  target: string,\n  patterns: string[],\n  threshold: number = 0.8\n): SimilarPatternResult[] {\n  const results: SimilarPatternResult[] = [];\n\n  for (let i = 0; i < patterns.length; i++) {\n    const pattern = patterns[i];\n    if (pattern !== undefined) {\n      const similarity = calculateSimilarity(target, pattern);\n      if (similarity >= threshold) {\n        results.push({ pattern, similarity, index: i });\n      }\n    }\n  }\n\n  // Sort by similarity descending\n  results.sort((a, b) => b.similarity - a.similarity);\n\n  return results;\n}\n","/**\n * Category Inference for LLKB\n *\n * Infers the category of code patterns based on keywords and patterns.\n *\n * @module llkb/inference\n */\n\nimport type { LLKBCategory, ComponentCategory } from './types.js';\n\n/**\n * Keyword patterns for each category\n */\nconst CATEGORY_PATTERNS: Record<ComponentCategory, string[]> = {\n  navigation: [\n    'goto',\n    'navigate',\n    'route',\n    'url',\n    'path',\n    'sidebar',\n    'menu',\n    'breadcrumb',\n    'nav',\n    'link',\n    'href',\n    'router',\n  ],\n  auth: [\n    'login',\n    'logout',\n    'auth',\n    'password',\n    'credential',\n    'session',\n    'token',\n    'user',\n    'signin',\n    'signout',\n    'authenticate',\n    'authorization',\n  ],\n  assertion: [\n    'expect',\n    'assert',\n    'verify',\n    'should',\n    'tobevisible',\n    'tohavetext',\n    'tobehidden',\n    'tocontain',\n    'tohaveattribute',\n    'tobeenabled',\n    'tobedisabled',\n    'tohavevalue',\n  ],\n  data: [\n    'api',\n    'fetch',\n    'response',\n    'request',\n    'json',\n    'payload',\n    'data',\n    'post',\n    'get',\n    'put',\n    'delete',\n    'endpoint',\n    'graphql',\n    'rest',\n  ],\n  selector: [\n    'locator',\n    'getby',\n    'selector',\n    'testid',\n    'data-testid',\n    'queryselector',\n    'findby',\n    'getbyrole',\n    'getbylabel',\n    'getbytext',\n    'getbyplaceholder',\n  ],\n  timing: [\n    'wait',\n    'timeout',\n    'delay',\n    'sleep',\n    'settimeout',\n    'poll',\n    'retry',\n    'interval',\n    'waitfor',\n    'waituntil',\n  ],\n  'ui-interaction': [\n    'click',\n    'fill',\n    'type',\n    'select',\n    'check',\n    'uncheck',\n    'upload',\n    'drag',\n    'drop',\n    'hover',\n    'focus',\n    'blur',\n    'press',\n    'scroll',\n    'dblclick',\n  ],\n};\n\n/**\n * Priority order for category matching\n * Higher priority categories are checked first\n */\nconst CATEGORY_PRIORITY: ComponentCategory[] = [\n  'auth', // Auth patterns are distinctive\n  'navigation', // Navigation patterns are common\n  'assertion', // Assertions are easy to identify\n  'data', // Data/API patterns\n  'timing', // Wait patterns\n  'selector', // Selector patterns\n  'ui-interaction', // Default fallback for UI ops\n];\n\n/**\n * Infer the category of a code pattern\n *\n * Analyzes the code for keywords associated with each category\n * and returns the best matching category.\n *\n * @param code - The code to analyze\n * @returns The inferred category\n *\n * @example\n * ```typescript\n * inferCategory(`await page.goto('/login')`); // 'navigation'\n * inferCategory(`expect(toast).toBeVisible()`); // 'assertion'\n * inferCategory(`await page.click('#submit')`); // 'ui-interaction'\n * ```\n */\nexport function inferCategory(code: string): ComponentCategory {\n  const codeLower = code.toLowerCase();\n\n  // Check each category in priority order\n  for (const category of CATEGORY_PRIORITY) {\n    const patterns = CATEGORY_PATTERNS[category];\n\n    if (patterns !== undefined) {\n      for (const pattern of patterns) {\n        if (codeLower.includes(pattern)) {\n          return category;\n        }\n      }\n    }\n  }\n\n  // Default to ui-interaction for unclassified patterns\n  return 'ui-interaction';\n}\n\n/**\n * Infer category with confidence score\n *\n * Returns both the category and a confidence score based on\n * how many matching keywords were found.\n *\n * @param code - The code to analyze\n * @returns Object with category and confidence\n *\n * @example\n * ```typescript\n * inferCategoryWithConfidence(`await page.goto('/login'); await expect(page).toHaveURL('/login');`);\n * // { category: 'navigation', confidence: 0.8, matchCount: 2 }\n * ```\n */\nexport function inferCategoryWithConfidence(code: string): {\n  category: ComponentCategory;\n  confidence: number;\n  matchCount: number;\n} {\n  const codeLower = code.toLowerCase();\n  const categoryMatches: Map<ComponentCategory, number> = new Map();\n\n  // Count matches for each category\n  for (const [category, patterns] of Object.entries(CATEGORY_PATTERNS)) {\n    let matchCount = 0;\n    for (const pattern of patterns) {\n      if (codeLower.includes(pattern)) {\n        matchCount++;\n      }\n    }\n    if (matchCount > 0) {\n      categoryMatches.set(category as ComponentCategory, matchCount);\n    }\n  }\n\n  // Find the category with most matches\n  let bestCategory: ComponentCategory = 'ui-interaction';\n  let maxMatches = 0;\n\n  for (const [category, count] of categoryMatches) {\n    if (count > maxMatches) {\n      maxMatches = count;\n      bestCategory = category;\n    }\n  }\n\n  // Calculate confidence based on match density\n  // More matches = higher confidence, capped at 1.0\n  const totalPatterns = CATEGORY_PATTERNS[bestCategory]?.length ?? 1;\n  const confidence = Math.min(maxMatches / Math.min(totalPatterns, 5), 1.0);\n\n  return {\n    category: bestCategory,\n    confidence: Math.round(confidence * 100) / 100,\n    matchCount: maxMatches,\n  };\n}\n\n/**\n * Check if a category is valid for components\n *\n * 'quirk' is a lesson-only category and cannot be used for components.\n *\n * @param category - The category to check\n * @returns true if valid for components\n */\nexport function isComponentCategory(category: LLKBCategory): category is ComponentCategory {\n  return category !== 'quirk';\n}\n\n/**\n * Get all valid categories\n *\n * @returns Array of all valid category names\n */\nexport function getAllCategories(): LLKBCategory[] {\n  return [\n    'selector',\n    'timing',\n    'quirk',\n    'auth',\n    'data',\n    'assertion',\n    'navigation',\n    'ui-interaction',\n  ];\n}\n\n/**\n * Get all valid component categories\n *\n * @returns Array of valid component category names\n */\nexport function getComponentCategories(): ComponentCategory[] {\n  return [\n    'selector',\n    'timing',\n    'auth',\n    'data',\n    'assertion',\n    'navigation',\n    'ui-interaction',\n  ];\n}\n","/**\n * Confidence Calculation for LLKB Lessons\n *\n * Provides functions to calculate and track lesson confidence scores.\n *\n * @module llkb/confidence\n */\n\nimport type { Lesson, ConfidenceHistoryEntry } from './types.js';\n\n/**\n * Maximum entries to keep in confidence history\n * Prevents unbounded growth while preserving useful trend data\n */\nexport const MAX_CONFIDENCE_HISTORY_ENTRIES = 100;\n\n/**\n * Number of days to retain in confidence history\n */\nexport const CONFIDENCE_HISTORY_RETENTION_DAYS = 90;\n\n/**\n * Calculate the confidence score for a lesson\n *\n * The confidence formula combines:\n * - Base score from occurrence count (more uses = higher confidence)\n * - Recency factor (recent success = higher confidence)\n * - Success factor (higher success rate = higher confidence)\n * - Validation boost (human-reviewed lessons get a boost)\n *\n * @param lesson - The lesson to calculate confidence for\n * @returns Confidence score between 0.0 and 1.0\n *\n * @example\n * ```typescript\n * const confidence = calculateConfidence(lesson);\n * if (confidence >= 0.7) {\n *   // Auto-apply this lesson\n * }\n * ```\n */\nexport function calculateConfidence(lesson: Lesson): number {\n  const metrics = lesson.metrics;\n\n  // STEP 1: Calculate base score (occurrence-based)\n  // More occurrences = higher base confidence\n  // Caps at 1.0 after 10 occurrences\n  const occurrences = metrics.occurrences;\n  const baseScore = Math.min(occurrences / 10.0, 1.0);\n\n  // STEP 2: Calculate recency factor (time decay)\n  // Lessons not used recently lose confidence\n  // Decays by 30% over 90 days, floors at 0.7\n  let recencyFactor: number;\n\n  if (metrics.lastSuccess) {\n    const daysSinceLastSuccess = daysBetween(new Date(), new Date(metrics.lastSuccess));\n    recencyFactor = Math.max(1.0 - (daysSinceLastSuccess / 90.0) * 0.3, 0.7);\n  } else {\n    // Never succeeded yet - use creation date\n    const daysSinceCreation = daysBetween(new Date(), new Date(metrics.firstSeen));\n    recencyFactor = Math.max(1.0 - (daysSinceCreation / 30.0) * 0.5, 0.5);\n  }\n\n  // STEP 3: Calculate success factor (effectiveness)\n  // Square root dampens the impact of low success rates\n  // e.g., 0.64 success rate  0.8 factor\n  const successRate = metrics.successRate;\n  const successFactor = Math.sqrt(successRate);\n\n  // STEP 4: Apply validation boost (human review)\n  // Human-reviewed lessons get 20% confidence boost\n  const validationBoost = lesson.validation.humanReviewed ? 1.2 : 1.0;\n\n  // STEP 5: Calculate final confidence\n  const rawConfidence = baseScore * recencyFactor * successFactor * validationBoost;\n\n  // Clamp to valid range [0.0, 1.0]\n  const confidence = Math.min(Math.max(rawConfidence, 0.0), 1.0);\n\n  return Math.round(confidence * 100) / 100;\n}\n\n/**\n * Detect if a lesson has declining confidence\n *\n * Compares current confidence to the 30-day rolling average.\n * A decline of 20% or more triggers this detection.\n *\n * @param lesson - The lesson to check\n * @returns true if confidence is declining significantly\n *\n * @example\n * ```typescript\n * if (detectDecliningConfidence(lesson)) {\n *   // Flag for review\n *   analytics.needsReview.decliningSuccessRate.push(lesson.id);\n * }\n * ```\n */\nexport function detectDecliningConfidence(lesson: Lesson): boolean {\n  const history = lesson.metrics.confidenceHistory;\n\n  if (!history || history.length < 2) {\n    return false; // Not enough data to detect trend\n  }\n\n  const currentConfidence = lesson.metrics.confidence;\n\n  // Get last 30 entries (or all if fewer)\n  const recentHistory = history.slice(-30);\n\n  // Calculate historical average\n  const sum = recentHistory.reduce((acc, entry) => acc + entry.value, 0);\n  const historicalAverage = sum / recentHistory.length;\n\n  // Check for 20% decline\n  return currentConfidence < historicalAverage * 0.8;\n}\n\n/**\n * Update the confidence history for a lesson\n *\n * Adds the current confidence to the history and prunes old entries.\n *\n * @param lesson - The lesson to update\n * @returns Updated confidence history array\n */\nexport function updateConfidenceHistory(lesson: Lesson): ConfidenceHistoryEntry[] {\n  const history = lesson.metrics.confidenceHistory ?? [];\n  const now = new Date();\n\n  // Add current confidence to history\n  const newEntry: ConfidenceHistoryEntry = {\n    date: now.toISOString(),\n    value: lesson.metrics.confidence,\n  };\n\n  history.push(newEntry);\n\n  // Keep only entries within retention period\n  const cutoffDate = new Date();\n  cutoffDate.setDate(cutoffDate.getDate() - CONFIDENCE_HISTORY_RETENTION_DAYS);\n\n  const filtered = history.filter((entry) => new Date(entry.date) >= cutoffDate);\n\n  // Cap at MAX_CONFIDENCE_HISTORY_ENTRIES\n  return filtered.slice(-MAX_CONFIDENCE_HISTORY_ENTRIES);\n}\n\n/**\n * Get the confidence trend direction\n *\n * @param history - Confidence history entries\n * @returns 'increasing', 'decreasing', 'stable', or 'unknown'\n */\nexport function getConfidenceTrend(\n  history: ConfidenceHistoryEntry[]\n): 'increasing' | 'decreasing' | 'stable' | 'unknown' {\n  if (!history || history.length < 3) {\n    return 'unknown';\n  }\n\n  // Compare first third average to last third average\n  const third = Math.floor(history.length / 3);\n  const firstThird = history.slice(0, third);\n  const lastThird = history.slice(-third);\n\n  const firstAvg = firstThird.reduce((acc, e) => acc + e.value, 0) / firstThird.length;\n  const lastAvg = lastThird.reduce((acc, e) => acc + e.value, 0) / lastThird.length;\n\n  const change = (lastAvg - firstAvg) / firstAvg;\n\n  if (change > 0.1) {\n    return 'increasing';\n  } else if (change < -0.1) {\n    return 'decreasing';\n  } else {\n    return 'stable';\n  }\n}\n\n/**\n * Calculate the number of days between two dates\n *\n * @param date1 - First date\n * @param date2 - Second date\n * @returns Number of days (can be fractional)\n */\nexport function daysBetween(date1: Date, date2: Date): number {\n  const msPerDay = 24 * 60 * 60 * 1000;\n  return Math.abs(date1.getTime() - date2.getTime()) / msPerDay;\n}\n\n/**\n * Check if a lesson should be flagged for review based on confidence\n *\n * @param lesson - The lesson to check\n * @param threshold - Low confidence threshold (default 0.4)\n * @returns true if lesson needs review\n */\nexport function needsConfidenceReview(lesson: Lesson, threshold: number = 0.4): boolean {\n  return lesson.metrics.confidence < threshold;\n}\n","/**\n * File Utilities for LLKB\n *\n * Provides safe file operations including atomic writes and file locking\n * to prevent data corruption from concurrent access.\n *\n * @module llkb/file-utils\n */\n\nimport * as fs from 'fs';\nimport * as path from 'path';\nimport type { SaveResult, UpdateResult } from './types.js';\n\n/**\n * Maximum wait time for acquiring a lock (in milliseconds)\n */\nexport const LOCK_MAX_WAIT_MS = 5000;\n\n/**\n * Stale lock threshold (in milliseconds)\n * Locks older than this are considered abandoned\n */\nexport const STALE_LOCK_THRESHOLD_MS = 30000;\n\n/**\n * Retry interval when waiting for a lock (in milliseconds)\n */\nexport const LOCK_RETRY_INTERVAL_MS = 50;\n\n/**\n * Generate a random ID for temporary files\n */\nfunction generateRandomId(): string {\n  return Math.random().toString(36).substring(2, 15);\n}\n\n/**\n * Save JSON data atomically\n *\n * Writes to a temporary file first, then renames to the target path.\n * This ensures the file is either fully written or not written at all.\n *\n * @param filePath - Target file path\n * @param data - Data to write\n * @returns SaveResult indicating success or failure\n *\n * @example\n * ```typescript\n * const result = await saveJSONAtomic('.artk/llkb/lessons.json', lessons);\n * if (!result.success) {\n *   console.error('Failed to save:', result.error);\n * }\n * ```\n */\nexport async function saveJSONAtomic(filePath: string, data: unknown): Promise<SaveResult> {\n  const tempPath = `${filePath}.tmp.${generateRandomId()}`;\n\n  try {\n    // Ensure directory exists\n    const dir = path.dirname(filePath);\n    if (!fs.existsSync(dir)) {\n      fs.mkdirSync(dir, { recursive: true });\n    }\n\n    // Write to temp file\n    const content = JSON.stringify(data, null, 2);\n    fs.writeFileSync(tempPath, content, 'utf-8');\n\n    // Atomic rename\n    fs.renameSync(tempPath, filePath);\n\n    return { success: true };\n  } catch (error) {\n    // Clean up temp file if it exists\n    try {\n      if (fs.existsSync(tempPath)) {\n        fs.unlinkSync(tempPath);\n      }\n    } catch {\n      // Ignore cleanup errors\n    }\n\n    return {\n      success: false,\n      error: error instanceof Error ? error.message : String(error),\n    };\n  }\n}\n\n/**\n * Synchronous version of saveJSONAtomic\n *\n * @param filePath - Target file path\n * @param data - Data to write\n * @returns SaveResult indicating success or failure\n */\nexport function saveJSONAtomicSync(filePath: string, data: unknown): SaveResult {\n  const tempPath = `${filePath}.tmp.${generateRandomId()}`;\n\n  try {\n    // Ensure directory exists\n    const dir = path.dirname(filePath);\n    if (!fs.existsSync(dir)) {\n      fs.mkdirSync(dir, { recursive: true });\n    }\n\n    // Write to temp file\n    const content = JSON.stringify(data, null, 2);\n    fs.writeFileSync(tempPath, content, 'utf-8');\n\n    // Atomic rename\n    fs.renameSync(tempPath, filePath);\n\n    return { success: true };\n  } catch (error) {\n    // Clean up temp file if it exists\n    try {\n      if (fs.existsSync(tempPath)) {\n        fs.unlinkSync(tempPath);\n      }\n    } catch {\n      // Ignore cleanup errors\n    }\n\n    return {\n      success: false,\n      error: error instanceof Error ? error.message : String(error),\n    };\n  }\n}\n\n/**\n * Acquire a file lock\n *\n * Creates a .lock file to prevent concurrent access.\n * Handles stale locks from crashed processes.\n *\n * @param filePath - Path of the file to lock\n * @returns true if lock was acquired, false otherwise\n */\nfunction acquireLock(filePath: string): boolean {\n  const lockPath = `${filePath}.lock`;\n  const now = Date.now();\n\n  try {\n    // Check if lock exists\n    if (fs.existsSync(lockPath)) {\n      const lockStat = fs.statSync(lockPath);\n      const lockAge = now - lockStat.mtimeMs;\n\n      // Check if lock is stale\n      if (lockAge > STALE_LOCK_THRESHOLD_MS) {\n        // Remove stale lock\n        fs.unlinkSync(lockPath);\n      } else {\n        // Lock is active\n        return false;\n      }\n    }\n\n    // Create lock file with exclusive flag\n    fs.writeFileSync(lockPath, String(now), { flag: 'wx' });\n    return true;\n  } catch (error) {\n    // EEXIST means another process created the lock\n    if ((error as NodeJS.ErrnoException).code === 'EEXIST') {\n      return false;\n    }\n    throw error;\n  }\n}\n\n/**\n * Release a file lock\n *\n * @param filePath - Path of the file to unlock\n */\nfunction releaseLock(filePath: string): void {\n  const lockPath = `${filePath}.lock`;\n  try {\n    if (fs.existsSync(lockPath)) {\n      fs.unlinkSync(lockPath);\n    }\n  } catch {\n    // Ignore errors - lock may have been removed by another process\n  }\n}\n\n/**\n * Update a JSON file with locking\n *\n * Reads the file, applies an update function, and saves atomically.\n * Uses file locking to prevent concurrent modifications.\n *\n * @param filePath - Path to the JSON file\n * @param updateFn - Function that receives current data and returns updated data\n * @returns UpdateResult indicating success or failure\n *\n * @example\n * ```typescript\n * const result = await updateJSONWithLock(\n *   '.artk/llkb/lessons.json',\n *   (lessons) => {\n *     lessons.lessons.push(newLesson);\n *     return lessons;\n *   }\n * );\n * ```\n */\nexport async function updateJSONWithLock<T>(\n  filePath: string,\n  updateFn: (data: T) => T\n): Promise<UpdateResult> {\n  const startTime = Date.now();\n  let retriesNeeded = 0;\n\n  // Try to acquire lock with timeout\n  while (Date.now() - startTime < LOCK_MAX_WAIT_MS) {\n    if (acquireLock(filePath)) {\n      try {\n        // Read current data\n        let data: T;\n        if (fs.existsSync(filePath)) {\n          const content = fs.readFileSync(filePath, 'utf-8');\n          data = JSON.parse(content) as T;\n        } else {\n          // File doesn't exist - updateFn must handle this\n          data = {} as T;\n        }\n\n        // Apply update\n        const updated = updateFn(data);\n\n        // Save atomically\n        const saveResult = await saveJSONAtomic(filePath, updated);\n\n        if (!saveResult.success) {\n          return {\n            success: false,\n            error: saveResult.error,\n            retriesNeeded,\n          };\n        }\n\n        return { success: true, retriesNeeded };\n      } finally {\n        releaseLock(filePath);\n      }\n    }\n\n    // Wait before retry\n    retriesNeeded++;\n    await sleep(LOCK_RETRY_INTERVAL_MS);\n  }\n\n  return {\n    success: false,\n    error: `Could not acquire lock within ${LOCK_MAX_WAIT_MS}ms`,\n    retriesNeeded,\n  };\n}\n\n/**\n * Synchronous version of updateJSONWithLock\n *\n * @param filePath - Path to the JSON file\n * @param updateFn - Function that receives current data and returns updated data\n * @returns UpdateResult indicating success or failure\n */\nexport function updateJSONWithLockSync<T>(\n  filePath: string,\n  updateFn: (data: T) => T\n): UpdateResult {\n  const startTime = Date.now();\n  let retriesNeeded = 0;\n\n  // Try to acquire lock with timeout\n  while (Date.now() - startTime < LOCK_MAX_WAIT_MS) {\n    if (acquireLock(filePath)) {\n      try {\n        // Read current data\n        let data: T;\n        if (fs.existsSync(filePath)) {\n          const content = fs.readFileSync(filePath, 'utf-8');\n          data = JSON.parse(content) as T;\n        } else {\n          data = {} as T;\n        }\n\n        // Apply update\n        const updated = updateFn(data);\n\n        // Save atomically\n        const saveResult = saveJSONAtomicSync(filePath, updated);\n\n        if (!saveResult.success) {\n          return {\n            success: false,\n            error: saveResult.error,\n            retriesNeeded,\n          };\n        }\n\n        return { success: true, retriesNeeded };\n      } finally {\n        releaseLock(filePath);\n      }\n    }\n\n    // Wait before retry (synchronous)\n    retriesNeeded++;\n    sleepSync(LOCK_RETRY_INTERVAL_MS);\n  }\n\n  return {\n    success: false,\n    error: `Could not acquire lock within ${LOCK_MAX_WAIT_MS}ms`,\n    retriesNeeded,\n  };\n}\n\n/**\n * Load JSON file with error handling\n *\n * @param filePath - Path to the JSON file\n * @returns Parsed JSON data or null if file doesn't exist\n * @throws Error if file exists but is invalid JSON\n */\nexport function loadJSON<T>(filePath: string): T | null {\n  try {\n    if (!fs.existsSync(filePath)) {\n      return null;\n    }\n    const content = fs.readFileSync(filePath, 'utf-8');\n    return JSON.parse(content) as T;\n  } catch (error) {\n    throw new Error(\n      `Failed to load JSON from ${filePath}: ${error instanceof Error ? error.message : String(error)}`\n    );\n  }\n}\n\n/**\n * Ensure a directory exists\n *\n * @param dirPath - Directory path to ensure\n */\nexport function ensureDir(dirPath: string): void {\n  if (!fs.existsSync(dirPath)) {\n    fs.mkdirSync(dirPath, { recursive: true });\n  }\n}\n\n/**\n * Sleep for a given number of milliseconds (async)\n *\n * @param ms - Milliseconds to sleep\n */\nfunction sleep(ms: number): Promise<void> {\n  return new Promise((resolve) => setTimeout(resolve, ms));\n}\n\n/**\n * Sleep synchronously\n *\n * Note: This blocks the event loop. Use sparingly.\n *\n * @param ms - Milliseconds to sleep\n */\nfunction sleepSync(ms: number): void {\n  const end = Date.now() + ms;\n  while (Date.now() < end) {\n    // Busy wait\n  }\n}\n","/**\n * History Logging for LLKB\n *\n * Provides functions for logging LLKB events to history files.\n * History files are append-only JSONL (JSON Lines) format.\n *\n * @module llkb/history\n */\n\nimport * as fs from 'fs';\nimport * as path from 'path';\nimport type { HistoryEvent, LLKBConfig } from './types.js';\nimport { ensureDir } from './file-utils.js';\n\n/**\n * Default LLKB root directory\n */\nexport const DEFAULT_LLKB_ROOT = '.artk/llkb';\n\n/**\n * Get the history directory path\n *\n * @param llkbRoot - Root LLKB directory (default: .artk/llkb)\n * @returns Path to the history directory\n */\nexport function getHistoryDir(llkbRoot: string = DEFAULT_LLKB_ROOT): string {\n  return path.join(llkbRoot, 'history');\n}\n\n/**\n * Get the history file path for a specific date\n *\n * @param date - The date for the history file\n * @param llkbRoot - Root LLKB directory\n * @returns Path to the history file (YYYY-MM-DD.jsonl)\n */\nexport function getHistoryFilePath(\n  date: Date = new Date(),\n  llkbRoot: string = DEFAULT_LLKB_ROOT\n): string {\n  const dateStr = formatDate(date);\n  return path.join(getHistoryDir(llkbRoot), `${dateStr}.jsonl`);\n}\n\n/**\n * Format a date as YYYY-MM-DD\n *\n * @param date - The date to format\n * @returns Formatted date string\n */\nexport function formatDate(date: Date): string {\n  const year = date.getFullYear();\n  const month = String(date.getMonth() + 1).padStart(2, '0');\n  const day = String(date.getDate()).padStart(2, '0');\n  return `${year}-${month}-${day}`;\n}\n\n/**\n * Append an event to the history file\n *\n * Creates the history directory and file if they don't exist.\n * Uses graceful degradation - logs warning but doesn't throw on failure.\n *\n * @param event - The event to log\n * @param llkbRoot - Root LLKB directory\n * @returns true if successful, false otherwise\n *\n * @example\n * ```typescript\n * appendToHistory({\n *   event: 'lesson_applied',\n *   timestamp: new Date().toISOString(),\n *   lessonId: 'L001',\n *   success: true,\n *   prompt: 'journey-implement'\n * });\n * ```\n */\nexport function appendToHistory(\n  event: HistoryEvent,\n  llkbRoot: string = DEFAULT_LLKB_ROOT\n): boolean {\n  try {\n    const historyDir = getHistoryDir(llkbRoot);\n    ensureDir(historyDir);\n\n    const filePath = getHistoryFilePath(new Date(), llkbRoot);\n    const line = JSON.stringify(event) + '\\n';\n\n    fs.appendFileSync(filePath, line, 'utf-8');\n    return true;\n  } catch (error) {\n    // Graceful degradation - log warning but don't crash\n    console.warn(\n      `[LLKB] Failed to append to history: ${error instanceof Error ? error.message : String(error)}`\n    );\n    return false;\n  }\n}\n\n/**\n * Read events from a history file\n *\n * @param filePath - Path to the history file\n * @returns Array of events, or empty array if file doesn't exist\n */\nexport function readHistoryFile(filePath: string): HistoryEvent[] {\n  if (!fs.existsSync(filePath)) {\n    return [];\n  }\n\n  const content = fs.readFileSync(filePath, 'utf-8');\n  const lines = content.split('\\n').filter((line) => line.trim().length > 0);\n\n  return lines.map((line) => JSON.parse(line) as HistoryEvent);\n}\n\n/**\n * Read today's history events\n *\n * @param llkbRoot - Root LLKB directory\n * @returns Array of today's events\n */\nexport function readTodayHistory(llkbRoot: string = DEFAULT_LLKB_ROOT): HistoryEvent[] {\n  const filePath = getHistoryFilePath(new Date(), llkbRoot);\n  return readHistoryFile(filePath);\n}\n\n/**\n * Count events of a specific type from today's history\n *\n * @param eventType - The event type to count\n * @param filter - Optional additional filter function\n * @param llkbRoot - Root LLKB directory\n * @returns Count of matching events\n */\nexport function countTodayEvents(\n  eventType: HistoryEvent['event'],\n  filter?: (event: HistoryEvent) => boolean,\n  llkbRoot: string = DEFAULT_LLKB_ROOT\n): number {\n  const events = readTodayHistory(llkbRoot);\n\n  return events.filter((e) => {\n    if (e.event !== eventType) {\n      return false;\n    }\n    return filter ? filter(e) : true;\n  }).length;\n}\n\n/**\n * Count predictive extractions for today\n *\n * Used for rate limiting in journey-implement.\n *\n * @param llkbRoot - Root LLKB directory\n * @returns Number of predictive extractions today\n *\n * @example\n * ```typescript\n * const count = countPredictiveExtractionsToday();\n * if (count >= config.extraction.maxPredictivePerDay) {\n *   // Rate limit reached\n * }\n * ```\n */\nexport function countPredictiveExtractionsToday(\n  llkbRoot: string = DEFAULT_LLKB_ROOT\n): number {\n  return countTodayEvents(\n    'component_extracted',\n    (e) => e.event === 'component_extracted' && e.prompt === 'journey-implement',\n    llkbRoot\n  );\n}\n\n/**\n * Count predictive extractions for a specific journey today\n *\n * @param journeyId - The journey ID to check\n * @param llkbRoot - Root LLKB directory\n * @returns Number of extractions for this journey today\n */\nexport function countJourneyExtractionsToday(\n  journeyId: string,\n  llkbRoot: string = DEFAULT_LLKB_ROOT\n): number {\n  return countTodayEvents(\n    'component_extracted',\n    (e) =>\n      e.event === 'component_extracted' &&\n      e.prompt === 'journey-implement' &&\n      e.journeyId === journeyId,\n    llkbRoot\n  );\n}\n\n/**\n * Check if daily extraction rate limit is reached\n *\n * @param config - LLKB configuration\n * @param llkbRoot - Root LLKB directory\n * @returns true if rate limit is reached\n */\nexport function isDailyRateLimitReached(\n  config: LLKBConfig,\n  llkbRoot: string = DEFAULT_LLKB_ROOT\n): boolean {\n  const count = countPredictiveExtractionsToday(llkbRoot);\n  return count >= config.extraction.maxPredictivePerDay;\n}\n\n/**\n * Check if journey extraction rate limit is reached\n *\n * @param journeyId - The journey ID to check\n * @param config - LLKB configuration\n * @param llkbRoot - Root LLKB directory\n * @returns true if rate limit is reached\n */\nexport function isJourneyRateLimitReached(\n  journeyId: string,\n  config: LLKBConfig,\n  llkbRoot: string = DEFAULT_LLKB_ROOT\n): boolean {\n  const count = countJourneyExtractionsToday(journeyId, llkbRoot);\n  return count >= config.extraction.maxPredictivePerJourney;\n}\n\n/**\n * Get all history files in date range\n *\n * @param startDate - Start date (inclusive)\n * @param endDate - End date (inclusive)\n * @param llkbRoot - Root LLKB directory\n * @returns Array of history file paths\n */\nexport function getHistoryFilesInRange(\n  startDate: Date,\n  endDate: Date,\n  llkbRoot: string = DEFAULT_LLKB_ROOT\n): string[] {\n  const historyDir = getHistoryDir(llkbRoot);\n\n  if (!fs.existsSync(historyDir)) {\n    return [];\n  }\n\n  const files = fs.readdirSync(historyDir).filter((f) => f.endsWith('.jsonl'));\n  const results: string[] = [];\n\n  for (const file of files) {\n    const match = file.match(/^(\\d{4}-\\d{2}-\\d{2})\\.jsonl$/);\n    if (match?.[1]) {\n      const fileDate = new Date(match[1]);\n      if (fileDate >= startDate && fileDate <= endDate) {\n        results.push(path.join(historyDir, file));\n      }\n    }\n  }\n\n  return results.sort();\n}\n\n/**\n * Clean up old history files\n *\n * Deletes history files older than the retention period.\n *\n * @param retentionDays - Number of days to retain (default: 365)\n * @param llkbRoot - Root LLKB directory\n * @returns Array of deleted file paths\n */\nexport function cleanupOldHistoryFiles(\n  retentionDays: number = 365,\n  llkbRoot: string = DEFAULT_LLKB_ROOT\n): string[] {\n  const historyDir = getHistoryDir(llkbRoot);\n\n  if (!fs.existsSync(historyDir)) {\n    return [];\n  }\n\n  const files = fs.readdirSync(historyDir).filter((f) => f.endsWith('.jsonl'));\n  const now = new Date();\n  const cutoffDate = new Date();\n  cutoffDate.setDate(now.getDate() - retentionDays);\n\n  const deleted: string[] = [];\n\n  for (const file of files) {\n    const match = file.match(/^(\\d{4}-\\d{2}-\\d{2})\\.jsonl$/);\n    if (match?.[1]) {\n      const fileDate = new Date(match[1]);\n      if (fileDate < cutoffDate) {\n        const filePath = path.join(historyDir, file);\n        fs.unlinkSync(filePath);\n        deleted.push(filePath);\n      }\n    }\n  }\n\n  return deleted;\n}\n","/**\n * Analytics Update for LLKB\n *\n * Provides functions to calculate and update LLKB analytics.\n *\n * @module llkb/analytics\n */\n\nimport * as path from 'path';\nimport type {\n  LessonsFile,\n  ComponentsFile,\n  AnalyticsFile,\n  AnalyticsOverview,\n  LessonStats,\n  ComponentStats,\n  TopPerformerLesson,\n  TopPerformerComponent,\n  LLKBCategory,\n  ComponentCategory,\n  LLKBScope,\n} from './types.js';\nimport { loadJSON, saveJSONAtomicSync } from './file-utils.js';\nimport { detectDecliningConfidence, daysBetween } from './confidence.js';\n\n/**\n * Default LLKB root directory\n */\nconst DEFAULT_LLKB_ROOT = '.artk/llkb';\n\n/**\n * All valid lesson categories\n */\nconst ALL_CATEGORIES: LLKBCategory[] = [\n  'selector',\n  'timing',\n  'quirk',\n  'auth',\n  'data',\n  'assertion',\n  'navigation',\n  'ui-interaction',\n];\n\n/**\n * All valid component categories (excludes 'quirk')\n */\nconst COMPONENT_CATEGORIES: ComponentCategory[] = [\n  'selector',\n  'timing',\n  'auth',\n  'data',\n  'assertion',\n  'navigation',\n  'ui-interaction',\n];\n\n/**\n * All valid scopes\n */\nconst ALL_SCOPES: LLKBScope[] = [\n  'universal',\n  'framework:angular',\n  'framework:react',\n  'framework:vue',\n  'framework:ag-grid',\n  'app-specific',\n];\n\n/**\n * Update analytics.json based on current lessons and components\n *\n * This function recalculates all statistics and saves the updated analytics.\n *\n * @param llkbRoot - Root LLKB directory\n * @returns true if successful, false otherwise\n *\n * @example\n * ```typescript\n * // Call after modifying lessons or components\n * updateAnalytics();\n * ```\n */\nexport function updateAnalytics(llkbRoot: string = DEFAULT_LLKB_ROOT): boolean {\n  try {\n    // Load current data\n    const lessonsPath = path.join(llkbRoot, 'lessons.json');\n    const componentsPath = path.join(llkbRoot, 'components.json');\n    const analyticsPath = path.join(llkbRoot, 'analytics.json');\n\n    const lessons = loadJSON<LessonsFile>(lessonsPath);\n    const components = loadJSON<ComponentsFile>(componentsPath);\n    let analytics = loadJSON<AnalyticsFile>(analyticsPath);\n\n    if (!lessons || !components) {\n      console.warn('[LLKB] Cannot update analytics: lessons or components not found');\n      return false;\n    }\n\n    // Initialize analytics if not exists\n    if (!analytics) {\n      analytics = createEmptyAnalytics();\n    }\n\n    // Update all sections\n    analytics.overview = calculateOverview(lessons, components);\n    analytics.lessonStats = calculateLessonStats(lessons);\n    analytics.componentStats = calculateComponentStats(components);\n    analytics.topPerformers = calculateTopPerformers(lessons, components);\n    analytics.needsReview = calculateNeedsReview(lessons, components);\n    analytics.lastUpdated = new Date().toISOString();\n\n    // Save updated analytics\n    const result = saveJSONAtomicSync(analyticsPath, analytics);\n    return result.success;\n  } catch (error) {\n    console.error(\n      `[LLKB] Failed to update analytics: ${error instanceof Error ? error.message : String(error)}`\n    );\n    return false;\n  }\n}\n\n/**\n * Update analytics with provided data (for testing or when data is already loaded)\n *\n * @param lessons - Lessons data\n * @param components - Components data\n * @param analyticsPath - Path to save analytics\n * @returns true if successful\n */\nexport function updateAnalyticsWithData(\n  lessons: LessonsFile,\n  components: ComponentsFile,\n  analyticsPath: string\n): boolean {\n  try {\n    let analytics = loadJSON<AnalyticsFile>(analyticsPath) ?? createEmptyAnalytics();\n\n    analytics.overview = calculateOverview(lessons, components);\n    analytics.lessonStats = calculateLessonStats(lessons);\n    analytics.componentStats = calculateComponentStats(components);\n    analytics.topPerformers = calculateTopPerformers(lessons, components);\n    analytics.needsReview = calculateNeedsReview(lessons, components);\n    analytics.lastUpdated = new Date().toISOString();\n\n    const result = saveJSONAtomicSync(analyticsPath, analytics);\n    return result.success;\n  } catch (error) {\n    console.error(`[LLKB] Failed to update analytics: ${error}`);\n    return false;\n  }\n}\n\n/**\n * Create an empty analytics structure\n */\nexport function createEmptyAnalytics(): AnalyticsFile {\n  return {\n    version: '1.0.0',\n    lastUpdated: new Date().toISOString(),\n    overview: {\n      totalLessons: 0,\n      activeLessons: 0,\n      archivedLessons: 0,\n      totalComponents: 0,\n      activeComponents: 0,\n      archivedComponents: 0,\n    },\n    lessonStats: {\n      byCategory: Object.fromEntries(ALL_CATEGORIES.map((c) => [c, 0])) as Record<\n        LLKBCategory,\n        number\n      >,\n      avgConfidence: 0,\n      avgSuccessRate: 0,\n    },\n    componentStats: {\n      byCategory: Object.fromEntries(COMPONENT_CATEGORIES.map((c) => [c, 0])) as Record<\n        ComponentCategory,\n        number\n      >,\n      byScope: Object.fromEntries(ALL_SCOPES.map((s) => [s, 0])) as Record<LLKBScope, number>,\n      totalReuses: 0,\n      avgReusesPerComponent: 0,\n    },\n    impact: {\n      verifyIterationsSaved: 0,\n      avgIterationsBeforeLLKB: 0,\n      avgIterationsAfterLLKB: 0,\n      codeDeduplicationRate: 0,\n      estimatedHoursSaved: 0,\n    },\n    topPerformers: {\n      lessons: [],\n      components: [],\n    },\n    needsReview: {\n      lowConfidenceLessons: [],\n      lowUsageComponents: [],\n      decliningSuccessRate: [],\n    },\n  };\n}\n\n/**\n * Calculate overview statistics\n */\nfunction calculateOverview(\n  lessons: LessonsFile,\n  components: ComponentsFile\n): AnalyticsOverview {\n  const activeLessons = lessons.lessons.filter((l) => !l.archived);\n  const activeComponents = components.components.filter((c) => !c.archived);\n  const archivedComponents = components.components.filter((c) => c.archived);\n\n  return {\n    totalLessons: lessons.lessons.length,\n    activeLessons: activeLessons.length,\n    archivedLessons: (lessons.archived ?? []).length,\n    totalComponents: components.components.length,\n    activeComponents: activeComponents.length,\n    archivedComponents: archivedComponents.length,\n  };\n}\n\n/**\n * Calculate lesson statistics\n */\nfunction calculateLessonStats(lessons: LessonsFile): LessonStats {\n  const activeLessons = lessons.lessons.filter((l) => !l.archived);\n\n  // Count by category\n  const byCategory = Object.fromEntries(ALL_CATEGORIES.map((c) => [c, 0])) as Record<\n    LLKBCategory,\n    number\n  >;\n\n  for (const lesson of activeLessons) {\n    const category = lesson.category;\n    if (category in byCategory) {\n      byCategory[category]++;\n    }\n  }\n\n  // Calculate averages\n  let avgConfidence = 0;\n  let avgSuccessRate = 0;\n\n  if (activeLessons.length > 0) {\n    const confidenceSum = activeLessons.reduce((acc, l) => acc + l.metrics.confidence, 0);\n    const successRateSum = activeLessons.reduce((acc, l) => acc + l.metrics.successRate, 0);\n\n    avgConfidence = Math.round((confidenceSum / activeLessons.length) * 100) / 100;\n    avgSuccessRate = Math.round((successRateSum / activeLessons.length) * 100) / 100;\n  }\n\n  return {\n    byCategory,\n    avgConfidence,\n    avgSuccessRate,\n  };\n}\n\n/**\n * Calculate component statistics\n */\nfunction calculateComponentStats(components: ComponentsFile): ComponentStats {\n  const activeComponents = components.components.filter((c) => !c.archived);\n\n  // Count by category\n  const byCategory = Object.fromEntries(COMPONENT_CATEGORIES.map((c) => [c, 0])) as Record<\n    ComponentCategory,\n    number\n  >;\n\n  for (const comp of activeComponents) {\n    const category = comp.category;\n    if (category in byCategory) {\n      byCategory[category]++;\n    }\n  }\n\n  // Count by scope\n  const byScope = Object.fromEntries(ALL_SCOPES.map((s) => [s, 0])) as Record<\n    LLKBScope,\n    number\n  >;\n\n  for (const comp of activeComponents) {\n    const scope = comp.scope;\n    if (scope in byScope) {\n      byScope[scope]++;\n    }\n  }\n\n  // Calculate reuse metrics\n  let totalReuses = 0;\n  let avgReusesPerComponent = 0;\n\n  if (activeComponents.length > 0) {\n    totalReuses = activeComponents.reduce((acc, c) => acc + (c.metrics.totalUses ?? 0), 0);\n    avgReusesPerComponent = Math.round((totalReuses / activeComponents.length) * 100) / 100;\n  }\n\n  return {\n    byCategory,\n    byScope,\n    totalReuses,\n    avgReusesPerComponent,\n  };\n}\n\n/**\n * Calculate top performers\n */\nfunction calculateTopPerformers(\n  lessons: LessonsFile,\n  components: ComponentsFile\n): { lessons: TopPerformerLesson[]; components: TopPerformerComponent[] } {\n  const activeLessons = lessons.lessons.filter((l) => !l.archived);\n  const activeComponents = components.components.filter((c) => !c.archived);\n\n  // Top lessons by (successRate * occurrences)\n  const topLessons: TopPerformerLesson[] = activeLessons\n    .map((l) => ({\n      id: l.id,\n      title: l.title,\n      score: Math.round(l.metrics.successRate * l.metrics.occurrences * 100) / 100,\n    }))\n    .sort((a, b) => b.score - a.score)\n    .slice(0, 5);\n\n  // Top components by totalUses\n  const topComponents: TopPerformerComponent[] = activeComponents\n    .map((c) => ({\n      id: c.id,\n      name: c.name,\n      uses: c.metrics.totalUses ?? 0,\n    }))\n    .sort((a, b) => b.uses - a.uses)\n    .slice(0, 5);\n\n  return {\n    lessons: topLessons,\n    components: topComponents,\n  };\n}\n\n/**\n * Calculate items needing review\n */\nfunction calculateNeedsReview(\n  lessons: LessonsFile,\n  components: ComponentsFile\n): {\n  lowConfidenceLessons: string[];\n  lowUsageComponents: string[];\n  decliningSuccessRate: string[];\n} {\n  const activeLessons = lessons.lessons.filter((l) => !l.archived);\n  const activeComponents = components.components.filter((c) => !c.archived);\n  const now = new Date();\n\n  // Low confidence lessons (< 0.4)\n  const lowConfidenceLessons = activeLessons\n    .filter((l) => l.metrics.confidence < 0.4)\n    .map((l) => l.id);\n\n  // Lessons with declining success rate\n  const decliningSuccessRate = activeLessons\n    .filter((l) => detectDecliningConfidence(l))\n    .map((l) => l.id);\n\n  // Low usage components (< 2 uses and age > 30 days)\n  const lowUsageComponents = activeComponents\n    .filter((c) => {\n      const uses = c.metrics.totalUses ?? 0;\n      const extractedAt = new Date(c.source.extractedAt);\n      const age = daysBetween(now, extractedAt);\n      return uses < 2 && age > 30;\n    })\n    .map((c) => c.id);\n\n  return {\n    lowConfidenceLessons,\n    lowUsageComponents,\n    decliningSuccessRate,\n  };\n}\n\n/**\n * Get analytics summary as a formatted string\n *\n * @param llkbRoot - Root LLKB directory\n * @returns Formatted summary string\n */\nexport function getAnalyticsSummary(llkbRoot: string = DEFAULT_LLKB_ROOT): string {\n  const analyticsPath = path.join(llkbRoot, 'analytics.json');\n  const analytics = loadJSON<AnalyticsFile>(analyticsPath);\n\n  if (!analytics) {\n    return 'Analytics not available';\n  }\n\n  const o = analytics.overview;\n  const l = analytics.lessonStats;\n  const c = analytics.componentStats;\n\n  return [\n    `LLKB Analytics (${analytics.lastUpdated})`,\n    ''.repeat(50),\n    `Lessons: ${o.activeLessons} active, ${o.archivedLessons} archived`,\n    `  Avg Confidence: ${l.avgConfidence}`,\n    `  Avg Success Rate: ${l.avgSuccessRate}`,\n    `Components: ${o.activeComponents} active, ${o.archivedComponents} archived`,\n    `  Total Reuses: ${c.totalReuses}`,\n    `  Avg Reuses/Component: ${c.avgReusesPerComponent}`,\n    `Items Needing Review: ${analytics.needsReview.lowConfidenceLessons.length + analytics.needsReview.lowUsageComponents.length + analytics.needsReview.decliningSuccessRate.length}`,\n  ].join('\\n');\n}\n","/**\n * LLKB Quality Controls Module\n *\n * Provides quality control mechanisms for discovered patterns:\n * - Deduplication (remove duplicates, keep higher confidence)\n * - Confidence threshold filtering\n * - Cross-source boosting (patterns found in multiple sources)\n * - Pruning (remove stale patterns)\n * - Signal weighting (assign base confidence based on source strength)\n *\n * @module llkb/quality-controls\n */\n\nimport type { DiscoveredPattern } from './pattern-generation.js';\n\n// =============================================================================\n// Constants\n// =============================================================================\n\n/** Default confidence threshold for filtering (spec AC3: >= 0.7) */\nconst DEFAULT_CONFIDENCE_THRESHOLD = 0.7;\n\n/** Default maximum age in days for pruning */\nconst DEFAULT_MAX_AGE_DAYS = 90;\n\n/** Confidence boost for cross-source patterns */\nconst CROSS_SOURCE_BOOST = 0.1;\n\n/** Maximum confidence cap */\nconst MAX_CONFIDENCE = 0.95;\n\n/** Milliseconds per day */\nconst MS_PER_DAY = 24 * 60 * 60 * 1000;\n\n/** Signal strength base confidences */\nconst SIGNAL_CONFIDENCES = {\n  strong: 0.85,\n  medium: 0.75,\n  weak: 0.60,\n};\n\n// =============================================================================\n// Type Definitions\n// =============================================================================\n\n/**\n * Usage statistics for pruning\n */\nexport interface UsageStats {\n  /** Map of pattern ID to usage metadata */\n  patternUsage: Map<string, { lastUsed: number; useCount: number }>;\n}\n\n/**\n * Quality control result with before/after metrics\n */\nexport interface QualityControlResult {\n  /** Number of patterns before quality controls */\n  inputCount: number;\n  /** Number of patterns after quality controls */\n  outputCount: number;\n  /** Number of patterns removed by deduplication */\n  deduplicated: number;\n  /** Number of patterns removed by threshold filtering */\n  thresholdFiltered: number;\n  /** Number of patterns boosted by cross-source detection */\n  crossSourceBoosted: number;\n  /** Number of patterns removed by pruning */\n  pruned: number;\n}\n\n// =============================================================================\n// Deduplication\n// =============================================================================\n\n/**\n * Remove duplicate patterns by normalized text + IR primitive.\n * When duplicates found, keep the one with higher confidence.\n *\n * Deduplication key: `${pattern.normalizedText}::${pattern.mappedPrimitive}`\n * When merging duplicates:\n * - Take the higher confidence\n * - Merge selectorHints (union)\n * - Sum successCount and failCount\n * - Preserve all unique templateSource and entityName values (for cross-source detection)\n *\n * @param patterns - Array of patterns (potentially with duplicates)\n * @returns Deduplicated array (higher confidence patterns preferred)\n */\nexport function deduplicatePatterns(patterns: DiscoveredPattern[]): DiscoveredPattern[] {\n  const seen = new Map<string, DiscoveredPattern>();\n\n  for (const pattern of patterns) {\n    const key = `${pattern.normalizedText.toLowerCase()}::${pattern.mappedPrimitive}`;\n    const existing = seen.get(key);\n\n    if (!existing) {\n      // First occurrence - store it with metadata preserved\n      seen.set(key, {\n        ...pattern,\n        // Store original templateSource and entityName in a way that cross-source can detect\n        // We'll keep the first one's values, but cross-source boosting will look at all patterns\n      });\n    } else {\n      // Duplicate found - merge with existing\n      const merged: DiscoveredPattern = {\n        ...existing,\n        confidence: Math.max(existing.confidence, pattern.confidence),\n        successCount: existing.successCount + pattern.successCount,\n        failCount: existing.failCount + pattern.failCount,\n        sourceJourneys: Array.from(new Set([...existing.sourceJourneys, ...pattern.sourceJourneys])),\n        selectorHints: mergeSelectors(existing.selectorHints, pattern.selectorHints),\n        // Keep existing templateSource and entityName (first wins)\n        // Cross-source boosting happens AFTER dedup, so it won't see these merged patterns as cross-source\n      };\n\n      seen.set(key, merged);\n    }\n  }\n\n  return Array.from(seen.values());\n}\n\n/**\n * Merge selector hints from two patterns (union, deduplicated by value)\n */\nfunction mergeSelectors(\n  hints1: DiscoveredPattern['selectorHints'],\n  hints2: DiscoveredPattern['selectorHints']\n): DiscoveredPattern['selectorHints'] {\n  const seen = new Map<string, DiscoveredPattern['selectorHints'][0]>();\n\n  for (const hint of [...hints1, ...hints2]) {\n    const key = `${hint.strategy}:${hint.value}`;\n    const existing = seen.get(key);\n\n    if (!existing || (hint.confidence && (!existing.confidence || hint.confidence > existing.confidence))) {\n      seen.set(key, hint);\n    }\n  }\n\n  return Array.from(seen.values());\n}\n\n// =============================================================================\n// Confidence Threshold Filtering\n// =============================================================================\n\n/**\n * Filter patterns below the confidence threshold.\n *\n * @param patterns - Array of patterns\n * @param threshold - Minimum confidence threshold (default: 0.7 per spec AC3)\n * @returns Filtered array\n */\nexport function applyConfidenceThreshold(\n  patterns: DiscoveredPattern[],\n  threshold: number = DEFAULT_CONFIDENCE_THRESHOLD\n): DiscoveredPattern[] {\n  return patterns.filter(p => p.confidence >= threshold);\n}\n\n// =============================================================================\n// Cross-Source Boosting\n// =============================================================================\n\n/**\n * Boost confidence of patterns found in multiple sources.\n * If a pattern text appears with different sourceJourneys or entityNames,\n * boost confidence by 0.1 (capped at 0.95).\n *\n * Cross-source boost: group by normalizedText, if same text appears from\n * 2+ different templateSource or entityName values, boost by 0.1\n *\n * @param patterns - Array of patterns\n * @returns Patterns with boosted confidence where applicable\n */\nexport function boostCrossSourcePatterns(patterns: DiscoveredPattern[]): DiscoveredPattern[] {\n  // Group by normalized text\n  const groups = new Map<string, DiscoveredPattern[]>();\n\n  for (const pattern of patterns) {\n    const key = pattern.normalizedText;\n    const group = groups.get(key) || [];\n    group.push(pattern);\n    groups.set(key, group);\n  }\n\n  const boosted: DiscoveredPattern[] = [];\n\n  // Convert Map values to array for iteration\n  const groupsArray = Array.from(groups.values());\n\n  for (const group of groupsArray) {\n    if (group.length === 1) {\n      // Single pattern - no boost needed\n      boosted.push({ ...group[0] } as DiscoveredPattern);\n      continue;\n    }\n\n    // Check if patterns come from different sources\n    const templateSources = new Set(group.map(p => p.templateSource).filter(Boolean));\n    const entityNames = new Set(group.map(p => p.entityName).filter(Boolean));\n    const sourceJourneys = new Set(group.flatMap(p => p.sourceJourneys));\n\n    // Calculate unique sources count\n    const uniqueSources = Math.max(templateSources.size, entityNames.size, sourceJourneys.size);\n\n    // If patterns come from 2+ different sources, boost confidence\n    if (uniqueSources >= 2) {\n      for (const pattern of group) {\n        const newConfidence = Math.min(pattern.confidence + CROSS_SOURCE_BOOST, MAX_CONFIDENCE);\n        boosted.push({ ...pattern, confidence: newConfidence });\n      }\n    } else {\n      // No boost - just copy\n      for (const pattern of group) {\n        boosted.push({ ...pattern });\n      }\n    }\n  }\n\n  return boosted;\n}\n\n// =============================================================================\n// Pruning\n// =============================================================================\n\n/**\n * Remove patterns that haven't been used in the specified time period.\n * Only prune patterns with successCount + failCount > 0 (i.e., patterns that\n * HAVE been tried but aren't being used anymore).\n * Never prune patterns that haven't been tried yet.\n *\n * @param patterns - Array of patterns\n * @param usageStats - Usage statistics with lastUsed timestamps\n * @param maxAgeDays - Maximum age in days before pruning (default: 90)\n * @returns Filtered array with stale patterns removed\n */\nexport function pruneUnusedPatterns(\n  patterns: DiscoveredPattern[],\n  usageStats: UsageStats,\n  maxAgeDays: number = DEFAULT_MAX_AGE_DAYS\n): DiscoveredPattern[] {\n  const now = Date.now();\n  const maxAgeMs = maxAgeDays * MS_PER_DAY;\n\n  return patterns.filter(pattern => {\n    const totalAttempts = pattern.successCount + pattern.failCount;\n\n    // Never prune patterns that haven't been tried yet\n    if (totalAttempts === 0) {\n      return true;\n    }\n\n    // Check usage stats\n    const usage = usageStats.patternUsage.get(pattern.id);\n\n    if (!usage) {\n      // No usage stats - keep the pattern (conservative approach)\n      return true;\n    }\n\n    const age = now - usage.lastUsed;\n    const isStale = age > maxAgeMs;\n\n    // Keep if not stale\n    return !isStale;\n  });\n}\n\n// =============================================================================\n// Signal Weighting\n// =============================================================================\n\n/**\n * Signal weighting: assign base confidence based on source strength.\n * Strong signals (routes, schemas): 0.85\n * Medium signals (i18n, component patterns): 0.75\n * Weak signals (string literals, guesses): 0.60\n *\n * @param patterns - Array of patterns\n * @param signalStrengths - Map of pattern ID to signal strength\n * @returns Patterns with confidence adjusted based on signal strength\n */\nexport function applySignalWeighting(\n  patterns: DiscoveredPattern[],\n  signalStrengths: Map<string, 'strong' | 'medium' | 'weak'>\n): DiscoveredPattern[] {\n  return patterns.map(pattern => {\n    const strength = signalStrengths.get(pattern.id);\n\n    if (!strength) {\n      // No signal strength info - keep original confidence\n      return { ...pattern };\n    }\n\n    const baseConfidence = SIGNAL_CONFIDENCES[strength];\n\n    // Raise confidence to signal baseline if lower; never lower a pattern that\n    // already has higher confidence (e.g., from learning/success accumulation)\n    return {\n      ...pattern,\n      confidence: Math.min(Math.max(pattern.confidence, baseConfidence), MAX_CONFIDENCE),\n    };\n  });\n}\n\n// =============================================================================\n// Combined Quality Controls\n// =============================================================================\n\n/**\n * Apply all quality controls in sequence.\n * Order: crossSource boost  deduplicate  threshold  prune\n *\n * Boost runs BEFORE dedup so that cross-source signal (templateSource, entityName)\n * is preserved when boost evaluates source diversity. Dedup then merges duplicates\n * with their already-boosted confidence. Threshold runs after boost so borderline\n * patterns that receive a cross-source boost can survive filtering.\n *\n * @param patterns - Array of patterns to process\n * @param options - Quality control options\n * @returns Object with processed patterns and result metrics\n */\nexport function applyAllQualityControls(\n  patterns: DiscoveredPattern[],\n  options?: {\n    threshold?: number;\n    usageStats?: UsageStats;\n    maxAgeDays?: number;\n  }\n): { patterns: DiscoveredPattern[]; result: QualityControlResult } {\n  const inputCount = patterns.length;\n\n  // Step 1: Cross-source boosting (BEFORE dedup to preserve source diversity)\n  const preboostConfidence = new Map<string, number>();\n  for (const p of patterns) {\n    preboostConfidence.set(p.id, p.confidence);\n  }\n  const afterBoost = boostCrossSourcePatterns(patterns);\n  const crossSourceBoosted = afterBoost.filter(p => {\n    const before = preboostConfidence.get(p.id);\n    return before !== undefined && p.confidence > before;\n  }).length;\n\n  // Step 2: Deduplication (after boost, so merged patterns keep boosted confidence)\n  const afterDedup = deduplicatePatterns(afterBoost);\n  const deduplicated = afterBoost.length - afterDedup.length;\n\n  // Step 3: Threshold filtering (after boost, so boosted patterns survive)\n  const afterThreshold = applyConfidenceThreshold(afterDedup, options?.threshold);\n  const thresholdFiltered = afterDedup.length - afterThreshold.length;\n\n  // Step 4: Pruning (if usage stats provided)\n  let afterPrune = afterThreshold;\n  let pruned = 0;\n\n  if (options?.usageStats) {\n    afterPrune = pruneUnusedPatterns(afterThreshold, options.usageStats, options?.maxAgeDays);\n    pruned = afterThreshold.length - afterPrune.length;\n  }\n\n  const outputCount = afterPrune.length;\n\n  return {\n    patterns: afterPrune,\n    result: {\n      inputCount,\n      outputCount,\n      deduplicated,\n      thresholdFiltered,\n      crossSourceBoosted,\n      pruned,\n    },\n  };\n}\n","/**\n * LLKB Pattern Generation Module\n *\n * Generates LLKB patterns from app profile and selector signals.\n * This is the core of F12 pattern discovery.\n *\n * @module llkb/pattern-generation\n */\n\nimport type { AuthHints, DiscoveredProfile, SelectorSignals } from './discovery.js';\nimport { randomUUID } from 'crypto';\nimport * as fs from 'fs';\nimport * as path from 'path';\nimport { saveJSONAtomicSync } from './file-utils.js';\nimport { deduplicatePatterns as deduplicatePatternsQC } from './quality-controls.js';\n\n// =============================================================================\n// Constants\n// =============================================================================\n\n/** Confidence for auth patterns with known selectors */\nconst HIGH_CONFIDENCE_AUTH = 0.85;\n/** Confidence for auth patterns without known selectors */\nconst MEDIUM_CONFIDENCE_AUTH = 0.70;\n/** Default confidence for framework patterns */\nconst FRAMEWORK_PATTERN_CONFIDENCE = 0.60;\n/** Maximum confidence for UI library patterns */\nconst MAX_UI_PATTERN_CONFIDENCE = 0.75;\n/** Percentage divisor for coverage calculations */\nconst PERCENTAGE_DIVISOR = 100;\n\n// =============================================================================\n// Type Definitions\n// =============================================================================\n\n/**\n * Hint for locating an element\n */\nexport interface SelectorHint {\n  /** Selector strategy */\n  strategy: 'data-testid' | 'data-cy' | 'data-test' | 'role' | 'aria-label' | 'css' | 'xpath' | 'text';\n  /** Selector value */\n  value: string;\n  /** Accessible name (for role-based selectors) */\n  name?: string;\n  /** Confidence in this selector */\n  confidence?: number;\n}\n\n/**\n * A pattern discovered during F12 discovery\n */\nexport interface DiscoveredPattern {\n  /** Unique pattern identifier (DP001, DP002, etc.) */\n  id: string;\n  /** Normalized text for matching */\n  normalizedText: string;\n  /** Original text before normalization */\n  originalText: string;\n  /** AutoGen IR primitive this maps to */\n  mappedPrimitive: string;\n  /** Hints for locating elements */\n  selectorHints: SelectorHint[];\n  /** Confidence score (0.0 - 1.0) */\n  confidence: number;\n  /** Pattern layer in the hierarchy */\n  layer: 'app-specific' | 'framework' | 'universal';\n  /** Pattern category */\n  category?: 'auth' | 'navigation' | 'ui-interaction' | 'data' | 'assertion' | 'timing';\n  /** Journey IDs where this pattern was discovered */\n  sourceJourneys: string[];\n  /** Number of successful applications */\n  successCount: number;\n  /** Number of failed applications */\n  failCount: number;\n  /** Template that generated this pattern */\n  templateSource?: 'crud' | 'form' | 'table' | 'modal' | 'navigation' | 'auth' | 'static';\n  /** Entity name if pattern was generated from a template */\n  entityName?: string;\n}\n\n/**\n * Collection of discovered patterns with metadata\n */\nexport interface DiscoveredPatternsFile {\n  /** Schema version */\n  version: string;\n  /** When patterns were generated */\n  generatedAt: string;\n  /** Source identifier */\n  source: string;\n  /** Array of discovered patterns */\n  patterns: DiscoveredPattern[];\n  /** Discovery metadata */\n  metadata: {\n    frameworks: string[];\n    uiLibraries: string[];\n    totalPatterns: number;\n    byCategory: Record<string, number>;\n    byTemplate: Record<string, number>;\n    averageConfidence: number;\n    discoveryDuration?: number;\n  };\n}\n\n/**\n * Existing learned pattern from LLKB (persistence/merge format).\n *\n * This is the simplified persistence type used for merging discovered patterns\n * with existing learned knowledge. It stores `irPrimitive` as a string type name\n * (e.g., \"click\", \"fill\", \"navigate\").\n *\n * NOTE: This is distinct from AutoGen's `LearnedPattern` in patternExtension.ts,\n * which stores `mappedPrimitive` as a full `IRPrimitive` object for runtime matching.\n * See I-01 in the review for context.\n */\nexport interface LearnedPattern {\n  normalizedText: string;\n  originalText: string;\n  irPrimitive: string;\n  confidence: number;\n  successCount: number;\n  failCount: number;\n  sourceJourneys: string[];\n  lastUpdated?: string;\n}\n\n/**\n * Type alias for clarity when importing alongside AutoGen's LearnedPattern.\n * Prefer this name in contexts where both types are visible.\n */\nexport type LearnedPatternEntry = LearnedPattern;\n\n// =============================================================================\n// Pattern Templates\n// =============================================================================\n\n/**\n * Auth-related pattern templates\n */\nexport const AUTH_PATTERN_TEMPLATES: Array<{\n  text: string;\n  primitive: string;\n  selectorKey?: string;\n}> = [\n  { text: 'click login button', primitive: 'click', selectorKey: 'submitButton' },\n  { text: 'click sign in button', primitive: 'click', selectorKey: 'submitButton' },\n  { text: 'enter username', primitive: 'fill', selectorKey: 'usernameField' },\n  { text: 'enter email', primitive: 'fill', selectorKey: 'usernameField' },\n  { text: 'enter password', primitive: 'fill', selectorKey: 'passwordField' },\n  { text: 'submit login form', primitive: 'click', selectorKey: 'submitButton' },\n  { text: 'click logout button', primitive: 'click' },\n  { text: 'click sign out button', primitive: 'click' },\n  { text: 'verify logged in', primitive: 'assert' },\n  { text: 'verify logged out', primitive: 'assert' },\n];\n\n/**\n * Navigation-related pattern templates\n */\nexport const NAVIGATION_PATTERN_TEMPLATES: Array<{\n  text: string;\n  primitive: string;\n}> = [\n  { text: 'navigate to {route}', primitive: 'navigate' },\n  { text: 'go to {route}', primitive: 'navigate' },\n  { text: 'open {route} page', primitive: 'navigate' },\n  { text: 'click {item} in navigation', primitive: 'click' },\n  { text: 'click {item} in sidebar', primitive: 'click' },\n  { text: 'click {item} in menu', primitive: 'click' },\n  { text: 'return to home', primitive: 'navigate' },\n  { text: 'go back', primitive: 'navigate' },\n];\n\n/**\n * UI interaction pattern templates by UI library\n */\nexport const UI_LIBRARY_PATTERNS: Record<string, Array<{\n  text: string;\n  primitive: string;\n  component?: string;\n}>> = {\n  mui: [\n    { text: 'click MUI button', primitive: 'click', component: 'Button' },\n    { text: 'open MUI dialog', primitive: 'click', component: 'Dialog' },\n    { text: 'close MUI dialog', primitive: 'click', component: 'Dialog' },\n    { text: 'select MUI option', primitive: 'click', component: 'Select' },\n    { text: 'fill MUI text field', primitive: 'fill', component: 'TextField' },\n    { text: 'open MUI menu', primitive: 'click', component: 'Menu' },\n    { text: 'click MUI tab', primitive: 'click', component: 'Tabs' },\n    { text: 'toggle MUI switch', primitive: 'click', component: 'Switch' },\n    { text: 'check MUI checkbox', primitive: 'check', component: 'Checkbox' },\n    { text: 'dismiss MUI snackbar', primitive: 'click', component: 'Snackbar' },\n  ],\n  antd: [\n    { text: 'click Ant button', primitive: 'click', component: 'Button' },\n    { text: 'open Ant modal', primitive: 'click', component: 'Modal' },\n    { text: 'close Ant modal', primitive: 'click', component: 'Modal' },\n    { text: 'select Ant option', primitive: 'click', component: 'Select' },\n    { text: 'fill Ant input', primitive: 'fill', component: 'Input' },\n    { text: 'click Ant table row', primitive: 'click', component: 'Table' },\n    { text: 'sort Ant table column', primitive: 'click', component: 'Table' },\n    { text: 'dismiss Ant message', primitive: 'click', component: 'Message' },\n  ],\n  chakra: [\n    { text: 'click Chakra button', primitive: 'click', component: 'Button' },\n    { text: 'open Chakra modal', primitive: 'click', component: 'Modal' },\n    { text: 'close Chakra modal', primitive: 'click', component: 'Modal' },\n    { text: 'fill Chakra input', primitive: 'fill', component: 'Input' },\n    { text: 'dismiss Chakra toast', primitive: 'click', component: 'Toast' },\n  ],\n  'ag-grid': [\n    { text: 'click AG Grid row', primitive: 'click', component: 'agGrid' },\n    { text: 'select AG Grid row', primitive: 'click', component: 'agGrid' },\n    { text: 'sort AG Grid column', primitive: 'click', component: 'agGrid' },\n    { text: 'filter AG Grid column', primitive: 'fill', component: 'agGrid' },\n    { text: 'expand AG Grid row', primitive: 'click', component: 'agGrid' },\n    { text: 'collapse AG Grid row', primitive: 'click', component: 'agGrid' },\n    { text: 'edit AG Grid cell', primitive: 'fill', component: 'agGrid' },\n    { text: 'clear AG Grid filter', primitive: 'click', component: 'agGrid' },\n  ],\n};\n\n// =============================================================================\n// Pattern Generation Functions\n// =============================================================================\n\n/**\n * Generate a unique pattern ID using UUID\n * This ensures uniqueness even across parallel discovery runs\n */\nfunction generatePatternId(): string {\n  return `DP-${randomUUID().slice(0, 8)}`;\n}\n\n/**\n * @deprecated No longer needed with UUID-based generation\n * Kept for backward compatibility with tests\n */\nexport function resetPatternIdCounter(): void {\n  // No-op: UUID-based IDs don't need reset\n}\n\n/**\n * Generate patterns from app profile and selector signals\n *\n * @param profile - App profile from discovery\n * @param signals - Selector signals from analysis\n * @returns Array of discovered patterns\n */\nexport function generatePatterns(\n  profile: DiscoveredProfile,\n  signals: SelectorSignals\n): DiscoveredPattern[] {\n  const patterns: DiscoveredPattern[] = [];\n\n  // Generate auth patterns if auth was detected\n  if (profile.auth.detected) {\n    patterns.push(...generateAuthPatterns(profile.auth, signals));\n  }\n\n  // Generate navigation patterns\n  patterns.push(...generateNavigationPatterns(signals));\n\n  // Generate UI library specific patterns\n  for (const uiLib of profile.uiLibraries) {\n    const libPatterns = UI_LIBRARY_PATTERNS[uiLib.name];\n    if (libPatterns) {\n      patterns.push(...generateUiLibraryPatterns(uiLib.name, libPatterns, signals, uiLib.confidence));\n    }\n  }\n\n  return patterns;\n}\n\n/**\n * Generate auth-related patterns\n */\nfunction generateAuthPatterns(\n  auth: AuthHints,\n  signals: SelectorSignals\n): DiscoveredPattern[] {\n  const patterns: DiscoveredPattern[] = [];\n\n  for (const template of AUTH_PATTERN_TEMPLATES) {\n    const selectorHints: SelectorHint[] = [];\n\n    // Add selector hint if we have a matching selector from auth discovery\n    const selectorKey = template.selectorKey;\n    const selectorValue = selectorKey ? auth.selectors?.[selectorKey] : undefined;\n    if (selectorKey && selectorValue) {\n      selectorHints.push({\n        strategy: signals.primaryAttribute as SelectorHint['strategy'],\n        value: selectorValue,\n        confidence: HIGH_CONFIDENCE_AUTH,\n      });\n    }\n\n    patterns.push({\n      id: generatePatternId(),\n      normalizedText: template.text.toLowerCase(),\n      originalText: template.text,\n      mappedPrimitive: template.primitive,\n      selectorHints,\n      confidence: auth.selectors?.[template.selectorKey || ''] ? HIGH_CONFIDENCE_AUTH : MEDIUM_CONFIDENCE_AUTH,\n      layer: 'app-specific',\n      category: 'auth',\n      sourceJourneys: [],\n      successCount: 0,\n      failCount: 0,\n      templateSource: 'auth',\n    });\n  }\n\n  return patterns;\n}\n\n/**\n * Generate navigation-related patterns\n */\nfunction generateNavigationPatterns(\n  _signals: SelectorSignals\n): DiscoveredPattern[] {\n  const patterns: DiscoveredPattern[] = [];\n\n  for (const template of NAVIGATION_PATTERN_TEMPLATES) {\n    patterns.push({\n      id: generatePatternId(),\n      normalizedText: template.text.toLowerCase(),\n      originalText: template.text,\n      mappedPrimitive: template.primitive,\n      selectorHints: [],\n      confidence: 0.70,\n      layer: 'app-specific',\n      category: 'navigation',\n      sourceJourneys: [],\n      successCount: 0,\n      failCount: 0,\n      templateSource: 'navigation',\n    });\n  }\n\n  return patterns;\n}\n\n/**\n * Generate UI library specific patterns\n */\nfunction generateUiLibraryPatterns(\n  _libraryName: string,\n  templates: Array<{ text: string; primitive: string; component?: string }>,\n  signals: SelectorSignals,\n  libraryConfidence: number\n): DiscoveredPattern[] {\n  const patterns: DiscoveredPattern[] = [];\n\n  for (const template of templates) {\n    const selectorHints: SelectorHint[] = [];\n\n    // Add generic selector hints based on component\n    if (template.component) {\n      // Try to infer selector from component name\n      const componentKebab = template.component\n        .replace(/([A-Z])/g, '-$1')\n        .toLowerCase()\n        .replace(/^-/, '');\n\n      selectorHints.push({\n        strategy: signals.primaryAttribute as SelectorHint['strategy'],\n        value: componentKebab,\n        confidence: FRAMEWORK_PATTERN_CONFIDENCE,\n      });\n    }\n\n    patterns.push({\n      id: generatePatternId(),\n      normalizedText: template.text.toLowerCase(),\n      originalText: template.text,\n      mappedPrimitive: template.primitive,\n      selectorHints,\n      confidence: Math.min(libraryConfidence, MAX_UI_PATTERN_CONFIDENCE),\n      layer: 'framework',\n      category: 'ui-interaction',\n      sourceJourneys: [],\n      successCount: 0,\n      failCount: 0,\n    });\n  }\n\n  return patterns;\n}\n\n/**\n * Merge discovered patterns with existing seed/learned patterns\n *\n * IMPORTANT: This is a NON-DESTRUCTIVE merge - existing patterns are NEVER modified.\n * Only new patterns are added. Duplicates are skipped entirely.\n *\n * @param existing - Existing patterns from LLKB (will not be modified)\n * @param discovered - Newly discovered patterns\n * @returns New array with existing patterns plus new discoveries (no mutations)\n */\nexport function mergeDiscoveredPatterns(\n  existing: LearnedPattern[],\n  discovered: DiscoveredPattern[]\n): LearnedPattern[] {\n  // Create lookup map for O(1) duplicate detection (fixes O(n^2) issue)\n  const existingTextsMap = new Map<string, boolean>();\n  for (const p of existing) {\n    existingTextsMap.set(`${p.normalizedText.toLowerCase()}:${p.irPrimitive}`, true);\n  }\n\n  // Start with a shallow copy of existing (non-destructive)\n  const merged: LearnedPattern[] = [...existing];\n\n  for (const pattern of discovered) {\n    const key = `${pattern.normalizedText.toLowerCase()}:${pattern.mappedPrimitive}`;\n\n    if (existingTextsMap.has(key)) {\n      // D-02 FIX: Check if discovered pattern has higher confidence than existing.\n      // If so, replace the existing entry (non-destructive to other patterns).\n      const existingIdx = merged.findIndex(\n        p => `${p.normalizedText.toLowerCase()}:${p.irPrimitive}` === key\n      );\n      if (existingIdx >= 0 && pattern.confidence > merged[existingIdx]!.confidence) {\n        merged[existingIdx] = {\n          normalizedText: pattern.normalizedText,\n          originalText: pattern.originalText,\n          irPrimitive: pattern.mappedPrimitive,\n          confidence: pattern.confidence,\n          successCount: pattern.successCount,\n          failCount: pattern.failCount,\n          sourceJourneys: pattern.sourceJourneys,\n          lastUpdated: new Date().toISOString(),\n        };\n      }\n      continue;\n    }\n\n    // Add new pattern\n    merged.push({\n      normalizedText: pattern.normalizedText,\n      originalText: pattern.originalText,\n      irPrimitive: pattern.mappedPrimitive,\n      confidence: pattern.confidence,\n      successCount: pattern.successCount,\n      failCount: pattern.failCount,\n      sourceJourneys: pattern.sourceJourneys,\n      lastUpdated: new Date().toISOString(),\n    });\n\n    existingTextsMap.set(key, true);\n  }\n\n  return merged;\n}\n\n/**\n * Create a DiscoveredPatternsFile from patterns and profile\n *\n * @param patterns - Array of discovered patterns\n * @param profile - App profile\n * @param durationMs - Discovery duration in milliseconds\n * @returns Complete discovered patterns file\n */\nexport function createDiscoveredPatternsFile(\n  patterns: DiscoveredPattern[],\n  profile: DiscoveredProfile,\n  durationMs?: number\n): DiscoveredPatternsFile {\n  // Calculate category counts\n  const byCategory: Record<string, number> = {};\n  const byTemplate: Record<string, number> = {};\n\n  for (const pattern of patterns) {\n    if (pattern.category) {\n      byCategory[pattern.category] = (byCategory[pattern.category] || 0) + 1;\n    }\n    if (pattern.templateSource) {\n      byTemplate[pattern.templateSource] = (byTemplate[pattern.templateSource] || 0) + 1;\n    }\n  }\n\n  // Calculate average confidence\n  const avgConfidence = patterns.length > 0\n    ? patterns.reduce((sum, p) => sum + p.confidence, 0) / patterns.length\n    : 0;\n\n  return {\n    version: '1.0',\n    generatedAt: new Date().toISOString(),\n    source: 'discover-foundation:F12',\n    patterns,\n    metadata: {\n      frameworks: profile.frameworks.map(f => f.name),\n      uiLibraries: profile.uiLibraries.map(l => l.name),\n      totalPatterns: patterns.length,\n      byCategory,\n      byTemplate,\n      averageConfidence: Math.round(avgConfidence * PERCENTAGE_DIVISOR) / PERCENTAGE_DIVISOR,\n      discoveryDuration: durationMs,\n    },\n  };\n}\n\n/**\n * Deduplicate patterns by normalized text + primitive.\n * Delegates to the richer implementation in quality-controls.ts\n * which uses :: separator (safe with CSS selectors), merges selector hints,\n * and sums success/fail counts.\n *\n * @param patterns - Array of patterns (potentially with duplicates)\n * @returns Deduplicated array (higher confidence patterns preferred)\n */\nexport function deduplicatePatterns(patterns: DiscoveredPattern[]): DiscoveredPattern[] {\n  return deduplicatePatternsQC(patterns);\n}\n\n/**\n * Save discovered patterns to disk\n *\n * @param patternsFile - The discovered patterns file to save\n * @param outputDir - Directory to save to (usually .artk/llkb/)\n */\nexport function saveDiscoveredPatterns(\n  patternsFile: DiscoveredPatternsFile,\n  outputDir: string\n): void {\n  const outputPath = path.join(outputDir, 'discovered-patterns.json');\n  fs.mkdirSync(outputDir, { recursive: true });\n  saveJSONAtomicSync(outputPath, patternsFile);\n}\n\n/**\n * Load discovered patterns from disk\n *\n * @param llkbDir - LLKB directory (usually .artk/llkb/)\n * @returns Discovered patterns file or null if not found\n */\nexport function loadDiscoveredPatterns(llkbDir: string): DiscoveredPatternsFile | null {\n  const patternsPath = path.join(llkbDir, 'discovered-patterns.json');\n  if (!fs.existsSync(patternsPath)) {\n    return null;\n  }\n  try {\n    const content = fs.readFileSync(patternsPath, 'utf-8');\n    const data: unknown = JSON.parse(content);\n\n    // SEC-F03: Runtime shape validation after JSON.parse\n    if (\n      typeof data !== 'object' || data === null ||\n      !('patterns' in data) || !Array.isArray(data.patterns) ||\n      !('version' in data) || typeof data.version !== 'string'\n    ) {\n      console.warn(`[LLKB] Invalid discovered patterns shape in ${patternsPath}`);\n      return null;\n    }\n\n    return data as DiscoveredPatternsFile;\n  } catch (err) {\n    console.warn(`[LLKB] Failed to load discovered patterns from ${patternsPath}: ${err instanceof Error ? err.message : String(err)}`);\n    return null;\n  }\n}\n","/**\n * LLKB Data Loaders\n *\n * Functions for loading and validating LLKB configuration and data files.\n *\n * @module @artk/llkb/loaders\n */\n\nimport { existsSync, readdirSync, readFileSync } from 'node:fs';\nimport { join } from 'node:path';\nimport { loadJSON } from './file-utils.js';\nimport type {\n  Component,\n  ComponentsFile,\n  Lesson,\n  LessonsFile,\n  LLKBCategory,\n  LLKBConfig,\n  LLKBScope,\n} from './types.js';\nimport { type DiscoveredPatternsFile, loadDiscoveredPatterns as loadDiscoveredPatternsFromFile } from './pattern-generation.js';\n\n// =============================================================================\n// Types\n// =============================================================================\n\n/**\n * App profile structure from app-profile.json\n */\nexport interface AppProfile {\n  version: string;\n  createdBy: string;\n  lastUpdated: string;\n  application: {\n    name: string;\n    framework: 'angular' | 'react' | 'vue' | 'nextjs' | 'other';\n    uiLibrary: 'material' | 'antd' | 'primeng' | 'bootstrap' | 'custom' | 'none';\n    dataGrid: 'ag-grid' | 'tanstack-table' | 'custom' | 'none';\n    authProvider: 'azure-ad' | 'okta' | 'auth0' | 'cognito' | 'custom' | 'none';\n    stateManagement: 'ngrx' | 'redux' | 'zustand' | 'none';\n  };\n  testability: {\n    testIdAttribute: string;\n    testIdCoverage: 'high' | 'medium' | 'low';\n    ariaCoverage: 'high' | 'medium' | 'low';\n    asyncComplexity: 'high' | 'medium' | 'low';\n  };\n  environment: {\n    baseUrls: Record<string, string>;\n    authBypass: {\n      available: boolean;\n      method: 'storage-state' | 'api-token' | 'mock-user' | 'none';\n    };\n  };\n}\n\n/**\n * Pattern file structure\n */\nexport interface PatternFile {\n  version: string;\n  [key: string]: unknown;\n}\n\n/**\n * Selector patterns file\n */\nexport interface SelectorPatterns extends PatternFile {\n  selectorPriority: {\n    order: Array<{\n      type: string;\n      reliability: number;\n      note?: string;\n    }>;\n  };\n  selectorPatterns: Array<{\n    id: string;\n    name: string;\n    context: string;\n    problem: string;\n    solution: string;\n    template: string;\n    applicableTo: string[];\n    confidence: number;\n  }>;\n  avoidSelectors: Array<{\n    pattern: string;\n    reason: string;\n  }>;\n  preferredSelectors: Array<{\n    pattern: string;\n    priority: number;\n    reason: string;\n  }>;\n}\n\n/**\n * Timing patterns file\n */\nexport interface TimingPatterns extends PatternFile {\n  asyncPatterns: Array<{\n    id: string;\n    name: string;\n    context: string;\n    pattern: string;\n    observedDelays: {\n      min: number;\n      avg: number;\n      max: number;\n      p95: number;\n    };\n    recommendation: string;\n  }>;\n  loadingIndicators: Array<{\n    component: string;\n    indicator: string;\n    avgLoadTime: number;\n    maxObservedTime: number;\n    waitStrategy: string;\n  }>;\n  networkPatterns: Array<{\n    endpoint: string;\n    avgResponseTime: number;\n    p95ResponseTime: number;\n    retryRecommended: boolean;\n    maxRetries: number;\n  }>;\n  forbiddenPatterns: Array<{\n    pattern: string;\n    severity: 'error' | 'warning';\n    alternative: string;\n  }>;\n}\n\n/**\n * Assertion patterns file\n */\nexport interface AssertionPatterns extends PatternFile {\n  commonAssertions: Array<{\n    id: string;\n    name: string;\n    pattern: string;\n    usageContext: string;\n    componentRef?: string;\n  }>;\n  assertionHelpers: Array<{\n    name: string;\n    module: string;\n    signature: string;\n    scope: LLKBScope;\n  }>;\n}\n\n/**\n * All patterns combined\n */\nexport interface LLKBPatterns {\n  selectors?: SelectorPatterns;\n  timing?: TimingPatterns;\n  assertions?: AssertionPatterns;\n  data?: PatternFile;\n  auth?: PatternFile;\n}\n\n/**\n * Filter options for loading lessons\n */\nexport interface LessonFilterOptions {\n  category?: LLKBCategory | LLKBCategory[];\n  scope?: LLKBScope | LLKBScope[];\n  minConfidence?: number;\n  tags?: string[];\n  includeArchived?: boolean;\n}\n\n/**\n * Filter options for loading components\n */\nexport interface ComponentFilterOptions {\n  category?: LLKBCategory | LLKBCategory[];\n  scope?: LLKBScope | LLKBScope[];\n  minConfidence?: number;\n  includeArchived?: boolean;\n}\n\n/**\n * Loaded LLKB data bundle\n */\nexport interface LLKBData {\n  config: LLKBConfig;\n  appProfile: AppProfile | null;\n  lessons: LessonsFile;\n  components: ComponentsFile;\n  patterns: LLKBPatterns;\n  discoveredPatterns: DiscoveredPatternsFile | null;\n}\n\n// =============================================================================\n// Default Configuration\n// =============================================================================\n\n/**\n * Default LLKB configuration when config.yml doesn't exist\n */\nexport const DEFAULT_LLKB_CONFIG: LLKBConfig = {\n  version: '1.0.0',\n  enabled: true,\n  extraction: {\n    minOccurrences: 2,\n    predictiveExtraction: true,\n    confidenceThreshold: 0.7,\n    maxPredictivePerDay: 5,\n    maxPredictivePerJourney: 2,\n    minLinesForExtraction: 3,\n    similarityThreshold: 0.8,\n  },\n  retention: {\n    maxLessonAge: 90,\n    minSuccessRate: 0.6,\n    archiveUnused: 30,\n  },\n  injection: {\n    prioritizeByConfidence: true,\n  },\n  scopes: {\n    universal: true,\n    frameworkSpecific: true,\n    appSpecific: true,\n  },\n  history: {\n    retentionDays: 365,\n  },\n  overrides: {\n    allowUserOverride: true,\n    logOverrides: true,\n    flagAfterOverrides: 3,\n  },\n};\n\n// =============================================================================\n// Config Loader\n// =============================================================================\n\n/**\n * Load LLKB configuration from config.yml\n *\n * @param llkbRoot - Root directory of LLKB (default: .artk/llkb)\n * @returns Loaded config or default if not found\n */\nexport function loadLLKBConfig(llkbRoot: string = '.artk/llkb'): LLKBConfig {\n  const configPath = join(llkbRoot, 'config.yml');\n\n  if (!existsSync(configPath)) {\n    return { ...DEFAULT_LLKB_CONFIG };\n  }\n\n  try {\n    const content = readFileSync(configPath, 'utf-8');\n\n    // Simple YAML parsing for the config structure\n    // For production, consider using a proper YAML parser\n    const config = parseSimpleYAML(content);\n\n    // Merge with defaults to ensure all fields exist\n    return mergeConfig(DEFAULT_LLKB_CONFIG, config);\n  } catch {\n    return { ...DEFAULT_LLKB_CONFIG };\n  }\n}\n\n/**\n * Simple YAML parser for config files\n * Handles basic key: value and nested structures\n */\nfunction parseSimpleYAML(content: string): Partial<LLKBConfig> {\n  const result: Record<string, unknown> = {};\n  const lines = content.split('\\n');\n  const stack: Array<{ obj: Record<string, unknown>; indent: number }> = [{ obj: result, indent: -1 }];\n\n  for (const line of lines) {\n    // Skip empty lines and comments\n    if (!line.trim() || line.trim().startsWith('#')) {\n      continue;\n    }\n\n    const indent = line.search(/\\S/);\n    const trimmed = line.trim();\n\n    // Check if it's a key: value pair\n    const colonIndex = trimmed.indexOf(':');\n    if (colonIndex === -1) {continue;}\n\n    const key = trimmed.substring(0, colonIndex).trim();\n    const valueStr = trimmed.substring(colonIndex + 1).trim();\n\n    // Pop stack until we find the right parent\n    while (stack.length > 1) {\n      const top = stack[stack.length - 1];\n      if (!top || top.indent < indent) {break;}\n      stack.pop();\n    }\n\n    const top = stack[stack.length - 1];\n    if (!top) {continue;}\n    const parent = top.obj;\n\n    if (valueStr === '' || valueStr === '|' || valueStr === '>') {\n      // Nested object\n      const newObj: Record<string, unknown> = {};\n      parent[key] = newObj;\n      stack.push({ obj: newObj, indent });\n    } else {\n      // Parse value\n      parent[key] = parseYAMLValue(valueStr);\n    }\n  }\n\n  return result as Partial<LLKBConfig>;\n}\n\n/**\n * Parse a YAML value string\n */\nfunction parseYAMLValue(value: string): unknown {\n  // Remove quotes\n  if ((value.startsWith('\"') && value.endsWith('\"')) || (value.startsWith(\"'\") && value.endsWith(\"'\"))) {\n    return value.slice(1, -1);\n  }\n\n  // Boolean\n  if (value === 'true') {return true;}\n  if (value === 'false') {return false;}\n\n  // Number\n  const num = Number(value);\n  if (!isNaN(num)) {return num;}\n\n  // String\n  return value;\n}\n\n/**\n * Deep merge config with defaults\n */\nfunction mergeConfig(defaults: LLKBConfig, overrides: Partial<LLKBConfig>): LLKBConfig {\n  const result = { ...defaults } as Record<string, unknown>;\n\n  for (const key of Object.keys(overrides) as (keyof LLKBConfig)[]) {\n    const override = overrides[key];\n    if (override !== undefined) {\n      if (typeof override === 'object' && override !== null && !Array.isArray(override)) {\n        // Deep merge nested objects\n        const defaultValue = defaults[key];\n        result[key] = {\n          ...(typeof defaultValue === 'object' && defaultValue !== null ? defaultValue : {}),\n          ...(override as object),\n        };\n      } else {\n        result[key] = override;\n      }\n    }\n  }\n\n  return result as unknown as LLKBConfig;\n}\n\n/**\n * Check if LLKB is enabled\n */\nexport function isLLKBEnabled(llkbRoot: string = '.artk/llkb'): boolean {\n  if (!existsSync(llkbRoot)) {\n    return false;\n  }\n\n  const config = loadLLKBConfig(llkbRoot);\n  return config.enabled;\n}\n\n// =============================================================================\n// App Profile Loader\n// =============================================================================\n\n/**\n * Load app profile from app-profile.json\n *\n * @param llkbRoot - Root directory of LLKB\n * @returns App profile or null if not found\n */\nexport function loadAppProfile(llkbRoot: string = '.artk/llkb'): AppProfile | null {\n  const profilePath = join(llkbRoot, 'app-profile.json');\n  return loadJSON<AppProfile>(profilePath);\n}\n\n// =============================================================================\n// Lessons Loader\n// =============================================================================\n\n/**\n * Load lessons file\n *\n * @param llkbRoot - Root directory of LLKB\n * @returns Lessons file or empty structure\n */\nexport function loadLessonsFile(llkbRoot: string = '.artk/llkb'): LessonsFile {\n  const lessonsPath = join(llkbRoot, 'lessons.json');\n  const data = loadJSON<LessonsFile>(lessonsPath);\n\n  if (!data) {\n    return {\n      version: '1.0.0',\n      lastUpdated: new Date().toISOString(),\n      lessons: [],\n      archived: [],\n      globalRules: [],\n      appQuirks: [],\n    };\n  }\n\n  return data;\n}\n\n/**\n * Load lessons with optional filtering\n *\n * @param llkbRoot - Root directory of LLKB\n * @param options - Filter options\n * @returns Filtered lessons array\n */\nexport function loadLessons(\n  llkbRoot: string = '.artk/llkb',\n  options: LessonFilterOptions = {}\n): Lesson[] {\n  const lessonsFile = loadLessonsFile(llkbRoot);\n  let lessons = lessonsFile.lessons;\n\n  // Filter archived\n  if (!options.includeArchived) {\n    lessons = lessons.filter((l) => !l.archived);\n  }\n\n  // Filter by category\n  if (options.category) {\n    const categories = Array.isArray(options.category) ? options.category : [options.category];\n    lessons = lessons.filter((l) => categories.includes(l.category));\n  }\n\n  // Filter by scope\n  if (options.scope) {\n    const scopes = Array.isArray(options.scope) ? options.scope : [options.scope];\n    lessons = lessons.filter((l) => scopes.includes(l.scope));\n  }\n\n  // Filter by minimum confidence\n  if (options.minConfidence !== undefined) {\n    lessons = lessons.filter((l) => l.metrics.confidence >= options.minConfidence!);\n  }\n\n  // Filter by tags\n  if (options.tags && options.tags.length > 0) {\n    lessons = lessons.filter((l) => l.tags && options.tags!.some((tag) => l.tags!.includes(tag)));\n  }\n\n  return lessons;\n}\n\n// =============================================================================\n// Components Loader\n// =============================================================================\n\n/**\n * Load components file\n *\n * @param llkbRoot - Root directory of LLKB\n * @returns Components file or empty structure\n */\nexport function loadComponentsFile(llkbRoot: string = '.artk/llkb'): ComponentsFile {\n  const componentsPath = join(llkbRoot, 'components.json');\n  const data = loadJSON<ComponentsFile>(componentsPath);\n\n  if (!data) {\n    return {\n      version: '1.0.0',\n      lastUpdated: new Date().toISOString(),\n      components: [],\n      componentsByCategory: {\n        selector: [],\n        timing: [],\n        auth: [],\n        data: [],\n        assertion: [],\n        navigation: [],\n        'ui-interaction': [],\n      },\n      componentsByScope: {\n        universal: [],\n        'framework:angular': [],\n        'framework:react': [],\n        'framework:vue': [],\n        'framework:ag-grid': [],\n        'app-specific': [],\n      },\n    };\n  }\n\n  return data;\n}\n\n/**\n * Load components with optional filtering\n *\n * @param llkbRoot - Root directory of LLKB\n * @param options - Filter options\n * @returns Filtered components array\n */\nexport function loadComponents(\n  llkbRoot: string = '.artk/llkb',\n  options: ComponentFilterOptions = {}\n): Component[] {\n  const componentsFile = loadComponentsFile(llkbRoot);\n  let components = componentsFile.components;\n\n  // Filter archived\n  if (!options.includeArchived) {\n    components = components.filter((c) => !c.archived);\n  }\n\n  // Filter by category\n  if (options.category) {\n    const categories = Array.isArray(options.category) ? options.category : [options.category];\n    components = components.filter((c) => categories.includes(c.category));\n  }\n\n  // Filter by scope\n  if (options.scope) {\n    const scopes = Array.isArray(options.scope) ? options.scope : [options.scope];\n    components = components.filter((c) => scopes.includes(c.scope));\n  }\n\n  // Filter by minimum confidence (uses successRate as proxy for confidence)\n  if (options.minConfidence !== undefined) {\n    components = components.filter((c) => c.metrics.successRate >= options.minConfidence!);\n  }\n\n  return components;\n}\n\n// =============================================================================\n// Pattern Loaders\n// =============================================================================\n\n/**\n * Load all pattern files\n *\n * @param llkbRoot - Root directory of LLKB\n * @returns All loaded patterns\n */\nexport function loadPatterns(llkbRoot: string = '.artk/llkb'): LLKBPatterns {\n  const patternsDir = join(llkbRoot, 'patterns');\n\n  if (!existsSync(patternsDir)) {\n    return {};\n  }\n\n  const patterns: LLKBPatterns = {};\n\n  // Load each pattern file if it exists\n  const selectorPatterns = loadJSON<SelectorPatterns>(join(patternsDir, 'selectors.json'));\n  if (selectorPatterns) {\n    patterns.selectors = selectorPatterns;\n  }\n\n  const timingPatterns = loadJSON<TimingPatterns>(join(patternsDir, 'timing.json'));\n  if (timingPatterns) {\n    patterns.timing = timingPatterns;\n  }\n\n  const assertionPatterns = loadJSON<AssertionPatterns>(join(patternsDir, 'assertions.json'));\n  if (assertionPatterns) {\n    patterns.assertions = assertionPatterns;\n  }\n\n  const dataPatterns = loadJSON<PatternFile>(join(patternsDir, 'data.json'));\n  if (dataPatterns) {\n    patterns.data = dataPatterns;\n  }\n\n  const authPatterns = loadJSON<PatternFile>(join(patternsDir, 'auth.json'));\n  if (authPatterns) {\n    patterns.auth = authPatterns;\n  }\n\n  return patterns;\n}\n\n/**\n * Load a specific pattern file\n *\n * @param llkbRoot - Root directory of LLKB\n * @param patternName - Name of the pattern file (without .json)\n * @returns Pattern file or null\n */\nexport function loadPatternFile<T extends PatternFile>(\n  llkbRoot: string,\n  patternName: string\n): T | null {\n  const patternPath = join(llkbRoot, 'patterns', `${patternName}.json`);\n  return loadJSON<T>(patternPath);\n}\n\n// =============================================================================\n// Full LLKB Loader\n// =============================================================================\n\n/**\n * Load all LLKB data in one call\n *\n * @param llkbRoot - Root directory of LLKB\n * @returns Complete LLKB data bundle\n */\nexport function loadLLKBData(llkbRoot: string = '.artk/llkb'): LLKBData {\n  return {\n    config: loadLLKBConfig(llkbRoot),\n    appProfile: loadAppProfile(llkbRoot),\n    lessons: loadLessonsFile(llkbRoot),\n    components: loadComponentsFile(llkbRoot),\n    patterns: loadPatterns(llkbRoot),\n    discoveredPatterns: loadDiscoveredPatternsFromFile(llkbRoot),\n  };\n}\n\n/**\n * Check if LLKB exists at the given path\n *\n * @param llkbRoot - Root directory to check\n * @returns True if LLKB structure exists\n */\nexport function llkbExists(llkbRoot: string = '.artk/llkb'): boolean {\n  return existsSync(llkbRoot) && existsSync(join(llkbRoot, 'config.yml'));\n}\n\n/**\n * Get list of all pattern file names in the patterns directory\n *\n * @param llkbRoot - Root directory of LLKB\n * @returns Array of pattern file names (without .json extension)\n */\nexport function getPatternFileNames(llkbRoot: string = '.artk/llkb'): string[] {\n  const patternsDir = join(llkbRoot, 'patterns');\n\n  if (!existsSync(patternsDir)) {\n    return [];\n  }\n\n  try {\n    return readdirSync(patternsDir)\n      .filter((f) => f.endsWith('.json'))\n      .map((f) => f.replace('.json', ''));\n  } catch {\n    return [];\n  }\n}\n","/**\n * @fileoverview LLKB Module Constants\n * @module @artk/core/llkb/constants\n *\n * Centralized constants to avoid magic numbers in LLKB module.\n */\n\n// =============================================================================\n// Confidence Thresholds\n// =============================================================================\n\nexport const CONFIDENCE = {\n  DEFAULT_WEIGHT: 0.5,\n  MIN_THRESHOLD: 0.6,\n} as const;\n\n// =============================================================================\n// Timeouts (milliseconds)\n// =============================================================================\n\nexport const TIMEOUTS = {\n  SHORT_MS: 300,\n  MEDIUM_MS: 1000,\n  LONG_MS: 2000,\n} as const;\n\n// =============================================================================\n// Table Display\n// =============================================================================\n\nexport const TABLE = {\n  MAX_WIDTH: 100,\n  COLUMN_WIDTH: 50,\n} as const;\n\n// =============================================================================\n// Time Conversions\n// =============================================================================\n\nexport const TIME = {\n  MS_PER_SECOND: 1000,\n  SECONDS_PER_MINUTE: 60,\n  MINUTES_PER_HOUR: 60,\n  HOURS_PER_DAY: 24,\n} as const;\n\n// =============================================================================\n// Limits\n// =============================================================================\n\nexport const LIMITS = {\n  MAX_RECENT_ITEMS: 5,\n  DEFAULT_RETENTION_DAYS: 30,\n} as const;\n\n// =============================================================================\n// Percentages\n// =============================================================================\n\nexport const PERCENTAGES = {\n  FULL: 100,\n} as const;\n","/**\n * LLKB Adapter Transform Functions\n *\n * This module provides functions to transform LLKB data structures\n * (lessons, components) into AutoGen-compatible formats.\n *\n * @module llkb/adapter-transforms\n */\n\nimport type { Component, Lesson } from './types.js';\nimport type {\n  AdditionalPattern,\n  GlossaryEntry,\n  IRPrimitive,\n  ModuleMapping,\n  PatternSource,\n  SelectorOverride,\n  TimingHint,\n} from './adapter-types.js';\nimport { CONFIDENCE, TIMEOUTS } from './constants.js';\n\n// =============================================================================\n// Category to Primitive Type Mapping\n// =============================================================================\n\n/**\n * Map LLKB categories to IR primitive types\n */\nfunction categoryToPrimitiveType(\n  category: string\n): 'callModule' | 'click' | 'fill' | 'navigate' | 'wait' | 'assert' {\n  switch (category) {\n    case 'navigation':\n      return 'navigate';\n    case 'timing':\n      return 'wait';\n    case 'assertion':\n      return 'assert';\n    case 'selector':\n    case 'ui-interaction':\n      return 'click';\n    default:\n      return 'callModule';\n  }\n}\n\n/**\n * Infer module name from component category\n */\nfunction inferModuleFromCategory(category: string): string {\n  switch (category) {\n    case 'selector':\n      return 'selectors';\n    case 'timing':\n      return 'timing';\n    case 'auth':\n      return 'auth';\n    case 'data':\n      return 'data';\n    case 'assertion':\n      return 'assertions';\n    case 'navigation':\n      return 'navigation';\n    case 'ui-interaction':\n      return 'ui';\n    default:\n      return 'helpers';\n  }\n}\n\n// =============================================================================\n// Trigger to Regex Conversion\n// =============================================================================\n\n/**\n * Convert a lesson trigger phrase into a regex pattern\n *\n * This is heuristic-based: it takes the trigger description and\n * attempts to create a flexible regex that matches similar phrases.\n *\n * @param trigger - The trigger phrase from the lesson\n * @returns Regex pattern string or null if conversion fails\n */\nexport function triggerToRegex(trigger: string): string | null {\n  if (!trigger || trigger.trim().length === 0) {\n    return null;\n  }\n\n  // Escape special regex characters first\n  let pattern = trigger\n    .replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&')\n    // Make common variations optional\n    .replace(/\\\\bthe\\\\b/gi, '(?:the\\\\s+)?')\n    .replace(/\\\\ba\\\\b/gi, '(?:a\\\\s+)?')\n    .replace(/\\\\ban\\\\b/gi, '(?:an\\\\s+)?');\n\n  // Allow flexible whitespace\n  pattern = pattern.replace(/\\s+/g, '\\\\s+');\n\n  // Make it case-insensitive compatible\n  pattern = `(?i)${pattern}`;\n\n  return pattern;\n}\n\n/**\n * Convert component name to a trigger pattern\n *\n * @param name - The component function name (e.g., \"waitForAgGridLoad\")\n * @returns Natural language trigger pattern\n */\nexport function componentNameToTrigger(name: string): string {\n  // Split camelCase into words\n  const words = name\n    .replace(/([A-Z])/g, ' $1')\n    .replace(/([a-z])([A-Z])/g, '$1 $2')\n    .toLowerCase()\n    .trim()\n    .split(/\\s+/);\n\n  // Build flexible regex pattern\n  const pattern = words\n    .map((word) => {\n      // Handle common abbreviations\n      if (word === 'ag' || word === 'aggrid') {\n        return '(?:ag-?)?grid';\n      }\n      return word;\n    })\n    .join('\\\\s+');\n\n  return `(?:${pattern})`;\n}\n\n/**\n * Generate natural language variations for a component name\n *\n * @param name - The component function name\n * @returns Array of natural language phrases\n */\nexport function generateNameVariations(name: string): string[] {\n  const variations: string[] = [];\n\n  // Split camelCase into words\n  const words = name\n    .replace(/([A-Z])/g, ' $1')\n    .replace(/([a-z])([A-Z])/g, '$1 $2')\n    .toLowerCase()\n    .trim();\n\n  // Add the basic form\n  variations.push(words);\n\n  // Add \"the\" prefix form\n  variations.push(`the ${words}`);\n\n  // Handle special cases\n  if (words.includes('grid')) {\n    variations.push(words.replace('grid', 'ag-grid'));\n    variations.push(words.replace('grid', 'ag grid'));\n  }\n\n  if (words.includes('wait for')) {\n    // \"wait for X to load\" -> \"X loads\"\n    const afterWaitFor = words.replace('wait for ', '').replace(' to load', '');\n    variations.push(`${afterWaitFor} loads`);\n    variations.push(`${afterWaitFor} is loaded`);\n  }\n\n  return [...new Set(variations)]; // Remove duplicates\n}\n\n// =============================================================================\n// Lesson Transform Functions\n// =============================================================================\n\n/**\n * Transform a lesson into an additional pattern for AutoGen\n *\n * Only applicable to lessons in certain categories that have\n * clear trigger patterns that can be converted to regex.\n *\n * @param lesson - The lesson to transform\n * @returns AdditionalPattern or null if not applicable\n */\nexport function lessonToPattern(lesson: Lesson): AdditionalPattern | null {\n  // Only certain categories can become patterns\n  const patternCategories = ['selector', 'timing', 'navigation', 'ui-interaction'];\n\n  if (!patternCategories.includes(lesson.category)) {\n    return null;\n  }\n\n  // Require minimum confidence\n  if (lesson.metrics.confidence < CONFIDENCE.DEFAULT_WEIGHT) {\n    return null;\n  }\n\n  // Try to convert trigger to regex\n  const regex = triggerToRegex(lesson.trigger);\n  if (!regex) {\n    return null;\n  }\n\n  const source: PatternSource = {\n    lessonId: lesson.id,\n    confidence: lesson.metrics.confidence,\n    occurrences: lesson.metrics.occurrences,\n  };\n\n  return {\n    name: `llkb-${lesson.id.toLowerCase()}`,\n    regex,\n    primitiveType: categoryToPrimitiveType(lesson.category),\n    source,\n  };\n}\n\n/**\n * Transform a lesson into a selector override\n *\n * Applicable to lessons in the 'selector' category that describe\n * specific selector patterns or fixes.\n *\n * @param lesson - The lesson to transform\n * @returns SelectorOverride or null if not applicable\n */\nexport function lessonToSelectorOverride(lesson: Lesson): SelectorOverride | null {\n  if (lesson.category !== 'selector') {\n    return null;\n  }\n\n  // Look for selector patterns in the lesson pattern\n  const pattern = lesson.pattern;\n\n  // Try to extract selector strategy and value from pattern\n  // Common patterns: \"use data-testid\", \"use role\", \"use label\"\n  const testIdMatch = pattern.match(/data-testid[=:]\\s*[\"']?([^\"'\\s]+)[\"']?/i);\n  const roleMatch = pattern.match(/role[=:]\\s*[\"']?([^\"'\\s]+)[\"']?/i);\n  const labelMatch = pattern.match(/aria-label[=:]\\s*[\"']?([^\"'\\s]+)[\"']?/i);\n\n  let strategy: 'testid' | 'role' | 'label' | 'css' | 'xpath' = 'testid';\n  let value = '';\n\n  if (testIdMatch?.[1]) {\n    strategy = 'testid';\n    value = testIdMatch[1];\n  } else if (roleMatch?.[1]) {\n    strategy = 'role';\n    value = roleMatch[1];\n  } else if (labelMatch?.[1]) {\n    strategy = 'label';\n    value = labelMatch[1];\n  } else {\n    // Cannot extract a valid selector override\n    return null;\n  }\n\n  const source: PatternSource = {\n    lessonId: lesson.id,\n    confidence: lesson.metrics.confidence,\n    occurrences: lesson.metrics.occurrences,\n  };\n\n  return {\n    pattern: lesson.trigger,\n    override: {\n      strategy,\n      value,\n    },\n    source,\n  };\n}\n\n/**\n * Transform a lesson into a timing hint\n *\n * Applicable to lessons in the 'timing' category that describe\n * wait times or delays.\n *\n * @param lesson - The lesson to transform\n * @returns TimingHint or null if not applicable\n */\nexport function lessonToTimingHint(lesson: Lesson): TimingHint | null {\n  if (lesson.category !== 'timing') {\n    return null;\n  }\n\n  // Try to extract wait time from pattern\n  const pattern = lesson.pattern;\n  const waitMatch = pattern.match(/wait\\s*(?:for\\s*)?\\s*(\\d+)\\s*(?:ms|milliseconds?)?/i);\n  const timeoutMatch = pattern.match(/timeout\\s*(?:of\\s*)?\\s*(\\d+)\\s*(?:ms|milliseconds?)?/i);\n  const delayMatch = pattern.match(/delay\\s*(?:of\\s*)?\\s*(\\d+)\\s*(?:ms|milliseconds?)?/i);\n\n  let waitMs = 0;\n\n  if (waitMatch?.[1]) {\n    waitMs = parseInt(waitMatch[1], 10);\n  } else if (timeoutMatch?.[1]) {\n    waitMs = parseInt(timeoutMatch[1], 10);\n  } else if (delayMatch?.[1]) {\n    waitMs = parseInt(delayMatch[1], 10);\n  }\n\n  // If no explicit time found, use a sensible default based on pattern keywords\n  if (waitMs === 0) {\n    if (pattern.toLowerCase().includes('animation')) {\n      waitMs = TIMEOUTS.SHORT_MS;\n    } else if (pattern.toLowerCase().includes('load')) {\n      waitMs = TIMEOUTS.MEDIUM_MS;\n    } else if (pattern.toLowerCase().includes('network')) {\n      waitMs = TIMEOUTS.LONG_MS;\n    } else {\n      // Cannot determine timing\n      return null;\n    }\n  }\n\n  const source: PatternSource = {\n    lessonId: lesson.id,\n    confidence: lesson.metrics.confidence,\n    occurrences: lesson.metrics.occurrences,\n  };\n\n  return {\n    trigger: lesson.trigger,\n    waitMs,\n    source,\n  };\n}\n\n// =============================================================================\n// Component Transform Functions\n// =============================================================================\n\n/**\n * Transform a component into a module mapping\n *\n * @param component - The component to transform\n * @returns ModuleMapping\n */\nexport function componentToModule(component: Component): ModuleMapping {\n  const trigger = componentNameToTrigger(component.name);\n\n  return {\n    name: component.name,\n    trigger,\n    componentId: component.id,\n    importPath: component.filePath,\n    confidence: component.metrics.successRate,\n  };\n}\n\n/**\n * Transform a component into glossary entries\n *\n * Generates multiple glossary entries for natural language variations\n * that map to the same component.\n *\n * @param component - The component to transform\n * @returns Array of [phrase, primitive] tuples\n */\nexport function componentToGlossaryEntries(\n  component: Component\n): GlossaryEntry[] {\n  const entries: GlossaryEntry[] = [];\n  const variations = generateNameVariations(component.name);\n  const moduleName = inferModuleFromCategory(component.category);\n\n  const primitive: IRPrimitive = {\n    type: 'callModule',\n    module: moduleName,\n    method: component.name,\n  };\n\n  for (const phrase of variations) {\n    entries.push({\n      phrase,\n      primitive,\n      sourceId: component.id,\n      confidence: component.metrics.successRate,\n    });\n  }\n\n  return entries;\n}\n\n/**\n * Transform a lesson into glossary entries\n *\n * @param lesson - The lesson to transform\n * @returns Array of GlossaryEntry or empty if not applicable\n */\nexport function lessonToGlossaryEntries(lesson: Lesson): GlossaryEntry[] {\n  // Only certain categories make sense as glossary entries\n  const glossaryCategories = ['navigation', 'ui-interaction', 'assertion'];\n\n  if (!glossaryCategories.includes(lesson.category)) {\n    return [];\n  }\n\n  const primitive: IRPrimitive = {\n    type: categoryToPrimitiveType(lesson.category),\n  };\n\n  // Generate a phrase from the trigger\n  const phrase = lesson.trigger.toLowerCase().trim();\n\n  if (!phrase) {\n    return [];\n  }\n\n  return [\n    {\n      phrase,\n      primitive,\n      sourceId: lesson.id,\n      confidence: lesson.metrics.confidence,\n    },\n  ];\n}\n","/**\n * LLKB Adapter Module\n *\n * Main adapter module that exports LLKB knowledge for AutoGen consumption.\n * Generates configuration files and glossary files that AutoGen can use\n * to enhance test generation with learned patterns and components.\n *\n * @module llkb/adapter\n */\n\nimport { existsSync, mkdirSync, writeFileSync } from 'node:fs';\nimport { join } from 'node:path';\nimport { stringify as yamlStringify } from 'yaml';\nimport { llkbExists, loadComponents, loadLessons, loadLLKBConfig } from './loaders.js';\nimport {\n  componentToGlossaryEntries,\n  componentToModule,\n  lessonToGlossaryEntries,\n  lessonToPattern,\n  lessonToSelectorOverride,\n  lessonToTimingHint,\n} from './adapter-transforms.js';\nimport type {\n  AdditionalPattern,\n  AutogenLLKBConfig,\n  ExportStats,\n  GlossaryEntry,\n  GlossaryMeta,\n  LLKBAdapterConfig,\n  LLKBAdapterResult,\n  ModuleMapping,\n  SelectorOverride,\n  TimingHint,\n} from './adapter-types.js';\nimport type { LLKBCategory, LLKBScope } from './types.js';\n\n// =============================================================================\n// Constants\n// =============================================================================\n\n/** Default minimum confidence threshold */\nconst DEFAULT_MIN_CONFIDENCE = 0.7;\n\n/** Default LLKB root directory */\nconst DEFAULT_LLKB_ROOT = '.artk/llkb';\n\n/** Current LLKB version */\nconst LLKB_VERSION = '1.0.0';\n\n// =============================================================================\n// Main Export Function\n// =============================================================================\n\n/**\n * Export LLKB knowledge for AutoGen consumption\n *\n * This is the main entry point for the adapter. It reads LLKB data,\n * transforms it into AutoGen-compatible formats, and writes the output files.\n *\n * @param config - Adapter configuration\n * @returns Export result with paths and statistics\n *\n * @example\n * ```typescript\n * const result = await exportForAutogen({\n *   outputDir: './artk-e2e/',\n *   minConfidence: 0.7,\n * });\n *\n * console.log(`Exported ${result.stats.patternsExported} patterns`);\n * console.log(`Config: ${result.configPath}`);\n * console.log(`Glossary: ${result.glossaryPath}`);\n * ```\n */\nexport function exportForAutogen(\n  config: LLKBAdapterConfig\n): LLKBAdapterResult {\n  const {\n    llkbRoot = DEFAULT_LLKB_ROOT,\n    outputDir,\n    minConfidence = DEFAULT_MIN_CONFIDENCE,\n    includeCategories,\n    includeScopes,\n    generateGlossary = true,\n    generateConfig = true,\n    configFormat = 'yaml',\n  } = config;\n\n  const warnings: string[] = [];\n  const exportedAt = new Date().toISOString();\n\n  // Validate LLKB exists\n  if (!llkbExists(llkbRoot)) {\n    return {\n      configPath: null,\n      glossaryPath: null,\n      stats: createEmptyStats(),\n      warnings: [`LLKB not found at ${llkbRoot}. Run /artk.discover-foundation first.`],\n      exportedAt,\n    };\n  }\n\n  // Load LLKB configuration\n  const llkbConfig = loadLLKBConfig(llkbRoot);\n  if (!llkbConfig.enabled) {\n    return {\n      configPath: null,\n      glossaryPath: null,\n      stats: createEmptyStats(),\n      warnings: ['LLKB is disabled in config.yml. Enable it to export.'],\n      exportedAt,\n    };\n  }\n\n  // Ensure output directory exists\n  if (!existsSync(outputDir)) {\n    mkdirSync(outputDir, { recursive: true });\n  }\n\n  // Load lessons and components with filters\n  const lessons = loadLessons(llkbRoot, {\n    category: includeCategories,\n    scope: includeScopes,\n    minConfidence,\n    includeArchived: false,\n  });\n\n  const components = loadComponents(llkbRoot, {\n    category: includeCategories,\n    scope: includeScopes,\n    minConfidence,\n    includeArchived: false,\n  });\n\n  // Count skipped items\n  const allLessons = loadLessons(llkbRoot, { includeArchived: false });\n  const allComponents = loadComponents(llkbRoot, { includeArchived: false });\n  const lessonsSkipped = allLessons.length - lessons.length;\n  const componentsSkipped = allComponents.length - components.length;\n\n  // Transform lessons\n  const patterns: AdditionalPattern[] = [];\n  const selectorOverrides: SelectorOverride[] = [];\n  const timingHints: TimingHint[] = [];\n\n  for (const lesson of lessons) {\n    // Try to convert to pattern\n    const pattern = lessonToPattern(lesson);\n    if (pattern) {\n      patterns.push(pattern);\n    }\n\n    // Try to convert to selector override\n    const selector = lessonToSelectorOverride(lesson);\n    if (selector) {\n      selectorOverrides.push(selector);\n    }\n\n    // Try to convert to timing hint\n    const timing = lessonToTimingHint(lesson);\n    if (timing) {\n      timingHints.push(timing);\n    }\n  }\n\n  // Transform components\n  const modules: ModuleMapping[] = [];\n  const glossaryEntries: GlossaryEntry[] = [];\n  const sourceComponents: string[] = [];\n  const sourceLessons: string[] = [];\n\n  for (const component of components) {\n    const moduleMapping = componentToModule(component);\n    modules.push(moduleMapping);\n    sourceComponents.push(component.id);\n\n    if (generateGlossary) {\n      const entries = componentToGlossaryEntries(component);\n      glossaryEntries.push(...entries);\n    }\n  }\n\n  // Add lesson glossary entries\n  if (generateGlossary) {\n    for (const lesson of lessons) {\n      const entries = lessonToGlossaryEntries(lesson);\n      if (entries.length > 0) {\n        glossaryEntries.push(...entries);\n        sourceLessons.push(lesson.id);\n      }\n    }\n  }\n\n  // Build stats\n  const stats: ExportStats = {\n    patternsExported: patterns.length,\n    selectorsExported: selectorOverrides.length,\n    timingHintsExported: timingHints.length,\n    modulesExported: modules.length,\n    glossaryEntriesExported: glossaryEntries.length,\n    lessonsSkipped,\n    componentsSkipped,\n  };\n\n  // Generate config file\n  let configPath: string | null = null;\n  if (generateConfig) {\n    const autogenConfig: AutogenLLKBConfig = {\n      version: 1,\n      exportedAt,\n      llkbVersion: LLKB_VERSION,\n      minConfidence,\n      additionalPatterns: patterns,\n      selectorOverrides,\n      timingHints,\n      modules,\n    };\n\n    const filename = configFormat === 'yaml' ? 'autogen-llkb.config.yml' : 'autogen-llkb.config.json';\n    configPath = join(outputDir, filename);\n\n    if (configFormat === 'yaml') {\n      writeFileSync(configPath, generateYAML(autogenConfig), 'utf-8');\n    } else {\n      writeFileSync(configPath, JSON.stringify(autogenConfig, null, 2), 'utf-8');\n    }\n  }\n\n  // Generate glossary file\n  let glossaryPath: string | null = null;\n  if (generateGlossary && glossaryEntries.length > 0) {\n    const glossaryMeta: GlossaryMeta = {\n      exportedAt,\n      minConfidence,\n      entryCount: glossaryEntries.length,\n      sourceComponents: [...new Set(sourceComponents)],\n      sourceLessons: [...new Set(sourceLessons)],\n    };\n\n    glossaryPath = join(outputDir, 'llkb-glossary.ts');\n    writeFileSync(glossaryPath, generateGlossaryFile(glossaryEntries, glossaryMeta), 'utf-8');\n  }\n\n  // Add warnings for low export counts\n  if (stats.patternsExported === 0 && stats.modulesExported === 0) {\n    warnings.push('No patterns or modules were exported. Consider lowering minConfidence.');\n  }\n\n  return {\n    configPath,\n    glossaryPath,\n    stats,\n    warnings,\n    exportedAt,\n  };\n}\n\n// =============================================================================\n// Helper Functions\n// =============================================================================\n\n/**\n * Create empty stats object\n */\nfunction createEmptyStats(): ExportStats {\n  return {\n    patternsExported: 0,\n    selectorsExported: 0,\n    timingHintsExported: 0,\n    modulesExported: 0,\n    glossaryEntriesExported: 0,\n    lessonsSkipped: 0,\n    componentsSkipped: 0,\n  };\n}\n\n/**\n * Generate YAML string from AutogenLLKBConfig using yaml library\n *\n * Uses the yaml library to ensure proper escaping and valid YAML output.\n */\nfunction generateYAML(config: AutogenLLKBConfig): string {\n  const header = '# Generated by LLKB Adapter - DO NOT EDIT MANUALLY\\n' +\n                 '# Regenerate with: npx artk-llkb export --for-autogen\\n\\n';\n  return header + yamlStringify(config, { lineWidth: 120 });\n}\n\n/**\n * Generate TypeScript glossary file content\n */\nfunction generateGlossaryFile(entries: GlossaryEntry[], meta: GlossaryMeta): string {\n  const lines: string[] = [\n    '/**',\n    ' * LLKB-Generated Glossary Extension',\n    ` * Generated: ${meta.exportedAt}`,\n    ' * Source: .artk/llkb/',\n    ` * Min Confidence: ${meta.minConfidence}`,\n    ' *',\n    ' * DO NOT EDIT - Regenerate with: npx artk-llkb export --for-autogen',\n    ' */',\n    '',\n    'export interface IRPrimitive {',\n    \"  type: 'callModule' | 'click' | 'fill' | 'navigate' | 'wait' | 'assert';\",\n    '  module?: string;',\n    '  method?: string;',\n    '  params?: Record<string, unknown>;',\n    '}',\n    '',\n    'export const llkbGlossary = new Map<string, IRPrimitive>([',\n  ];\n\n  // Group entries by source for comments\n  const entriesBySource = new Map<string, GlossaryEntry[]>();\n  for (const entry of entries) {\n    const source = entry.sourceId;\n    if (!entriesBySource.has(source)) {\n      entriesBySource.set(source, []);\n    }\n    entriesBySource.get(source)?.push(entry);\n  }\n\n  for (const [sourceId, sourceEntries] of entriesBySource) {\n    const confidence = sourceEntries[0]?.confidence ?? 0;\n    lines.push(`  // From ${sourceId} (confidence: ${confidence.toFixed(2)})`);\n\n    for (const entry of sourceEntries) {\n      const primitiveStr = JSON.stringify(entry.primitive);\n      lines.push(`  [\"${escapeJSString(entry.phrase)}\", ${primitiveStr}],`);\n    }\n    lines.push('');\n  }\n\n  lines.push(']);');\n  lines.push('');\n  lines.push('export const llkbGlossaryMeta = {');\n  lines.push(`  exportedAt: \"${meta.exportedAt}\",`);\n  lines.push(`  minConfidence: ${meta.minConfidence},`);\n  lines.push(`  entryCount: ${meta.entryCount},`);\n  lines.push(`  sourceComponents: ${JSON.stringify(meta.sourceComponents)},`);\n  lines.push(`  sourceLessons: ${JSON.stringify(meta.sourceLessons)},`);\n  lines.push('};');\n  lines.push('');\n\n  return lines.join('\\n');\n}\n\n/**\n * Escape special characters for JavaScript strings\n */\nfunction escapeJSString(str: string): string {\n  return str.replace(/\\\\/g, '\\\\\\\\').replace(/\"/g, '\\\\\"').replace(/\\n/g, '\\\\n');\n}\n\n// =============================================================================\n// Utility Exports\n// =============================================================================\n\n/**\n * Format export result for console output\n *\n * @param result - The export result\n * @returns Formatted string for display\n */\nexport function formatExportResult(result: LLKBAdapterResult): string {\n  const lines: string[] = [];\n\n  lines.push('LLKB Export for AutoGen');\n  lines.push('========================');\n  lines.push(`Exported patterns: ${result.stats.patternsExported}`);\n  lines.push(`Exported selector overrides: ${result.stats.selectorsExported}`);\n  lines.push(`Exported timing hints: ${result.stats.timingHintsExported}`);\n  lines.push(`Exported modules: ${result.stats.modulesExported}`);\n  lines.push(`Generated glossary entries: ${result.stats.glossaryEntriesExported}`);\n  lines.push('');\n\n  if (result.stats.lessonsSkipped > 0 || result.stats.componentsSkipped > 0) {\n    lines.push('Skipped (low confidence):');\n    lines.push(`  Lessons: ${result.stats.lessonsSkipped}`);\n    lines.push(`  Components: ${result.stats.componentsSkipped}`);\n    lines.push('');\n  }\n\n  lines.push('Output files:');\n  if (result.configPath) {\n    lines.push(`  - ${result.configPath}`);\n  }\n  if (result.glossaryPath) {\n    lines.push(`  - ${result.glossaryPath}`);\n  }\n\n  if (result.warnings.length > 0) {\n    lines.push('');\n    lines.push('Warnings:');\n    for (const warning of result.warnings) {\n      lines.push(`  ! ${warning}`);\n    }\n  }\n\n  lines.push('');\n  lines.push(`Export completed at: ${result.exportedAt}`);\n\n  return lines.join('\\n');\n}\n\n// =============================================================================\n// CLI Functions (T005: Add runAdapterCLI Function)\n// =============================================================================\n\n/**\n * Parse command-line arguments for the adapter CLI\n *\n * @param args - Command-line arguments (e.g., process.argv.slice(2))\n * @returns Parsed adapter configuration\n *\n * @example\n * ```typescript\n * const config = parseAdapterArgs(['--output-dir', './artk-e2e', '--min-confidence', '0.8']);\n * ```\n */\nexport function parseAdapterArgs(args: string[]): LLKBAdapterConfig {\n  const config: LLKBAdapterConfig = {\n    outputDir: './artk-e2e',\n    minConfidence: DEFAULT_MIN_CONFIDENCE,\n    generateGlossary: true,\n    generateConfig: true,\n    configFormat: 'yaml',\n  };\n\n  for (let i = 0; i < args.length; i++) {\n    const arg = args[i];\n\n    switch (arg) {\n      case '--output-dir':\n      case '-o':\n        config.outputDir = args[++i] ?? './artk-e2e';\n        break;\n\n      case '--llkb-root':\n        config.llkbRoot = args[++i];\n        break;\n\n      case '--min-confidence':\n        config.minConfidence = parseFloat(args[++i] ?? String(DEFAULT_MIN_CONFIDENCE));\n        break;\n\n      case '--format':\n        config.configFormat = args[++i] === 'json' ? 'json' : 'yaml';\n        break;\n\n      case '--no-glossary':\n        config.generateGlossary = false;\n        break;\n\n      case '--no-config':\n        config.generateConfig = false;\n        break;\n\n      case '--categories':\n        config.includeCategories = args[++i]?.split(',') as LLKBCategory[] | undefined;\n        break;\n\n      case '--scopes':\n        config.includeScopes = args[++i]?.split(',') as LLKBScope[] | undefined;\n        break;\n\n      default:\n        // Ignore unknown arguments\n        break;\n    }\n  }\n\n  return config;\n}\n\n/**\n * Run the adapter CLI (T005: Add runAdapterCLI Function)\n *\n * This is a wrapper function that provides a simple entry point for CLI usage.\n * It parses arguments, runs the export, and formats the output for console display.\n *\n * @param args - Command-line arguments (e.g., process.argv.slice(2))\n * @returns Promise that resolves when export is complete\n *\n * @example\n * ```typescript\n * // In CLI script\n * import { runAdapterCLI } from '@artk/llkb';\n * await runAdapterCLI(process.argv.slice(2));\n * ```\n *\n * @example\n * ```bash\n * # Command-line usage\n * npx artk-llkb export --for-autogen --output-dir ./artk-e2e --min-confidence 0.7\n * ```\n */\nexport function runAdapterCLI(args: string[]): void {\n  const parsed = parseAdapterArgs(args);\n  const result = exportForAutogen(parsed);\n  // eslint-disable-next-line no-console\n  console.log(formatExportResult(result));\n}\n","/**\n * Learning Loop for LLKB\n *\n * Records test generation outcomes back to LLKB for continuous improvement.\n * This module enables the learning loop by tracking:\n * - Pattern validations (selector strategies that worked/failed)\n * - Component usage (reusable modules that were applied)\n * - Lesson applications (knowledge that was used)\n *\n * @module llkb/learning\n */\n\nimport * as path from 'path';\nimport type {\n  ComponentsFile,\n  Lesson,\n  LessonsFile,\n} from './types.js';\nimport { appendToHistory, DEFAULT_LLKB_ROOT } from './history.js';\nimport { updateJSONWithLockSync } from './file-utils.js';\nimport { calculateConfidence } from './confidence.js';\nimport { PERCENTAGES } from './constants.js';\n\n// =============================================================================\n// Input Types\n// =============================================================================\n\n/**\n * Base input for all learning operations\n */\nexport interface LearningInput {\n  /** Journey ID where the learning occurred */\n  journeyId: string;\n\n  /** Test file path */\n  testFile: string;\n\n  /** Source prompt that triggered the learning */\n  prompt: 'journey-implement' | 'journey-verify';\n\n  /** LLKB root directory (optional, defaults to .artk/llkb) */\n  llkbRoot?: string;\n}\n\n/**\n * Input for recording a pattern learned/validated\n */\nexport interface PatternLearnedInput extends LearningInput {\n  /** The step text that triggered the pattern */\n  stepText: string;\n\n  /** The selector that was used */\n  selectorUsed: {\n    strategy: string;\n    value: string;\n  };\n\n  /** Whether the pattern worked successfully */\n  success: boolean;\n}\n\n/**\n * Input for recording a component usage\n */\nexport interface ComponentUsedInput extends LearningInput {\n  /** Component ID that was used */\n  componentId: string;\n\n  /** Whether the component worked successfully */\n  success: boolean;\n}\n\n/**\n * Input for recording a lesson application\n */\nexport interface LessonAppliedInput extends LearningInput {\n  /** Lesson ID that was applied */\n  lessonId: string;\n\n  /** Whether the lesson worked successfully */\n  success: boolean;\n\n  /** Additional context about the application */\n  context?: string;\n}\n\n// =============================================================================\n// Result Types\n// =============================================================================\n\n/**\n * Result of a learning operation\n */\nexport interface LearningResult {\n  /** Whether the learning was recorded successfully */\n  success: boolean;\n\n  /** Error message if failed */\n  error?: string;\n\n  /** Updated metrics (if applicable) */\n  metrics?: {\n    confidence?: number;\n    successRate?: number;\n    occurrences?: number;\n    totalUses?: number;\n  };\n\n  /** ID of the affected entity (lesson or component) */\n  entityId?: string;\n}\n\n// =============================================================================\n// Batch Operations (T006: Add Batch Operations to Learning Module)\n// =============================================================================\n\n/**\n * Base type for batch learning events\n */\ninterface BaseBatchLearningEvent {\n  /** Journey ID where the learning occurred */\n  journeyId: string;\n\n  /** Test file path */\n  testFile: string;\n\n  /** Source prompt that triggered the learning */\n  prompt: 'journey-implement' | 'journey-verify';\n}\n\n/**\n * Batch learning event for components\n */\ninterface BatchComponentEvent extends BaseBatchLearningEvent {\n  type: 'component';\n\n  /** Component ID that was used */\n  componentId: string;\n\n  /** Whether the component worked successfully */\n  success: boolean;\n}\n\n/**\n * Batch learning event for lessons\n */\ninterface BatchLessonEvent extends BaseBatchLearningEvent {\n  type: 'lesson';\n\n  /** Lesson ID that was applied */\n  lessonId: string;\n\n  /** Whether the lesson worked successfully */\n  success: boolean;\n\n  /** Additional context about the application */\n  context?: string;\n}\n\n/**\n * Batch learning event for patterns\n */\ninterface BatchPatternEvent extends BaseBatchLearningEvent {\n  type: 'pattern';\n\n  /** The step text that triggered the pattern */\n  stepText: string;\n\n  /** The selector that was used */\n  selectorUsed: {\n    strategy: string;\n    value: string;\n  };\n\n  /** Whether the pattern worked successfully */\n  success: boolean;\n}\n\n/**\n * Union type for all batch learning events\n */\nexport type BatchLearningEvent = BatchComponentEvent | BatchLessonEvent | BatchPatternEvent;\n\n/**\n * Result of batch learning operation\n */\nexport interface BatchResult {\n  /** Number of events successfully processed */\n  processed: number;\n\n  /** Number of events that failed */\n  failed: number;\n\n  /** Detailed error information for failed events */\n  errors: Array<{\n    /** Index of the failed event in the input array */\n    index: number;\n\n    /** Error message */\n    error: string;\n  }>;\n}\n\n// =============================================================================\n// Helper Functions\n// =============================================================================\n\n/**\n * Calculate new success rate based on existing metrics and new outcome\n */\nfunction calculateNewSuccessRate(\n  currentSuccessRate: number,\n  currentOccurrences: number,\n  newSuccess: boolean\n): number {\n  const totalSuccesses = currentSuccessRate * currentOccurrences;\n  const newSuccesses = newSuccess ? totalSuccesses + 1 : totalSuccesses;\n  const newOccurrences = currentOccurrences + 1;\n  return Math.round((newSuccesses / newOccurrences) * PERCENTAGES.FULL) / PERCENTAGES.FULL;\n}\n\n/**\n * Find a lesson by pattern or trigger match\n */\nfunction findMatchingLesson(\n  lessons: Lesson[],\n  selectorValue: string,\n  stepText: string\n): Lesson | undefined {\n  // Try exact match on selector value first\n  const exactMatch = lessons.find(\n    (l) => !l.archived && l.pattern.includes(selectorValue)\n  );\n  if (exactMatch) {\n    return exactMatch;\n  }\n\n  // Try trigger match\n  const triggerMatch = lessons.find(\n    (l) => !l.archived && l.trigger.toLowerCase().includes(stepText.toLowerCase())\n  );\n  return triggerMatch;\n}\n\n// =============================================================================\n// Main Functions\n// =============================================================================\n\n/**\n * Record that a selector pattern was learned/validated\n *\n * This function is called after test verification to update LLKB with\n * information about which selector patterns worked or failed.\n *\n * @param input - Pattern learning input\n * @returns Learning result with updated metrics\n *\n * @example\n * ```typescript\n * const result = recordPatternLearned({\n *   journeyId: 'JRN-0001',\n *   testFile: 'tests/login.spec.ts',\n *   prompt: 'journey-verify',\n *   stepText: 'Click the Save button',\n *   selectorUsed: { strategy: 'testid', value: 'btn-save' },\n *   success: true,\n * });\n * ```\n */\nexport function recordPatternLearned(input: PatternLearnedInput): LearningResult {\n  const llkbRoot = input.llkbRoot ?? DEFAULT_LLKB_ROOT;\n  const lessonsPath = path.join(llkbRoot, 'lessons.json');\n\n  try {\n    let matchedLessonId: string | undefined;\n    let updatedMetrics: LearningResult['metrics'] | undefined;\n\n    // Update lessons file if lesson exists\n    const updateResult = updateJSONWithLockSync<LessonsFile>(\n      lessonsPath,\n      (data: LessonsFile) => {\n        const existingLesson = findMatchingLesson(\n          data.lessons,\n          input.selectorUsed.value,\n          input.stepText\n        );\n\n        if (existingLesson) {\n          matchedLessonId = existingLesson.id;\n\n          // Update metrics\n          existingLesson.metrics.occurrences++;\n          existingLesson.metrics.lastApplied = new Date().toISOString();\n\n          if (input.success) {\n            existingLesson.metrics.lastSuccess = new Date().toISOString();\n          }\n\n          existingLesson.metrics.successRate = calculateNewSuccessRate(\n            existingLesson.metrics.successRate,\n            existingLesson.metrics.occurrences - 1,\n            input.success\n          );\n\n          existingLesson.metrics.confidence = calculateConfidence(existingLesson);\n\n          // Add journey ID if not present\n          if (!existingLesson.journeyIds.includes(input.journeyId)) {\n            existingLesson.journeyIds.push(input.journeyId);\n          }\n\n          updatedMetrics = {\n            confidence: existingLesson.metrics.confidence,\n            successRate: existingLesson.metrics.successRate,\n            occurrences: existingLesson.metrics.occurrences,\n          };\n        }\n\n        data.lastUpdated = new Date().toISOString();\n        return data;\n      }\n    );\n\n    // Log to history (graceful - doesn't throw on failure)\n    // Only log if we matched a lesson\n    if (matchedLessonId) {\n      appendToHistory(\n        {\n          event: 'lesson_applied',\n          timestamp: new Date().toISOString(),\n          journeyId: input.journeyId,\n          prompt: input.prompt,\n          lessonId: matchedLessonId,\n          success: input.success,\n          context: input.stepText,\n        },\n        llkbRoot\n      );\n    }\n\n    return {\n      success: updateResult.success,\n      error: updateResult.error,\n      metrics: updatedMetrics,\n      entityId: matchedLessonId,\n    };\n  } catch (error) {\n    const message = error instanceof Error ? error.message : String(error);\n    console.warn(`[LLKB] Failed to record pattern learned: ${message}`);\n    return {\n      success: false,\n      error: message,\n    };\n  }\n}\n\n/**\n * Record that a component was used\n *\n * This function is called when a reusable component is used in test generation.\n * It updates the component's usage metrics.\n *\n * @param input - Component usage input\n * @returns Learning result with updated metrics\n *\n * @example\n * ```typescript\n * const result = recordComponentUsed({\n *   journeyId: 'JRN-0001',\n *   testFile: 'tests/login.spec.ts',\n *   prompt: 'journey-implement',\n *   componentId: 'COMP012',\n *   success: true,\n * });\n * ```\n */\nexport function recordComponentUsed(input: ComponentUsedInput): LearningResult {\n  const llkbRoot = input.llkbRoot ?? DEFAULT_LLKB_ROOT;\n  const componentsPath = path.join(llkbRoot, 'components.json');\n\n  try {\n    let foundComponent = false;\n    let updatedMetrics: LearningResult['metrics'] | undefined;\n\n    const updateResult = updateJSONWithLockSync<ComponentsFile>(\n      componentsPath,\n      (data: ComponentsFile) => {\n        const component = data.components.find((c) => c.id === input.componentId);\n\n        if (component && !component.archived) {\n          foundComponent = true;\n\n          // Update metrics\n          component.metrics.totalUses++;\n          component.metrics.lastUsed = new Date().toISOString();\n\n          // Update success rate (for both success and failure)\n          component.metrics.successRate = calculateNewSuccessRate(\n            component.metrics.successRate,\n            component.metrics.totalUses - 1,\n            input.success\n          );\n\n          updatedMetrics = {\n            totalUses: component.metrics.totalUses,\n            successRate: component.metrics.successRate,\n          };\n        }\n\n        data.lastUpdated = new Date().toISOString();\n        return data;\n      }\n    );\n\n    // Log to history\n    appendToHistory(\n      {\n        event: 'component_used',\n        timestamp: new Date().toISOString(),\n        journeyId: input.journeyId,\n        prompt: input.prompt,\n        componentId: input.componentId,\n        success: input.success,\n      },\n      llkbRoot\n    );\n\n    if (!foundComponent) {\n      return {\n        success: false,\n        error: `Component not found: ${input.componentId}`,\n      };\n    }\n\n    return {\n      success: updateResult.success,\n      error: updateResult.error,\n      metrics: updatedMetrics,\n      entityId: input.componentId,\n    };\n  } catch (error) {\n    const message = error instanceof Error ? error.message : String(error);\n    console.warn(`[LLKB] Failed to record component used: ${message}`);\n    return {\n      success: false,\n      error: message,\n    };\n  }\n}\n\n/**\n * Record that a lesson was applied\n *\n * This function is called when a specific lesson is explicitly applied\n * during test generation or verification.\n *\n * @param input - Lesson application input\n * @returns Learning result with updated metrics\n *\n * @example\n * ```typescript\n * const result = recordLessonApplied({\n *   journeyId: 'JRN-0001',\n *   testFile: 'tests/login.spec.ts',\n *   prompt: 'journey-verify',\n *   lessonId: 'L042',\n *   success: true,\n *   context: 'Applied ag-grid wait pattern',\n * });\n * ```\n */\nexport function recordLessonApplied(input: LessonAppliedInput): LearningResult {\n  const llkbRoot = input.llkbRoot ?? DEFAULT_LLKB_ROOT;\n  const lessonsPath = path.join(llkbRoot, 'lessons.json');\n\n  try {\n    let foundLesson = false;\n    let updatedMetrics: LearningResult['metrics'] | undefined;\n\n    const updateResult = updateJSONWithLockSync<LessonsFile>(\n      lessonsPath,\n      (data: LessonsFile) => {\n        const lesson = data.lessons.find((l) => l.id === input.lessonId);\n\n        if (lesson && !lesson.archived) {\n          foundLesson = true;\n\n          // Update metrics\n          lesson.metrics.occurrences++;\n          lesson.metrics.lastApplied = new Date().toISOString();\n\n          if (input.success) {\n            lesson.metrics.lastSuccess = new Date().toISOString();\n          }\n\n          lesson.metrics.successRate = calculateNewSuccessRate(\n            lesson.metrics.successRate,\n            lesson.metrics.occurrences - 1,\n            input.success\n          );\n\n          lesson.metrics.confidence = calculateConfidence(lesson);\n\n          // Add journey ID if not present\n          if (!lesson.journeyIds.includes(input.journeyId)) {\n            lesson.journeyIds.push(input.journeyId);\n          }\n\n          updatedMetrics = {\n            confidence: lesson.metrics.confidence,\n            successRate: lesson.metrics.successRate,\n            occurrences: lesson.metrics.occurrences,\n          };\n        }\n\n        data.lastUpdated = new Date().toISOString();\n        return data;\n      }\n    );\n\n    // Log to history\n    appendToHistory(\n      {\n        event: 'lesson_applied',\n        timestamp: new Date().toISOString(),\n        journeyId: input.journeyId,\n        prompt: input.prompt,\n        lessonId: input.lessonId,\n        success: input.success,\n        context: input.context,\n      },\n      llkbRoot\n    );\n\n    if (!foundLesson) {\n      return {\n        success: false,\n        error: `Lesson not found: ${input.lessonId}`,\n      };\n    }\n\n    return {\n      success: updateResult.success,\n      error: updateResult.error,\n      metrics: updatedMetrics,\n      entityId: input.lessonId,\n    };\n  } catch (error) {\n    const message = error instanceof Error ? error.message : String(error);\n    console.warn(`[LLKB] Failed to record lesson applied: ${message}`);\n    return {\n      success: false,\n      error: message,\n    };\n  }\n}\n\n// =============================================================================\n// CLI Helper Functions\n// =============================================================================\n\n/**\n * Record learning event from CLI\n *\n * This is a convenience function for the CLI that dispatches to the\n * appropriate recording function based on the event type.\n *\n * @param args - CLI arguments\n * @returns Learning result\n *\n * @example\n * ```bash\n * npx artk-llkb learn --type component --id COMP012 --journey JRN-0001 --success\n * npx artk-llkb learn --type lesson --id L042 --journey JRN-0001 --success --context \"grid edit\"\n * npx artk-llkb learn --type pattern --journey JRN-0001 --step \"Click Save\" --selector \"btn-save\" --success\n * ```\n */\nexport function recordLearning(args: {\n  type: 'pattern' | 'component' | 'lesson';\n  journeyId: string;\n  testFile?: string;\n  prompt?: 'journey-implement' | 'journey-verify';\n  id?: string;\n  success: boolean;\n  context?: string;\n  stepText?: string;\n  selectorStrategy?: string;\n  selectorValue?: string;\n  llkbRoot?: string;\n}): LearningResult {\n  const baseInput: LearningInput = {\n    journeyId: args.journeyId,\n    testFile: args.testFile ?? 'unknown',\n    prompt: args.prompt ?? 'journey-verify',\n    llkbRoot: args.llkbRoot,\n  };\n\n  switch (args.type) {\n    case 'pattern':\n      return recordPatternLearned({\n        ...baseInput,\n        stepText: args.stepText ?? args.context ?? '',\n        selectorUsed: {\n          strategy: args.selectorStrategy ?? 'unknown',\n          value: args.selectorValue ?? '',\n        },\n        success: args.success,\n      });\n\n    case 'component':\n      if (!args.id) {\n        return {\n          success: false,\n          error: 'Component ID is required for component learning',\n        };\n      }\n      return recordComponentUsed({\n        ...baseInput,\n        componentId: args.id,\n        success: args.success,\n      });\n\n    case 'lesson':\n      if (!args.id) {\n        return {\n          success: false,\n          error: 'Lesson ID is required for lesson learning',\n        };\n      }\n      return recordLessonApplied({\n        ...baseInput,\n        lessonId: args.id,\n        success: args.success,\n        context: args.context,\n      });\n\n    default:\n      // Exhaustive check - should never reach here if all types are handled\n      return {\n        success: false,\n        error: `Unknown learning type: ${args.type as string}`,\n      };\n  }\n}\n\n/**\n * Format learning result for console output\n */\nexport function formatLearningResult(result: LearningResult): string {\n  const lines: string[] = [];\n\n  if (result.success) {\n    lines.push('Learning recorded successfully');\n    if (result.entityId) {\n      lines.push(`  Entity: ${result.entityId}`);\n    }\n    if (result.metrics) {\n      lines.push('  Updated metrics:');\n      if (result.metrics.confidence !== undefined) {\n        lines.push(`    - Confidence: ${result.metrics.confidence}`);\n      }\n      if (result.metrics.successRate !== undefined) {\n        lines.push(`    - Success Rate: ${result.metrics.successRate}`);\n      }\n      if (result.metrics.occurrences !== undefined) {\n        lines.push(`    - Occurrences: ${result.metrics.occurrences}`);\n      }\n      if (result.metrics.totalUses !== undefined) {\n        lines.push(`    - Total Uses: ${result.metrics.totalUses}`);\n      }\n    }\n  } else {\n    lines.push('Learning recording failed');\n    if (result.error) {\n      lines.push(`  Error: ${result.error}`);\n    }\n  }\n\n  return lines.join('\\n');\n}\n\n/**\n * Record multiple learning events in a single atomic operation (T006)\n *\n * This function processes multiple learning events (component, lesson, pattern)\n * in a single file operation for improved performance. It performs atomic updates\n * with a single file read and single file write.\n *\n * All events in the batch must succeed or all fail (atomic operation).\n *\n * @param events - Array of learning events to record\n * @param llkbRoot - LLKB root directory (optional, defaults to .artk/llkb)\n * @returns Batch result with processed/failed counts\n *\n * @example\n * ```typescript\n * const events: BatchLearningEvent[] = [\n *   {\n *     type: 'component',\n *     journeyId: 'JRN-0001',\n *     testFile: 'tests/login.spec.ts',\n *     prompt: 'journey-implement',\n *     componentId: 'COMP012',\n *     success: true,\n *   },\n *   {\n *     type: 'lesson',\n *     journeyId: 'JRN-0001',\n *     testFile: 'tests/login.spec.ts',\n *     prompt: 'journey-verify',\n *     lessonId: 'L042',\n *     success: true,\n *     context: 'Applied ag-grid wait pattern',\n *   },\n * ];\n *\n * const result = recordBatch(events);\n * console.log(`Processed: ${result.processed}, Failed: ${result.failed}`);\n * ```\n */\nexport function recordBatch(\n  events: BatchLearningEvent[],\n  llkbRoot?: string\n): BatchResult {\n  const root = llkbRoot ?? DEFAULT_LLKB_ROOT;\n  const lessonsPath = path.join(root, 'lessons.json');\n  const componentsPath = path.join(root, 'components.json');\n\n  const result: BatchResult = {\n    processed: 0,\n    failed: 0,\n    errors: [],\n  };\n\n  // Validate input\n  if (events.length === 0) {\n    return result;\n  }\n\n  try {\n    // Group events by type for efficient processing\n    const componentEvents = events.filter((e): e is BatchComponentEvent => e.type === 'component');\n    const lessonEvents = events.filter((e): e is BatchLessonEvent | BatchPatternEvent =>\n      e.type === 'lesson' || e.type === 'pattern'\n    );\n\n    // Process component events (single file operation)\n    if (componentEvents.length > 0) {\n      const componentResult = updateJSONWithLockSync<ComponentsFile>(\n        componentsPath,\n        (data: ComponentsFile) => {\n          for (const event of componentEvents) {\n            const component = data.components.find((c) => c.id === event.componentId);\n\n            if (component && !component.archived) {\n              // Update metrics\n              component.metrics.totalUses++;\n              component.metrics.lastUsed = new Date().toISOString();\n\n              // Update success rate\n              component.metrics.successRate = calculateNewSuccessRate(\n                component.metrics.successRate,\n                component.metrics.totalUses - 1,\n                event.success\n              );\n            }\n          }\n\n          data.lastUpdated = new Date().toISOString();\n          return data;\n        }\n      );\n\n      if (!componentResult.success) {\n        // Atomic failure - all or nothing\n        return {\n          processed: 0,\n          failed: events.length,\n          errors: [{ index: 0, error: componentResult.error ?? 'Component batch update failed' }],\n        };\n      }\n\n      result.processed += componentEvents.length;\n    }\n\n    // Process lesson/pattern events (single file operation)\n    if (lessonEvents.length > 0) {\n      const lessonResult = updateJSONWithLockSync<LessonsFile>(\n        lessonsPath,\n        (data: LessonsFile) => {\n          for (const event of lessonEvents) {\n            let lesson: Lesson | undefined;\n\n            if (event.type === 'lesson') {\n              lesson = data.lessons.find((l) => l.id === event.lessonId);\n            } else if (event.type === 'pattern') {\n              lesson = findMatchingLesson(\n                data.lessons,\n                event.selectorUsed.value,\n                event.stepText\n              );\n            }\n\n            if (lesson && !lesson.archived) {\n              // Update metrics\n              lesson.metrics.occurrences++;\n              lesson.metrics.lastApplied = new Date().toISOString();\n\n              if (event.success) {\n                lesson.metrics.lastSuccess = new Date().toISOString();\n              }\n\n              lesson.metrics.successRate = calculateNewSuccessRate(\n                lesson.metrics.successRate,\n                lesson.metrics.occurrences - 1,\n                event.success\n              );\n\n              lesson.metrics.confidence = calculateConfidence(lesson);\n\n              // Add journey ID if not present\n              if (!lesson.journeyIds.includes(event.journeyId)) {\n                lesson.journeyIds.push(event.journeyId);\n              }\n            }\n          }\n\n          data.lastUpdated = new Date().toISOString();\n          return data;\n        }\n      );\n\n      if (!lessonResult.success) {\n        // Atomic failure - rollback component changes not possible, report failure\n        return {\n          processed: componentEvents.length, // Component updates succeeded\n          failed: lessonEvents.length,\n          errors: [{ index: componentEvents.length, error: lessonResult.error ?? 'Lesson batch update failed' }],\n        };\n      }\n\n      result.processed += lessonEvents.length;\n    }\n\n    // Log all events to history (graceful - doesn't affect success)\n    for (let i = 0; i < events.length; i++) {\n      const event = events[i];\n\n      if (!event) {\n        continue;\n      }\n\n      try {\n        if (event.type === 'component') {\n          appendToHistory(\n            {\n              event: 'component_used',\n              timestamp: new Date().toISOString(),\n              journeyId: event.journeyId,\n              prompt: event.prompt,\n              componentId: event.componentId,\n              success: event.success,\n            },\n            root\n          );\n        } else if (event.type === 'lesson') {\n          appendToHistory(\n            {\n              event: 'lesson_applied',\n              timestamp: new Date().toISOString(),\n              journeyId: event.journeyId,\n              prompt: event.prompt,\n              lessonId: event.lessonId,\n              success: event.success,\n              context: event.context,\n            },\n            root\n          );\n        } else if (event.type === 'pattern') {\n          // Pattern events don't have explicit lesson IDs, so we skip history logging\n          // unless we matched a lesson\n        }\n      } catch {\n        // History logging is non-fatal\n      }\n    }\n\n    return result;\n  } catch (error) {\n    const message = error instanceof Error ? error.message : String(error);\n    return {\n      processed: 0,\n      failed: events.length,\n      errors: [{ index: 0, error: `Batch operation failed: ${message}` }],\n    };\n  }\n}\n","/**\n * LLKB Version Tracking Module\n *\n * Provides functions to track LLKB versions in generated tests and detect\n * when tests need updating due to new LLKB knowledge.\n *\n * @module llkb/versioning\n */\n\nimport * as fs from 'fs';\nimport * as path from 'path';\nimport type { AnalyticsFile, ComponentsFile, LessonsFile } from './types.js';\nimport { loadJSON } from './file-utils.js';\nimport { LIMITS, TABLE, TIME } from './constants.js';\n\n/**\n * Default LLKB root directory\n */\nconst DEFAULT_LLKB_ROOT = '.artk/llkb';\n\n/**\n * Version comparison result\n */\nexport interface VersionComparison {\n  /** LLKB version from the test file header (ISO timestamp or null if not found) */\n  testLlkbVersion: string | null;\n\n  /** Current LLKB version (lastUpdated from analytics.json) */\n  currentLlkbVersion: string;\n\n  /** Whether the test is outdated (LLKB has newer knowledge) */\n  isOutdated: boolean;\n\n  /** Number of days since the test was generated */\n  daysSinceUpdate: number;\n\n  /** Number of new patterns (lessons) available since test was generated */\n  newPatternsAvailable: number;\n\n  /** Number of new components available since test was generated */\n  newComponentsAvailable: number;\n\n  /** Recommendation for the user */\n  recommendation: 'update' | 'skip' | 'review';\n}\n\n/**\n * Result of checking updates for multiple tests\n */\nexport interface UpdateCheckResult {\n  /** Tests that need updating */\n  outdated: Array<{\n    testFile: string;\n    comparison: VersionComparison;\n  }>;\n\n  /** Tests that are up to date */\n  upToDate: Array<{\n    testFile: string;\n    comparison: VersionComparison;\n  }>;\n\n  /** Tests that couldn't be read or parsed */\n  errors: Array<{\n    testFile: string;\n    error: string;\n  }>;\n\n  /** Summary statistics */\n  summary: {\n    total: number;\n    outdated: number;\n    upToDate: number;\n    errors: number;\n    recommendation: string;\n  };\n}\n\n/**\n * Extract @llkb-version from test file content\n *\n * Looks for JSDoc-style comment: @llkb-version 2026-01-23T10:00:00Z\n *\n * @param testContent - Content of the test file\n * @returns ISO timestamp string or null if not found\n *\n * @example\n * ```typescript\n * const content = `\n *   // @llkb-version 2026-01-23T10:00:00Z\n *   import { test } from '@playwright/test';\n * `;\n * const version = extractLlkbVersionFromTest(content);\n * // version === '2026-01-23T10:00:00Z'\n * ```\n */\nexport function extractLlkbVersionFromTest(testContent: string): string | null {\n  // Match @llkb-version followed by an ISO timestamp\n  // Supports various comment styles: // @llkb-version, * @llkb-version\n  const match = testContent.match(/@llkb-version\\s+(\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(?:\\.\\d+)?Z?)/);\n  return match ? match[1] ?? null : null;\n}\n\n/**\n * Extract @llkb-entries count from test file content\n *\n * @param testContent - Content of the test file\n * @returns Entry count or null if not found\n */\nexport function extractLlkbEntriesFromTest(testContent: string): number | null {\n  const match = testContent.match(/@llkb-entries\\s+(\\d+)/);\n  return match ? parseInt(match[1] ?? '0', 10) : null;\n}\n\n/**\n * Update @llkb-version header in test content\n *\n * If the header exists, updates it. If not, adds it after @timestamp.\n *\n * @param testContent - Original test file content\n * @param newVersion - New LLKB version (ISO timestamp)\n * @param entryCount - Optional entry count to update\n * @returns Updated test content\n *\n * @example\n * ```typescript\n * const updated = updateTestLlkbVersion(content, '2026-01-23T15:00:00Z', 24);\n * ```\n */\nexport function updateTestLlkbVersion(\n  testContent: string,\n  newVersion: string,\n  entryCount?: number\n): string {\n  let result = testContent;\n\n  // Update or add @llkb-version\n  const versionRegex = /(@llkb-version\\s+)\\S+/;\n  if (versionRegex.test(result)) {\n    result = result.replace(versionRegex, `$1${newVersion}`);\n  } else {\n    // Add after @timestamp line if it exists\n    const timestampRegex = /(@timestamp\\s+\\S+)/;\n    if (timestampRegex.test(result)) {\n      result = result.replace(timestampRegex, `$1\\n * @llkb-version ${newVersion}`);\n    }\n  }\n\n  // Update or add @llkb-entries if count provided\n  if (entryCount !== undefined) {\n    const entriesRegex = /(@llkb-entries\\s+)\\d+/;\n    if (entriesRegex.test(result)) {\n      result = result.replace(entriesRegex, `$1${entryCount}`);\n    } else {\n      // Add after @llkb-version if it exists\n      const llkbVersionRegex = /(@llkb-version\\s+\\S+)/;\n      if (llkbVersionRegex.test(result)) {\n        result = result.replace(llkbVersionRegex, `$1\\n * @llkb-entries ${entryCount}`);\n      }\n    }\n  }\n\n  return result;\n}\n\n/**\n * Get current LLKB version from analytics\n *\n * @param llkbRoot - LLKB root directory\n * @returns Current LLKB version (lastUpdated timestamp) or current time if not found\n */\nexport function getCurrentLlkbVersion(llkbRoot: string = DEFAULT_LLKB_ROOT): string {\n  const analyticsPath = path.join(llkbRoot, 'analytics.json');\n\n  try {\n    const analytics = loadJSON<AnalyticsFile>(analyticsPath);\n    if (analytics?.lastUpdated) {\n      return analytics.lastUpdated;\n    }\n  } catch {\n    // Fall through to default\n  }\n\n  // Fall back to current time if analytics not available\n  return new Date().toISOString();\n}\n\n/**\n * Count new entries (lessons or components) added since a given timestamp\n *\n * @param sinceTimestamp - ISO timestamp to compare against (or null for all entries)\n * @param type - Type of entries to count ('lessons' or 'components')\n * @param llkbRoot - LLKB root directory\n * @returns Number of new entries since the timestamp\n *\n * @example\n * ```typescript\n * const newLessons = countNewEntriesSince('2026-01-15T00:00:00Z', 'lessons');\n * console.log(`${newLessons} new lessons since Jan 15`);\n * ```\n */\nexport function countNewEntriesSince(\n  sinceTimestamp: string | null,\n  type: 'lessons' | 'components',\n  llkbRoot: string = DEFAULT_LLKB_ROOT\n): number {\n  // If no timestamp, return 0 (nothing is \"new\" relative to nothing)\n  if (!sinceTimestamp) {\n    return 0;\n  }\n\n  const sinceDate = new Date(sinceTimestamp);\n\n  if (type === 'lessons') {\n    const lessonsPath = path.join(llkbRoot, 'lessons.json');\n    try {\n      const lessons = loadJSON<LessonsFile>(lessonsPath);\n      if (!lessons?.lessons) {return 0;}\n\n      return lessons.lessons.filter((lesson) => {\n        const firstSeen = lesson.metrics.firstSeen;\n        if (!firstSeen) {return false;}\n        return new Date(firstSeen) > sinceDate;\n      }).length;\n    } catch {\n      return 0;\n    }\n  } else {\n    const componentsPath = path.join(llkbRoot, 'components.json');\n    try {\n      const components = loadJSON<ComponentsFile>(componentsPath);\n      if (!components?.components) {return 0;}\n\n      return components.components.filter((component) => {\n        const extractedAt = component.source?.extractedAt;\n        if (!extractedAt) {return false;}\n        return new Date(extractedAt) > sinceDate;\n      }).length;\n    } catch {\n      return 0;\n    }\n  }\n}\n\n/**\n * Compare a test file's LLKB version with current LLKB state\n *\n * @param testFilePath - Path to the test file\n * @param llkbRoot - LLKB root directory\n * @returns Comparison result with recommendation\n *\n * @example\n * ```typescript\n * const comparison = compareVersions('tests/login.spec.ts');\n * if (comparison.isOutdated) {\n *   console.log(`Test has ${comparison.newPatternsAvailable} new patterns available`);\n *   console.log(`Recommendation: ${comparison.recommendation}`);\n * }\n * ```\n */\nexport function compareVersions(\n  testFilePath: string,\n  llkbRoot: string = DEFAULT_LLKB_ROOT\n): VersionComparison {\n  // Read test file\n  const testContent = fs.readFileSync(testFilePath, 'utf-8');\n\n  // Extract LLKB version from test\n  const testLlkbVersion = extractLlkbVersionFromTest(testContent);\n\n  // Get current LLKB version\n  const currentLlkbVersion = getCurrentLlkbVersion(llkbRoot);\n\n  // Calculate if outdated\n  const isOutdated = !testLlkbVersion ||\n    new Date(testLlkbVersion) < new Date(currentLlkbVersion);\n\n  // Calculate days since update\n  const daysSinceUpdate = testLlkbVersion\n    ? Math.floor((Date.now() - new Date(testLlkbVersion).getTime()) / (TIME.MS_PER_SECOND * TIME.SECONDS_PER_MINUTE * TIME.MINUTES_PER_HOUR * TIME.HOURS_PER_DAY))\n    : Infinity;\n\n  // Count new entries since test version\n  const newPatternsAvailable = countNewEntriesSince(testLlkbVersion, 'lessons', llkbRoot);\n  const newComponentsAvailable = countNewEntriesSince(testLlkbVersion, 'components', llkbRoot);\n\n  // Determine recommendation\n  let recommendation: 'update' | 'skip' | 'review' = 'skip';\n\n  if (isOutdated && (newPatternsAvailable > LIMITS.MAX_RECENT_ITEMS || newComponentsAvailable > 2)) {\n    recommendation = 'update';\n  } else if (isOutdated && daysSinceUpdate > LIMITS.DEFAULT_RETENTION_DAYS) {\n    recommendation = 'review';\n  } else if (newPatternsAvailable > 0 || newComponentsAvailable > 0) {\n    recommendation = 'review';\n  }\n\n  return {\n    testLlkbVersion,\n    currentLlkbVersion,\n    isOutdated,\n    daysSinceUpdate,\n    newPatternsAvailable,\n    newComponentsAvailable,\n    recommendation,\n  };\n}\n\n/**\n * Check multiple test files for LLKB updates\n *\n * @param testsDir - Directory containing test files\n * @param llkbRoot - LLKB root directory\n * @param pattern - Glob pattern for test files (default: *.spec.ts)\n * @returns Update check result with categorized tests\n *\n * @example\n * ```typescript\n * const result = checkUpdates('artk-e2e/tests/');\n * console.log(`${result.summary.outdated} tests need updating`);\n * ```\n */\nexport function checkUpdates(\n  testsDir: string,\n  llkbRoot: string = DEFAULT_LLKB_ROOT,\n  pattern: string = '*.spec.ts'\n): UpdateCheckResult {\n  const result: UpdateCheckResult = {\n    outdated: [],\n    upToDate: [],\n    errors: [],\n    summary: {\n      total: 0,\n      outdated: 0,\n      upToDate: 0,\n      errors: 0,\n      recommendation: '',\n    },\n  };\n\n  // Find test files\n  if (!fs.existsSync(testsDir)) {\n    return result;\n  }\n\n  const testFiles = findTestFiles(testsDir, pattern);\n  result.summary.total = testFiles.length;\n\n  for (const testFile of testFiles) {\n    try {\n      const comparison = compareVersions(testFile, llkbRoot);\n\n      if (comparison.isOutdated) {\n        result.outdated.push({ testFile, comparison });\n        result.summary.outdated++;\n      } else {\n        result.upToDate.push({ testFile, comparison });\n        result.summary.upToDate++;\n      }\n    } catch (error) {\n      result.errors.push({\n        testFile,\n        error: error instanceof Error ? error.message : String(error),\n      });\n      result.summary.errors++;\n    }\n  }\n\n  // Generate recommendation\n  if (result.summary.outdated === 0) {\n    result.summary.recommendation = 'All tests are up to date';\n  } else if (result.summary.outdated === 1) {\n    result.summary.recommendation = '1 test should be updated';\n  } else {\n    result.summary.recommendation = `${result.summary.outdated} tests should be updated`;\n  }\n\n  return result;\n}\n\n/**\n * Find test files in a directory (recursive)\n *\n * @param dir - Directory to search\n * @param pattern - File pattern to match\n * @returns Array of file paths\n */\nfunction findTestFiles(dir: string, pattern: string): string[] {\n  const files: string[] = [];\n  const patternRegex = globToRegex(pattern);\n\n  function walkDir(currentDir: string): void {\n    const entries = fs.readdirSync(currentDir, { withFileTypes: true });\n\n    for (const entry of entries) {\n      const fullPath = path.join(currentDir, entry.name);\n\n      if (entry.isDirectory()) {\n        // Skip node_modules and hidden directories\n        if (!entry.name.startsWith('.') && entry.name !== 'node_modules') {\n          walkDir(fullPath);\n        }\n      } else if (entry.isFile() && patternRegex.test(entry.name)) {\n        files.push(fullPath);\n      }\n    }\n  }\n\n  walkDir(dir);\n  return files;\n}\n\n/**\n * Convert a simple glob pattern to regex\n */\nfunction globToRegex(pattern: string): RegExp {\n  const escaped = pattern\n    .replace(/\\./g, '\\\\.')\n    .replace(/\\*/g, '.*')\n    .replace(/\\?/g, '.');\n  return new RegExp(`^${escaped}$`);\n}\n\n/**\n * Format version comparison result for console output\n *\n * @param testFile - Test file path\n * @param comparison - Version comparison result\n * @returns Formatted string\n */\nexport function formatVersionComparison(testFile: string, comparison: VersionComparison): string {\n  const status = comparison.isOutdated ? '!' : '';\n  const llkbVer = comparison.testLlkbVersion\n    ? comparison.testLlkbVersion.split('T')[0]\n    : 'none';\n  const currentVer = comparison.currentLlkbVersion.split('T')[0];\n\n  let info = `${status} ${path.basename(testFile)}`;\n  info += ` (LLKB: ${llkbVer}, current: ${currentVer}`;\n\n  if (comparison.newPatternsAvailable > 0 || comparison.newComponentsAvailable > 0) {\n    const parts: string[] = [];\n    if (comparison.newPatternsAvailable > 0) {\n      parts.push(`+${comparison.newPatternsAvailable} patterns`);\n    }\n    if (comparison.newComponentsAvailable > 0) {\n      parts.push(`+${comparison.newComponentsAvailable} components`);\n    }\n    info += `, ${parts.join(', ')}`;\n  }\n\n  info += ')';\n\n  return info;\n}\n\n/**\n * Format update check result for console output\n *\n * @param result - Update check result\n * @returns Formatted string for console\n */\nexport function formatUpdateCheckResult(result: UpdateCheckResult): string {\n  const lines: string[] = [];\n\n  lines.push('LLKB Version Check');\n  lines.push(''.repeat(TABLE.COLUMN_WIDTH));\n  lines.push('');\n\n  if (result.outdated.length > 0) {\n    lines.push('Tests needing LLKB update:');\n    for (const { testFile, comparison } of result.outdated) {\n      lines.push(`  ${formatVersionComparison(testFile, comparison)}`);\n    }\n    lines.push('');\n  }\n\n  if (result.upToDate.length > 0 && result.outdated.length === 0) {\n    lines.push('All tests are up to date');\n    lines.push('');\n  } else if (result.upToDate.length > 0) {\n    lines.push(`Up to date: ${result.upToDate.length} tests`);\n    lines.push('');\n  }\n\n  if (result.errors.length > 0) {\n    lines.push('Errors:');\n    for (const { testFile, error } of result.errors) {\n      lines.push(`   ${path.basename(testFile)}: ${error}`);\n    }\n    lines.push('');\n  }\n\n  lines.push(''.repeat(TABLE.COLUMN_WIDTH));\n  lines.push(`Total: ${result.summary.total} tests`);\n  lines.push(result.summary.recommendation);\n\n  return lines.join('\\n');\n}\n\n/**\n * Result of atomic test update with version check\n */\nexport interface UpdateTestResult {\n  /** Whether the update succeeded */\n  success: boolean;\n\n  /** Version mismatch detected (LLKB updated since check) */\n  versionMismatch?: boolean;\n\n  /** Error message if failed */\n  error?: string;\n\n  /** New version written to test file */\n  newVersion?: string;\n}\n\n/**\n * Update test file with atomic version check to prevent race conditions\n *\n * This function checks the LLKB version at write time to ensure LLKB hasn't\n * been updated between the initial check and the actual test update.\n *\n * @param testPath - Path to test file to update\n * @param expectedLlkbVersion - Expected LLKB version from initial check\n * @param llkbRoot - LLKB root directory\n * @returns Update result with success/mismatch status\n *\n * @example\n * ```typescript\n * // Initial check\n * const comparison = compareVersions('tests/login.spec.ts');\n * const expectedVersion = comparison.currentLlkbVersion;\n *\n * // Perform update with atomic version check\n * const result = updateTestWithVersionCheck(\n *   'tests/login.spec.ts',\n *   expectedVersion,\n *   '.artk/llkb'\n * );\n *\n * if (!result.success && result.versionMismatch) {\n *   console.log('LLKB was updated during operation, retry needed');\n * }\n * ```\n */\nexport function updateTestWithVersionCheck(\n  testPath: string,\n  expectedLlkbVersion: string,\n  llkbRoot: string = DEFAULT_LLKB_ROOT\n): UpdateTestResult {\n  try {\n    // Atomic version check at write time\n    const currentVersion = getCurrentLlkbVersion(llkbRoot);\n\n    if (currentVersion !== expectedLlkbVersion) {\n      return {\n        success: false,\n        versionMismatch: true,\n        error: `LLKB version changed: expected ${expectedLlkbVersion}, current ${currentVersion}`,\n      };\n    }\n\n    // Read test file\n    const testContent = fs.readFileSync(testPath, 'utf-8');\n\n    // Update version in test content\n    const updatedContent = updateTestLlkbVersion(testContent, currentVersion);\n\n    // Write updated content\n    fs.writeFileSync(testPath, updatedContent, 'utf-8');\n\n    return {\n      success: true,\n      newVersion: currentVersion,\n    };\n  } catch (error) {\n    return {\n      success: false,\n      error: error instanceof Error ? error.message : String(error),\n    };\n  }\n}\n\n// =============================================================================\n// Rollback Support (T007: Implement Rollback for Failed Updates)\n// =============================================================================\n\n/**\n * Options for updateTestSafe with verification and rollback\n */\nexport interface UpdateTestSafeOptions {\n  /** Path to the test file to update */\n  testPath: string;\n\n  /** LLKB root directory (optional, defaults to .artk/llkb) */\n  llkbRoot?: string;\n\n  /** Whether to verify the test runs after update */\n  verifyAfterUpdate?: boolean;\n\n  /** Whether to rollback on verification failure */\n  rollbackOnFailure?: boolean;\n\n  /** Custom verification command (default: runs the test file) */\n  verificationCommand?: string;\n}\n\n/**\n * Result of safe test update with optional rollback\n */\nexport interface UpdateTestSafeResult {\n  /** Whether the update succeeded */\n  success: boolean;\n\n  /** Whether the update was rolled back */\n  rolledBack?: boolean;\n\n  /** Path to the backup file (if created) */\n  originalBackupPath?: string;\n\n  /** Error message if failed */\n  error?: string;\n\n  /** New version written to test file (if successful) */\n  newVersion?: string;\n\n  /** Verification result (if verification was requested) */\n  verificationResult?: {\n    success: boolean;\n    output?: string;\n    error?: string;\n  };\n}\n\n/**\n * Update test file with atomic version check and optional rollback (T007)\n *\n * This function provides a safe update mechanism with backup and rollback support:\n * 1. Creates a backup of the original test file\n * 2. Updates the test file with new LLKB version\n * 3. Optionally verifies the test runs successfully\n * 4. Rolls back to backup if verification fails\n * 5. Cleans up backup on success\n *\n * @param options - Update options with verification and rollback settings\n * @returns Update result with success/rollback status\n *\n * @example\n * ```typescript\n * const result = await updateTestSafe({\n *   testPath: 'tests/login.spec.ts',\n *   llkbRoot: '.artk/llkb',\n *   verifyAfterUpdate: true,\n *   rollbackOnFailure: true,\n * });\n *\n * if (result.rolledBack) {\n *   console.log('Update failed verification, rolled back');\n * } else if (result.success) {\n *   console.log('Update successful');\n * }\n * ```\n */\nexport async function updateTestSafe(\n  options: UpdateTestSafeOptions\n): Promise<UpdateTestSafeResult> {\n  const {\n    testPath,\n    llkbRoot = DEFAULT_LLKB_ROOT,\n    verifyAfterUpdate = false,\n    rollbackOnFailure = true,\n    verificationCommand,\n  } = options;\n\n  let backupPath: string | null = null;\n\n  try {\n    // Step 1: Create backup\n    backupPath = `${testPath}.backup`;\n\n    try {\n      fs.copyFileSync(testPath, backupPath);\n    } catch (error) {\n      return {\n        success: false,\n        error: `Failed to create backup: ${error instanceof Error ? error.message : String(error)}`,\n      };\n    }\n\n    // Step 2: Get current LLKB version\n    const currentVersion = getCurrentLlkbVersion(llkbRoot);\n\n    // Step 3: Read and update test file\n    let testContent: string;\n    try {\n      testContent = fs.readFileSync(testPath, 'utf-8');\n    } catch (error) {\n      // Restore backup before returning\n      if (backupPath) {\n        fs.copyFileSync(backupPath, testPath);\n        fs.unlinkSync(backupPath);\n      }\n      return {\n        success: false,\n        error: `Failed to read test file: ${error instanceof Error ? error.message : String(error)}`,\n      };\n    }\n\n    // Update version in content\n    const updatedContent = updateTestLlkbVersion(testContent, currentVersion);\n\n    // Write updated content\n    try {\n      fs.writeFileSync(testPath, updatedContent, 'utf-8');\n    } catch (error) {\n      // Restore backup before returning\n      if (backupPath) {\n        fs.copyFileSync(backupPath, testPath);\n        fs.unlinkSync(backupPath);\n      }\n      return {\n        success: false,\n        error: `Failed to write updated test: ${error instanceof Error ? error.message : String(error)}`,\n      };\n    }\n\n    // Step 4: Verify test runs (if requested)\n    if (verifyAfterUpdate) {\n      const verificationResult = await verifyTest(testPath, verificationCommand);\n\n      if (!verificationResult.success) {\n        // Verification failed - rollback if requested\n        if (rollbackOnFailure && backupPath) {\n          try {\n            fs.copyFileSync(backupPath, testPath);\n            fs.unlinkSync(backupPath);\n\n            return {\n              success: false,\n              rolledBack: true,\n              originalBackupPath: backupPath,\n              error: 'Verification failed, rolled back to original',\n              verificationResult,\n            };\n          } catch (rollbackError) {\n            return {\n              success: false,\n              rolledBack: false,\n              error: `Verification failed and rollback failed: ${rollbackError instanceof Error ? rollbackError.message : String(rollbackError)}`,\n              verificationResult,\n            };\n          }\n        }\n\n        // Verification failed but rollback not requested\n        return {\n          success: false,\n          rolledBack: false,\n          error: 'Verification failed, no rollback requested',\n          verificationResult,\n        };\n      }\n\n      // Verification succeeded - clean up backup\n      if (backupPath) {\n        try {\n          fs.unlinkSync(backupPath);\n        } catch {\n          // Non-fatal - backup cleanup failed but update succeeded\n        }\n      }\n\n      return {\n        success: true,\n        rolledBack: false,\n        newVersion: currentVersion,\n        verificationResult,\n      };\n    }\n\n    // No verification requested - clean up backup and return success\n    if (backupPath) {\n      try {\n        fs.unlinkSync(backupPath);\n      } catch {\n        // Non-fatal - backup cleanup failed but update succeeded\n      }\n    }\n\n    return {\n      success: true,\n      rolledBack: false,\n      newVersion: currentVersion,\n    };\n  } catch (error) {\n    // Unexpected error - attempt rollback if backup exists\n    if (backupPath && fs.existsSync(backupPath)) {\n      try {\n        fs.copyFileSync(backupPath, testPath);\n        fs.unlinkSync(backupPath);\n        return {\n          success: false,\n          rolledBack: true,\n          error: `Unexpected error, rolled back: ${error instanceof Error ? error.message : String(error)}`,\n        };\n      } catch {\n        return {\n          success: false,\n          rolledBack: false,\n          error: `Unexpected error and rollback failed: ${error instanceof Error ? error.message : String(error)}`,\n        };\n      }\n    }\n\n    return {\n      success: false,\n      error: error instanceof Error ? error.message : String(error),\n    };\n  }\n}\n\n/**\n * Verify a test file runs successfully\n *\n * @param testPath - Path to test file\n * @param customCommand - Custom verification command (optional)\n * @returns Verification result\n */\nasync function verifyTest(\n  testPath: string,\n  customCommand?: string\n): Promise<{ success: boolean; output?: string; error?: string }> {\n  // Import dynamically to avoid requiring Node.js child_process at module load time\n  const { execSync } = await import('node:child_process');\n\n  const command = customCommand ?? `npx playwright test ${testPath}`;\n\n  try {\n    const output = execSync(command, {\n      encoding: 'utf-8',\n      stdio: 'pipe',\n      timeout: 60000, // 60 second timeout\n    });\n\n    return {\n      success: true,\n      output,\n    };\n  } catch (error) {\n    return {\n      success: false,\n      error: error instanceof Error ? error.message : String(error),\n    };\n  }\n}\n","/**\n * CLI Commands for LLKB\n *\n * Provides command-line interface functions for LLKB management.\n *\n * @module llkb/cli\n */\n\nimport * as fs from 'fs';\nimport * as path from 'path';\nimport type { AnalyticsFile, ComponentsFile, LessonsFile, LLKBCategory, LLKBScope } from './types.js';\nimport { loadJSON } from './file-utils.js';\nimport { updateAnalytics } from './analytics.js';\nimport { cleanupOldHistoryFiles, getHistoryDir, readTodayHistory } from './history.js';\nimport { detectDecliningConfidence, needsConfidenceReview } from './confidence.js';\nimport { exportForAutogen, formatExportResult } from './adapter.js';\nimport type { LLKBAdapterConfig, LLKBAdapterResult } from './adapter-types.js';\nimport { formatLearningResult, type LearningResult, recordLearning } from './learning.js';\nimport { PERCENTAGES, TABLE } from './constants.js';\n\n/**\n * Default LLKB root directory\n */\nconst DEFAULT_LLKB_ROOT = '.artk/llkb';\n\n/**\n * Health check result\n */\nexport interface HealthCheckResult {\n  status: 'healthy' | 'warning' | 'error';\n  checks: HealthCheck[];\n  summary: string;\n}\n\n/**\n * Individual health check\n */\nexport interface HealthCheck {\n  name: string;\n  status: 'pass' | 'warn' | 'fail';\n  message: string;\n  details?: string;\n}\n\n/**\n * Stats result\n */\nexport interface StatsResult {\n  lessons: {\n    total: number;\n    active: number;\n    archived: number;\n    avgConfidence: number;\n    avgSuccessRate: number;\n    needsReview: number;\n  };\n  components: {\n    total: number;\n    active: number;\n    archived: number;\n    totalReuses: number;\n    avgReusesPerComponent: number;\n  };\n  history: {\n    todayEvents: number;\n    historyFiles: number;\n    oldestFile: string | null;\n    newestFile: string | null;\n  };\n}\n\n/**\n * Prune result\n */\nexport interface PruneResult {\n  historyFilesDeleted: number;\n  deletedFiles: string[];\n  archivedLessons: number;\n  archivedComponents: number;\n  errors: string[];\n}\n\n/**\n * Run health check on LLKB\n *\n * Verifies that:\n * - All required files exist\n * - JSON files are valid\n * - No data corruption detected\n * - Configuration is valid\n *\n * @param llkbRoot - Root LLKB directory\n * @returns Health check result\n *\n * @example\n * ```typescript\n * const result = runHealthCheck();\n * if (result.status === 'error') {\n *   console.error('LLKB needs attention:', result.summary);\n * }\n * ```\n */\nexport function runHealthCheck(llkbRoot: string = DEFAULT_LLKB_ROOT): HealthCheckResult {\n  const checks: HealthCheck[] = [];\n  let hasError = false;\n  let hasWarning = false;\n\n  // Check 1: Directory exists\n  if (fs.existsSync(llkbRoot)) {\n    checks.push({\n      name: 'Directory exists',\n      status: 'pass',\n      message: `LLKB directory found at ${llkbRoot}`,\n    });\n  } else {\n    checks.push({\n      name: 'Directory exists',\n      status: 'fail',\n      message: `LLKB directory not found at ${llkbRoot}`,\n    });\n    hasError = true;\n  }\n\n  // Check 2: Config file\n  const configPath = path.join(llkbRoot, 'config.yml');\n  if (fs.existsSync(configPath)) {\n    checks.push({\n      name: 'Config file',\n      status: 'pass',\n      message: 'config.yml found',\n    });\n  } else {\n    checks.push({\n      name: 'Config file',\n      status: 'warn',\n      message: 'config.yml not found - using defaults',\n    });\n    hasWarning = true;\n  }\n\n  // Check 3: Lessons file\n  const lessonsPath = path.join(llkbRoot, 'lessons.json');\n  const lessonsCheck = checkJSONFile<LessonsFile>(lessonsPath, 'lessons.json');\n  checks.push(lessonsCheck);\n  if (lessonsCheck.status === 'fail') {hasError = true;}\n  if (lessonsCheck.status === 'warn') {hasWarning = true;}\n\n  // Check 4: Components file\n  const componentsPath = path.join(llkbRoot, 'components.json');\n  const componentsCheck = checkJSONFile<ComponentsFile>(componentsPath, 'components.json');\n  checks.push(componentsCheck);\n  if (componentsCheck.status === 'fail') {hasError = true;}\n  if (componentsCheck.status === 'warn') {hasWarning = true;}\n\n  // Check 5: Analytics file\n  const analyticsPath = path.join(llkbRoot, 'analytics.json');\n  const analyticsCheck = checkJSONFile<AnalyticsFile>(analyticsPath, 'analytics.json');\n  checks.push(analyticsCheck);\n  if (analyticsCheck.status === 'fail') {hasError = true;}\n  if (analyticsCheck.status === 'warn') {hasWarning = true;}\n\n  // Check 6: History directory\n  const historyDir = getHistoryDir(llkbRoot);\n  if (fs.existsSync(historyDir)) {\n    const historyFiles = fs.readdirSync(historyDir).filter((f) => f.endsWith('.jsonl'));\n    checks.push({\n      name: 'History directory',\n      status: 'pass',\n      message: `History directory found with ${historyFiles.length} files`,\n    });\n  } else {\n    checks.push({\n      name: 'History directory',\n      status: 'warn',\n      message: 'History directory not found - will be created on first event',\n    });\n    hasWarning = true;\n  }\n\n  // Check 7: Low confidence lessons\n  // Only check if lessons.json was valid (checkJSONFile passed)\n  if (lessonsCheck.status === 'pass') {\n    try {\n      const lessons = loadJSON<LessonsFile>(lessonsPath);\n      if (lessons) {\n        const lowConfidence = lessons.lessons.filter(\n          (l) => !l.archived && needsConfidenceReview(l)\n        );\n        const declining = lessons.lessons.filter(\n          (l) => !l.archived && detectDecliningConfidence(l)\n        );\n\n        if (lowConfidence.length > 0 || declining.length > 0) {\n          checks.push({\n            name: 'Lesson health',\n            status: 'warn',\n            message: `${lowConfidence.length} low confidence, ${declining.length} declining`,\n            details: [\n              ...lowConfidence.map((l) => `Low confidence: ${l.id} (${l.metrics.confidence})`),\n              ...declining.map((l) => `Declining: ${l.id}`),\n            ].join(', '),\n          });\n          hasWarning = true;\n        } else {\n          checks.push({\n            name: 'Lesson health',\n            status: 'pass',\n            message: 'All lessons healthy',\n          });\n        }\n      }\n    } catch {\n      // Skip lesson health check if JSON is invalid (already flagged by checkJSONFile)\n    }\n  }\n\n  // Determine overall status\n  let status: 'healthy' | 'warning' | 'error';\n  let summary: string;\n\n  if (hasError) {\n    status = 'error';\n    summary = `LLKB has errors: ${checks.filter((c) => c.status === 'fail').length} failed checks`;\n  } else if (hasWarning) {\n    status = 'warning';\n    summary = `LLKB has warnings: ${checks.filter((c) => c.status === 'warn').length} warnings`;\n  } else {\n    status = 'healthy';\n    summary = 'LLKB is healthy';\n  }\n\n  return { status, checks, summary };\n}\n\n/**\n * Check a JSON file for validity\n */\nfunction checkJSONFile<T>(filePath: string, fileName: string): HealthCheck {\n  if (!fs.existsSync(filePath)) {\n    return {\n      name: fileName,\n      status: 'warn',\n      message: `${fileName} not found`,\n    };\n  }\n\n  try {\n    const content = fs.readFileSync(filePath, 'utf-8');\n    JSON.parse(content) as T;\n    return {\n      name: fileName,\n      status: 'pass',\n      message: `${fileName} is valid JSON`,\n    };\n  } catch (error) {\n    return {\n      name: fileName,\n      status: 'fail',\n      message: `${fileName} is invalid JSON`,\n      details: error instanceof Error ? error.message : String(error),\n    };\n  }\n}\n\n/**\n * Get LLKB statistics\n *\n * @param llkbRoot - Root LLKB directory\n * @returns Statistics about LLKB contents\n *\n * @example\n * ```typescript\n * const stats = getStats();\n * console.log(`Total lessons: ${stats.lessons.total}`);\n * console.log(`Total reuses: ${stats.components.totalReuses}`);\n * ```\n */\nexport function getStats(llkbRoot: string = DEFAULT_LLKB_ROOT): StatsResult {\n  const lessonsPath = path.join(llkbRoot, 'lessons.json');\n  const componentsPath = path.join(llkbRoot, 'components.json');\n  const historyDir = getHistoryDir(llkbRoot);\n\n  // Lessons stats\n  const lessons = loadJSON<LessonsFile>(lessonsPath);\n  const activeLessons = lessons?.lessons.filter((l) => !l.archived) ?? [];\n  const archivedLessons = lessons?.archived ?? [];\n\n  let avgConfidence = 0;\n  let avgSuccessRate = 0;\n  let needsReview = 0;\n\n  if (activeLessons.length > 0) {\n    avgConfidence =\n      Math.round(\n        (activeLessons.reduce((acc, l) => acc + l.metrics.confidence, 0) /\n          activeLessons.length) *\n          PERCENTAGES.FULL\n      ) / PERCENTAGES.FULL;\n    avgSuccessRate =\n      Math.round(\n        (activeLessons.reduce((acc, l) => acc + l.metrics.successRate, 0) /\n          activeLessons.length) *\n          PERCENTAGES.FULL\n      ) / PERCENTAGES.FULL;\n    needsReview = activeLessons.filter(\n      (l) => needsConfidenceReview(l) || detectDecliningConfidence(l)\n    ).length;\n  }\n\n  // Components stats\n  const components = loadJSON<ComponentsFile>(componentsPath);\n  const activeComponents = components?.components.filter((c) => !c.archived) ?? [];\n  const archivedComponents = components?.components.filter((c) => c.archived) ?? [];\n\n  let totalReuses = 0;\n  let avgReusesPerComponent = 0;\n\n  if (activeComponents.length > 0) {\n    totalReuses = activeComponents.reduce((acc, c) => acc + (c.metrics.totalUses ?? 0), 0);\n    avgReusesPerComponent =\n      Math.round((totalReuses / activeComponents.length) * PERCENTAGES.FULL) / PERCENTAGES.FULL;\n  }\n\n  // History stats\n  let todayEvents = 0;\n  let historyFiles = 0;\n  let oldestFile: string | null = null;\n  let newestFile: string | null = null;\n\n  if (fs.existsSync(historyDir)) {\n    const files = fs\n      .readdirSync(historyDir)\n      .filter((f) => f.endsWith('.jsonl'))\n      .sort();\n\n    historyFiles = files.length;\n    if (files.length > 0) {\n      oldestFile = files[0] ?? null;\n      newestFile = files[files.length - 1] ?? null;\n    }\n\n    todayEvents = readTodayHistory(llkbRoot).length;\n  }\n\n  return {\n    lessons: {\n      total: (lessons?.lessons.length ?? 0) + archivedLessons.length,\n      active: activeLessons.length,\n      archived: archivedLessons.length,\n      avgConfidence,\n      avgSuccessRate,\n      needsReview,\n    },\n    components: {\n      total: components?.components.length ?? 0,\n      active: activeComponents.length,\n      archived: archivedComponents.length,\n      totalReuses,\n      avgReusesPerComponent,\n    },\n    history: {\n      todayEvents,\n      historyFiles,\n      oldestFile,\n      newestFile,\n    },\n  };\n}\n\n/**\n * Prune old history files and optionally archive stale items\n *\n * @param options - Prune options\n * @returns Prune result with counts of deleted/archived items\n *\n * @example\n * ```typescript\n * const result = prune({ historyRetentionDays: 90 });\n * console.log(`Deleted ${result.historyFilesDeleted} old history files`);\n * ```\n */\nexport function prune(\n  options: {\n    llkbRoot?: string;\n    historyRetentionDays?: number;\n    archiveInactiveLessons?: boolean;\n    archiveInactiveComponents?: boolean;\n    inactiveDays?: number;\n  } = {}\n): PruneResult {\n  const {\n    llkbRoot = DEFAULT_LLKB_ROOT,\n    historyRetentionDays = 365,\n    archiveInactiveLessons = false,\n    archiveInactiveComponents = false,\n    inactiveDays = 180,\n  } = options;\n\n  const result: PruneResult = {\n    historyFilesDeleted: 0,\n    deletedFiles: [],\n    archivedLessons: 0,\n    archivedComponents: 0,\n    errors: [],\n  };\n\n  // Clean up old history files\n  try {\n    const deletedFiles = cleanupOldHistoryFiles(historyRetentionDays, llkbRoot);\n    result.historyFilesDeleted = deletedFiles.length;\n    result.deletedFiles = deletedFiles;\n  } catch (error) {\n    result.errors.push(\n      `Failed to clean history files: ${error instanceof Error ? error.message : String(error)}`\n    );\n  }\n\n  // Archive inactive lessons\n  if (archiveInactiveLessons) {\n    try {\n      const archivedCount = archiveInactiveItems(\n        path.join(llkbRoot, 'lessons.json'),\n        'lessons',\n        inactiveDays\n      );\n      result.archivedLessons = archivedCount;\n    } catch (error) {\n      result.errors.push(\n        `Failed to archive lessons: ${error instanceof Error ? error.message : String(error)}`\n      );\n    }\n  }\n\n  // Archive inactive components\n  if (archiveInactiveComponents) {\n    try {\n      const archivedCount = archiveInactiveItems(\n        path.join(llkbRoot, 'components.json'),\n        'components',\n        inactiveDays\n      );\n      result.archivedComponents = archivedCount;\n    } catch (error) {\n      result.errors.push(\n        `Failed to archive components: ${error instanceof Error ? error.message : String(error)}`\n      );\n    }\n  }\n\n  // Update analytics after pruning\n  try {\n    updateAnalytics(llkbRoot);\n  } catch (error) {\n    result.errors.push(\n      `Failed to update analytics: ${error instanceof Error ? error.message : String(error)}`\n    );\n  }\n\n  return result;\n}\n\n/**\n * Archive items that haven't been used in a specified number of days\n */\nfunction archiveInactiveItems(\n  filePath: string,\n  itemsKey: 'lessons' | 'components',\n  inactiveDays: number\n): number {\n  if (!fs.existsSync(filePath)) {\n    return 0;\n  }\n\n  const content = fs.readFileSync(filePath, 'utf-8');\n  const data = JSON.parse(content) as Record<string, unknown>;\n  const items = data[itemsKey] as Array<{\n    archived?: boolean;\n    metrics: { lastSuccess?: string; lastUsed?: string };\n  }>;\n\n  if (!Array.isArray(items)) {\n    return 0;\n  }\n\n  const now = new Date();\n  const cutoffDate = new Date();\n  cutoffDate.setDate(now.getDate() - inactiveDays);\n\n  let archivedCount = 0;\n\n  for (const item of items) {\n    if (item.archived) {continue;}\n\n    const lastUsedStr = item.metrics.lastSuccess ?? item.metrics.lastUsed;\n    if (!lastUsedStr) {continue;}\n\n    const lastUsed = new Date(lastUsedStr);\n    if (lastUsed < cutoffDate) {\n      item.archived = true;\n      archivedCount++;\n    }\n  }\n\n  if (archivedCount > 0) {\n    fs.writeFileSync(filePath, JSON.stringify(data, null, 2), 'utf-8');\n  }\n\n  return archivedCount;\n}\n\n/**\n * Format health check result for console output\n *\n * @param result - Health check result\n * @returns Formatted string for console\n */\nexport function formatHealthCheck(result: HealthCheckResult): string {\n  const lines: string[] = [];\n  const statusIcon = result.status === 'healthy' ? '' : result.status === 'warning' ? '' : '';\n\n  lines.push(`${statusIcon} LLKB Health Check: ${result.status.toUpperCase()}`);\n  lines.push(''.repeat(TABLE.COLUMN_WIDTH));\n\n  for (const check of result.checks) {\n    const icon = check.status === 'pass' ? '' : check.status === 'warn' ? '' : '';\n    lines.push(`${icon} ${check.name}: ${check.message}`);\n    if (check.details) {\n      lines.push(`  ${check.details}`);\n    }\n  }\n\n  lines.push(''.repeat(TABLE.COLUMN_WIDTH));\n  lines.push(result.summary);\n\n  return lines.join('\\n');\n}\n\n/**\n * Format stats result for console output\n *\n * @param stats - Stats result\n * @returns Formatted string for console\n */\nexport function formatStats(stats: StatsResult): string {\n  const lines: string[] = [];\n\n  lines.push('LLKB Statistics');\n  lines.push(''.repeat(TABLE.COLUMN_WIDTH));\n\n  lines.push('');\n  lines.push('Lessons:');\n  lines.push(`  Total: ${stats.lessons.total} (${stats.lessons.active} active, ${stats.lessons.archived} archived)`);\n  lines.push(`  Avg Confidence: ${stats.lessons.avgConfidence}`);\n  lines.push(`  Avg Success Rate: ${stats.lessons.avgSuccessRate}`);\n  lines.push(`  Needs Review: ${stats.lessons.needsReview}`);\n\n  lines.push('');\n  lines.push('Components:');\n  lines.push(`  Total: ${stats.components.total} (${stats.components.active} active, ${stats.components.archived} archived)`);\n  lines.push(`  Total Reuses: ${stats.components.totalReuses}`);\n  lines.push(`  Avg Reuses/Component: ${stats.components.avgReusesPerComponent}`);\n\n  lines.push('');\n  lines.push('History:');\n  lines.push(`  Today's Events: ${stats.history.todayEvents}`);\n  lines.push(`  History Files: ${stats.history.historyFiles}`);\n  if (stats.history.oldestFile) {\n    lines.push(`  Date Range: ${stats.history.oldestFile} to ${stats.history.newestFile}`);\n  }\n\n  return lines.join('\\n');\n}\n\n/**\n * Format prune result for console output\n *\n * @param result - Prune result\n * @returns Formatted string for console\n */\nexport function formatPruneResult(result: PruneResult): string {\n  const lines: string[] = [];\n\n  lines.push('LLKB Prune Results');\n  lines.push(''.repeat(TABLE.COLUMN_WIDTH));\n\n  lines.push(`History files deleted: ${result.historyFilesDeleted}`);\n  if (result.archivedLessons > 0) {\n    lines.push(`Lessons archived: ${result.archivedLessons}`);\n  }\n  if (result.archivedComponents > 0) {\n    lines.push(`Components archived: ${result.archivedComponents}`);\n  }\n\n  if (result.errors.length > 0) {\n    lines.push('');\n    lines.push('Errors:');\n    for (const error of result.errors) {\n      lines.push(`   ${error}`);\n    }\n  }\n\n  return lines.join('\\n');\n}\n\n// =============================================================================\n// Export Command Types and Functions\n// =============================================================================\n\n/**\n * Options for the AutoGen export command\n */\nexport interface AutogenExportOptions {\n  /** LLKB root directory (default: .artk/llkb) */\n  llkbRoot?: string;\n\n  /** Output directory for generated files */\n  outputDir: string;\n\n  /** Minimum confidence threshold (default: 0.7) */\n  minConfidence?: number;\n\n  /** Categories to include (default: all) */\n  includeCategories?: LLKBCategory[];\n\n  /** Scopes to include (default: all) */\n  includeScopes?: LLKBScope[];\n\n  /** Whether to generate glossary file (default: true) */\n  generateGlossary?: boolean;\n\n  /** Whether to generate config file (default: true) */\n  generateConfig?: boolean;\n\n  /** Output format for config (default: yaml) */\n  configFormat?: 'yaml' | 'json';\n}\n\n/**\n * Export LLKB for AutoGen consumption\n *\n * Generates configuration and glossary files that AutoGen can use\n * to enhance test generation with learned patterns and components.\n *\n * @param options - Export options\n * @returns Export result with paths and statistics\n *\n * @example\n * ```typescript\n * const result = await runExportForAutogen({\n *   outputDir: './artk-e2e/',\n *   minConfidence: 0.7,\n *   configFormat: 'yaml',\n * });\n *\n * console.log(formatExportResultForConsole(result));\n * ```\n */\nexport function runExportForAutogen(options: AutogenExportOptions): LLKBAdapterResult {\n  const config: LLKBAdapterConfig = {\n    llkbRoot: options.llkbRoot,\n    outputDir: options.outputDir,\n    minConfidence: options.minConfidence,\n    includeCategories: options.includeCategories,\n    includeScopes: options.includeScopes,\n    generateGlossary: options.generateGlossary,\n    generateConfig: options.generateConfig,\n    configFormat: options.configFormat,\n  };\n\n  return exportForAutogen(config);\n}\n\n/**\n * Format export result for console output\n *\n * @param result - Export result\n * @returns Formatted string for console\n */\nexport function formatExportResultForConsole(result: LLKBAdapterResult): string {\n  return formatExportResult(result);\n}\n\n// =============================================================================\n// Learning Command Types and Functions\n// =============================================================================\n\n/**\n * Options for the learn command\n */\nexport interface LearnOptions {\n  /** Type of learning event */\n  type: 'pattern' | 'component' | 'lesson';\n\n  /** Journey ID where the learning occurred */\n  journeyId: string;\n\n  /** Entity ID (component or lesson ID) */\n  id?: string;\n\n  /** Whether the operation was successful */\n  success: boolean;\n\n  /** Additional context or step text */\n  context?: string;\n\n  /** Test file path */\n  testFile?: string;\n\n  /** Source prompt */\n  prompt?: 'journey-implement' | 'journey-verify';\n\n  /** Selector strategy (for pattern type) */\n  selectorStrategy?: string;\n\n  /** Selector value (for pattern type) */\n  selectorValue?: string;\n\n  /** LLKB root directory */\n  llkbRoot?: string;\n}\n\n/**\n * Run the learn command to record a learning event\n *\n * Records patterns, component usages, or lesson applications back to LLKB\n * for continuous improvement of the knowledge base.\n *\n * @param options - Learn options\n * @returns Learning result\n *\n * @example\n * ```typescript\n * // Record component usage\n * const result = runLearnCommand({\n *   type: 'component',\n *   journeyId: 'JRN-0001',\n *   id: 'COMP012',\n *   success: true,\n * });\n *\n * // Record lesson application\n * const result = runLearnCommand({\n *   type: 'lesson',\n *   journeyId: 'JRN-0001',\n *   id: 'L042',\n *   success: true,\n *   context: 'Applied ag-grid wait pattern',\n * });\n *\n * // Record pattern learned\n * const result = runLearnCommand({\n *   type: 'pattern',\n *   journeyId: 'JRN-0001',\n *   success: true,\n *   context: 'Click the Save button',\n *   selectorStrategy: 'testid',\n *   selectorValue: 'btn-save',\n * });\n *\n * console.log(formatLearnResult(result));\n * ```\n */\nexport function runLearnCommand(options: LearnOptions): LearningResult {\n  return recordLearning({\n    type: options.type,\n    journeyId: options.journeyId,\n    testFile: options.testFile,\n    prompt: options.prompt,\n    id: options.id,\n    success: options.success,\n    context: options.context,\n    stepText: options.context,\n    selectorStrategy: options.selectorStrategy,\n    selectorValue: options.selectorValue,\n    llkbRoot: options.llkbRoot,\n  });\n}\n\n/**\n * Format learn result for console output\n *\n * @param result - Learning result\n * @returns Formatted string for console\n */\nexport function formatLearnResult(result: LearningResult): string {\n  return formatLearningResult(result);\n}\n\n// Re-export learning types for CLI consumers\nexport type { LearningResult } from './learning.js';\n\n// =============================================================================\n// Version Check Command Types and Functions\n// =============================================================================\n\nimport {\n  checkUpdates,\n  compareVersions,\n  extractLlkbVersionFromTest,\n  formatUpdateCheckResult,\n  formatVersionComparison,\n  getCurrentLlkbVersion,\n  type UpdateCheckResult,\n  updateTestLlkbVersion,\n  type VersionComparison,\n} from './versioning.js';\n\n// Re-export versioning types for CLI consumers\nexport type { VersionComparison, UpdateCheckResult };\n\n/**\n * Options for the check-updates command\n */\nexport interface CheckUpdatesOptions {\n  /** Directory containing test files */\n  testsDir: string;\n\n  /** LLKB root directory (default: .artk/llkb) */\n  llkbRoot?: string;\n\n  /** File pattern (default: *.spec.ts) */\n  pattern?: string;\n}\n\n/**\n * Options for the update-test command\n *\n * Note: This command has both singular (update-test) and plural (update-tests) forms.\n * The singular form is an alias for updating a single test file.\n *\n * CLI usage:\n * - `artk-llkb update-test --test <file>` (singular - single file)\n * - `artk-llkb update-tests --tests-dir <dir>` (plural - batch update)\n */\nexport interface UpdateTestOptions {\n  /** Path to the test file to update */\n  testPath: string;\n\n  /** LLKB root directory (default: .artk/llkb) */\n  llkbRoot?: string;\n\n  /** Whether to perform a dry run (show changes without writing) */\n  dryRun?: boolean;\n}\n\n/**\n * Options for the update-tests command (batch)\n */\nexport interface UpdateTestsOptions {\n  /** Directory containing test files */\n  testsDir: string;\n\n  /** LLKB root directory (default: .artk/llkb) */\n  llkbRoot?: string;\n\n  /** File pattern (default: *.spec.ts) */\n  pattern?: string;\n\n  /** Whether to require confirmation for each file */\n  confirm?: boolean;\n\n  /** Whether to perform a dry run */\n  dryRun?: boolean;\n}\n\n/**\n * Result of updating a test file\n */\nexport interface UpdateTestResult {\n  /** Whether the update succeeded */\n  success: boolean;\n\n  /** Path to the test file */\n  testPath: string;\n\n  /** Previous LLKB version (or null if none) */\n  previousVersion: string | null;\n\n  /** New LLKB version */\n  newVersion: string;\n\n  /** Whether the file was modified */\n  modified: boolean;\n\n  /** Error message if failed */\n  error?: string;\n\n  /** Whether this was a dry run */\n  dryRun: boolean;\n}\n\n/**\n * Result of batch updating tests\n */\nexport interface UpdateTestsResult {\n  /** Successfully updated tests */\n  updated: UpdateTestResult[];\n\n  /** Tests that were skipped (already up to date) */\n  skipped: Array<{ testPath: string; reason: string }>;\n\n  /** Tests that failed to update */\n  failed: Array<{ testPath: string; error: string }>;\n\n  /** Summary statistics */\n  summary: {\n    total: number;\n    updated: number;\n    skipped: number;\n    failed: number;\n  };\n}\n\n/**\n * Check which tests need LLKB updates\n *\n * @param options - Check options\n * @returns Update check result\n *\n * @example\n * ```typescript\n * const result = runCheckUpdates({ testsDir: 'artk-e2e/tests/' });\n * console.log(formatCheckUpdatesResult(result));\n * ```\n */\nexport function runCheckUpdates(options: CheckUpdatesOptions): UpdateCheckResult {\n  return checkUpdates(\n    options.testsDir,\n    options.llkbRoot || DEFAULT_LLKB_ROOT,\n    options.pattern || '*.spec.ts'\n  );\n}\n\n/**\n * Format check-updates result for console output\n *\n * @param result - Check result\n * @returns Formatted string for console\n */\nexport function formatCheckUpdatesResult(result: UpdateCheckResult): string {\n  return formatUpdateCheckResult(result);\n}\n\n/**\n * Update a single test file with current LLKB version\n *\n * @param options - Update options\n * @returns Update result\n *\n * @example\n * ```typescript\n * const result = runUpdateTest({\n *   testPath: 'artk-e2e/tests/login.spec.ts',\n *   dryRun: true,\n * });\n * console.log(formatUpdateTestResult(result));\n * ```\n */\nexport function runUpdateTest(options: UpdateTestOptions): UpdateTestResult {\n  const { testPath, llkbRoot = DEFAULT_LLKB_ROOT, dryRun = false } = options;\n\n  try {\n    // Read current test content\n    const content = fs.readFileSync(testPath, 'utf-8');\n\n    // Extract current version\n    const previousVersion = extractLlkbVersionFromTest(content);\n\n    // Get current LLKB version\n    const newVersion = getCurrentLlkbVersion(llkbRoot);\n\n    // Check if update is needed\n    if (previousVersion && previousVersion === newVersion) {\n      return {\n        success: true,\n        testPath,\n        previousVersion,\n        newVersion,\n        modified: false,\n        dryRun,\n      };\n    }\n\n    // Update content\n    const updatedContent = updateTestLlkbVersion(content, newVersion);\n\n    // Check if content actually changed\n    const modified = content !== updatedContent;\n\n    // Write if not dry run and content changed\n    if (!dryRun && modified) {\n      fs.writeFileSync(testPath, updatedContent, 'utf-8');\n    }\n\n    return {\n      success: true,\n      testPath,\n      previousVersion,\n      newVersion,\n      modified,\n      dryRun,\n    };\n  } catch (error) {\n    return {\n      success: false,\n      testPath,\n      previousVersion: null,\n      newVersion: getCurrentLlkbVersion(llkbRoot),\n      modified: false,\n      error: error instanceof Error ? error.message : String(error),\n      dryRun,\n    };\n  }\n}\n\n/**\n * Format update-test result for console output\n *\n * @param result - Update result\n * @returns Formatted string for console\n */\nexport function formatUpdateTestResult(result: UpdateTestResult): string {\n  const lines: string[] = [];\n  const filename = path.basename(result.testPath);\n\n  if (!result.success) {\n    lines.push(` ${filename}: ${result.error}`);\n    return lines.join('\\n');\n  }\n\n  if (!result.modified) {\n    lines.push(` ${filename}: Already up to date`);\n    return lines.join('\\n');\n  }\n\n  const action = result.dryRun ? 'Would update' : 'Updated';\n  const prevVer = result.previousVersion?.split('T')[0] || 'none';\n  const newVer = result.newVersion.split('T')[0] ?? 'unknown';\n\n  lines.push(` ${filename}: ${action} LLKB version ${prevVer}  ${newVer}`);\n\n  if (result.dryRun) {\n    lines.push('  (dry run - no changes written)');\n  }\n\n  return lines.join('\\n');\n}\n\n/**\n * Update multiple test files with current LLKB version\n *\n * @param options - Update options\n * @returns Batch update result\n *\n * @example\n * ```typescript\n * const result = runUpdateTests({\n *   testsDir: 'artk-e2e/tests/',\n *   dryRun: true,\n * });\n * console.log(formatUpdateTestsResult(result));\n * ```\n */\nexport function runUpdateTests(options: UpdateTestsOptions): UpdateTestsResult {\n  const {\n    testsDir,\n    llkbRoot = DEFAULT_LLKB_ROOT,\n    pattern = '*.spec.ts',\n    dryRun = false,\n  } = options;\n\n  const result: UpdateTestsResult = {\n    updated: [],\n    skipped: [],\n    failed: [],\n    summary: {\n      total: 0,\n      updated: 0,\n      skipped: 0,\n      failed: 0,\n    },\n  };\n\n  // First check which tests need updates\n  const checkResult = checkUpdates(testsDir, llkbRoot, pattern);\n  result.summary.total = checkResult.summary.total;\n\n  // Process outdated tests\n  for (const { testFile } of checkResult.outdated) {\n    const updateResult = runUpdateTest({\n      testPath: testFile,\n      llkbRoot,\n      dryRun,\n    });\n\n    if (updateResult.success) {\n      if (updateResult.modified) {\n        result.updated.push(updateResult);\n        result.summary.updated++;\n      } else {\n        result.skipped.push({\n          testPath: testFile,\n          reason: 'No changes needed after header update attempt',\n        });\n        result.summary.skipped++;\n      }\n    } else {\n      result.failed.push({\n        testPath: testFile,\n        error: updateResult.error || 'Unknown error',\n      });\n      result.summary.failed++;\n    }\n  }\n\n  // Count up-to-date as skipped\n  for (const { testFile } of checkResult.upToDate) {\n    result.skipped.push({\n      testPath: testFile,\n      reason: 'Already up to date',\n    });\n    result.summary.skipped++;\n  }\n\n  // Count errors\n  for (const { testFile, error } of checkResult.errors) {\n    result.failed.push({ testPath: testFile, error });\n    result.summary.failed++;\n  }\n\n  return result;\n}\n\n/**\n * Format update-tests result for console output\n *\n * @param result - Batch update result\n * @returns Formatted string for console\n */\nexport function formatUpdateTestsResult(result: UpdateTestsResult): string {\n  const lines: string[] = [];\n\n  lines.push('LLKB Batch Update Results');\n  lines.push(''.repeat(TABLE.COLUMN_WIDTH));\n  lines.push('');\n\n  if (result.updated.length > 0) {\n    lines.push('Updated:');\n    for (const update of result.updated) {\n      lines.push(`  ${formatUpdateTestResult(update)}`);\n    }\n    lines.push('');\n  }\n\n  if (result.failed.length > 0) {\n    lines.push('Failed:');\n    for (const { testPath, error } of result.failed) {\n      lines.push(`   ${path.basename(testPath)}: ${error}`);\n    }\n    lines.push('');\n  }\n\n  lines.push(''.repeat(TABLE.COLUMN_WIDTH));\n  lines.push(`Total: ${result.summary.total} tests`);\n  lines.push(`  Updated: ${result.summary.updated}`);\n  lines.push(`  Skipped: ${result.summary.skipped}`);\n  lines.push(`  Failed: ${result.summary.failed}`);\n\n  return lines.join('\\n');\n}\n\n// Re-export versioning functions that may be useful directly\nexport {\n  compareVersions as compareTestVersion,\n  extractLlkbVersionFromTest,\n  updateTestLlkbVersion,\n  getCurrentLlkbVersion,\n  formatVersionComparison,\n};\n","/**\n * LLKB Context Injection\n *\n * Functions for filtering and prioritizing LLKB data based on journey context.\n * Used to inject relevant lessons, components, and patterns into prompts.\n *\n * @module @artk/llkb/context\n */\n\nimport type {\n  Lesson,\n  Component,\n  LLKBConfig,\n  LLKBScope,\n  LLKBCategory,\n} from './types.js';\nimport type { AppProfile, LLKBPatterns, SelectorPatterns, TimingPatterns } from './loaders.js';\nimport { tokenize } from './normalize.js';\n\n// =============================================================================\n// Types\n// =============================================================================\n\n/**\n * Journey context for filtering LLKB data\n */\nexport interface JourneyContext {\n  /** Journey ID (e.g., JRN-0001) */\n  id: string;\n  /** Journey scope (e.g., \"orders\", \"catalog\") */\n  scope: string;\n  /** Journey title */\n  title: string;\n  /** Inferred routes from journey */\n  routes?: string[];\n  /** Keywords extracted from journey steps */\n  keywords?: string[];\n  /** Categories of actions in the journey */\n  categories?: LLKBCategory[];\n}\n\n/**\n * Filtered and prioritized LLKB context\n */\nexport interface RelevantContext {\n  /** Filtered lessons sorted by relevance */\n  lessons: ScoredLesson[];\n  /** Filtered components sorted by relevance */\n  components: ScoredComponent[];\n  /** Relevant app quirks */\n  quirks: AppQuirkInfo[];\n  /** Relevant selector patterns */\n  selectorPatterns: SelectorPatternInfo[];\n  /** Relevant timing patterns */\n  timingPatterns: TimingPatternInfo[];\n  /** Summary statistics */\n  summary: ContextSummary;\n}\n\n/**\n * Lesson with relevance score\n */\nexport interface ScoredLesson extends Lesson {\n  relevanceScore: number;\n  matchReasons: string[];\n}\n\n/**\n * Component with relevance score\n */\nexport interface ScoredComponent extends Component {\n  relevanceScore: number;\n  matchReasons: string[];\n}\n\n/**\n * App quirk info for context\n */\nexport interface AppQuirkInfo {\n  id: string;\n  component: string;\n  location: string;\n  quirk: string;\n  impact: string;\n  workaround: string;\n}\n\n/**\n * Selector pattern info for context\n */\nexport interface SelectorPatternInfo {\n  id: string;\n  name: string;\n  template: string;\n  confidence: number;\n}\n\n/**\n * Timing pattern info for context\n */\nexport interface TimingPatternInfo {\n  id: string;\n  name: string;\n  pattern: string;\n  recommendation: string;\n}\n\n/**\n * Summary of injected context\n */\nexport interface ContextSummary {\n  totalLessons: number;\n  totalComponents: number;\n  totalQuirks: number;\n  avgLessonConfidence: number;\n  avgComponentSuccessRate: number;\n  topCategories: string[];\n}\n\n// =============================================================================\n// Constants\n// =============================================================================\n\n/** Default maximum lessons to include in context */\nconst DEFAULT_MAX_LESSONS = 10;\n\n/** Default maximum components to include in context */\nconst DEFAULT_MAX_COMPONENTS = 10;\n\n// =============================================================================\n// Relevance Calculation\n// =============================================================================\n\n/**\n * Calculate relevance score for a lesson\n */\nfunction calculateLessonRelevance(\n  lesson: Lesson,\n  journey: JourneyContext,\n  appProfile: AppProfile | null\n): { score: number; reasons: string[] } {\n  let score = 0;\n  const reasons: string[] = [];\n\n  // Base confidence contributes to score\n  score += lesson.metrics.confidence * 0.3;\n\n  // Scope matching\n  if (lesson.scope === 'universal') {\n    score += 0.2;\n    reasons.push('universal scope');\n  } else if (appProfile && lesson.scope === `framework:${appProfile.application.framework}`) {\n    score += 0.25;\n    reasons.push(`framework match: ${appProfile.application.framework}`);\n  } else if (lesson.scope === 'app-specific') {\n    score += 0.15;\n    reasons.push('app-specific');\n  }\n\n  // Tag matching\n  const journeyKeywords = journey.keywords || extractKeywords(journey);\n  if (lesson.tags && lesson.tags.length > 0) {\n    const matchingTags = lesson.tags.filter((tag) =>\n      journeyKeywords.some((kw) => tag.toLowerCase().includes(kw.toLowerCase()))\n    );\n    if (matchingTags.length > 0) {\n      score += Math.min(matchingTags.length * 0.1, 0.3);\n      reasons.push(`tags: ${matchingTags.join(', ')}`);\n    }\n  }\n\n  // Journey ID matching\n  if (lesson.journeyIds && lesson.journeyIds.length > 0) {\n    if (lesson.journeyIds.includes(journey.id)) {\n      score += 0.25;\n      reasons.push('same journey');\n    } else {\n      // Check if lesson was used in similar scopes\n      const journeyScopePattern = journey.scope.toLowerCase();\n      const matchingJourneys = lesson.journeyIds.filter((jid) =>\n        jid.toLowerCase().includes(journeyScopePattern)\n      );\n      if (matchingJourneys.length > 0) {\n        score += 0.15;\n        reasons.push(`similar journeys: ${matchingJourneys.length}`);\n      }\n    }\n  }\n\n  // Category matching\n  if (journey.categories && journey.categories.includes(lesson.category)) {\n    score += 0.15;\n    reasons.push(`category: ${lesson.category}`);\n  }\n\n  // Trigger keyword matching\n  const triggerTokens = tokenize(lesson.trigger);\n  const triggerMatches = journeyKeywords.filter((kw) =>\n    [...triggerTokens].some((t) => t.toLowerCase().includes(kw.toLowerCase()))\n  );\n  if (triggerMatches.length > 0) {\n    score += Math.min(triggerMatches.length * 0.05, 0.15);\n    reasons.push(`trigger match: ${triggerMatches.slice(0, 2).join(', ')}`);\n  }\n\n  // Recency bonus\n  if (lesson.metrics.lastSuccess) {\n    const daysSinceSuccess = daysSince(lesson.metrics.lastSuccess);\n    if (daysSinceSuccess < 7) {\n      score += 0.1;\n      reasons.push('recently successful');\n    } else if (daysSinceSuccess < 30) {\n      score += 0.05;\n    }\n  }\n\n  // Success rate bonus\n  if (lesson.metrics.successRate >= 0.9) {\n    score += 0.1;\n    reasons.push('high success rate');\n  }\n\n  return { score: Math.min(score, 1.0), reasons };\n}\n\n/**\n * Calculate relevance score for a component\n */\nfunction calculateComponentRelevance(\n  component: Component,\n  journey: JourneyContext,\n  appProfile: AppProfile | null\n): { score: number; reasons: string[] } {\n  let score = 0;\n  const reasons: string[] = [];\n\n  // Base success rate contributes to score\n  score += component.metrics.successRate * 0.3;\n\n  // Scope matching\n  if (component.scope === 'universal') {\n    score += 0.2;\n    reasons.push('universal scope');\n  } else if (appProfile && component.scope === `framework:${appProfile.application.framework}`) {\n    score += 0.25;\n    reasons.push(`framework match: ${appProfile.application.framework}`);\n  } else if (\n    appProfile &&\n    component.scope === `framework:${appProfile.application.dataGrid}` &&\n    appProfile.application.dataGrid !== 'none'\n  ) {\n    score += 0.25;\n    reasons.push(`data grid match: ${appProfile.application.dataGrid}`);\n  }\n\n  // Category matching\n  if (journey.categories && journey.categories.includes(component.category)) {\n    score += 0.2;\n    reasons.push(`category: ${component.category}`);\n  }\n\n  // Description similarity\n  const journeyKeywords = journey.keywords || extractKeywords(journey);\n  const descTokens = tokenize(component.description);\n  const contextMatches = journeyKeywords.filter((kw) =>\n    [...descTokens].some((t) => t.toLowerCase().includes(kw.toLowerCase()))\n  );\n  if (contextMatches.length > 0) {\n    score += Math.min(contextMatches.length * 0.05, 0.2);\n    reasons.push(`context match: ${contextMatches.slice(0, 3).join(', ')}`);\n  }\n\n  // Usage frequency bonus\n  if (component.metrics.totalUses > 10) {\n    score += 0.15;\n    reasons.push('widely used');\n  } else if (component.metrics.totalUses > 3) {\n    score += 0.1;\n    reasons.push('commonly used');\n  }\n\n  // Success rate\n  if (component.metrics.successRate >= 0.95) {\n    score += 0.1;\n    reasons.push('high reliability');\n  }\n\n  return { score: Math.min(score, 1.0), reasons };\n}\n\n// =============================================================================\n// Context Filtering\n// =============================================================================\n\n/**\n * Get relevant LLKB context for a journey\n *\n * @param journey - Journey context for filtering\n * @param lessons - All available lessons\n * @param components - All available components\n * @param config - LLKB configuration\n * @param appProfile - Application profile\n * @param patterns - Pattern files\n * @returns Filtered and prioritized context\n */\nexport function getRelevantContext(\n  journey: JourneyContext,\n  lessons: Lesson[],\n  components: Component[],\n  config: LLKBConfig,\n  appProfile: AppProfile | null = null,\n  patterns: LLKBPatterns = {}\n): RelevantContext {\n  const maxLessons = DEFAULT_MAX_LESSONS;\n  const maxComponents = DEFAULT_MAX_COMPONENTS;\n\n  // Extract keywords from journey if not provided\n  const journeyWithKeywords = {\n    ...journey,\n    keywords: journey.keywords || extractKeywords(journey),\n  };\n\n  // Score and filter lessons\n  const scoredLessons = lessons\n    .filter((l) => !l.archived)\n    .map((lesson) => {\n      const { score, reasons } = calculateLessonRelevance(lesson, journeyWithKeywords, appProfile);\n      return { ...lesson, relevanceScore: score, matchReasons: reasons } as ScoredLesson;\n    })\n    .filter((l) => l.relevanceScore > 0.2)\n    .sort((a, b) => {\n      if (config.injection.prioritizeByConfidence) {\n        // Sort by confidence first, then relevance\n        return b.metrics.confidence - a.metrics.confidence || b.relevanceScore - a.relevanceScore;\n      }\n      return b.relevanceScore - a.relevanceScore;\n    })\n    .slice(0, maxLessons);\n\n  // Score and filter components\n  const scoredComponents = components\n    .filter((c) => !c.archived)\n    .map((component) => {\n      const { score, reasons } = calculateComponentRelevance(\n        component,\n        journeyWithKeywords,\n        appProfile\n      );\n      return { ...component, relevanceScore: score, matchReasons: reasons } as ScoredComponent;\n    })\n    .filter((c) => c.relevanceScore > 0.2)\n    .sort((a, b) => {\n      if (config.injection.prioritizeByConfidence) {\n        return b.metrics.successRate - a.metrics.successRate || b.relevanceScore - a.relevanceScore;\n      }\n      return b.relevanceScore - a.relevanceScore;\n    })\n    .slice(0, maxComponents);\n\n  // Extract relevant quirks from lessons\n  const quirks = extractRelevantQuirks(lessons, journeyWithKeywords);\n\n  // Extract relevant selector patterns\n  const selectorPatterns = extractRelevantSelectorPatterns(\n    patterns.selectors,\n    journeyWithKeywords,\n    appProfile\n  );\n\n  // Extract relevant timing patterns\n  const timingPatterns = extractRelevantTimingPatterns(patterns.timing, journeyWithKeywords);\n\n  // Calculate summary\n  const summary = calculateSummary(scoredLessons, scoredComponents, quirks);\n\n  return {\n    lessons: scoredLessons,\n    components: scoredComponents,\n    quirks,\n    selectorPatterns,\n    timingPatterns,\n    summary,\n  };\n}\n\n/**\n * Extract relevant app quirks from quirk-category lessons\n */\nfunction extractRelevantQuirks(lessons: Lesson[], journey: JourneyContext): AppQuirkInfo[] {\n  const quirks: AppQuirkInfo[] = [];\n\n  for (const lesson of lessons) {\n    // Check if lesson is a quirk category\n    if (lesson.category === 'quirk') {\n      // Check if it matches the journey scope, routes, or keywords\n      const journeyKeywords = journey.keywords || extractKeywords(journey);\n      const triggerTokens = tokenize(lesson.trigger);\n      const patternTokens = tokenize(lesson.pattern);\n\n      const matchesScope =\n        lesson.journeyIds.some(\n          (jid) =>\n            journey.scope.toLowerCase().includes(jid.toLowerCase()) ||\n            jid.toLowerCase().includes(journey.scope.toLowerCase())\n        ) ||\n        journeyKeywords.some(\n          (kw) =>\n            [...triggerTokens].some((t) => t.toLowerCase().includes(kw.toLowerCase())) ||\n            [...patternTokens].some((t) => t.toLowerCase().includes(kw.toLowerCase()))\n        ) ||\n        (journey.routes &&\n          journey.routes.some((route) =>\n            lesson.journeyIds.some((jid) => route.toLowerCase().includes(jid.toLowerCase()))\n          ));\n\n      if (matchesScope) {\n        quirks.push({\n          id: lesson.id,\n          component: lesson.title,\n          location: lesson.journeyIds.join(', ') || lesson.scope,\n          quirk: lesson.trigger,\n          impact: `Confidence: ${Math.round(lesson.metrics.confidence * 100)}%`,\n          workaround: lesson.pattern,\n        });\n      }\n    }\n  }\n\n  return quirks.slice(0, 5); // Limit to 5 quirks\n}\n\n/**\n * Extract relevant selector patterns\n */\nfunction extractRelevantSelectorPatterns(\n  selectorPatterns: SelectorPatterns | undefined,\n  journey: JourneyContext,\n  appProfile: AppProfile | null\n): SelectorPatternInfo[] {\n  if (!selectorPatterns) return [];\n\n  const relevant: SelectorPatternInfo[] = [];\n\n  for (const pattern of selectorPatterns.selectorPatterns || []) {\n    // Check if pattern applies to journey or app profile\n    const matchesApp =\n      appProfile &&\n      pattern.applicableTo.some(\n        (app) =>\n          app === appProfile.application.framework ||\n          app === appProfile.application.dataGrid ||\n          app === appProfile.application.uiLibrary\n      );\n\n    const matchesKeywords =\n      journey.keywords &&\n      pattern.applicableTo.some((app) =>\n        journey.keywords!.some((kw) => app.toLowerCase().includes(kw.toLowerCase()))\n      );\n\n    if (matchesApp || matchesKeywords || pattern.confidence >= 0.9) {\n      relevant.push({\n        id: pattern.id,\n        name: pattern.name,\n        template: pattern.template,\n        confidence: pattern.confidence,\n      });\n    }\n  }\n\n  return relevant.slice(0, 5);\n}\n\n/**\n * Extract relevant timing patterns\n */\nfunction extractRelevantTimingPatterns(\n  timingPatterns: TimingPatterns | undefined,\n  journey: JourneyContext\n): TimingPatternInfo[] {\n  if (!timingPatterns) return [];\n\n  const relevant: TimingPatternInfo[] = [];\n\n  for (const pattern of timingPatterns.asyncPatterns || []) {\n    // Check if pattern context matches journey keywords\n    const contextTokens = tokenize(pattern.context);\n    const journeyKeywords = journey.keywords || [];\n    const matches = journeyKeywords.some((kw) =>\n      [...contextTokens].some((t) => t.toLowerCase().includes(kw.toLowerCase()))\n    );\n\n    if (matches) {\n      relevant.push({\n        id: pattern.id,\n        name: pattern.name,\n        pattern: pattern.pattern,\n        recommendation: pattern.recommendation,\n      });\n    }\n  }\n\n  return relevant.slice(0, 5);\n}\n\n/**\n * Calculate context summary\n */\nfunction calculateSummary(\n  lessons: ScoredLesson[],\n  components: ScoredComponent[],\n  quirks: AppQuirkInfo[]\n): ContextSummary {\n  const avgLessonConfidence =\n    lessons.length > 0\n      ? lessons.reduce((sum, l) => sum + l.metrics.confidence, 0) / lessons.length\n      : 0;\n\n  const avgComponentSuccessRate =\n    components.length > 0\n      ? components.reduce((sum, c) => sum + c.metrics.successRate, 0) / components.length\n      : 0;\n\n  // Count categories\n  const categoryCounts: Record<string, number> = {};\n  for (const lesson of lessons) {\n    categoryCounts[lesson.category] = (categoryCounts[lesson.category] || 0) + 1;\n  }\n  for (const component of components) {\n    categoryCounts[component.category] = (categoryCounts[component.category] || 0) + 1;\n  }\n\n  const topCategories = Object.entries(categoryCounts)\n    .sort((a, b) => b[1] - a[1])\n    .slice(0, 3)\n    .map(([cat]) => cat);\n\n  return {\n    totalLessons: lessons.length,\n    totalComponents: components.length,\n    totalQuirks: quirks.length,\n    avgLessonConfidence,\n    avgComponentSuccessRate,\n    topCategories,\n  };\n}\n\n// =============================================================================\n// Helper Functions\n// =============================================================================\n\n/**\n * Extract keywords from journey context\n */\nexport function extractKeywords(journey: JourneyContext): string[] {\n  const keywords: string[] = [];\n\n  // Extract from title\n  const titleTokens = journey.title\n    .toLowerCase()\n    .split(/\\s+/)\n    .filter((w) => w.length > 3);\n  keywords.push(...titleTokens);\n\n  // Extract from scope\n  keywords.push(journey.scope.toLowerCase());\n\n  // Extract from routes\n  if (journey.routes) {\n    for (const route of journey.routes) {\n      const routeParts = route\n        .split('/')\n        .filter((p) => p && p.length > 2)\n        .map((p) => p.toLowerCase());\n      keywords.push(...routeParts);\n    }\n  }\n\n  // Deduplicate\n  return [...new Set(keywords)];\n}\n\n/**\n * Calculate days since a date\n */\nfunction daysSince(dateStr: string): number {\n  const date = new Date(dateStr);\n  const now = new Date();\n  return Math.floor((now.getTime() - date.getTime()) / (1000 * 60 * 60 * 24));\n}\n\n/**\n * Format context for prompt injection\n *\n * @param context - Relevant context to format\n * @param journey - Journey context\n * @returns Markdown-formatted context string\n */\nexport function formatContextForPrompt(context: RelevantContext, journey: JourneyContext): string {\n  const lines: string[] = [];\n\n  lines.push(`## LLKB Context (Auto-Injected for ${journey.id})`);\n  lines.push('');\n\n  // Components section\n  if (context.components.length > 0) {\n    lines.push(`### Available Components (Top ${context.components.length} for this scope)`);\n    lines.push('');\n    lines.push('| Component | File | Success Rate | Description |');\n    lines.push('|-----------|------|--------------|-------------|');\n\n    for (const comp of context.components) {\n      const successRate = Math.round(comp.metrics.successRate * 100);\n      const description = comp.description.slice(0, 50) + (comp.description.length > 50 ? '...' : '');\n      lines.push(`| ${comp.name} | ${comp.filePath} | ${successRate}% | ${description} |`);\n    }\n\n    lines.push('');\n    lines.push('**Import Example:**');\n    lines.push('```typescript');\n\n    // Group by file path directory\n    const byPath: Record<string, string[]> = {};\n    for (const comp of context.components) {\n      const importPath = comp.filePath.replace(/\\.ts$/, '').replace(/^\\.\\//, '');\n      if (!byPath[importPath]) byPath[importPath] = [];\n      byPath[importPath].push(comp.name);\n    }\n\n    for (const [path, names] of Object.entries(byPath)) {\n      lines.push(`import { ${names.join(', ')} } from './${path}';`);\n    }\n    lines.push('```');\n    lines.push('');\n  }\n\n  // Lessons section\n  if (context.lessons.length > 0) {\n    lines.push(`### Relevant Lessons (Top ${context.lessons.length})`);\n    lines.push('');\n\n    for (let i = 0; i < context.lessons.length; i++) {\n      const lesson = context.lessons[i];\n      if (!lesson) continue;\n\n      const confidence =\n        lesson.metrics.confidence >= 0.8\n          ? 'HIGH'\n          : lesson.metrics.confidence >= 0.5\n            ? 'MEDIUM'\n            : 'LOW';\n      lines.push(`${i + 1}. **[${confidence}] ${lesson.id}: ${lesson.title}**`);\n      lines.push(`   - Trigger: ${lesson.trigger}`);\n      lines.push(`   - Pattern: \\`${lesson.pattern.slice(0, 100)}${lesson.pattern.length > 100 ? '...' : ''}\\``);\n      lines.push('');\n    }\n  }\n\n  // Quirks section\n  if (context.quirks.length > 0) {\n    lines.push('### Known Quirks for This Scope');\n    lines.push('');\n\n    for (const quirk of context.quirks) {\n      lines.push(`- **${quirk.id} (${quirk.component})**: ${quirk.quirk}`);\n      if (quirk.workaround) {\n        lines.push(`  - Workaround: ${quirk.workaround}`);\n      }\n    }\n    lines.push('');\n  }\n\n  lines.push('---');\n\n  return lines.join('\\n');\n}\n\n/**\n * Get scopes relevant to the app profile\n */\nexport function getRelevantScopes(appProfile: AppProfile | null): LLKBScope[] {\n  const scopes: LLKBScope[] = ['universal', 'app-specific'];\n\n  if (appProfile) {\n    if (appProfile.application.framework !== 'other') {\n      scopes.push(`framework:${appProfile.application.framework}` as LLKBScope);\n    }\n    if (appProfile.application.dataGrid !== 'none') {\n      scopes.push(`framework:${appProfile.application.dataGrid}` as LLKBScope);\n    }\n    if (appProfile.application.uiLibrary !== 'custom' && appProfile.application.uiLibrary !== 'none') {\n      scopes.push(`framework:${appProfile.application.uiLibrary}` as LLKBScope);\n    }\n  }\n\n  return scopes;\n}\n","/**\n * LLKB Component Matching Module\n *\n * This module provides functions to match journey steps to existing components\n * and determine whether code should be extracted as a reusable component.\n *\n * @module llkb/matching\n */\n\nimport type {\n  Component,\n  ComponentCategory,\n  LLKBScope,\n  LLKBConfig,\n  ExtractionCandidate,\n} from './types.js';\nimport { normalizeCode, hashCode, countLines } from './normalize.js';\nimport { calculateSimilarity } from './similarity.js';\nimport { inferCategory } from './inference.js';\n\n// =============================================================================\n// Types\n// =============================================================================\n\n/**\n * A journey step to match against components\n */\nexport interface JourneyStep {\n  /** Step name or description */\n  name: string;\n\n  /** Step description (if separate from name) */\n  description?: string;\n\n  /** Action keywords (verify, navigate, click, etc.) */\n  keywords?: string[];\n\n  /** The journey scope */\n  scope?: string;\n\n  /** Inline code if available */\n  code?: string;\n}\n\n/**\n * Result of matching a step to a component\n */\nexport interface StepMatchResult {\n  /** The step that was matched */\n  step: JourneyStep;\n\n  /** Matched component (if any) */\n  component: Component | null;\n\n  /** Match score (0.0 - 1.0) */\n  score: number;\n\n  /** Match recommendation */\n  recommendation: 'USE' | 'SUGGEST' | 'NONE';\n\n  /** Reason for the recommendation */\n  reason: string;\n}\n\n/**\n * Options for step matching\n */\nexport interface MatchOptions {\n  /** Minimum score to use component (default: 0.7) */\n  useThreshold?: number;\n\n  /** Minimum score to suggest component (default: 0.4) */\n  suggestThreshold?: number;\n\n  /** App framework for scope filtering */\n  appFramework?: string;\n\n  /** Filter by categories */\n  categories?: ComponentCategory[];\n}\n\n/**\n * Result of extraction check\n */\nexport interface ExtractionCheckResult {\n  /** Whether the code should be extracted */\n  shouldExtract: boolean;\n\n  /** Confidence score (0.0 - 1.0) */\n  confidence: number;\n\n  /** Reason for the decision */\n  reason: string;\n\n  /** Suggested component category */\n  suggestedCategory?: ComponentCategory;\n\n  /** Suggested module path */\n  suggestedPath?: string;\n}\n\n/**\n * Pattern occurrence info for extraction analysis\n */\nexport interface PatternOccurrence {\n  /** File path */\n  file: string;\n\n  /** Journey ID */\n  journeyId: string;\n\n  /** Step name */\n  stepName: string;\n\n  /** Line start */\n  lineStart: number;\n\n  /** Line end */\n  lineEnd: number;\n}\n\n// =============================================================================\n// Constants\n// =============================================================================\n\n/** Common action keywords for step analysis */\nconst ACTION_KEYWORDS = [\n  'verify',\n  'check',\n  'assert',\n  'expect',\n  'navigate',\n  'goto',\n  'click',\n  'fill',\n  'type',\n  'select',\n  'wait',\n  'load',\n  'submit',\n  'upload',\n  'download',\n  'hover',\n  'drag',\n  'drop',\n  'scroll',\n  'resize',\n  'close',\n  'open',\n  'toggle',\n  'expand',\n  'collapse',\n  'search',\n  'filter',\n  'sort',\n  'create',\n  'delete',\n  'update',\n  'edit',\n  'save',\n  'cancel',\n  'confirm',\n  'login',\n  'logout',\n  'authenticate',\n];\n\n/** Common UI patterns that indicate reusable components */\nconst REUSABLE_PATTERNS = [\n  { pattern: /navigation|sidebar|menu|breadcrumb/i, category: 'navigation' as ComponentCategory },\n  { pattern: /form|input|submit|validation/i, category: 'ui-interaction' as ComponentCategory },\n  { pattern: /table|grid|row|cell|column/i, category: 'data' as ComponentCategory },\n  { pattern: /modal|dialog|popup|overlay/i, category: 'ui-interaction' as ComponentCategory },\n  { pattern: /toast|alert|notification|message/i, category: 'assertion' as ComponentCategory },\n  { pattern: /login|auth|logout|session/i, category: 'auth' as ComponentCategory },\n  { pattern: /loading|spinner|skeleton|progress/i, category: 'timing' as ComponentCategory },\n  { pattern: /select|dropdown|picker|autocomplete/i, category: 'ui-interaction' as ComponentCategory },\n  { pattern: /tab|accordion|panel|collapse/i, category: 'ui-interaction' as ComponentCategory },\n  { pattern: /search|filter|sort|pagination/i, category: 'data' as ComponentCategory },\n];\n\n// =============================================================================\n// Step Matching Functions\n// =============================================================================\n\n/**\n * Extract keywords from a journey step\n */\nexport function extractStepKeywords(step: JourneyStep): string[] {\n  const text = `${step.name} ${step.description || ''}`.toLowerCase();\n  const keywords: string[] = [];\n\n  // Extract action keywords\n  for (const keyword of ACTION_KEYWORDS) {\n    if (text.includes(keyword)) {\n      keywords.push(keyword);\n    }\n  }\n\n  // Add explicit keywords\n  if (step.keywords) {\n    keywords.push(...step.keywords.map((k) => k.toLowerCase()));\n  }\n\n  // Extract potential UI element keywords\n  const elementMatches = text.match(/\\b(button|link|input|field|table|grid|form|modal|dialog|toast|sidebar|menu|dropdown|checkbox|radio)\\b/gi);\n  if (elementMatches) {\n    keywords.push(...elementMatches.map((m) => m.toLowerCase()));\n  }\n\n  return [...new Set(keywords)];\n}\n\n/**\n * Calculate similarity between step and component\n */\nfunction calculateStepComponentSimilarity(\n  step: JourneyStep,\n  component: Component,\n  stepKeywords: string[]\n): number {\n  let score = 0;\n  let factors = 0;\n\n  // 1. Category match (if step has code, infer category)\n  if (step.code) {\n    const stepCategory = inferCategory(step.code);\n    if (stepCategory === component.category) {\n      score += 0.3;\n    }\n  }\n  factors += 0.3;\n\n  // 2. Keyword overlap\n  const componentKeywords = [\n    component.category,\n    ...(component.description?.toLowerCase().split(/\\s+/) || []),\n    component.name.toLowerCase(),\n  ];\n\n  const keywordOverlap = stepKeywords.filter((k) =>\n    componentKeywords.some((ck) => ck.includes(k) || k.includes(ck))\n  ).length;\n\n  const keywordScore = Math.min(keywordOverlap / Math.max(stepKeywords.length, 1), 1);\n  score += keywordScore * 0.4;\n  factors += 0.4;\n\n  // 3. Name similarity\n  const stepText = `${step.name} ${step.description || ''}`.toLowerCase();\n  const componentText = `${component.name} ${component.description}`.toLowerCase();\n\n  // Simple word overlap\n  const stepWords = new Set(stepText.split(/\\s+/).filter((w) => w.length > 2));\n  const componentWords = new Set(componentText.split(/\\s+/).filter((w) => w.length > 2));\n\n  let overlap = 0;\n  for (const word of stepWords) {\n    if (componentWords.has(word)) {\n      overlap++;\n    }\n  }\n\n  const nameScore = overlap / Math.max(stepWords.size, 1);\n  score += nameScore * 0.3;\n  factors += 0.3;\n\n  return score / factors;\n}\n\n/**\n * Check if component scope matches journey scope\n */\nfunction scopeMatches(\n  componentScope: LLKBScope,\n  _journeyScope: string | undefined,\n  appFramework?: string\n): boolean {\n  // Universal scope matches everything\n  if (componentScope === 'universal') {\n    return true;\n  }\n\n  // Framework-specific scope\n  if (componentScope.startsWith('framework:')) {\n    const framework = componentScope.replace('framework:', '');\n    return appFramework === framework;\n  }\n\n  // App-specific scope always matches within the same app\n  if (componentScope === 'app-specific') {\n    return true;\n  }\n\n  return false;\n}\n\n/**\n * Match journey steps to existing components\n *\n * For each step, finds the best matching component and provides\n * a recommendation on whether to use it, suggest it, or skip.\n *\n * @param steps - Array of journey steps to match\n * @param components - Available components to match against\n * @param options - Matching options\n * @returns Array of match results for each step\n *\n * @example\n * ```typescript\n * const results = matchStepsToComponents(\n *   [{ name: 'Verify sidebar is ready', scope: 'orders' }],\n *   components,\n *   { appFramework: 'angular', useThreshold: 0.7 }\n * );\n * ```\n */\nexport function matchStepsToComponents(\n  steps: JourneyStep[],\n  components: Component[],\n  options: MatchOptions = {}\n): StepMatchResult[] {\n  const { useThreshold = 0.7, suggestThreshold = 0.4, appFramework, categories } = options;\n\n  // Filter components by scope and category\n  const filteredComponents = components.filter((c) => {\n    // Skip archived components\n    if (c.archived) {\n      return false;\n    }\n\n    // Filter by category if specified\n    if (categories && categories.length > 0 && !categories.includes(c.category)) {\n      return false;\n    }\n\n    return true;\n  });\n\n  return steps.map((step) => {\n    const stepKeywords = extractStepKeywords(step);\n\n    // Find best matching component\n    let bestMatch: Component | null = null;\n    let bestScore = 0;\n\n    for (const component of filteredComponents) {\n      // Check scope compatibility\n      if (!scopeMatches(component.scope, step.scope, appFramework)) {\n        continue;\n      }\n\n      const score = calculateStepComponentSimilarity(step, component, stepKeywords);\n\n      if (score > bestScore) {\n        bestScore = score;\n        bestMatch = component;\n      }\n    }\n\n    // Determine recommendation\n    let recommendation: 'USE' | 'SUGGEST' | 'NONE';\n    let reason: string;\n\n    if (bestScore >= useThreshold) {\n      recommendation = 'USE';\n      reason = `High confidence match (${(bestScore * 100).toFixed(0)}%) - use ${bestMatch!.name} component`;\n    } else if (bestScore >= suggestThreshold) {\n      recommendation = 'SUGGEST';\n      reason = `Moderate match (${(bestScore * 100).toFixed(0)}%) - consider ${bestMatch!.name} component`;\n    } else {\n      recommendation = 'NONE';\n      reason = bestMatch\n        ? `Low match score (${(bestScore * 100).toFixed(0)}%) - write inline code`\n        : 'No matching components found';\n      bestMatch = null;\n    }\n\n    return {\n      step,\n      component: bestMatch,\n      score: bestScore,\n      recommendation,\n      reason,\n    };\n  });\n}\n\n// =============================================================================\n// Extraction Detection Functions\n// =============================================================================\n\n/**\n * Determine if code pattern matches a reusable pattern\n */\nfunction matchesReusablePattern(code: string): {\n  matches: boolean;\n  category?: ComponentCategory;\n} {\n  for (const { pattern, category } of REUSABLE_PATTERNS) {\n    if (pattern.test(code)) {\n      return { matches: true, category };\n    }\n  }\n  return { matches: false };\n}\n\n/**\n * Suggest module path for component based on category and scope\n */\nfunction suggestModulePath(category: ComponentCategory, scope: LLKBScope): string {\n  if (scope === 'universal') {\n    return `@artk/core/${category}`;\n  }\n\n  if (scope.startsWith('framework:')) {\n    const framework = scope.replace('framework:', '');\n    return `@artk/core/${framework}/${category}`;\n  }\n\n  // App-specific\n  return `modules/foundation/${category}`;\n}\n\n/**\n * Determine if code should be extracted as a reusable component\n *\n * Analyzes code patterns, occurrences, and configuration to decide\n * whether to extract the code into a reusable module.\n *\n * @param code - The code to analyze\n * @param occurrences - Where this pattern appears\n * @param config - LLKB configuration\n * @param existingComponents - Existing components to check for duplicates\n * @returns Extraction check result with recommendation\n *\n * @example\n * ```typescript\n * const result = shouldExtractAsComponent(\n *   'await page.waitForSelector(\".sidebar\");',\n *   [{ file: 'test1.spec.ts', journeyId: 'JRN-001', stepName: 'Verify sidebar', lineStart: 10, lineEnd: 15 }],\n *   config,\n *   existingComponents\n * );\n * if (result.shouldExtract) {\n *   // Extract as component\n * }\n * ```\n */\nexport function shouldExtractAsComponent(\n  code: string,\n  occurrences: PatternOccurrence[],\n  config: LLKBConfig,\n  existingComponents: Component[] = []\n): ExtractionCheckResult {\n  const {\n    minOccurrences = 2,\n    predictiveExtraction = true,\n    minLinesForExtraction = 3,\n    similarityThreshold = 0.8,\n  } = config.extraction;\n\n  // 1. Check minimum lines\n  const lineCount = countLines(code);\n  if (lineCount < minLinesForExtraction) {\n    return {\n      shouldExtract: false,\n      confidence: 0,\n      reason: `Code too short (${lineCount} lines < ${minLinesForExtraction} minimum)`,\n    };\n  }\n\n  // 2. Check for existing similar component\n  const normalizedCode = normalizeCode(code);\n\n  for (const component of existingComponents) {\n    if (component.archived) continue;\n\n    // Check source code similarity\n    const sourceNormalized = normalizeCode(component.source.originalCode);\n    const similarity = calculateSimilarity(normalizedCode, sourceNormalized);\n\n    if (similarity >= similarityThreshold) {\n      return {\n        shouldExtract: false,\n        confidence: 1.0,\n        reason: `Similar component already exists: ${component.name} (${(similarity * 100).toFixed(0)}% similar)`,\n      };\n    }\n  }\n\n  // 3. Infer category and check reusable patterns\n  const category = inferCategory(code);\n  const patternMatch = matchesReusablePattern(code);\n\n  // 4. Check occurrence threshold\n  const uniqueJourneys = new Set(occurrences.map((o) => o.journeyId)).size;\n\n  if (occurrences.length >= minOccurrences) {\n    return {\n      shouldExtract: true,\n      confidence: Math.min(0.7 + uniqueJourneys * 0.1, 0.95),\n      reason: `Pattern appears ${occurrences.length} times across ${uniqueJourneys} journey(s) (>= ${minOccurrences} threshold)`,\n      suggestedCategory: patternMatch.category || category,\n      suggestedPath: suggestModulePath(patternMatch.category || category, 'app-specific'),\n    };\n  }\n\n  // 5. Check predictive extraction\n  if (predictiveExtraction && patternMatch.matches) {\n    return {\n      shouldExtract: true,\n      confidence: 0.6,\n      reason: `Predictive extraction: matches common ${patternMatch.category} pattern`,\n      suggestedCategory: patternMatch.category,\n      suggestedPath: suggestModulePath(patternMatch.category!, 'app-specific'),\n    };\n  }\n\n  // 6. Single occurrence, not a common pattern\n  if (occurrences.length === 1 && !patternMatch.matches) {\n    return {\n      shouldExtract: false,\n      confidence: 0.3,\n      reason: 'Single occurrence, not a common pattern - keep inline',\n      suggestedCategory: category,\n    };\n  }\n\n  // 7. Default: not enough evidence\n  return {\n    shouldExtract: false,\n    confidence: 0.4,\n    reason: `Not enough occurrences (${occurrences.length} < ${minOccurrences}) and no common pattern match`,\n    suggestedCategory: category,\n  };\n}\n\n/**\n * Analyze multiple code snippets and identify extraction candidates\n *\n * Groups similar code patterns and recommends which ones to extract.\n *\n * @param codeSnippets - Array of code snippets with metadata\n * @param config - LLKB configuration\n * @param existingComponents - Existing components\n * @returns Array of extraction candidates sorted by score\n */\nexport function findExtractionCandidates(\n  codeSnippets: Array<{\n    code: string;\n    file: string;\n    journeyId: string;\n    stepName: string;\n    lineStart: number;\n    lineEnd: number;\n  }>,\n  config: LLKBConfig,\n  existingComponents: Component[] = []\n): ExtractionCandidate[] {\n  const { similarityThreshold = 0.8 } = config.extraction;\n\n  // Group similar patterns\n  const groups: Map<string, PatternOccurrence[]> = new Map();\n  const codeByHash: Map<string, string> = new Map();\n\n  for (const snippet of codeSnippets) {\n    const normalized = normalizeCode(snippet.code);\n    const hash = hashCode(normalized);\n\n    // Check if this is similar to an existing group\n    let matchedHash: string | null = null;\n\n    for (const [existingHash, existingCode] of codeByHash.entries()) {\n      const similarity = calculateSimilarity(normalized, existingCode);\n      if (similarity >= similarityThreshold) {\n        matchedHash = existingHash;\n        break;\n      }\n    }\n\n    const groupHash = matchedHash || hash;\n\n    if (!groups.has(groupHash)) {\n      groups.set(groupHash, []);\n      codeByHash.set(groupHash, normalized);\n    }\n\n    groups.get(groupHash)!.push({\n      file: snippet.file,\n      journeyId: snippet.journeyId,\n      stepName: snippet.stepName,\n      lineStart: snippet.lineStart,\n      lineEnd: snippet.lineEnd,\n    });\n  }\n\n  // Analyze each group\n  const candidates: ExtractionCandidate[] = [];\n\n  for (const [hash, occurrences] of groups.entries()) {\n    const code = codeByHash.get(hash)!;\n    const firstOccurrence = occurrences[0];\n\n    // Skip if no occurrences (should not happen, but TypeScript requires check)\n    if (!firstOccurrence) continue;\n\n    // Get original code from first occurrence\n    const originalSnippet = codeSnippets.find(\n      (s) =>\n        s.file === firstOccurrence.file &&\n        s.lineStart === firstOccurrence.lineStart\n    );\n\n    const checkResult = shouldExtractAsComponent(\n      originalSnippet?.code || code,\n      occurrences,\n      config,\n      existingComponents\n    );\n\n    // Calculate extraction score\n    const uniqueJourneys = new Set(occurrences.map((o) => o.journeyId)).size;\n    const score = occurrences.length * 0.3 + uniqueJourneys * 0.4 + checkResult.confidence * 0.3;\n\n    let recommendation: 'EXTRACT_NOW' | 'CONSIDER' | 'SKIP';\n    if (checkResult.shouldExtract && score >= 0.7) {\n      recommendation = 'EXTRACT_NOW';\n    } else if (checkResult.shouldExtract || score >= 0.5) {\n      recommendation = 'CONSIDER';\n    } else {\n      recommendation = 'SKIP';\n    }\n\n    candidates.push({\n      pattern: code,\n      originalCode: originalSnippet?.code || code,\n      occurrences: occurrences.length,\n      journeys: [...new Set(occurrences.map((o) => o.journeyId))],\n      files: [...new Set(occurrences.map((o) => o.file))],\n      category: checkResult.suggestedCategory || inferCategory(code),\n      score,\n      recommendation,\n    });\n  }\n\n  // Sort by score descending\n  return candidates.sort((a, b) => b.score - a.score);\n}\n","/**\n * LLKB Cross-Journey Detection Module\n *\n * This module provides functions to detect duplicate patterns across\n * multiple journey test files and identify extraction opportunities.\n *\n * @module llkb/detection\n */\n\nimport * as fs from 'fs';\nimport * as path from 'path';\nimport type { TestStep, ExtractionCandidate, Component } from './types.js';\nimport { normalizeCode, hashCode, countLines } from './normalize.js';\nimport { calculateSimilarity } from './similarity.js';\nimport { inferCategory } from './inference.js';\n\n// =============================================================================\n// Types\n// =============================================================================\n\n/**\n * Result of duplicate detection across files\n */\nexport interface DuplicateDetectionResult {\n  /** All test steps extracted from files */\n  totalSteps: number;\n\n  /** Number of unique patterns found */\n  uniquePatterns: number;\n\n  /** Number of duplicate patterns found */\n  duplicatePatterns: number;\n\n  /** Duplicate groups with their occurrences */\n  duplicateGroups: DuplicateGroup[];\n\n  /** Extraction candidates (sorted by priority) */\n  extractionCandidates: ExtractionCandidate[];\n\n  /** Files analyzed */\n  filesAnalyzed: string[];\n}\n\n/**\n * A group of duplicate patterns\n */\nexport interface DuplicateGroup {\n  /** Hash of the normalized pattern */\n  patternHash: string;\n\n  /** Normalized pattern code */\n  normalizedCode: string;\n\n  /** Original code samples */\n  originalSamples: string[];\n\n  /** All occurrences */\n  occurrences: TestStep[];\n\n  /** Number of unique journeys */\n  uniqueJourneys: number;\n\n  /** Number of unique files */\n  uniqueFiles: number;\n\n  /** Inferred category */\n  category: string;\n\n  /** Similarity score between occurrences */\n  internalSimilarity: number;\n}\n\n/**\n * Options for duplicate detection\n */\nexport interface DetectionOptions {\n  /** Minimum similarity threshold (default: 0.8) */\n  similarityThreshold?: number;\n\n  /** Minimum occurrences to report (default: 2) */\n  minOccurrences?: number;\n\n  /** Minimum lines for a pattern (default: 3) */\n  minLines?: number;\n\n  /** Include archived patterns */\n  includeArchived?: boolean;\n\n  /** File extensions to scan (default: ['.ts', '.js']) */\n  extensions?: string[];\n\n  /** Directories to exclude */\n  excludeDirs?: string[];\n}\n\n/**\n * Parsed test step from file analysis\n */\ninterface ParsedStep {\n  file: string;\n  journeyId: string;\n  stepName: string;\n  code: string;\n  lineStart: number;\n  lineEnd: number;\n}\n\n// =============================================================================\n// Constants\n// =============================================================================\n\n/** Default file extensions to scan */\nconst DEFAULT_EXTENSIONS = ['.ts', '.js'];\n\n/** Default directories to exclude */\nconst DEFAULT_EXCLUDE_DIRS = ['node_modules', 'dist', 'build', '.git', 'coverage'];\n\n/** Regex to extract test.step blocks */\nconst TEST_STEP_REGEX = /(?:await\\s+)?test\\.step\\s*\\(\\s*(['\"`])(.+?)\\1\\s*,\\s*async\\s*\\([^)]*\\)\\s*=>\\s*\\{([\\s\\S]*?)\\}\\s*\\)/g;\n\n/** Regex to extract journey ID from file */\nconst JOURNEY_ID_REGEX = /(?:JRN|jrn)[-_]?(\\d+)/i;\n\n// =============================================================================\n// File Parsing Functions\n// =============================================================================\n\n/**\n * Extract journey ID from file path or content\n */\nfunction extractJourneyId(filePath: string, content: string): string {\n  // Try filename first\n  const fileMatch = path.basename(filePath).match(JOURNEY_ID_REGEX);\n  if (fileMatch && fileMatch[1]) {\n    return `JRN-${fileMatch[1].padStart(4, '0')}`;\n  }\n\n  // Try content\n  const contentMatch = content.match(JOURNEY_ID_REGEX);\n  if (contentMatch && contentMatch[1]) {\n    return `JRN-${contentMatch[1].padStart(4, '0')}`;\n  }\n\n  // Generate from filename\n  const basename = path.basename(filePath, path.extname(filePath));\n  return `JRN-${basename.toUpperCase().replace(/[^A-Z0-9]/g, '-').slice(0, 20)}`;\n}\n\n/**\n * Parse test.step blocks from file content\n */\nfunction parseTestSteps(filePath: string, content: string): ParsedStep[] {\n  const steps: ParsedStep[] = [];\n  const journeyId = extractJourneyId(filePath, content);\n\n  // Reset regex\n  TEST_STEP_REGEX.lastIndex = 0;\n\n  let match: RegExpExecArray | null;\n  while ((match = TEST_STEP_REGEX.exec(content)) !== null) {\n    const stepName = match[2];\n    const stepCode = match[3];\n\n    // Skip if we didn't capture properly\n    if (!stepName || !stepCode) continue;\n\n    const trimmedCode = stepCode.trim();\n\n    // Calculate line numbers\n    const beforeMatch = content.slice(0, match.index);\n    const lineStart = beforeMatch.split('\\n').length;\n    const lineEnd = lineStart + match[0].split('\\n').length - 1;\n\n    // Only include steps with actual code (not just comments)\n    const codeWithoutComments = trimmedCode.replace(/\\/\\/.*$/gm, '').replace(/\\/\\*[\\s\\S]*?\\*\\//g, '').trim();\n    if (codeWithoutComments.length > 0) {\n      steps.push({\n        file: filePath,\n        journeyId,\n        stepName,\n        code: trimmedCode,\n        lineStart,\n        lineEnd,\n      });\n    }\n  }\n\n  return steps;\n}\n\n/**\n * Recursively find test files in directory\n */\nfunction findTestFiles(\n  dir: string,\n  extensions: string[],\n  excludeDirs: string[]\n): string[] {\n  const files: string[] = [];\n\n  if (!fs.existsSync(dir)) {\n    return files;\n  }\n\n  const entries = fs.readdirSync(dir, { withFileTypes: true });\n\n  for (const entry of entries) {\n    const fullPath = path.join(dir, entry.name);\n\n    if (entry.isDirectory()) {\n      if (!excludeDirs.includes(entry.name)) {\n        files.push(...findTestFiles(fullPath, extensions, excludeDirs));\n      }\n    } else if (entry.isFile()) {\n      const ext = path.extname(entry.name);\n      if (extensions.includes(ext)) {\n        // Look for test files specifically\n        if (\n          entry.name.includes('.spec.') ||\n          entry.name.includes('.test.') ||\n          entry.name.includes('.e2e.')\n        ) {\n          files.push(fullPath);\n        }\n      }\n    }\n  }\n\n  return files;\n}\n\n// =============================================================================\n// Duplicate Detection Functions\n// =============================================================================\n\n/**\n * Group similar patterns together\n */\nfunction groupSimilarPatterns(\n  steps: ParsedStep[],\n  similarityThreshold: number,\n  minLines: number\n): Map<string, ParsedStep[]> {\n  const groups: Map<string, ParsedStep[]> = new Map();\n  const normalizedByStep: Map<ParsedStep, string> = new Map();\n\n  // Normalize all steps\n  for (const step of steps) {\n    const normalized = normalizeCode(step.code);\n    const lineCount = countLines(step.code);\n\n    // Skip steps that are too short\n    if (lineCount < minLines) {\n      continue;\n    }\n\n    normalizedByStep.set(step, normalized);\n  }\n\n  // Group by similarity\n  const processed = new Set<ParsedStep>();\n\n  for (const [step, normalized] of normalizedByStep) {\n    if (processed.has(step)) continue;\n\n    const hash = hashCode(normalized);\n    let foundGroup = false;\n\n    // Check if this is similar to an existing group\n    for (const [groupHash, groupSteps] of groups) {\n      const firstGroupStep = groupSteps[0];\n      if (!firstGroupStep) continue;\n\n      const groupNormalized = normalizedByStep.get(firstGroupStep);\n      if (!groupNormalized) continue;\n\n      const similarity = calculateSimilarity(normalized, groupNormalized);\n\n      if (similarity >= similarityThreshold) {\n        const existingGroup = groups.get(groupHash);\n        if (existingGroup) {\n          existingGroup.push(step);\n        }\n        processed.add(step);\n        foundGroup = true;\n        break;\n      }\n    }\n\n    // Create new group if no match found\n    if (!foundGroup) {\n      groups.set(hash, [step]);\n      processed.add(step);\n    }\n  }\n\n  return groups;\n}\n\n/**\n * Convert step groups to duplicate groups with metadata\n */\nfunction buildDuplicateGroups(\n  stepGroups: Map<string, ParsedStep[]>,\n  minOccurrences: number\n): DuplicateGroup[] {\n  const duplicateGroups: DuplicateGroup[] = [];\n\n  for (const [hash, steps] of stepGroups) {\n    // Only include groups with multiple occurrences\n    if (steps.length < minOccurrences) {\n      continue;\n    }\n\n    const uniqueJourneys = new Set(steps.map((s) => s.journeyId)).size;\n    const uniqueFiles = new Set(steps.map((s) => s.file)).size;\n\n    // Calculate internal similarity (average pairwise similarity)\n    let totalSimilarity = 0;\n    let pairs = 0;\n\n    for (let i = 0; i < steps.length; i++) {\n      for (let j = i + 1; j < steps.length; j++) {\n        const stepI = steps[i];\n        const stepJ = steps[j];\n        if (!stepI || !stepJ) continue;\n\n        const sim = calculateSimilarity(\n          normalizeCode(stepI.code),\n          normalizeCode(stepJ.code)\n        );\n        totalSimilarity += sim;\n        pairs++;\n      }\n    }\n\n    const internalSimilarity = pairs > 0 ? totalSimilarity / pairs : 1.0;\n\n    // Collect original samples (up to 3)\n    const originalSamples = steps.slice(0, 3).map((s) => s.code);\n\n    // Infer category from first step\n    const firstStep = steps[0];\n    if (!firstStep) continue;\n\n    const category = inferCategory(firstStep.code);\n\n    // Convert to TestStep format\n    const occurrences: TestStep[] = steps.map((s) => ({\n      file: s.file,\n      journey: s.journeyId,\n      stepName: s.stepName,\n      code: s.code,\n      normalizedCode: normalizeCode(s.code),\n      hash: hashCode(normalizeCode(s.code)),\n      lineStart: s.lineStart,\n      lineEnd: s.lineEnd,\n    }));\n\n    duplicateGroups.push({\n      patternHash: hash,\n      normalizedCode: normalizeCode(firstStep.code),\n      originalSamples,\n      occurrences,\n      uniqueJourneys,\n      uniqueFiles,\n      category,\n      internalSimilarity,\n    });\n  }\n\n  // Sort by number of occurrences (descending)\n  return duplicateGroups.sort((a, b) => b.occurrences.length - a.occurrences.length);\n}\n\n/**\n * Detect duplicate patterns across multiple test files\n *\n * Scans test files for test.step blocks, normalizes the code,\n * and groups similar patterns to identify extraction opportunities.\n *\n * @param testDir - Directory containing test files\n * @param options - Detection options\n * @returns Duplicate detection result with groups and candidates\n *\n * @example\n * ```typescript\n * const result = detectDuplicatesAcrossFiles(\n *   'artk-e2e/tests',\n *   { similarityThreshold: 0.8, minOccurrences: 2 }\n * );\n * console.log(`Found ${result.duplicatePatterns} duplicate patterns`);\n * ```\n */\nexport function detectDuplicatesAcrossFiles(\n  testDir: string,\n  options: DetectionOptions = {}\n): DuplicateDetectionResult {\n  const {\n    similarityThreshold = 0.8,\n    minOccurrences = 2,\n    minLines = 3,\n    extensions = DEFAULT_EXTENSIONS,\n    excludeDirs = DEFAULT_EXCLUDE_DIRS,\n  } = options;\n\n  // Find all test files\n  const testFiles = findTestFiles(testDir, extensions, excludeDirs);\n\n  // Parse all test steps\n  const allSteps: ParsedStep[] = [];\n\n  for (const file of testFiles) {\n    try {\n      const content = fs.readFileSync(file, 'utf-8');\n      const steps = parseTestSteps(file, content);\n      allSteps.push(...steps);\n    } catch (error) {\n      // Skip files that can't be read\n      console.warn(`Warning: Could not read file ${file}`);\n    }\n  }\n\n  // Group similar patterns\n  const stepGroups = groupSimilarPatterns(allSteps, similarityThreshold, minLines);\n\n  // Build duplicate groups\n  const duplicateGroups = buildDuplicateGroups(stepGroups, minOccurrences);\n\n  // Count unique patterns (groups with 1 occurrence)\n  const uniquePatterns = Array.from(stepGroups.values()).filter(\n    (g) => g.length === 1\n  ).length;\n\n  // Convert to extraction candidates format\n  const extractionCandidates: ExtractionCandidate[] = duplicateGroups.map((group) => ({\n    pattern: group.normalizedCode,\n    originalCode: group.originalSamples[0] || group.normalizedCode,\n    occurrences: group.occurrences.length,\n    journeys: [...new Set(group.occurrences.map((o) => o.journey))],\n    files: [...new Set(group.occurrences.map((o) => o.file))],\n    category: group.category as ExtractionCandidate['category'],\n    score: (group.occurrences.length * 0.3 + group.uniqueJourneys * 0.4 + group.internalSimilarity * 0.3),\n    recommendation:\n      group.occurrences.length >= 3 ? 'EXTRACT_NOW' :\n      group.occurrences.length >= 2 ? 'CONSIDER' : 'SKIP',\n  }));\n\n  return {\n    totalSteps: allSteps.length,\n    uniquePatterns,\n    duplicatePatterns: duplicateGroups.length,\n    duplicateGroups,\n    extractionCandidates: extractionCandidates.sort((a, b) => b.score - a.score),\n    filesAnalyzed: testFiles,\n  };\n}\n\n/**\n * Detect duplicates within a single file\n *\n * @param filePath - Path to the test file\n * @param options - Detection options\n * @returns Duplicate detection result\n */\nexport function detectDuplicatesInFile(\n  filePath: string,\n  options: DetectionOptions = {}\n): DuplicateDetectionResult {\n  const {\n    similarityThreshold = 0.8,\n    minOccurrences = 2,\n    minLines = 2, // Lower threshold for single file\n  } = options;\n\n  if (!fs.existsSync(filePath)) {\n    return {\n      totalSteps: 0,\n      uniquePatterns: 0,\n      duplicatePatterns: 0,\n      duplicateGroups: [],\n      extractionCandidates: [],\n      filesAnalyzed: [],\n    };\n  }\n\n  const content = fs.readFileSync(filePath, 'utf-8');\n  const steps = parseTestSteps(filePath, content);\n\n  // Group similar patterns\n  const stepGroups = groupSimilarPatterns(steps, similarityThreshold, minLines);\n\n  // Build duplicate groups\n  const duplicateGroups = buildDuplicateGroups(stepGroups, minOccurrences);\n\n  // Count unique patterns\n  const uniquePatterns = Array.from(stepGroups.values()).filter(\n    (g) => g.length === 1\n  ).length;\n\n  // Convert to extraction candidates\n  const extractionCandidates: ExtractionCandidate[] = duplicateGroups.map((group) => {\n    const firstOccurrence = group.occurrences[0];\n    return {\n      pattern: group.normalizedCode,\n      originalCode: group.originalSamples[0] || group.normalizedCode,\n      occurrences: group.occurrences.length,\n      journeys: firstOccurrence ? [firstOccurrence.journey] : [],\n      files: [filePath],\n      category: group.category as ExtractionCandidate['category'],\n      score: group.occurrences.length * 0.5 + group.internalSimilarity * 0.5,\n      recommendation: group.occurrences.length >= 2 ? 'CONSIDER' : 'SKIP',\n    };\n  });\n\n  return {\n    totalSteps: steps.length,\n    uniquePatterns,\n    duplicatePatterns: duplicateGroups.length,\n    duplicateGroups,\n    extractionCandidates: extractionCandidates.sort((a, b) => b.score - a.score),\n    filesAnalyzed: [filePath],\n  };\n}\n\n/**\n * Find patterns in test files that match existing components\n *\n * Useful for identifying code that should be refactored to use components.\n *\n * @param testDir - Directory containing test files\n * @param components - Existing components to match against\n * @param options - Detection options\n * @returns Array of matches with component and location\n */\nexport function findUnusedComponentOpportunities(\n  testDir: string,\n  components: Component[],\n  options: DetectionOptions = {}\n): Array<{\n  component: Component;\n  matches: Array<{\n    file: string;\n    stepName: string;\n    similarity: number;\n    lineStart: number;\n    lineEnd: number;\n  }>;\n}> {\n  const {\n    similarityThreshold = 0.6, // Lower threshold for opportunities\n    extensions = DEFAULT_EXTENSIONS,\n    excludeDirs = DEFAULT_EXCLUDE_DIRS,\n  } = options;\n\n  const testFiles = findTestFiles(testDir, extensions, excludeDirs);\n  const opportunities: Map<string, Array<{\n    file: string;\n    stepName: string;\n    similarity: number;\n    lineStart: number;\n    lineEnd: number;\n  }>> = new Map();\n\n  // Initialize map for each component\n  for (const component of components) {\n    if (!component.archived) {\n      opportunities.set(component.id, []);\n    }\n  }\n\n  // Scan all test files\n  for (const file of testFiles) {\n    try {\n      const content = fs.readFileSync(file, 'utf-8');\n      const steps = parseTestSteps(file, content);\n\n      for (const step of steps) {\n        const normalizedStep = normalizeCode(step.code);\n\n        // Compare against each component\n        for (const component of components) {\n          if (component.archived) continue;\n\n          const normalizedComponent = normalizeCode(component.source.originalCode);\n          const similarity = calculateSimilarity(normalizedStep, normalizedComponent);\n\n          if (similarity >= similarityThreshold) {\n            const componentOpportunities = opportunities.get(component.id);\n            if (componentOpportunities) {\n              componentOpportunities.push({\n                file: step.file,\n                stepName: step.stepName,\n                similarity,\n                lineStart: step.lineStart,\n                lineEnd: step.lineEnd,\n              });\n            }\n          }\n        }\n      }\n    } catch {\n      // Skip unreadable files\n    }\n  }\n\n  // Convert to result format\n  return components\n    .filter((c) => {\n      if (c.archived) return false;\n      const ops = opportunities.get(c.id);\n      return ops && ops.length > 0;\n    })\n    .map((component) => ({\n      component,\n      matches: (opportunities.get(component.id) || []).sort((a, b) => b.similarity - a.similarity),\n    }))\n    .sort((a, b) => b.matches.length - a.matches.length);\n}\n","/**\n * LLKB Module Registry Module\n *\n * This module provides functions to manage the module registry,\n * which tracks all exported components and their metadata.\n *\n * @module llkb/registry\n */\n\nimport * as fs from 'fs';\nimport * as path from 'path';\nimport type { Component, ComponentCategory, SaveResult } from './types.js';\nimport { saveJSONAtomic, loadJSON } from './file-utils.js';\n\n// =============================================================================\n// Types\n// =============================================================================\n\n/**\n * An export entry in the module registry\n */\nexport interface ModuleExport {\n  /** Export name */\n  name: string;\n\n  /** Export type (async function, function, class, const) */\n  type: 'async function' | 'function' | 'class' | 'const' | 'type';\n\n  /** Component ID (if registered in components.json) */\n  componentId?: string;\n\n  /** TypeScript signature */\n  signature: string;\n\n  /** Description */\n  description: string;\n}\n\n/**\n * A module entry in the registry\n */\nexport interface ModuleEntry {\n  /** Module name */\n  name: string;\n\n  /** Module path (relative to modules directory) */\n  path: string;\n\n  /** Module description */\n  description: string;\n\n  /** Exports from this module */\n  exports: ModuleExport[];\n\n  /** Dependencies on other modules */\n  dependencies: string[];\n\n  /** Peer dependencies (external packages) */\n  peerDependencies: string[];\n\n  /** Module version */\n  version?: string;\n\n  /** Last updated timestamp */\n  lastUpdated?: string;\n}\n\n/**\n * The modules registry.json file structure\n */\nexport interface ModuleRegistry {\n  /** Schema version */\n  version: string;\n\n  /** Last updated timestamp */\n  lastUpdated: string;\n\n  /** All modules in the registry */\n  modules: ModuleEntry[];\n\n  /** Quick lookup: component ID to module path */\n  componentToModule: Record<string, string>;\n\n  /** Quick lookup: export name to module path */\n  exportToModule: Record<string, string>;\n}\n\n/**\n * Options for adding a component to the registry\n */\nexport interface AddToRegistryOptions {\n  /** Module name (e.g., 'navigation') */\n  moduleName: string;\n\n  /** Module path (e.g., 'foundation/navigation') */\n  modulePath: string;\n\n  /** Module description */\n  moduleDescription?: string;\n\n  /** Export details */\n  exportDetails: {\n    name: string;\n    type: ModuleExport['type'];\n    signature: string;\n    description: string;\n  };\n\n  /** Dependencies */\n  dependencies?: string[];\n\n  /** Peer dependencies */\n  peerDependencies?: string[];\n}\n\n// =============================================================================\n// Constants\n// =============================================================================\n\n/** Default registry file name */\nconst REGISTRY_FILENAME = 'registry.json';\n\n/** Default modules directory */\nconst DEFAULT_MODULES_DIR = 'src/modules';\n\n// =============================================================================\n// Registry Management Functions\n// =============================================================================\n\n/**\n * Get the registry file path\n */\nfunction getRegistryPath(harnessRoot: string): string {\n  return path.join(harnessRoot, DEFAULT_MODULES_DIR, REGISTRY_FILENAME);\n}\n\n/**\n * Create an empty registry\n */\nexport function createEmptyRegistry(): ModuleRegistry {\n  return {\n    version: '1.0.0',\n    lastUpdated: new Date().toISOString(),\n    modules: [],\n    componentToModule: {},\n    exportToModule: {},\n  };\n}\n\n/**\n * Load the module registry\n *\n * @param harnessRoot - Root directory of the test harness\n * @returns The module registry or null if not found\n */\nexport function loadRegistry(harnessRoot: string): ModuleRegistry | null {\n  const registryPath = getRegistryPath(harnessRoot);\n\n  try {\n    const data = loadJSON<ModuleRegistry>(registryPath);\n    return data || createEmptyRegistry();\n  } catch {\n    return null;\n  }\n}\n\n/**\n * Save the module registry\n *\n * @param harnessRoot - Root directory of the test harness\n * @param registry - Registry to save\n * @returns Save result\n */\nexport async function saveRegistry(\n  harnessRoot: string,\n  registry: ModuleRegistry\n): Promise<SaveResult> {\n  const registryPath = getRegistryPath(harnessRoot);\n\n  // Update timestamp\n  registry.lastUpdated = new Date().toISOString();\n\n  // Ensure directory exists\n  const dir = path.dirname(registryPath);\n  if (!fs.existsSync(dir)) {\n    fs.mkdirSync(dir, { recursive: true });\n  }\n\n  return saveJSONAtomic(registryPath, registry);\n}\n\n/**\n * Rebuild lookup indexes in registry\n */\nfunction rebuildIndexes(registry: ModuleRegistry): void {\n  registry.componentToModule = {};\n  registry.exportToModule = {};\n\n  for (const module of registry.modules) {\n    for (const exp of module.exports) {\n      if (exp.componentId) {\n        registry.componentToModule[exp.componentId] = module.path;\n      }\n      registry.exportToModule[exp.name] = module.path;\n    }\n  }\n}\n\n/**\n * Add a component to the module registry\n *\n * If the module exists, adds the export to it. If not, creates a new module entry.\n *\n * @param harnessRoot - Root directory of the test harness\n * @param component - The component to register\n * @param options - Registration options\n * @returns Save result\n *\n * @example\n * ```typescript\n * await addComponentToRegistry(\n *   'artk-e2e',\n *   component,\n *   {\n *     moduleName: 'navigation',\n *     modulePath: 'foundation/navigation',\n *     moduleDescription: 'Navigation utilities',\n *     exportDetails: {\n *       name: 'verifySidebarReady',\n *       type: 'async function',\n *       signature: 'verifySidebarReady(page: Page, options?: Options): Promise<void>',\n *       description: 'Verify sidebar is loaded and interactive',\n *     },\n *   }\n * );\n * ```\n */\nexport async function addComponentToRegistry(\n  harnessRoot: string,\n  component: Component,\n  options: AddToRegistryOptions\n): Promise<SaveResult> {\n  // Load existing registry\n  let registry = loadRegistry(harnessRoot);\n  if (!registry) {\n    registry = createEmptyRegistry();\n  }\n\n  // Find or create module entry\n  let moduleEntry = registry.modules.find((m) => m.path === options.modulePath);\n\n  if (!moduleEntry) {\n    moduleEntry = {\n      name: options.moduleName,\n      path: options.modulePath,\n      description: options.moduleDescription || `${options.moduleName} utilities`,\n      exports: [],\n      dependencies: options.dependencies || [],\n      peerDependencies: options.peerDependencies || ['@playwright/test'],\n      lastUpdated: new Date().toISOString(),\n    };\n    registry.modules.push(moduleEntry);\n  }\n\n  // Check if export already exists\n  const existingExport = moduleEntry.exports.find((e) => e.name === options.exportDetails.name);\n\n  if (existingExport) {\n    // Update existing export\n    existingExport.componentId = component.id;\n    existingExport.signature = options.exportDetails.signature;\n    existingExport.description = options.exportDetails.description;\n  } else {\n    // Add new export\n    moduleEntry.exports.push({\n      name: options.exportDetails.name,\n      type: options.exportDetails.type,\n      componentId: component.id,\n      signature: options.exportDetails.signature,\n      description: options.exportDetails.description,\n    });\n  }\n\n  // Update module timestamp\n  moduleEntry.lastUpdated = new Date().toISOString();\n\n  // Rebuild indexes\n  rebuildIndexes(registry);\n\n  // Save registry\n  return saveRegistry(harnessRoot, registry);\n}\n\n/**\n * Remove a component from the registry\n *\n * @param harnessRoot - Root directory of the test harness\n * @param componentId - ID of the component to remove\n * @returns Save result\n */\nexport async function removeComponentFromRegistry(\n  harnessRoot: string,\n  componentId: string\n): Promise<SaveResult> {\n  const registry = loadRegistry(harnessRoot);\n  if (!registry) {\n    return { success: false, error: 'Registry not found' };\n  }\n\n  // Find and remove the export\n  let found = false;\n  for (const module of registry.modules) {\n    const exportIndex = module.exports.findIndex((e) => e.componentId === componentId);\n    if (exportIndex !== -1) {\n      module.exports.splice(exportIndex, 1);\n      module.lastUpdated = new Date().toISOString();\n      found = true;\n      break;\n    }\n  }\n\n  if (!found) {\n    return { success: false, error: `Component ${componentId} not found in registry` };\n  }\n\n  // Rebuild indexes\n  rebuildIndexes(registry);\n\n  // Save registry\n  return saveRegistry(harnessRoot, registry);\n}\n\n/**\n * Update component details in the registry\n *\n * @param harnessRoot - Root directory of the test harness\n * @param componentId - ID of the component to update\n * @param updates - Fields to update\n * @returns Save result\n */\nexport async function updateComponentInRegistry(\n  harnessRoot: string,\n  componentId: string,\n  updates: Partial<{\n    signature: string;\n    description: string;\n    type: ModuleExport['type'];\n  }>\n): Promise<SaveResult> {\n  const registry = loadRegistry(harnessRoot);\n  if (!registry) {\n    return { success: false, error: 'Registry not found' };\n  }\n\n  // Find the export\n  let found = false;\n  for (const module of registry.modules) {\n    const exportEntry = module.exports.find((e) => e.componentId === componentId);\n    if (exportEntry) {\n      if (updates.signature !== undefined) {\n        exportEntry.signature = updates.signature;\n      }\n      if (updates.description !== undefined) {\n        exportEntry.description = updates.description;\n      }\n      if (updates.type !== undefined) {\n        exportEntry.type = updates.type;\n      }\n      module.lastUpdated = new Date().toISOString();\n      found = true;\n      break;\n    }\n  }\n\n  if (!found) {\n    return { success: false, error: `Component ${componentId} not found in registry` };\n  }\n\n  // Save registry\n  return saveRegistry(harnessRoot, registry);\n}\n\n/**\n * Get module info for a component\n *\n * @param harnessRoot - Root directory of the test harness\n * @param componentId - Component ID\n * @returns Module entry and export info, or null if not found\n */\nexport function getModuleForComponent(\n  harnessRoot: string,\n  componentId: string\n): { module: ModuleEntry; export: ModuleExport } | null {\n  const registry = loadRegistry(harnessRoot);\n  if (!registry) {\n    return null;\n  }\n\n  const modulePath = registry.componentToModule[componentId];\n  if (!modulePath) {\n    return null;\n  }\n\n  const module = registry.modules.find((m) => m.path === modulePath);\n  if (!module) {\n    return null;\n  }\n\n  const exportEntry = module.exports.find((e) => e.componentId === componentId);\n  if (!exportEntry) {\n    return null;\n  }\n\n  return { module, export: exportEntry };\n}\n\n/**\n * Get the import path for a component\n *\n * @param harnessRoot - Root directory of the test harness\n * @param componentId - Component ID\n * @returns Import statement or null if not found\n *\n * @example\n * ```typescript\n * const importPath = getImportPath('artk-e2e', 'COMP001');\n * // Returns: \"import { verifySidebarReady } from '@modules/foundation/navigation';\"\n * ```\n */\nexport function getImportPath(harnessRoot: string, componentId: string): string | null {\n  const info = getModuleForComponent(harnessRoot, componentId);\n  if (!info) {\n    return null;\n  }\n\n  return `import { ${info.export.name} } from '@modules/${info.module.path}';`;\n}\n\n/**\n * List all modules in the registry\n *\n * @param harnessRoot - Root directory of the test harness\n * @returns Array of module entries\n */\nexport function listModules(harnessRoot: string): ModuleEntry[] {\n  const registry = loadRegistry(harnessRoot);\n  return registry?.modules || [];\n}\n\n/**\n * Find modules by category\n *\n * @param harnessRoot - Root directory of the test harness\n * @param category - Category to filter by\n * @returns Array of modules that have components in the given category\n */\nexport function findModulesByCategory(\n  harnessRoot: string,\n  category: ComponentCategory\n): ModuleEntry[] {\n  const registry = loadRegistry(harnessRoot);\n  if (!registry) {\n    return [];\n  }\n\n  // Category is typically in the module path (e.g., 'foundation/navigation')\n  return registry.modules.filter(\n    (m) => m.path.includes(category) || m.name.includes(category)\n  );\n}\n\n/**\n * Validate registry consistency with components.json\n *\n * @param harnessRoot - Root directory of the test harness\n * @param components - Components from components.json\n * @returns Validation result with inconsistencies\n */\nexport function validateRegistryConsistency(\n  harnessRoot: string,\n  components: Component[]\n): {\n  valid: boolean;\n  missingInRegistry: string[];\n  missingInComponents: string[];\n  pathMismatches: Array<{ componentId: string; registryPath: string; componentPath: string }>;\n} {\n  const registry = loadRegistry(harnessRoot);\n\n  const result = {\n    valid: true,\n    missingInRegistry: [] as string[],\n    missingInComponents: [] as string[],\n    pathMismatches: [] as Array<{ componentId: string; registryPath: string; componentPath: string }>,\n  };\n\n  if (!registry) {\n    result.valid = false;\n    result.missingInRegistry = components.filter((c) => !c.archived).map((c) => c.id);\n    return result;\n  }\n\n  // Get all component IDs in registry\n  const registryComponentIds = new Set<string>();\n  for (const module of registry.modules) {\n    for (const exp of module.exports) {\n      if (exp.componentId) {\n        registryComponentIds.add(exp.componentId);\n      }\n    }\n  }\n\n  // Check each active component is in registry\n  for (const component of components) {\n    if (component.archived) continue;\n\n    if (!registryComponentIds.has(component.id)) {\n      result.missingInRegistry.push(component.id);\n      result.valid = false;\n    } else {\n      // Check path matches\n      const modulePath = registry.componentToModule[component.id];\n      if (modulePath && !component.filePath.includes(modulePath)) {\n        result.pathMismatches.push({\n          componentId: component.id,\n          registryPath: modulePath,\n          componentPath: component.filePath,\n        });\n        result.valid = false;\n      }\n    }\n  }\n\n  // Check each registry component exists in components.json\n  const componentIds = new Set(components.map((c) => c.id));\n  for (const componentId of registryComponentIds) {\n    if (!componentIds.has(componentId)) {\n      result.missingInComponents.push(componentId);\n      result.valid = false;\n    }\n  }\n\n  return result;\n}\n\n/**\n * Synchronize registry with components.json\n *\n * Adds missing components and removes stale entries.\n *\n * @param harnessRoot - Root directory of the test harness\n * @param components - Components from components.json\n * @returns Save result\n */\nexport async function syncRegistryWithComponents(\n  harnessRoot: string,\n  components: Component[]\n): Promise<SaveResult & { added: number; removed: number }> {\n  const validation = validateRegistryConsistency(harnessRoot, components);\n\n  let registry = loadRegistry(harnessRoot);\n  if (!registry) {\n    registry = createEmptyRegistry();\n  }\n\n  let added = 0;\n  let removed = 0;\n\n  // Remove stale entries\n  for (const staleId of validation.missingInComponents) {\n    for (const module of registry.modules) {\n      const index = module.exports.findIndex((e) => e.componentId === staleId);\n      if (index !== -1) {\n        module.exports.splice(index, 1);\n        removed++;\n      }\n    }\n  }\n\n  // Remove empty modules\n  registry.modules = registry.modules.filter((m) => m.exports.length > 0);\n\n  // Note: We don't auto-add missing components because we need the module path info\n  // which comes from the extraction process. Just count them for reporting.\n  added = validation.missingInRegistry.length;\n\n  // Rebuild indexes\n  rebuildIndexes(registry);\n\n  // Save\n  const saveResult = await saveRegistry(harnessRoot, registry);\n\n  return {\n    ...saveResult,\n    added,\n    removed,\n  };\n}\n","/**\n * LLKB Migration Module\n *\n * This module provides utilities for migrating LLKB data between versions,\n * upgrading schemas, and handling backward compatibility.\n *\n * @module llkb/migration\n */\n\nimport * as fs from 'fs';\nimport * as path from 'path';\nimport type {\n  LessonsFile,\n  ComponentsFile,\n  SaveResult,\n} from './types.js';\nimport { saveJSONAtomic, loadJSON, ensureDir } from './file-utils.js';\nimport { createEmptyAnalytics } from './analytics.js';\n\n// =============================================================================\n// Types\n// =============================================================================\n\n/**\n * Migration result\n */\nexport interface MigrationResult {\n  /** Whether migration succeeded */\n  success: boolean;\n\n  /** Files that were migrated */\n  migratedFiles: string[];\n\n  /** Errors encountered */\n  errors: string[];\n\n  /** Warnings */\n  warnings: string[];\n\n  /** Version before migration */\n  fromVersion: string;\n\n  /** Version after migration */\n  toVersion: string;\n}\n\n/**\n * Schema version info\n */\nexport interface VersionInfo {\n  /** Major version */\n  major: number;\n\n  /** Minor version */\n  minor: number;\n\n  /** Patch version */\n  patch: number;\n\n  /** Full version string */\n  full: string;\n}\n\n/**\n * Migration function signature\n */\ntype MigrationFn = (data: any, llkbRoot: string) => Promise<{ data: any; warnings: string[] }>;\n\n// =============================================================================\n// Constants\n// =============================================================================\n\n/** Current schema version */\nexport const CURRENT_VERSION = '1.0.0';\n\n/** Minimum supported version */\nexport const MIN_SUPPORTED_VERSION = '0.1.0';\n\n// =============================================================================\n// Version Parsing\n// =============================================================================\n\n/**\n * Parse a version string into components\n */\nexport function parseVersion(version: string): VersionInfo {\n  const match = version.match(/^(\\d+)\\.(\\d+)\\.(\\d+)/);\n  if (!match) {\n    return { major: 0, minor: 0, patch: 0, full: '0.0.0' };\n  }\n\n  const major = match[1] || '0';\n  const minor = match[2] || '0';\n  const patch = match[3] || '0';\n\n  return {\n    major: parseInt(major, 10),\n    minor: parseInt(minor, 10),\n    patch: parseInt(patch, 10),\n    full: `${major}.${minor}.${patch}`,\n  };\n}\n\n/**\n * Compare two versions\n * @returns -1 if a < b, 0 if equal, 1 if a > b\n */\nexport function compareVersions(a: string, b: string): number {\n  const va = parseVersion(a);\n  const vb = parseVersion(b);\n\n  if (va.major !== vb.major) return va.major < vb.major ? -1 : 1;\n  if (va.minor !== vb.minor) return va.minor < vb.minor ? -1 : 1;\n  if (va.patch !== vb.patch) return va.patch < vb.patch ? -1 : 1;\n  return 0;\n}\n\n/**\n * Check if a version is supported\n */\nexport function isVersionSupported(version: string): boolean {\n  return compareVersions(version, MIN_SUPPORTED_VERSION) >= 0;\n}\n\n/**\n * Check if migration is needed\n */\nexport function needsMigration(version: string): boolean {\n  return compareVersions(version, CURRENT_VERSION) < 0;\n}\n\n// =============================================================================\n// Migration Functions by Version\n// =============================================================================\n\n/**\n * Registry of migrations from version to version\n */\nconst migrations: Map<string, MigrationFn> = new Map();\n\n// Migration from 0.x to 1.0.0\nmigrations.set('0.x->1.0.0', async (data: any, _llkbRoot: string) => {\n  const warnings: string[] = [];\n\n  // Handle lessons migration\n  if (data.lessons && Array.isArray(data.lessons)) {\n    data.lessons = data.lessons.map((lesson: any) => {\n      // Ensure required fields exist\n      if (!lesson.metrics) {\n        lesson.metrics = {\n          occurrences: lesson.occurrences || 0,\n          successRate: lesson.successRate || 0.5,\n          confidence: lesson.confidence || 0.5,\n          firstSeen: lesson.createdAt || new Date().toISOString(),\n          lastSuccess: null,\n          lastApplied: null,\n        };\n        warnings.push(`Added missing metrics to lesson ${lesson.id}`);\n      }\n\n      if (!lesson.validation) {\n        lesson.validation = {\n          humanReviewed: false,\n        };\n      }\n\n      // Migrate old field names\n      if (lesson.created && !lesson.metrics.firstSeen) {\n        lesson.metrics.firstSeen = lesson.created;\n        delete lesson.created;\n      }\n\n      return lesson;\n    });\n  }\n\n  // Handle components migration\n  if (data.components && Array.isArray(data.components)) {\n    data.components = data.components.map((component: any) => {\n      // Ensure required fields exist\n      if (!component.metrics) {\n        component.metrics = {\n          totalUses: component.uses || 0,\n          successRate: 1.0,\n          lastUsed: null,\n        };\n        delete component.uses;\n        warnings.push(`Added missing metrics to component ${component.id}`);\n      }\n\n      if (!component.source) {\n        component.source = {\n          originalCode: component.code || '',\n          extractedFrom: component.journeyId || 'unknown',\n          extractedBy: 'journey-verify',\n          extractedAt: component.createdAt || new Date().toISOString(),\n        };\n        delete component.code;\n        delete component.journeyId;\n        warnings.push(`Added missing source info to component ${component.id}`);\n      }\n\n      return component;\n    });\n  }\n\n  // Update version\n  data.version = '1.0.0';\n  data.lastUpdated = new Date().toISOString();\n\n  return { data, warnings };\n});\n\n// =============================================================================\n// Core Migration Functions\n// =============================================================================\n\n/**\n * Get the appropriate migration path\n */\nfunction getMigrationPath(fromVersion: string, toVersion: string): string[] {\n  const from = parseVersion(fromVersion);\n  const to = parseVersion(toVersion);\n  const path: string[] = [];\n\n  // For now, we have a simple migration path\n  // Future versions can add more granular migrations\n  if (from.major === 0 && to.major >= 1) {\n    path.push('0.x->1.0.0');\n  }\n\n  return path;\n}\n\n/**\n * Apply a single migration\n */\nasync function applyMigration(\n  data: any,\n  migrationKey: string,\n  llkbRoot: string\n): Promise<{ data: any; warnings: string[] }> {\n  const migrationFn = migrations.get(migrationKey);\n  if (!migrationFn) {\n    return { data, warnings: [`No migration found for ${migrationKey}`] };\n  }\n\n  return migrationFn(data, llkbRoot);\n}\n\n/**\n * Migrate a single file\n */\nasync function migrateFile(\n  filePath: string,\n  llkbRoot: string\n): Promise<{ success: boolean; warnings: string[]; error?: string }> {\n  try {\n    // Read current file\n    const data = loadJSON<any>(filePath);\n    if (!data) {\n      return { success: false, warnings: [], error: `Could not read ${filePath}` };\n    }\n\n    const currentVersion = data.version || '0.0.0';\n\n    // Check if migration is needed\n    if (!needsMigration(currentVersion)) {\n      return { success: true, warnings: ['Already at current version'] };\n    }\n\n    // Check if version is supported\n    if (!isVersionSupported(currentVersion)) {\n      return {\n        success: false,\n        warnings: [],\n        error: `Version ${currentVersion} is not supported (min: ${MIN_SUPPORTED_VERSION})`,\n      };\n    }\n\n    // Get migration path\n    const migrationPath = getMigrationPath(currentVersion, CURRENT_VERSION);\n\n    let migratedData = data;\n    const allWarnings: string[] = [];\n\n    // Apply each migration in sequence\n    for (const migrationKey of migrationPath) {\n      const result = await applyMigration(migratedData, migrationKey, llkbRoot);\n      migratedData = result.data;\n      allWarnings.push(...result.warnings);\n    }\n\n    // Create backup\n    const backupPath = `${filePath}.backup.${Date.now()}`;\n    fs.copyFileSync(filePath, backupPath);\n\n    // Save migrated data\n    const saveResult = await saveJSONAtomic(filePath, migratedData);\n    if (!saveResult.success) {\n      // Restore backup\n      fs.copyFileSync(backupPath, filePath);\n      return { success: false, warnings: allWarnings, error: saveResult.error };\n    }\n\n    // Remove backup on success (optional - could keep for safety)\n    fs.unlinkSync(backupPath);\n\n    return { success: true, warnings: allWarnings };\n  } catch (error) {\n    return {\n      success: false,\n      warnings: [],\n      error: error instanceof Error ? error.message : 'Unknown error',\n    };\n  }\n}\n\n/**\n * Migrate all LLKB files to the current version\n *\n * @param llkbRoot - Root directory of LLKB\n * @returns Migration result\n *\n * @example\n * ```typescript\n * const result = await migrateLLKB('.artk/llkb');\n * if (result.success) {\n *   console.log(`Migrated ${result.migratedFiles.length} files`);\n * }\n * ```\n */\nexport async function migrateLLKB(llkbRoot: string): Promise<MigrationResult> {\n  const result: MigrationResult = {\n    success: true,\n    migratedFiles: [],\n    errors: [],\n    warnings: [],\n    fromVersion: '0.0.0',\n    toVersion: CURRENT_VERSION,\n  };\n\n  // Files to migrate\n  const files = [\n    path.join(llkbRoot, 'lessons.json'),\n    path.join(llkbRoot, 'components.json'),\n    path.join(llkbRoot, 'analytics.json'),\n  ];\n\n  // Get initial version from lessons.json\n  const lessonsPath = path.join(llkbRoot, 'lessons.json');\n  if (fs.existsSync(lessonsPath)) {\n    const lessonsData = loadJSON<any>(lessonsPath);\n    result.fromVersion = lessonsData?.version || '0.0.0';\n  }\n\n  // Migrate each file\n  for (const file of files) {\n    if (!fs.existsSync(file)) {\n      result.warnings.push(`File not found: ${file}`);\n      continue;\n    }\n\n    const migrationResult = await migrateFile(file, llkbRoot);\n\n    if (migrationResult.success) {\n      result.migratedFiles.push(file);\n    } else {\n      result.success = false;\n      if (migrationResult.error) {\n        result.errors.push(`${file}: ${migrationResult.error}`);\n      }\n    }\n\n    result.warnings.push(...migrationResult.warnings.map((w) => `${path.basename(file)}: ${w}`));\n  }\n\n  return result;\n}\n\n/**\n * Check if LLKB needs migration\n *\n * @param llkbRoot - Root directory of LLKB\n * @returns Version check result\n */\nexport function checkMigrationNeeded(llkbRoot: string): {\n  needsMigration: boolean;\n  currentVersion: string;\n  targetVersion: string;\n  supported: boolean;\n} {\n  const lessonsPath = path.join(llkbRoot, 'lessons.json');\n\n  if (!fs.existsSync(lessonsPath)) {\n    return {\n      needsMigration: false,\n      currentVersion: CURRENT_VERSION,\n      targetVersion: CURRENT_VERSION,\n      supported: true,\n    };\n  }\n\n  const lessonsData = loadJSON<any>(lessonsPath);\n  const currentVersion = lessonsData?.version || '0.0.0';\n\n  return {\n    needsMigration: needsMigration(currentVersion),\n    currentVersion,\n    targetVersion: CURRENT_VERSION,\n    supported: isVersionSupported(currentVersion),\n  };\n}\n\n// =============================================================================\n// Initialization Functions\n// =============================================================================\n\n/**\n * Initialize LLKB directory structure with default files\n *\n * @param llkbRoot - Root directory for LLKB\n * @returns Save result\n *\n * @example\n * ```typescript\n * const result = await initializeLLKB('.artk/llkb');\n * ```\n */\nexport async function initializeLLKB(llkbRoot: string): Promise<SaveResult> {\n  try {\n    // Create directories\n    ensureDir(llkbRoot);\n    ensureDir(path.join(llkbRoot, 'patterns'));\n    ensureDir(path.join(llkbRoot, 'history'));\n\n    // Create default config.yml if not exists\n    const configPath = path.join(llkbRoot, 'config.yml');\n    if (!fs.existsSync(configPath)) {\n      const defaultConfig = `# LLKB Configuration\nversion: \"1.0.0\"\nenabled: true\n\nextraction:\n  minOccurrences: 2\n  predictiveExtraction: true\n  confidenceThreshold: 0.7\n  maxPredictivePerJourney: 3\n  maxPredictivePerDay: 10\n  minLinesForExtraction: 3\n  similarityThreshold: 0.8\n\nretention:\n  maxLessonAge: 90\n  minSuccessRate: 0.6\n  archiveUnused: 30\n\nhistory:\n  retentionDays: 365\n\ninjection:\n  prioritizeByConfidence: true\n\nscopes:\n  universal: true\n  frameworkSpecific: true\n  appSpecific: true\n\noverrides:\n  allowUserOverride: true\n  logOverrides: true\n  flagAfterOverrides: 3\n`;\n      fs.writeFileSync(configPath, defaultConfig, 'utf-8');\n    }\n\n    // Create default lessons.json if not exists\n    const lessonsPath = path.join(llkbRoot, 'lessons.json');\n    if (!fs.existsSync(lessonsPath)) {\n      const defaultLessons: LessonsFile = {\n        version: CURRENT_VERSION,\n        lastUpdated: new Date().toISOString(),\n        lessons: [],\n        archived: [],\n        globalRules: [],\n        appQuirks: [],\n      };\n      await saveJSONAtomic(lessonsPath, defaultLessons);\n    }\n\n    // Create default components.json if not exists\n    const componentsPath = path.join(llkbRoot, 'components.json');\n    if (!fs.existsSync(componentsPath)) {\n      const defaultComponents: ComponentsFile = {\n        version: CURRENT_VERSION,\n        lastUpdated: new Date().toISOString(),\n        components: [],\n        componentsByCategory: {\n          selector: [],\n          timing: [],\n          auth: [],\n          data: [],\n          assertion: [],\n          navigation: [],\n          'ui-interaction': [],\n        },\n        componentsByScope: {\n          universal: [],\n          'framework:angular': [],\n          'framework:react': [],\n          'framework:vue': [],\n          'framework:ag-grid': [],\n          'app-specific': [],\n        },\n      };\n      await saveJSONAtomic(componentsPath, defaultComponents);\n    }\n\n    // Create default analytics.json if not exists\n    const analyticsPath = path.join(llkbRoot, 'analytics.json');\n    if (!fs.existsSync(analyticsPath)) {\n      const defaultAnalytics = createEmptyAnalytics();\n      await saveJSONAtomic(analyticsPath, defaultAnalytics);\n    }\n\n    // Seed learned-patterns.json with universal patterns (cold start solution)\n    const learnedPatternsPath = path.join(llkbRoot, 'learned-patterns.json');\n    if (!fs.existsSync(learnedPatternsPath)) {\n      const { createUniversalSeedPatterns } = await import('./universal-seeds.js');\n      const seedPatterns = createUniversalSeedPatterns();\n      await saveJSONAtomic(learnedPatternsPath, {\n        version: CURRENT_VERSION,\n        lastUpdated: new Date().toISOString(),\n        patterns: seedPatterns,\n        metadata: { source: 'universal-seeds', totalPatterns: seedPatterns.length },\n      });\n    }\n\n    // Create default pattern files if not exist\n    const patternFiles = ['selectors.json', 'timing.json', 'assertions.json', 'auth.json', 'data.json'];\n    for (const patternFile of patternFiles) {\n      const patternPath = path.join(llkbRoot, 'patterns', patternFile);\n      if (!fs.existsSync(patternPath)) {\n        await saveJSONAtomic(patternPath, {\n          version: CURRENT_VERSION,\n          patterns: [],\n        });\n      }\n    }\n\n    return { success: true };\n  } catch (error) {\n    return {\n      success: false,\n      error: error instanceof Error ? error.message : 'Unknown error',\n    };\n  }\n}\n\n/**\n * Validate LLKB installation\n *\n * @param llkbRoot - Root directory of LLKB\n * @returns Validation result\n */\nexport function validateLLKBInstallation(llkbRoot: string): {\n  valid: boolean;\n  missingFiles: string[];\n  invalidFiles: string[];\n  version: string;\n} {\n  const result = {\n    valid: true,\n    missingFiles: [] as string[],\n    invalidFiles: [] as string[],\n    version: CURRENT_VERSION,\n  };\n\n  // Required files\n  const requiredFiles = [\n    'config.yml',\n    'lessons.json',\n    'components.json',\n    'analytics.json',\n  ];\n\n  for (const file of requiredFiles) {\n    const filePath = path.join(llkbRoot, file);\n    if (!fs.existsSync(filePath)) {\n      result.missingFiles.push(file);\n      result.valid = false;\n    } else if (file.endsWith('.json')) {\n      // Validate JSON\n      try {\n        const data = loadJSON<any>(filePath);\n        if (!data || !data.version) {\n          result.invalidFiles.push(file);\n          result.valid = false;\n        } else if (file === 'lessons.json') {\n          result.version = data.version;\n        }\n      } catch {\n        result.invalidFiles.push(file);\n        result.valid = false;\n      }\n    }\n  }\n\n  // Check patterns directory\n  const patternsDir = path.join(llkbRoot, 'patterns');\n  if (!fs.existsSync(patternsDir)) {\n    result.missingFiles.push('patterns/');\n    result.valid = false;\n  }\n\n  return result;\n}\n","/**\n * LLKB Search and Export Module\n *\n * This module provides search functionality across LLKB data\n * and export capabilities for reports and sharing.\n *\n * @module llkb/search\n */\n\nimport * as fs from 'fs';\nimport type {\n  Lesson,\n  Component,\n  LLKBCategory,\n  ComponentCategory,\n  LLKBScope,\n  AppQuirk,\n  GlobalRule,\n} from './types.js';\nimport { loadLessons, loadComponents, loadAppProfile, loadLLKBConfig } from './loaders.js';\n\n// =============================================================================\n// Types\n// =============================================================================\n\n/**\n * Search query options\n */\nexport interface SearchQuery {\n  /** Text to search for (searches titles, descriptions, patterns) */\n  text?: string;\n\n  /** Filter by category */\n  category?: LLKBCategory | ComponentCategory;\n\n  /** Filter by scope */\n  scope?: LLKBScope;\n\n  /** Filter by tags */\n  tags?: string[];\n\n  /** Filter by minimum confidence */\n  minConfidence?: number;\n\n  /** Filter by journey ID */\n  journeyId?: string;\n\n  /** Include archived items */\n  includeArchived?: boolean;\n\n  /** Maximum results */\n  limit?: number;\n}\n\n/**\n * Unified search result\n */\nexport interface SearchResult {\n  /** Result type */\n  type: 'lesson' | 'component' | 'quirk' | 'rule';\n\n  /** Item ID */\n  id: string;\n\n  /** Title or name */\n  title: string;\n\n  /** Description or pattern */\n  description: string;\n\n  /** Category */\n  category: string;\n\n  /** Scope */\n  scope: LLKBScope;\n\n  /** Relevance score (0.0 - 1.0) */\n  relevance: number;\n\n  /** The original item */\n  item: Lesson | Component | AppQuirk | GlobalRule;\n}\n\n/**\n * Export format\n */\nexport type ExportFormat = 'json' | 'markdown' | 'csv';\n\n/**\n * Export options\n */\nexport interface ExportOptions {\n  /** Export format */\n  format: ExportFormat;\n\n  /** Include archived items */\n  includeArchived?: boolean;\n\n  /** Include metrics */\n  includeMetrics?: boolean;\n\n  /** Include source code */\n  includeSource?: boolean;\n\n  /** Filter by categories */\n  categories?: (LLKBCategory | ComponentCategory)[];\n\n  /** Filter by scopes */\n  scopes?: LLKBScope[];\n}\n\n/**\n * Report section\n */\nexport interface ReportSection {\n  title: string;\n  content: string;\n}\n\n// =============================================================================\n// Search Functions\n// =============================================================================\n\n/**\n * Calculate text relevance score\n */\nfunction calculateTextRelevance(text: string, query: string): number {\n  if (!query) return 1.0;\n\n  const lowerText = text.toLowerCase();\n  const lowerQuery = query.toLowerCase();\n  const queryWords = lowerQuery.split(/\\s+/).filter((w) => w.length > 1);\n\n  if (queryWords.length === 0) return 1.0;\n\n  // Exact match\n  if (lowerText.includes(lowerQuery)) {\n    return 1.0;\n  }\n\n  // Word matches\n  let matchedWords = 0;\n  for (const word of queryWords) {\n    if (lowerText.includes(word)) {\n      matchedWords++;\n    }\n  }\n\n  return matchedWords / queryWords.length;\n}\n\n/**\n * Search lessons\n */\nfunction searchLessons(\n  lessons: Lesson[],\n  query: SearchQuery\n): SearchResult[] {\n  return lessons\n    .filter((lesson) => {\n      // Filter archived\n      if (!query.includeArchived && lesson.archived) {\n        return false;\n      }\n\n      // Filter by category\n      if (query.category && lesson.category !== query.category) {\n        return false;\n      }\n\n      // Filter by scope\n      if (query.scope && lesson.scope !== query.scope) {\n        return false;\n      }\n\n      // Filter by tags\n      if (query.tags && query.tags.length > 0) {\n        const lessonTags = lesson.tags || [];\n        if (!query.tags.some((t) => lessonTags.includes(t))) {\n          return false;\n        }\n      }\n\n      // Filter by confidence\n      if (query.minConfidence !== undefined) {\n        if (lesson.metrics.confidence < query.minConfidence) {\n          return false;\n        }\n      }\n\n      // Filter by journey\n      if (query.journeyId && !lesson.journeyIds.includes(query.journeyId)) {\n        return false;\n      }\n\n      return true;\n    })\n    .map((lesson) => {\n      const searchText = `${lesson.title} ${lesson.pattern} ${lesson.trigger}`;\n      const relevance = calculateTextRelevance(searchText, query.text || '');\n\n      return {\n        type: 'lesson' as const,\n        id: lesson.id,\n        title: lesson.title,\n        description: lesson.pattern,\n        category: lesson.category,\n        scope: lesson.scope,\n        relevance,\n        item: lesson,\n      };\n    })\n    .filter((result) => result.relevance > 0.1);\n}\n\n/**\n * Search components\n */\nfunction searchComponents(\n  components: Component[],\n  query: SearchQuery\n): SearchResult[] {\n  return components\n    .filter((component) => {\n      // Filter archived\n      if (!query.includeArchived && component.archived) {\n        return false;\n      }\n\n      // Filter by category\n      if (query.category && component.category !== query.category) {\n        return false;\n      }\n\n      // Filter by scope\n      if (query.scope && component.scope !== query.scope) {\n        return false;\n      }\n\n      return true;\n    })\n    .map((component) => {\n      const searchText = `${component.name} ${component.description}`;\n      const relevance = calculateTextRelevance(searchText, query.text || '');\n\n      return {\n        type: 'component' as const,\n        id: component.id,\n        title: component.name,\n        description: component.description,\n        category: component.category,\n        scope: component.scope,\n        relevance,\n        item: component,\n      };\n    })\n    .filter((result) => result.relevance > 0.1);\n}\n\n/**\n * Search LLKB data\n *\n * Searches across lessons, components, quirks, and rules.\n *\n * @param llkbRoot - Root directory of LLKB\n * @param query - Search query\n * @returns Array of search results sorted by relevance\n *\n * @example\n * ```typescript\n * const results = search('.artk/llkb', {\n *   text: 'sidebar navigation',\n *   category: 'navigation',\n *   minConfidence: 0.7,\n * });\n * ```\n */\nexport function search(llkbRoot: string, query: SearchQuery): SearchResult[] {\n  const lessons = loadLessons(llkbRoot, { includeArchived: query.includeArchived });\n  const components = loadComponents(llkbRoot, { includeArchived: query.includeArchived });\n\n  // Search all types\n  const lessonResults = searchLessons(lessons, query);\n  const componentResults = searchComponents(components, query);\n\n  // Combine and sort by relevance\n  const allResults = [...lessonResults, ...componentResults];\n  allResults.sort((a, b) => b.relevance - a.relevance);\n\n  // Apply limit\n  if (query.limit && query.limit > 0) {\n    return allResults.slice(0, query.limit);\n  }\n\n  return allResults;\n}\n\n/**\n * Find lessons by pattern\n *\n * Searches for lessons that match a specific code pattern.\n *\n * @param llkbRoot - Root directory of LLKB\n * @param pattern - Pattern to search for\n * @returns Matching lessons\n */\nexport function findLessonsByPattern(llkbRoot: string, pattern: string): Lesson[] {\n  const lessons = loadLessons(llkbRoot);\n\n  return lessons.filter((lesson) => {\n    const lowerPattern = pattern.toLowerCase();\n    const lowerLessonPattern = lesson.pattern.toLowerCase();\n    const lowerTrigger = lesson.trigger.toLowerCase();\n\n    return (\n      lowerLessonPattern.includes(lowerPattern) ||\n      lowerTrigger.includes(lowerPattern)\n    );\n  });\n}\n\n/**\n * Find components by name or description\n *\n * @param llkbRoot - Root directory of LLKB\n * @param searchTerm - Term to search for\n * @returns Matching components\n */\nexport function findComponents(llkbRoot: string, searchTerm: string): Component[] {\n  const components = loadComponents(llkbRoot);\n  const lowerSearch = searchTerm.toLowerCase();\n\n  return components.filter((component) => {\n    return (\n      component.name.toLowerCase().includes(lowerSearch) ||\n      component.description.toLowerCase().includes(lowerSearch)\n    );\n  });\n}\n\n/**\n * Get lessons for a specific journey\n *\n * @param llkbRoot - Root directory of LLKB\n * @param journeyId - Journey ID\n * @returns Lessons associated with the journey\n */\nexport function getLessonsForJourney(llkbRoot: string, journeyId: string): Lesson[] {\n  const lessons = loadLessons(llkbRoot);\n  return lessons.filter((lesson) => lesson.journeyIds.includes(journeyId));\n}\n\n/**\n * Get components for a specific journey\n *\n * @param llkbRoot - Root directory of LLKB\n * @param journeyId - Journey ID\n * @returns Components used in or extracted from the journey\n */\nexport function getComponentsForJourney(llkbRoot: string, journeyId: string): Component[] {\n  const components = loadComponents(llkbRoot);\n  return components.filter(\n    (component) => component.source.extractedFrom === journeyId\n  );\n}\n\n// =============================================================================\n// Export Functions\n// =============================================================================\n\n/**\n * Export lessons to specified format\n */\nfunction exportLessonsToMarkdown(lessons: Lesson[], includeMetrics: boolean): string {\n  let md = '# Lessons\\n\\n';\n\n  const byCategory = new Map<string, Lesson[]>();\n  for (const lesson of lessons) {\n    const category = lesson.category;\n    if (!byCategory.has(category)) {\n      byCategory.set(category, []);\n    }\n    byCategory.get(category)!.push(lesson);\n  }\n\n  for (const [category, categoryLessons] of byCategory) {\n    md += `## ${category.charAt(0).toUpperCase() + category.slice(1)}\\n\\n`;\n\n    for (const lesson of categoryLessons) {\n      md += `### ${lesson.id}: ${lesson.title}\\n\\n`;\n      md += `**Trigger:** ${lesson.trigger}\\n\\n`;\n      md += `**Pattern:** ${lesson.pattern}\\n\\n`;\n      md += `**Scope:** ${lesson.scope}\\n\\n`;\n\n      if (includeMetrics) {\n        md += `**Metrics:**\\n`;\n        md += `- Occurrences: ${lesson.metrics.occurrences}\\n`;\n        md += `- Success Rate: ${(lesson.metrics.successRate * 100).toFixed(1)}%\\n`;\n        md += `- Confidence: ${(lesson.metrics.confidence * 100).toFixed(1)}%\\n`;\n        md += '\\n';\n      }\n\n      md += '---\\n\\n';\n    }\n  }\n\n  return md;\n}\n\n/**\n * Export components to specified format\n */\nfunction exportComponentsToMarkdown(\n  components: Component[],\n  includeMetrics: boolean,\n  includeSource: boolean\n): string {\n  let md = '# Components\\n\\n';\n\n  const byCategory = new Map<string, Component[]>();\n  for (const component of components) {\n    const category = component.category;\n    if (!byCategory.has(category)) {\n      byCategory.set(category, []);\n    }\n    byCategory.get(category)!.push(component);\n  }\n\n  for (const [category, categoryComponents] of byCategory) {\n    md += `## ${category.charAt(0).toUpperCase() + category.slice(1)}\\n\\n`;\n\n    for (const component of categoryComponents) {\n      md += `### ${component.id}: ${component.name}\\n\\n`;\n      md += `${component.description}\\n\\n`;\n      md += `**File:** \\`${component.filePath}\\`\\n\\n`;\n      md += `**Scope:** ${component.scope}\\n\\n`;\n\n      if (includeMetrics) {\n        md += `**Metrics:**\\n`;\n        md += `- Total Uses: ${component.metrics.totalUses}\\n`;\n        md += `- Success Rate: ${(component.metrics.successRate * 100).toFixed(1)}%\\n`;\n        md += '\\n';\n      }\n\n      if (includeSource && component.source.originalCode) {\n        md += '**Original Code:**\\n\\n';\n        md += '```typescript\\n';\n        md += component.source.originalCode;\n        md += '\\n```\\n\\n';\n      }\n\n      md += '---\\n\\n';\n    }\n  }\n\n  return md;\n}\n\n/**\n * Export lessons to CSV\n */\nfunction exportLessonsToCSV(lessons: Lesson[]): string {\n  const headers = [\n    'ID',\n    'Title',\n    'Category',\n    'Scope',\n    'Trigger',\n    'Pattern',\n    'Occurrences',\n    'Success Rate',\n    'Confidence',\n  ];\n\n  const rows = lessons.map((lesson) => [\n    lesson.id,\n    `\"${lesson.title.replace(/\"/g, '\"\"')}\"`,\n    lesson.category,\n    lesson.scope,\n    `\"${lesson.trigger.replace(/\"/g, '\"\"')}\"`,\n    `\"${lesson.pattern.replace(/\"/g, '\"\"')}\"`,\n    lesson.metrics.occurrences.toString(),\n    lesson.metrics.successRate.toFixed(3),\n    lesson.metrics.confidence.toFixed(3),\n  ]);\n\n  return [headers.join(','), ...rows.map((r) => r.join(','))].join('\\n');\n}\n\n/**\n * Export components to CSV\n */\nfunction exportComponentsToCSV(components: Component[]): string {\n  const headers = [\n    'ID',\n    'Name',\n    'Category',\n    'Scope',\n    'File Path',\n    'Description',\n    'Total Uses',\n    'Success Rate',\n    'Extracted From',\n  ];\n\n  const rows = components.map((component) => [\n    component.id,\n    component.name,\n    component.category,\n    component.scope,\n    `\"${component.filePath}\"`,\n    `\"${component.description.replace(/\"/g, '\"\"')}\"`,\n    component.metrics.totalUses.toString(),\n    component.metrics.successRate.toFixed(3),\n    component.source.extractedFrom,\n  ]);\n\n  return [headers.join(','), ...rows.map((r) => r.join(','))].join('\\n');\n}\n\n/**\n * Export LLKB data\n *\n * @param llkbRoot - Root directory of LLKB\n * @param options - Export options\n * @returns Export content as string\n *\n * @example\n * ```typescript\n * const markdown = exportLLKB('.artk/llkb', {\n *   format: 'markdown',\n *   includeMetrics: true,\n * });\n * fs.writeFileSync('llkb-export.md', markdown);\n * ```\n */\nexport function exportLLKB(llkbRoot: string, options: ExportOptions): string {\n  const lessons = loadLessons(llkbRoot, {\n    includeArchived: options.includeArchived,\n    category: options.categories as LLKBCategory[],\n    scope: options.scopes,\n  });\n\n  const components = loadComponents(llkbRoot, {\n    includeArchived: options.includeArchived,\n    category: options.categories as ComponentCategory[],\n    scope: options.scopes,\n  });\n\n  switch (options.format) {\n    case 'markdown':\n      return [\n        exportLessonsToMarkdown(lessons, options.includeMetrics || false),\n        exportComponentsToMarkdown(\n          components,\n          options.includeMetrics || false,\n          options.includeSource || false\n        ),\n      ].join('\\n\\n');\n\n    case 'csv':\n      return [\n        '# Lessons',\n        exportLessonsToCSV(lessons),\n        '',\n        '# Components',\n        exportComponentsToCSV(components),\n      ].join('\\n');\n\n    case 'json':\n    default:\n      return JSON.stringify(\n        {\n          exported: new Date().toISOString(),\n          lessons,\n          components,\n        },\n        null,\n        2\n      );\n  }\n}\n\n/**\n * Generate a summary report of LLKB\n *\n * @param llkbRoot - Root directory of LLKB\n * @returns Markdown report\n */\nexport function generateReport(llkbRoot: string): string {\n  // Load config to verify LLKB is properly configured\n  loadLLKBConfig(llkbRoot);\n  const lessons = loadLessons(llkbRoot);\n  const components = loadComponents(llkbRoot);\n  const appProfile = loadAppProfile(llkbRoot);\n\n  const archivedLessons = loadLessons(llkbRoot, { includeArchived: true }).filter(\n    (l) => l.archived\n  ).length;\n  const archivedComponents = loadComponents(llkbRoot, { includeArchived: true }).filter(\n    (c) => c.archived\n  ).length;\n\n  // Calculate stats\n  const avgConfidence =\n    lessons.length > 0\n      ? lessons.reduce((sum, l) => sum + l.metrics.confidence, 0) / lessons.length\n      : 0;\n\n  const avgSuccessRate =\n    lessons.length > 0\n      ? lessons.reduce((sum, l) => sum + l.metrics.successRate, 0) / lessons.length\n      : 0;\n\n  const totalComponentUses = components.reduce(\n    (sum, c) => sum + c.metrics.totalUses,\n    0\n  );\n\n  // Count by category\n  const lessonsByCategory = new Map<string, number>();\n  for (const lesson of lessons) {\n    const count = lessonsByCategory.get(lesson.category) || 0;\n    lessonsByCategory.set(lesson.category, count + 1);\n  }\n\n  const componentsByCategory = new Map<string, number>();\n  for (const component of components) {\n    const count = componentsByCategory.get(component.category) || 0;\n    componentsByCategory.set(component.category, count + 1);\n  }\n\n  // Generate report\n  let report = '# LLKB Status Report\\n\\n';\n  report += `**Generated:** ${new Date().toISOString()}\\n\\n`;\n\n  if (appProfile) {\n    report += '## Application Profile\\n\\n';\n    report += `- **Framework:** ${appProfile.application.framework}\\n`;\n    report += `- **UI Library:** ${appProfile.application.uiLibrary}\\n`;\n    report += `- **Data Grid:** ${appProfile.application.dataGrid}\\n`;\n    report += '\\n';\n  }\n\n  report += '## Overview\\n\\n';\n  report += `| Metric | Value |\\n`;\n  report += `|--------|-------|\\n`;\n  report += `| Active Lessons | ${lessons.length} |\\n`;\n  report += `| Archived Lessons | ${archivedLessons} |\\n`;\n  report += `| Active Components | ${components.length} |\\n`;\n  report += `| Archived Components | ${archivedComponents} |\\n`;\n  report += `| Avg. Lesson Confidence | ${(avgConfidence * 100).toFixed(1)}% |\\n`;\n  report += `| Avg. Lesson Success Rate | ${(avgSuccessRate * 100).toFixed(1)}% |\\n`;\n  report += `| Total Component Uses | ${totalComponentUses} |\\n`;\n  report += '\\n';\n\n  report += '## Lessons by Category\\n\\n';\n  report += `| Category | Count |\\n`;\n  report += `|----------|-------|\\n`;\n  for (const [category, count] of lessonsByCategory) {\n    report += `| ${category} | ${count} |\\n`;\n  }\n  report += '\\n';\n\n  report += '## Components by Category\\n\\n';\n  report += `| Category | Count |\\n`;\n  report += `|----------|-------|\\n`;\n  for (const [category, count] of componentsByCategory) {\n    report += `| ${category} | ${count} |\\n`;\n  }\n  report += '\\n';\n\n  // Top lessons\n  const topLessons = [...lessons]\n    .sort((a, b) => b.metrics.confidence - a.metrics.confidence)\n    .slice(0, 5);\n\n  if (topLessons.length > 0) {\n    report += '## Top Lessons (by Confidence)\\n\\n';\n    for (const lesson of topLessons) {\n      report += `- **${lesson.id}** - ${lesson.title} (${(lesson.metrics.confidence * 100).toFixed(0)}%)\\n`;\n    }\n    report += '\\n';\n  }\n\n  // Most used components\n  const topComponents = [...components]\n    .sort((a, b) => b.metrics.totalUses - a.metrics.totalUses)\n    .slice(0, 5);\n\n  if (topComponents.length > 0) {\n    report += '## Most Used Components\\n\\n';\n    for (const component of topComponents) {\n      report += `- **${component.id}** - ${component.name} (${component.metrics.totalUses} uses)\\n`;\n    }\n    report += '\\n';\n  }\n\n  // Low confidence lessons (needs review)\n  const lowConfidence = lessons.filter((l) => l.metrics.confidence < 0.4);\n  if (lowConfidence.length > 0) {\n    report += '## Needs Review (Low Confidence)\\n\\n';\n    for (const lesson of lowConfidence.slice(0, 5)) {\n      report += `- **${lesson.id}** - ${lesson.title} (${(lesson.metrics.confidence * 100).toFixed(0)}%)\\n`;\n    }\n    report += '\\n';\n  }\n\n  return report;\n}\n\n/**\n * Export to file\n *\n * @param llkbRoot - Root directory of LLKB\n * @param outputPath - Output file path\n * @param options - Export options\n */\nexport async function exportToFile(\n  llkbRoot: string,\n  outputPath: string,\n  options: ExportOptions\n): Promise<void> {\n  const content = exportLLKB(llkbRoot, options);\n  fs.writeFileSync(outputPath, content, 'utf-8');\n}\n","/**\n * Standardized Result Types for LLKB Operations\n *\n * Provides consistent error handling and result types across all LLKB modules.\n * All operations return LLKBResult<T> with success flag, optional data, errors, and warnings.\n *\n * @module llkb/result-types\n */\n\n/**\n * Standardized result type for LLKB operations\n *\n * @template T - The type of data returned on success\n */\nexport interface LLKBResult<T> {\n  /** Whether the operation succeeded */\n  success: boolean;\n\n  /** Data returned on success (undefined on failure) */\n  data?: T;\n\n  /** Error message on failure (undefined on success) */\n  error?: string;\n\n  /** Non-fatal warnings (present on success or failure) */\n  warnings: string[];\n}\n\n/**\n * Create a successful result with data\n *\n * @template T - The type of data being returned\n * @param data - The successful result data\n * @param warnings - Optional non-fatal warnings\n * @returns LLKBResult indicating success\n *\n * @example\n * ```typescript\n * const result = ok({ count: 5 }, ['Item A skipped']);\n * // { success: true, data: { count: 5 }, warnings: ['Item A skipped'] }\n * ```\n */\nexport function ok<T>(data: T, warnings: string[] = []): LLKBResult<T> {\n  return {\n    success: true,\n    data,\n    warnings,\n  };\n}\n\n/**\n * Create a failed result with error\n *\n * @template T - The type that would have been returned on success\n * @param error - The error message describing the failure\n * @param warnings - Optional non-fatal warnings\n * @returns LLKBResult indicating failure\n *\n * @example\n * ```typescript\n * const result = fail<number>('File not found');\n * // { success: false, error: 'File not found', warnings: [] }\n * ```\n */\nexport function fail<T>(error: string, warnings: string[] = []): LLKBResult<T> {\n  return {\n    success: false,\n    error,\n    warnings,\n  };\n}\n\n/**\n * Create a result from a try-catch block\n *\n * @template T - The type of data being returned\n * @param fn - The function to execute\n * @param errorMessage - Optional custom error message prefix\n * @returns LLKBResult with success or failure\n *\n * @example\n * ```typescript\n * const result = tryCatch(\n *   () => JSON.parse(text),\n *   'Failed to parse JSON'\n * );\n * ```\n */\nexport function tryCatch<T>(\n  fn: () => T,\n  errorMessage?: string\n): LLKBResult<T> {\n  try {\n    const data = fn();\n    return ok(data);\n  } catch (error) {\n    const message = error instanceof Error ? error.message : String(error);\n    const fullMessage = errorMessage ? `${errorMessage}: ${message}` : message;\n    return fail(fullMessage);\n  }\n}\n\n/**\n * Map a successful result to a new type\n *\n * @template T - Original data type\n * @template U - New data type\n * @param result - The result to map\n * @param mapper - Function to transform the data\n * @returns New LLKBResult with mapped data or original error\n *\n * @example\n * ```typescript\n * const numResult: LLKBResult<number> = ok(5);\n * const strResult = mapResult(numResult, n => n.toString());\n * // { success: true, data: '5', warnings: [] }\n * ```\n */\nexport function mapResult<T, U>(\n  result: LLKBResult<T>,\n  mapper: (data: T) => U\n): LLKBResult<U> {\n  if (!result.success) {\n    return {\n      success: false,\n      error: result.error,\n      warnings: result.warnings,\n    };\n  }\n\n  try {\n    const mappedData = mapper(result.data as T);\n    return ok(mappedData, result.warnings);\n  } catch (error) {\n    const message = error instanceof Error ? error.message : String(error);\n    return fail(`Mapping failed: ${message}`, result.warnings);\n  }\n}\n\n/**\n * Combine multiple results into one\n *\n * If any result fails, returns the first failure.\n * If all succeed, combines data into an array.\n * Warnings are accumulated from all results.\n *\n * @template T - The type of data in the results\n * @param results - Array of results to combine\n * @returns Combined result with all data or first error\n *\n * @example\n * ```typescript\n * const r1 = ok(1);\n * const r2 = ok(2, ['warning']);\n * const combined = combineResults([r1, r2]);\n * // { success: true, data: [1, 2], warnings: ['warning'] }\n * ```\n */\nexport function combineResults<T>(\n  results: Array<LLKBResult<T>>\n): LLKBResult<T[]> {\n  const allWarnings: string[] = [];\n  const allData: T[] = [];\n\n  for (const result of results) {\n    allWarnings.push(...result.warnings);\n\n    if (!result.success) {\n      return fail(result.error ?? 'Unknown error', allWarnings);\n    }\n\n    if (result.data !== undefined) {\n      allData.push(result.data);\n    }\n  }\n\n  return ok(allData, allWarnings);\n}\n\n/**\n * Check if a result is successful and has data\n *\n * Type guard that narrows the result type to successful with data.\n *\n * @template T - The type of data in the result\n * @param result - The result to check\n * @returns True if successful with data, false otherwise\n *\n * @example\n * ```typescript\n * const result = ok(5);\n * if (isOk(result)) {\n *   console.log(result.data); // TypeScript knows data is defined\n * }\n * ```\n */\nexport function isOk<T>(result: LLKBResult<T>): result is LLKBResult<T> & { data: T } {\n  return result.success && result.data !== undefined;\n}\n\n/**\n * Check if a result is a failure\n *\n * Type guard that narrows the result type to failed with error.\n *\n * @template T - The type of data in the result\n * @param result - The result to check\n * @returns True if failed with error, false otherwise\n *\n * @example\n * ```typescript\n * const result = fail<number>('Error');\n * if (isFail(result)) {\n *   console.error(result.error); // TypeScript knows error is defined\n * }\n * ```\n */\nexport function isFail<T>(result: LLKBResult<T>): result is LLKBResult<T> & { error: string } {\n  return !result.success && result.error !== undefined;\n}\n","/**\n * LLKB Pattern Discovery Module\n *\n * This module provides functions for discovering app-specific patterns\n * by analyzing the target application's codebase. It detects:\n * - Frameworks (React, Angular, Vue, Next.js)\n * - UI Libraries (MUI, Ant Design, Chakra, AG Grid)\n * - Selector conventions (data-testid, aria-label, role)\n * - Authentication patterns\n *\n * @module llkb/discovery\n */\n\nimport * as fs from 'fs';\nimport * as fsp from 'fs/promises';\nimport * as path from 'path';\nimport { saveJSONAtomicSync } from './file-utils.js';\n\n// =============================================================================\n// Constants\n// =============================================================================\n\n/** Confidence boost for each package found in package.json */\nconst PACKAGE_CONFIDENCE_BOOST = 0.3;\n/** Confidence boost for each config file found */\nconst FILE_CONFIDENCE_BOOST = 0.2;\n/** Confidence boost for UI library packages */\nconst UI_PACKAGE_CONFIDENCE_BOOST = 0.25;\n/** Additional confidence boost for enterprise UI library versions */\nconst UI_ENTERPRISE_BOOST = 0.15;\n/** Maximum number of sample selectors to collect */\nconst MAX_SAMPLE_SELECTORS = 50;\n\n// =============================================================================\n// Type Definitions\n// =============================================================================\n\n/**\n * Signal indicating a detected framework\n */\nexport interface FrameworkSignal {\n  /** Framework name (react, angular, vue, nextjs, svelte) */\n  name: string;\n  /** Detected version if available */\n  version?: string;\n  /** Confidence score (0.0 - 1.0) */\n  confidence: number;\n  /** Evidence that led to detection */\n  evidence: string[];\n}\n\n/**\n * Signal indicating a detected UI library\n */\nexport interface UiLibrarySignal {\n  /** Library name (mui, antd, chakra, ag-grid) */\n  name: string;\n  /** Confidence score (0.0 - 1.0) */\n  confidence: number;\n  /** Evidence that led to detection */\n  evidence: string[];\n  /** Whether enterprise version is detected */\n  hasEnterprise?: boolean;\n}\n\n/**\n * Analysis of selector usage patterns in the codebase\n */\nexport interface SelectorSignals {\n  /** Most commonly used selector attribute */\n  primaryAttribute: string;\n  /** Detected naming convention */\n  namingConvention: 'kebab-case' | 'camelCase' | 'snake_case' | 'mixed';\n  /** Coverage percentage for each selector type */\n  coverage: Record<string, number>;\n  /** Total components analyzed */\n  totalComponentsAnalyzed: number;\n  /** Sample selectors found */\n  sampleSelectors: string[];\n}\n\n/**\n * Hints about authentication patterns in the application\n */\nexport interface AuthHints {\n  /** Whether auth was detected */\n  detected: boolean;\n  /** Type of authentication */\n  type?: 'form' | 'oidc' | 'oauth' | 'sso' | 'basic';\n  /** Login route path */\n  loginRoute?: string;\n  /** Detected selectors for auth elements */\n  selectors?: Record<string, string>;\n  /** Whether bypass mechanism is available */\n  bypassAvailable?: boolean;\n  /** How to bypass auth for testing */\n  bypassMethod?: string;\n}\n\n/**\n * Complete app profile combining all discovery signals\n * Note: Named DiscoveredProfile to avoid collision with AppProfile in loaders.ts\n */\nexport interface DiscoveredProfile {\n  /** Schema version */\n  version: string;\n  /** When this profile was generated */\n  generatedAt: string;\n  /** Root directory of the project */\n  projectRoot: string;\n  /** Detected frameworks */\n  frameworks: FrameworkSignal[];\n  /** Detected UI libraries */\n  uiLibraries: UiLibrarySignal[];\n  /** Selector usage analysis */\n  selectorSignals: SelectorSignals;\n  /** Authentication hints */\n  auth: AuthHints;\n  /** Runtime validation status (if performed) */\n  runtime: {\n    validated: boolean;\n    scanUrl: string | null;\n    domSampleCount: number;\n  };\n}\n\n/**\n * Result of a complete discovery run\n */\nexport interface DiscoveryResult {\n  /** Whether discovery was successful */\n  success: boolean;\n  /** Generated app profile */\n  profile: DiscoveredProfile | null;\n  /** Any errors encountered */\n  errors: string[];\n  /** Warnings (non-fatal issues) */\n  warnings: string[];\n}\n\n// =============================================================================\n// Framework Detection Patterns\n// =============================================================================\n\n/**\n * Pattern definitions for framework detection\n */\nexport const FRAMEWORK_PATTERNS: Record<string, {\n  packages: string[];\n  files: string[];\n  baseConfidence: number;\n}> = {\n  react: {\n    packages: ['react', 'react-dom'],\n    files: ['src/App.tsx', 'src/App.jsx', 'src/index.tsx', 'src/index.jsx'],\n    baseConfidence: 0.95,\n  },\n  angular: {\n    packages: ['@angular/core', '@angular/common'],\n    files: ['angular.json', 'src/app/app.module.ts', 'src/app/app.component.ts'],\n    baseConfidence: 0.95,\n  },\n  vue: {\n    packages: ['vue'],\n    files: ['src/App.vue', 'src/main.ts', 'vue.config.js', 'vite.config.ts'],\n    baseConfidence: 0.90,\n  },\n  nextjs: {\n    packages: ['next'],\n    files: ['next.config.js', 'next.config.mjs', 'next.config.ts', 'src/app/page.tsx', 'pages/_app.tsx'],\n    baseConfidence: 0.95,\n  },\n  svelte: {\n    packages: ['svelte'],\n    files: ['svelte.config.js', 'src/App.svelte'],\n    baseConfidence: 0.90,\n  },\n};\n\n/**\n * Pattern definitions for UI library detection\n */\nexport const UI_LIBRARY_PATTERNS: Record<string, {\n  packages: string[];\n  enterprisePackages?: string[];\n  baseConfidence: number;\n}> = {\n  mui: {\n    packages: ['@mui/material', '@mui/core', '@emotion/react', '@emotion/styled'],\n    enterprisePackages: ['@mui/x-data-grid-pro', '@mui/x-data-grid-premium'],\n    baseConfidence: 0.85,\n  },\n  antd: {\n    packages: ['antd', '@ant-design/icons'],\n    enterprisePackages: ['@ant-design/pro-components', '@ant-design/pro-layout'],\n    baseConfidence: 0.85,\n  },\n  chakra: {\n    packages: ['@chakra-ui/react', '@chakra-ui/core'],\n    baseConfidence: 0.85,\n  },\n  'ag-grid': {\n    packages: ['ag-grid-community', 'ag-grid-react', 'ag-grid-angular', 'ag-grid-vue'],\n    enterprisePackages: ['ag-grid-enterprise', '@ag-grid-enterprise/core'],\n    baseConfidence: 0.90,\n  },\n  tailwind: {\n    packages: ['tailwindcss'],\n    baseConfidence: 0.80,\n  },\n  bootstrap: {\n    packages: ['bootstrap', 'react-bootstrap', 'ng-bootstrap', 'bootstrap-vue'],\n    baseConfidence: 0.80,\n  },\n};\n\n/**\n * Regex source patterns for selector attribute detection.\n * Stored as source strings so each consumer creates a fresh RegExp\n * (avoids shared mutable lastIndex state from /g flag).\n */\nconst SELECTOR_PATTERN_SOURCES: Record<string, string> = {\n  'data-testid': `data-testid=['\"]([^'\"]+)['\"]`,\n  'data-cy': `data-cy=['\"]([^'\"]+)['\"]`,\n  'data-test': `data-test=['\"]([^'\"]+)['\"]`,\n  'data-test-id': `data-test-id=['\"]([^'\"]+)['\"]`,\n  'aria-label': `aria-label=['\"]([^'\"]+)['\"]`,\n  'role': `role=['\"]([^'\"]+)['\"]`,\n};\n\n/**\n * Get fresh regex instances for selector patterns (no shared /g state).\n * @returns Record of selector name to fresh RegExp with /g flag\n */\nfunction createSelectorPatterns(): Record<string, RegExp> {\n  const patterns: Record<string, RegExp> = {};\n  for (const [key, source] of Object.entries(SELECTOR_PATTERN_SOURCES)) {\n    patterns[key] = new RegExp(source, 'g');\n  }\n  return patterns;\n}\n\n/**\n * Exported for backward compatibility. Note: these use /g flag and have\n * mutable lastIndex. Prefer createSelectorPatterns() for repeated use.\n * @deprecated Use createSelectorPatterns() for thread-safe usage\n */\nexport const SELECTOR_PATTERNS: Record<string, RegExp> = createSelectorPatterns();\n\n// =============================================================================\n// Detection Functions\n// =============================================================================\n\n/**\n * Detect frameworks used in a project\n *\n * @param projectRoot - Path to the project root directory\n * @returns Array of detected framework signals\n */\nexport function detectFrameworks(projectRoot: string): FrameworkSignal[] {\n  const signals: FrameworkSignal[] = [];\n  const packageJsonPath = path.join(projectRoot, 'package.json');\n\n  // Check if package.json exists\n  if (!fs.existsSync(packageJsonPath)) {\n    return signals;\n  }\n\n  let packageJson: { dependencies?: Record<string, string>; devDependencies?: Record<string, string> };\n  try {\n    const content = fs.readFileSync(packageJsonPath, 'utf-8');\n    const parsed: unknown = JSON.parse(content);\n    // SEC-F03: Runtime shape validation\n    if (typeof parsed !== 'object' || parsed === null) {\n      return signals;\n    }\n    packageJson = parsed as typeof packageJson;\n  } catch {\n    return signals;\n  }\n\n  const allDeps = {\n    ...packageJson.dependencies,\n    ...packageJson.devDependencies,\n  };\n\n  for (const [framework, patterns] of Object.entries(FRAMEWORK_PATTERNS)) {\n    const evidence: string[] = [];\n    let confidence = 0;\n\n    // Check packages\n    for (const pkg of patterns.packages) {\n      if (allDeps[pkg]) {\n        evidence.push(`package.json:${pkg}@${allDeps[pkg]}`);\n        confidence += PACKAGE_CONFIDENCE_BOOST;\n      }\n    }\n\n    // Check files\n    for (const file of patterns.files) {\n      const filePath = path.join(projectRoot, file);\n      if (fs.existsSync(filePath)) {\n        evidence.push(`file:${file}`);\n        confidence += FILE_CONFIDENCE_BOOST;\n      }\n    }\n\n    if (evidence.length > 0) {\n      // Cap confidence at base confidence level\n      confidence = Math.min(confidence, patterns.baseConfidence);\n\n      // Extract version from primary package\n      const primaryPkg = patterns.packages[0] ?? '';\n      const version = primaryPkg ? allDeps[primaryPkg]?.replace(/[\\^~>=<]/, '') : undefined;\n\n      signals.push({\n        name: framework,\n        version,\n        confidence,\n        evidence,\n      });\n    }\n  }\n\n  // Sort by confidence descending\n  return signals.sort((a, b) => b.confidence - a.confidence);\n}\n\n/**\n * Detect UI libraries used in a project\n *\n * @param projectRoot - Path to the project root directory\n * @returns Array of detected UI library signals\n */\nexport function detectUiLibraries(projectRoot: string): UiLibrarySignal[] {\n  const signals: UiLibrarySignal[] = [];\n  const packageJsonPath = path.join(projectRoot, 'package.json');\n\n  if (!fs.existsSync(packageJsonPath)) {\n    return signals;\n  }\n\n  let packageJson: { dependencies?: Record<string, string>; devDependencies?: Record<string, string> };\n  try {\n    const content = fs.readFileSync(packageJsonPath, 'utf-8');\n    const parsed: unknown = JSON.parse(content);\n    // SEC-F03: Runtime shape validation\n    if (typeof parsed !== 'object' || parsed === null) {\n      return signals;\n    }\n    packageJson = parsed as typeof packageJson;\n  } catch {\n    return signals;\n  }\n\n  const allDeps = {\n    ...packageJson.dependencies,\n    ...packageJson.devDependencies,\n  };\n\n  for (const [library, patterns] of Object.entries(UI_LIBRARY_PATTERNS)) {\n    const evidence: string[] = [];\n    let confidence = 0;\n    let hasEnterprise = false;\n\n    // Check packages\n    for (const pkg of patterns.packages) {\n      if (allDeps[pkg]) {\n        evidence.push(`package.json:${pkg}`);\n        confidence += UI_PACKAGE_CONFIDENCE_BOOST;\n      }\n    }\n\n    // Check enterprise packages\n    if (patterns.enterprisePackages) {\n      for (const pkg of patterns.enterprisePackages) {\n        if (allDeps[pkg]) {\n          evidence.push(`package.json:${pkg} (enterprise)`);\n          hasEnterprise = true;\n          confidence += UI_ENTERPRISE_BOOST;\n        }\n      }\n    }\n\n    if (evidence.length > 0) {\n      confidence = Math.min(confidence, patterns.baseConfidence);\n\n      signals.push({\n        name: library,\n        confidence,\n        evidence,\n        hasEnterprise: hasEnterprise || undefined,\n      });\n    }\n  }\n\n  return signals.sort((a, b) => b.confidence - a.confidence);\n}\n\n/**\n * Analyze selector patterns in source files\n *\n * @param projectRoot - Path to the project root directory\n * @returns Selector signal analysis\n */\nexport async function analyzeSelectorSignals(projectRoot: string): Promise<SelectorSignals> {\n  const coverage: Record<string, number> = {};\n  const selectorCounts: Record<string, number> = {};\n  const sampleSelectors: string[] = [];\n  let totalFiles = 0;\n\n  // Initialize counts\n  for (const attr of Object.keys(SELECTOR_PATTERNS)) {\n    selectorCounts[attr] = 0;\n  }\n\n  // Find source files\n  const srcDir = path.join(projectRoot, 'src');\n  if (fs.existsSync(srcDir)) {\n    await scanDirectoryForSelectors(srcDir, selectorCounts, sampleSelectors);\n    totalFiles = await countSourceFiles(srcDir);\n  }\n\n  // Calculate coverage\n  const totalSelectors = Object.values(selectorCounts).reduce((sum, count) => sum + count, 0);\n  for (const [attr, count] of Object.entries(selectorCounts)) {\n    coverage[attr] = totalSelectors > 0 ? count / totalSelectors : 0;\n  }\n\n  // Determine primary attribute\n  const primaryAttribute = Object.entries(selectorCounts)\n    .sort(([, a], [, b]) => b - a)[0]?.[0] || 'data-testid';\n\n  // Detect naming convention from samples\n  const namingConvention = detectNamingConvention(sampleSelectors);\n\n  return {\n    primaryAttribute,\n    namingConvention,\n    coverage,\n    totalComponentsAnalyzed: totalFiles,\n    sampleSelectors: sampleSelectors.slice(0, 10), // Keep top 10 samples\n  };\n}\n\n/**\n * Extract authentication hints from project\n *\n * @param projectRoot - Path to the project root directory\n * @returns Authentication hints\n */\nexport async function extractAuthHints(projectRoot: string): Promise<AuthHints> {\n  const hints: AuthHints = {\n    detected: false,\n  };\n\n  // Check for ARTK discovery output first\n  const artkDiscoveryPath = path.join(projectRoot, '.artk', 'discovery.json');\n  if (fs.existsSync(artkDiscoveryPath)) {\n    try {\n      interface DiscoveryJson {\n        auth?: {\n          type?: AuthHints['type'];\n          loginRoute?: string;\n          selectors?: AuthHints['selectors'];\n          bypassAvailable?: boolean;\n          bypassMethod?: string;\n        };\n      }\n      const parsed: unknown = JSON.parse(fs.readFileSync(artkDiscoveryPath, 'utf-8'));\n      // SEC-F03: Runtime shape validation\n      if (typeof parsed !== 'object' || parsed === null) {\n        throw new Error('Invalid discovery.json shape');\n      }\n      const discovery = parsed as DiscoveryJson;\n      if (discovery.auth) {\n        hints.detected = true;\n        hints.type = discovery.auth.type;\n        hints.loginRoute = discovery.auth.loginRoute;\n        hints.selectors = discovery.auth.selectors;\n        hints.bypassAvailable = discovery.auth.bypassAvailable;\n        hints.bypassMethod = discovery.auth.bypassMethod;\n        return hints;\n      }\n    } catch {\n      // Continue with fallback detection\n    }\n  }\n\n  // Fallback: scan for auth patterns\n  const srcDir = path.join(projectRoot, 'src');\n  if (!fs.existsSync(srcDir)) {\n    return hints;\n  }\n\n  const authPatterns = await scanForAuthPatterns(srcDir);\n  if (authPatterns.hasAuth) {\n    hints.detected = true;\n    hints.type = authPatterns.type;\n    hints.loginRoute = authPatterns.loginRoute;\n    hints.selectors = authPatterns.selectors;\n  }\n\n  return hints;\n}\n\n/**\n * Run full discovery and generate app profile\n *\n * @param projectRoot - Path to the project root directory\n * @returns Discovery result with app profile\n */\nexport async function runDiscovery(projectRoot: string): Promise<DiscoveryResult> {\n  const errors: string[] = [];\n  const warnings: string[] = [];\n\n  // Validate project root\n  if (!fs.existsSync(projectRoot)) {\n    return {\n      success: false,\n      profile: null,\n      errors: [`Project root does not exist: ${projectRoot}`],\n      warnings: [],\n    };\n  }\n\n  // Run all detection functions\n  let frameworks: FrameworkSignal[] = [];\n  let uiLibraries: UiLibrarySignal[] = [];\n  let selectorSignals: SelectorSignals;\n  let auth: AuthHints;\n\n  try {\n    frameworks = detectFrameworks(projectRoot);\n    if (frameworks.length === 0) {\n      warnings.push('No frameworks detected');\n    }\n  } catch (e) {\n    errors.push(`Framework detection failed: ${String(e)}`);\n  }\n\n  try {\n    uiLibraries = detectUiLibraries(projectRoot);\n  } catch (e) {\n    warnings.push(`UI library detection failed: ${String(e)}`);\n  }\n\n  try {\n    selectorSignals = await analyzeSelectorSignals(projectRoot);\n  } catch (e) {\n    warnings.push(`Selector analysis failed: ${String(e)}`);\n    selectorSignals = {\n      primaryAttribute: 'data-testid',\n      namingConvention: 'kebab-case',\n      coverage: {},\n      totalComponentsAnalyzed: 0,\n      sampleSelectors: [],\n    };\n  }\n\n  try {\n    auth = await extractAuthHints(projectRoot);\n  } catch (e) {\n    warnings.push(`Auth hint extraction failed: ${String(e)}`);\n    auth = { detected: false };\n  }\n\n  const profile: DiscoveredProfile = {\n    version: '1.0',\n    generatedAt: new Date().toISOString(),\n    projectRoot,\n    frameworks,\n    uiLibraries,\n    selectorSignals,\n    auth,\n    runtime: {\n      validated: false,\n      scanUrl: null,\n      domSampleCount: 0,\n    },\n  };\n\n  return {\n    success: errors.length === 0,\n    profile,\n    errors,\n    warnings,\n  };\n}\n\n/**\n * Save discovered profile to disk\n *\n * @param profile - The discovered profile to save\n * @param outputDir - Directory to save to (usually .artk/llkb/)\n */\nexport function saveDiscoveredProfile(profile: DiscoveredProfile, outputDir: string): void {\n  const outputPath = path.join(outputDir, 'discovered-profile.json');\n  fs.mkdirSync(outputDir, { recursive: true });\n\n  // SEC-F05: Redact absolute projectRoot to prevent info disclosure if committed.\n  // SEC-F09: Redact auth selector values (credential-adjacent data).\n  // Auth metadata (type, loginRoute, bypassAvailable) is safe; raw selectors are not.\n  const redactedAuth = profile.auth.selectors\n    ? { ...profile.auth, selectors: Object.fromEntries(\n        Object.keys(profile.auth.selectors).map(k => [k, '[REDACTED]'])\n      ) }\n    : profile.auth;\n\n  const redacted = {\n    ...profile,\n    projectRoot: path.basename(profile.projectRoot),\n    auth: redactedAuth,\n  };\n  saveJSONAtomicSync(outputPath, redacted);\n}\n\n/**\n * Load discovered profile from disk\n *\n * @param llkbDir - Directory containing the profile (usually .artk/llkb/)\n * @returns The discovered profile, or null if not found\n */\nexport function loadDiscoveredProfile(llkbDir: string): DiscoveredProfile | null {\n  const filePath = path.join(llkbDir, 'discovered-profile.json');\n  if (!fs.existsSync(filePath)) {\n    return null;\n  }\n\n  try {\n    const content = fs.readFileSync(filePath, 'utf-8');\n    const parsed: unknown = JSON.parse(content);\n    // SEC-F03: Runtime shape validation\n    if (typeof parsed !== 'object' || parsed === null) {\n      return null;\n    }\n    // Validate minimum required fields\n    const obj = parsed as Record<string, unknown>;\n    if (!obj.version || !Array.isArray(obj.frameworks)) {\n      return null;\n    }\n    return obj as unknown as DiscoveredProfile;\n  } catch {\n    return null;\n  }\n}\n\n/**\n * @deprecated Use saveDiscoveredProfile instead\n */\nexport const saveAppProfile = saveDiscoveredProfile;\n\n// =============================================================================\n// Helper Functions\n// =============================================================================\n\n/** Maximum recursion depth for directory scanning */\nconst MAX_SCAN_DEPTH = 20;\n/** Maximum number of files to scan */\nconst MAX_FILES_TO_SCAN = 5000;\n\n/**\n * Recursively scan directory for selector patterns (async)\n */\nasync function scanDirectoryForSelectors(\n  dir: string,\n  selectorCounts: Record<string, number>,\n  sampleSelectors: string[],\n  depth: number = 0,\n  fileCount: { count: number } = { count: 0 }\n): Promise<void> {\n  // Guard against excessive recursion or file count\n  if (depth > MAX_SCAN_DEPTH || fileCount.count > MAX_FILES_TO_SCAN) {\n    return;\n  }\n\n  const extensions = ['.tsx', '.jsx', '.vue', '.html', '.ts', '.js'];\n\n  let entries: fs.Dirent[];\n  try {\n    entries = await fsp.readdir(dir, { withFileTypes: true });\n  } catch {\n    return; // Directory not readable\n  }\n\n  for (const entry of entries) {\n    if (fileCount.count > MAX_FILES_TO_SCAN) {break;}\n\n    const fullPath = path.join(dir, entry.name);\n\n    if (entry.isDirectory()) {\n      // Skip node_modules, hidden directories, and symlinks\n      if (entry.name !== 'node_modules' && !entry.name.startsWith('.') && !entry.isSymbolicLink()) {\n        await scanDirectoryForSelectors(fullPath, selectorCounts, sampleSelectors, depth + 1, fileCount);\n      }\n    } else if (entry.isFile() && extensions.some(ext => entry.name.endsWith(ext))) {\n      fileCount.count++;\n      try {\n        const content = await fsp.readFile(fullPath, 'utf-8');\n\n        // Create fresh regex instances per file to avoid shared lastIndex state\n        const freshPatterns = createSelectorPatterns();\n        for (const [attr, pattern] of Object.entries(freshPatterns)) {\n          let match: RegExpExecArray | null;\n          while ((match = pattern.exec(content)) !== null) {\n            selectorCounts[attr]!++;\n            if (sampleSelectors.length < MAX_SAMPLE_SELECTORS && match[1]) {\n              sampleSelectors.push(match[1]);\n            }\n          }\n        }\n      } catch {\n        // Skip files that can't be read\n      }\n    }\n  }\n}\n\n/**\n * Count source files in a directory (async)\n */\nasync function countSourceFiles(dir: string, depth: number = 0): Promise<number> {\n  if (depth > MAX_SCAN_DEPTH) {return 0;}\n\n  const extensions = ['.tsx', '.jsx', '.vue', '.ts', '.js'];\n  let count = 0;\n\n  let entries: fs.Dirent[];\n  try {\n    entries = await fsp.readdir(dir, { withFileTypes: true });\n  } catch {\n    return 0;\n  }\n\n  for (const entry of entries) {\n    const fullPath = path.join(dir, entry.name);\n\n    if (entry.isDirectory() && entry.name !== 'node_modules' && !entry.name.startsWith('.') && !entry.isSymbolicLink()) {\n      count += await countSourceFiles(fullPath, depth + 1);\n    } else if (entry.isFile() && extensions.some(ext => entry.name.endsWith(ext))) {\n      count++;\n    }\n  }\n\n  return count;\n}\n\n/**\n * Detect naming convention from selector samples\n */\nfunction detectNamingConvention(samples: string[]): 'kebab-case' | 'camelCase' | 'snake_case' | 'mixed' {\n  if (samples.length === 0) {return 'kebab-case';}\n\n  let kebabCount = 0;\n  let camelCount = 0;\n  let snakeCount = 0;\n\n  for (const sample of samples) {\n    if (sample.includes('-')) {kebabCount++;}\n    if (/[a-z][A-Z]/.test(sample)) {camelCount++;}\n    if (sample.includes('_')) {snakeCount++;}\n  }\n\n  const maxCount = Math.max(kebabCount, camelCount, snakeCount);\n\n  if (maxCount === 0) {return 'kebab-case';}\n  if (kebabCount === maxCount && camelCount < maxCount && snakeCount < maxCount) {return 'kebab-case';}\n  if (camelCount === maxCount && kebabCount < maxCount && snakeCount < maxCount) {return 'camelCase';}\n  if (snakeCount === maxCount && kebabCount < maxCount && camelCount < maxCount) {return 'snake_case';}\n\n  return 'mixed';\n}\n\n/**\n * Scan for authentication patterns\n */\nasync function scanForAuthPatterns(srcDir: string, depth: number = 0): Promise<{\n  hasAuth: boolean;\n  type?: 'form' | 'oidc' | 'oauth' | 'sso' | 'basic';\n  loginRoute?: string;\n  selectors?: Record<string, string>;\n}> {\n  // SEC-F04 FIX: Add depth limit (all other scan functions have one)\n  if (depth > MAX_SCAN_DEPTH) {\n    return { hasAuth: false };\n  }\n\n  const result: { hasAuth: boolean; type?: 'form' | 'oidc' | 'oauth' | 'sso' | 'basic'; loginRoute?: string; selectors?: Record<string, string> } = {\n    hasAuth: false,\n  };\n\n  // Auth-related file patterns\n  const authFilePatterns = [\n    /auth/i,\n    /login/i,\n    /signin/i,\n    /oauth/i,\n    /sso/i,\n  ];\n\n  // Auth-related code patterns\n  const authCodePatterns = {\n    oidc: [/oidc/i, /openid/i, /id_token/i, /authorization_code/i],\n    oauth: [/oauth/i, /access_token/i, /refresh_token/i],\n    form: [/login.*form/i, /username.*password/i, /signin/i],\n    sso: [/sso/i, /saml/i, /federation/i],\n  };\n\n  let entries: fs.Dirent[];\n  try {\n    entries = await fsp.readdir(srcDir, { withFileTypes: true });\n  } catch {\n    return result; // Directory not readable\n  }\n\n  for (const entry of entries) {\n    const fullPath = path.join(srcDir, entry.name);\n\n    if (entry.isFile() && authFilePatterns.some(p => p.test(entry.name))) {\n      result.hasAuth = true;\n\n      try {\n        const content = await fsp.readFile(fullPath, 'utf-8');\n\n        // Check for auth type\n        for (const [type, patterns] of Object.entries(authCodePatterns)) {\n          if (patterns.some(p => p.test(content))) {\n            result.type = type as 'oidc' | 'oauth' | 'form' | 'sso';\n            break;\n          }\n        }\n\n        // Look for login route\n        const routeMatch = content.match(/['\"](\\/login|\\/signin|\\/auth)['\"]/i);\n        if (routeMatch) {\n          result.loginRoute = routeMatch[1];\n        }\n      } catch {\n        // Skip files that can't be read\n      }\n    } else if (entry.isDirectory() && !entry.name.startsWith('.') && entry.name !== 'node_modules') {\n      const subResult = await scanForAuthPatterns(fullPath, depth + 1);\n      if (subResult.hasAuth) {\n        result.hasAuth = true;\n        result.type = result.type || subResult.type;\n        result.loginRoute = result.loginRoute || subResult.loginRoute;\n      }\n    }\n  }\n\n  return result;\n}\n","/**\n * LLKB Mining Module\n *\n * Extracts entities, routes, forms, tables, and modals from codebases\n * to enable zero-config pattern generation.\n *\n * Extraction sources:\n * - Entities: API calls, TypeScript types, database models (Prisma, TypeORM)\n * - Routes: React Router, Next.js, Angular Router, Vue Router\n * - Forms: Zod/Yup schemas, React Hook Form, Formik, HTML forms\n * - Tables: AG Grid, TanStack Table, MUI DataGrid, HTML tables\n * - Modals: MUI Dialog, Radix Dialog, React Modal, custom patterns\n *\n * ARCH-002: Uses MiningCache for file caching to reduce I/O\n * ARCH-003: Uses SOURCE_DIRECTORIES for consistent directory coverage\n *\n * @module llkb/mining\n */\n\nimport * as fs from 'fs';\nimport * as fsp from 'fs/promises';\nimport * as path from 'path';\nimport type {\n  DiscoveredElements,\n  DiscoveredEntity,\n  DiscoveredForm,\n  DiscoveredModal,\n  DiscoveredRoute,\n  DiscoveredTable,\n  FormField,\n  GenerationResult,\n} from './template-generators.js';\nimport { pluralize, singularize } from './pluralization.js';\nimport {\n  MiningCache,\n  scanAllSourceDirectories,\n  type ScannedFile,\n} from './mining-cache.js';\n\n// =============================================================================\n// Constants\n// =============================================================================\n\n/** Maximum recursion depth for directory scanning */\nconst MAX_SCAN_DEPTH = 15;\n/** Maximum number of files to scan */\nconst MAX_FILES_TO_SCAN = 3000;\n/** Maximum file size to read (SEC-002: prevent memory issues with large files) */\nconst MAX_FILE_SIZE_BYTES = 5 * 1024 * 1024; // 5MB\n/** SEC-004: Maximum regex iterations to prevent ReDoS on pathological input */\nconst MAX_REGEX_ITERATIONS = 10_000;\n/** Extensions to scan */\nconst SOURCE_EXTENSIONS = ['.ts', '.tsx', '.js', '.jsx', '.vue', '.svelte'];\n\n// =============================================================================\n// Security Helpers (SEC-001, SEC-002)\n// =============================================================================\n\n/**\n * Validate that a path is within the project root (SEC-001: prevent path traversal)\n */\nfunction validatePathWithinRoot(projectRoot: string, targetPath: string): boolean {\n  const resolvedRoot = path.resolve(projectRoot);\n  const resolvedTarget = path.resolve(targetPath);\n  return resolvedTarget.startsWith(resolvedRoot + path.sep) || resolvedTarget === resolvedRoot;\n}\n\n/**\n * Check if file size is within limits (SEC-002: prevent memory issues)\n */\nasync function isFileSizeWithinLimit(filePath: string): Promise<boolean> {\n  try {\n    const stats = await fsp.lstat(filePath);\n    // SEC-005: Reject symlinks\n    if (stats.isSymbolicLink()) {return false;}\n    return stats.size <= MAX_FILE_SIZE_BYTES;\n  } catch {\n    return false;\n  }\n}\n\n/**\n * Count source files in a directory (BUG-006: track filesScanned stat)\n */\n// @ts-expect-error Reserved for future use\nfunction _countSourceFilesInDir(\n  dir: string,\n  count: { value: number },\n  depth: number = 0,\n  maxDepth: number = MAX_SCAN_DEPTH\n): void {\n  if (depth > maxDepth || count.value > MAX_FILES_TO_SCAN) {return;}\n\n  let entries: fs.Dirent[];\n  try {\n    entries = fs.readdirSync(dir, { withFileTypes: true });\n  } catch {\n    return;\n  }\n\n  for (const entry of entries) {\n    if (count.value > MAX_FILES_TO_SCAN) {break;}\n\n    const fullPath = path.join(dir, entry.name);\n\n    if (entry.isDirectory()) {\n      if (!entry.name.startsWith('.') &&\n          entry.name !== 'node_modules' &&\n          entry.name !== 'dist' &&\n          entry.name !== 'build' &&\n          !entry.isSymbolicLink()) {\n        _countSourceFilesInDir(fullPath, count, depth + 1, maxDepth);\n      }\n    } else if (entry.isFile() && SOURCE_EXTENSIONS.some(ext => entry.name.endsWith(ext))) {\n      count.value++;\n    }\n  }\n}\n\n// =============================================================================\n// Pluralization - ARCH-001 FIX: Now imported from shared module\n// =============================================================================\n// pluralize and singularize are imported from './pluralization.js'\n\n// =============================================================================\n// Entity Mining\n// =============================================================================\n\n/**\n * Patterns to extract entity names from code\n */\nconst ENTITY_PATTERNS = {\n  // TypeScript/JavaScript types and interfaces (including exported)\n  // BUG-002 FIX: Added optional export prefix to catch exported interfaces/types\n  typeInterface: /(?:export\\s+)?(?:interface|type)\\s+(\\w+)(?:\\s+extends|\\s*[={<])/g,\n\n  // Class names (often entities in ORM) - also handle exported classes\n  className: /(?:export\\s+)?class\\s+(\\w+)(?:\\s+extends|\\s+implements|\\s*\\{)/g,\n\n  // Prisma model\n  prismaModel: /model\\s+(\\w+)\\s*\\{/g,\n\n  // TypeORM Entity\n  typeormEntity: /@Entity\\s*\\(\\s*['\"]?(\\w+)?['\"]?\\s*\\)/g,\n\n  // API fetch patterns\n  apiFetch: /(?:fetch|axios\\.(?:get|post|put|delete|patch))\\s*\\(\\s*[`'\"]\\/?(?:api\\/)?(\\w+)/gi,\n\n  // REST resource patterns\n  restResource: /\\/api\\/(\\w+)(?:\\/|['\"`])/gi,\n\n  // GraphQL types\n  graphqlType: /type\\s+(\\w+)\\s*(?:@|\\{|implements)/g,\n\n  // Mongoose/MongoDB schema\n  mongooseSchema: /new\\s+(?:mongoose\\.)?Schema\\s*<?\\s*(\\w+)?/g,\n  mongooseModel: /mongoose\\.model\\s*[<(]\\s*['\"]?(\\w+)/g,\n\n  // Sequelize model\n  sequelizeModel: /sequelize\\.define\\s*\\(\\s*['\"](\\w+)/g,\n\n  // MikroORM entity\n  mikroEntity: /@Entity\\s*\\(\\s*\\{\\s*(?:tableName|collection)\\s*:\\s*['\"](\\w+)/g,\n};\n\n/**\n * Words to exclude from entity detection\n */\nconst ENTITY_EXCLUSIONS = new Set([\n  // Common utility types\n  'props', 'state', 'context', 'config', 'options', 'params', 'args',\n  'request', 'response', 'result', 'error', 'data', 'payload',\n  // React types\n  'component', 'element', 'node', 'children', 'ref', 'handler',\n  'event', 'callback', 'dispatch', 'action', 'reducer', 'store',\n  // Common suffixes that aren't entities\n  'service', 'controller', 'repository', 'factory', 'builder',\n  'helper', 'util', 'utils', 'hook', 'provider', 'consumer',\n  // Generic types\n  'string', 'number', 'boolean', 'object', 'array', 'function',\n  'any', 'unknown', 'void', 'null', 'undefined', 'never',\n  'partial', 'required', 'readonly', 'pick', 'omit', 'record',\n  'promise', 'async', 'await', 'import', 'export', 'default',\n]);\n\n/**\n * Mine entities from a project directory.\n *\n * NOTE: This function does NOT use the MiningCache and scans a subset of directories.\n * For better performance with caching and full directory coverage, use `mineElements()`\n * which implements ARCH-002 (file caching) and ARCH-003 (unified directories).\n *\n * @deprecated Use `mineElements()` instead for caching and full directory coverage.\n * @param projectRoot - Path to the project root directory\n * @param options - Mining options (maxDepth, maxFiles)\n * @returns Array of discovered entities\n */\nexport async function mineEntities(\n  projectRoot: string,\n  options: { maxDepth?: number; maxFiles?: number } = {}\n): Promise<DiscoveredEntity[]> {\n  // SEC-001: Resolve and validate project root\n  const resolvedRoot = path.resolve(projectRoot);\n\n  const maxDepth = options.maxDepth ?? MAX_SCAN_DEPTH;\n  const maxFiles = options.maxFiles ?? MAX_FILES_TO_SCAN;\n\n  const entityMap = new Map<string, { name: string; sources: string[]; endpoints: string[] }>();\n  const fileCount = { count: 0 };\n\n  // Scan common source directories\n  const srcDirs = ['src', 'app', 'lib', 'pages', 'components', 'models', 'entities', 'types'];\n\n  for (const dir of srcDirs) {\n    const fullPath = path.join(resolvedRoot, dir);\n    // SEC-001: Validate path is within project root\n    if (!validatePathWithinRoot(resolvedRoot, fullPath)) {continue;}\n    if (fs.existsSync(fullPath)) {\n      await scanForEntities(fullPath, entityMap, fileCount, 0, maxDepth, maxFiles);\n    }\n  }\n\n  // Also check prisma schema\n  const prismaPath = path.join(projectRoot, 'prisma', 'schema.prisma');\n  if (fs.existsSync(prismaPath)) {\n    await extractPrismaEntities(prismaPath, entityMap);\n  }\n\n  // Convert to DiscoveredEntity array\n  return Array.from(entityMap.values()).map(({ name, sources, endpoints }) => {\n    const singular = singularize(name);\n    const plural = pluralize(singular);\n    return {\n      name,\n      singular,\n      plural,\n      source: sources[0],\n      endpoint: endpoints[0],\n    };\n  });\n}\n\nasync function scanForEntities(\n  dir: string,\n  entityMap: Map<string, { name: string; sources: string[]; endpoints: string[] }>,\n  fileCount: { count: number },\n  depth: number,\n  maxDepth: number,\n  maxFiles: number\n): Promise<void> {\n  if (depth > maxDepth || fileCount.count > maxFiles) {return;}\n\n  let entries: fs.Dirent[];\n  try {\n    entries = await fsp.readdir(dir, { withFileTypes: true });\n  } catch {\n    return;\n  }\n\n  for (const entry of entries) {\n    if (fileCount.count > maxFiles) {break;}\n\n    const fullPath = path.join(dir, entry.name);\n\n    if (entry.isDirectory()) {\n      if (!entry.name.startsWith('.') &&\n          entry.name !== 'node_modules' &&\n          entry.name !== 'dist' &&\n          entry.name !== 'build' &&\n          !entry.isSymbolicLink()) {\n        await scanForEntities(fullPath, entityMap, fileCount, depth + 1, maxDepth, maxFiles);\n      }\n    } else if (entry.isFile() && !entry.isSymbolicLink() && SOURCE_EXTENSIONS.some(ext => entry.name.endsWith(ext))) {\n      // SEC-003: Skip symlinks to prevent reading arbitrary files\n      fileCount.count++;\n      try {\n        // SEC-002: Skip files that are too large (e.g., minified bundles)\n        if (!await isFileSizeWithinLimit(fullPath)) {continue;}\n        const content = await fsp.readFile(fullPath, 'utf-8');\n        extractEntitiesFromContent(content, fullPath, entityMap);\n      } catch {\n        // Skip unreadable files\n      }\n    }\n  }\n}\n\nfunction extractEntitiesFromContent(\n  content: string,\n  source: string,\n  entityMap: Map<string, { name: string; sources: string[]; endpoints: string[] }>\n): void {\n  for (const [patternName, pattern] of Object.entries(ENTITY_PATTERNS)) {\n    pattern.lastIndex = 0;\n    let match: RegExpExecArray | null;\n\n    // Determine if this is an API pattern (which extracts plural names)\n    const isApiPattern = patternName.includes('api') || patternName.includes('rest') || patternName.includes('fetch');\n\n    let iterations = 0;\n    while ((match = pattern.exec(content)) !== null) {\n      if (++iterations > MAX_REGEX_ITERATIONS) {break;} // SEC-004: prevent ReDoS\n      const rawName = match[1];\n      if (!rawName) {continue;}\n\n      // Normalize the name\n      const name = rawName.replace(/(?:Model|Entity|Schema|Type|Interface|DTO|Input|Output)$/i, '');\n      let normalized = name.toLowerCase();\n\n      // For API patterns, singularize the name (e.g., \"users\" -> \"user\")\n      if (isApiPattern) {\n        normalized = singularize(normalized);\n      }\n\n      // Skip exclusions and very short names\n      if (ENTITY_EXCLUSIONS.has(normalized) || normalized.length < 3) {continue;}\n\n      // Skip if it looks like a utility type (ends with common suffixes)\n      if (/(?:Props|State|Context|Config|Options|Params|Args|Handler|Callback|Service|Controller|Repository)$/i.test(rawName)) {\n        continue;\n      }\n\n      const existing = entityMap.get(normalized);\n      if (existing) {\n        if (!existing.sources.includes(source)) {\n          existing.sources.push(source);\n        }\n      } else {\n        entityMap.set(normalized, {\n          name: normalized,\n          sources: [source],\n          endpoints: [],\n        });\n      }\n\n      // If this was an API pattern, also record the endpoint (use plural form for endpoint)\n      if (isApiPattern) {\n        const entry = entityMap.get(normalized);\n        const pluralForm = pluralize(normalized);\n        if (entry && !entry.endpoints.includes(`/api/${pluralForm}`)) {\n          entry.endpoints.push(`/api/${pluralForm}`);\n        }\n      }\n    }\n  }\n}\n\nasync function extractPrismaEntities(\n  prismaPath: string,\n  entityMap: Map<string, { name: string; sources: string[]; endpoints: string[] }>\n): Promise<void> {\n  try {\n    const content = await fsp.readFile(prismaPath, 'utf-8');\n    const modelPattern = /model\\s+(\\w+)\\s*\\{/g;\n    let match: RegExpExecArray | null;\n\n    let iterations = 0;\n    while ((match = modelPattern.exec(content)) !== null) {\n      if (++iterations > MAX_REGEX_ITERATIONS) {break;} // SEC-004\n      const name = match[1]!.toLowerCase();\n      if (!ENTITY_EXCLUSIONS.has(name) && name.length >= 3) {\n        const existing = entityMap.get(name);\n        if (existing) {\n          if (!existing.sources.includes(prismaPath)) {\n            existing.sources.push(prismaPath);\n          }\n        } else {\n          entityMap.set(name, {\n            name,\n            sources: [prismaPath],\n            endpoints: [`/api/${name}`],\n          });\n        }\n      }\n    }\n  } catch {\n    // Skip if unreadable\n  }\n}\n\n// =============================================================================\n// Route Mining\n// =============================================================================\n\n/**\n * Patterns to extract routes from code\n */\nconst ROUTE_PATTERNS = {\n  // React Router v6 - BUG-004 FIX: Handle JSX expressions and variable references\n  reactRouterPath: /<Route\\s+[^>]*path\\s*=\\s*[{'\"]([\\w/:.-]+)['\"}\\s]/gi,\n  reactRouterElement: /path:\\s*['\"]([^'\"]+)['\"]/g,\n  // Route config arrays: { path: '/users', element: <Users /> }\n  routeConfigPath: /\\{\\s*path:\\s*['\"]([^'\"]+)['\"][^}]*(?:element|component)/g,\n\n  // React Router useRoutes\n  useRoutesPath: /\\{\\s*path:\\s*['\"]([^'\"]+)['\"]/g,\n\n  // Route constants (ROUTES.USERS = '/users')\n  routeConstants: /(?:ROUTES|PATHS|routes|paths)\\s*[.:=]\\s*\\{[^}]*(\\w+)\\s*:\\s*['\"]([^'\"]+)['\"]/gi,\n\n  // Next.js pages directory (from file names)\n  nextPage: /pages\\/(.+?)(?:\\/index)?\\.(?:tsx?|jsx?)/,\n\n  // Next.js app directory\n  nextAppRoute: /app\\/(.+?)\\/page\\.(?:tsx?|jsx?)/,\n\n  // Angular router\n  angularPath: /path:\\s*['\"]([^'\"]+)['\"],?\\s*(?:component|loadComponent|children)/g,\n\n  // Vue Router\n  vueRouterPath: /path:\\s*['\"]([^'\"]+)['\"],?\\s*(?:name|component|components)/g,\n\n  // Express/Fastify routes\n  expressRoute: /(?:app|router)\\.(?:get|post|put|delete|patch|all)\\s*\\(\\s*['\"]([^'\"]+)['\"]/gi,\n\n  // NestJS routes\n  nestRoute: /@(?:Get|Post|Put|Delete|Patch|All)\\s*\\(\\s*['\"]?([^'\")\\s]*)/gi,\n};\n\n/**\n * Mine routes from a project directory.\n *\n * NOTE: This function does NOT use the MiningCache and scans a subset of directories.\n * For better performance with caching and full directory coverage, use `mineElements()`\n * which implements ARCH-002 (file caching) and ARCH-003 (unified directories).\n *\n * @deprecated Use `mineElements()` instead for caching and full directory coverage.\n * @param projectRoot - Path to the project root directory\n * @param options - Mining options (maxDepth, maxFiles)\n * @returns Array of discovered routes\n */\nexport async function mineRoutes(\n  projectRoot: string,\n  options: { maxDepth?: number; maxFiles?: number } = {}\n): Promise<DiscoveredRoute[]> {\n  // SEC-001: Resolve and validate project root\n  const resolvedRoot = path.resolve(projectRoot);\n\n  const maxDepth = options.maxDepth ?? MAX_SCAN_DEPTH;\n  const maxFiles = options.maxFiles ?? MAX_FILES_TO_SCAN;\n\n  const routeMap = new Map<string, DiscoveredRoute>();\n  const fileCount = { count: 0 };\n\n  // Scan source directories\n  const srcDirs = ['src', 'app', 'pages', 'routes', 'views'];\n\n  for (const dir of srcDirs) {\n    const fullPath = path.join(resolvedRoot, dir);\n    // SEC-001: Validate path is within project root\n    if (!validatePathWithinRoot(resolvedRoot, fullPath)) {continue;}\n    if (fs.existsSync(fullPath)) {\n      await scanForRoutes(fullPath, routeMap, fileCount, 0, maxDepth, maxFiles);\n    }\n  }\n\n  // Check for Next.js pages directory structure\n  const pagesDir = path.join(resolvedRoot, 'pages');\n  if (validatePathWithinRoot(resolvedRoot, pagesDir) && fs.existsSync(pagesDir)) {\n    await extractNextJsPages(pagesDir, routeMap, '');\n  }\n\n  // Check for Next.js app directory structure\n  const appDir = path.join(resolvedRoot, 'app');\n  if (validatePathWithinRoot(resolvedRoot, appDir) && fs.existsSync(appDir)) {\n    await extractNextJsAppRoutes(appDir, routeMap, '');\n  }\n\n  return Array.from(routeMap.values());\n}\n\nasync function scanForRoutes(\n  dir: string,\n  routeMap: Map<string, DiscoveredRoute>,\n  fileCount: { count: number },\n  depth: number,\n  maxDepth: number,\n  maxFiles: number\n): Promise<void> {\n  if (depth > maxDepth || fileCount.count > maxFiles) {return;}\n\n  let entries: fs.Dirent[];\n  try {\n    entries = await fsp.readdir(dir, { withFileTypes: true });\n  } catch {\n    return;\n  }\n\n  for (const entry of entries) {\n    if (fileCount.count > maxFiles) {break;}\n\n    const fullPath = path.join(dir, entry.name);\n\n    if (entry.isDirectory()) {\n      if (!entry.name.startsWith('.') &&\n          entry.name !== 'node_modules' &&\n          entry.name !== 'dist' &&\n          entry.name !== 'build' &&\n          !entry.isSymbolicLink()) {\n        await scanForRoutes(fullPath, routeMap, fileCount, depth + 1, maxDepth, maxFiles);\n      }\n    } else if (entry.isFile() && !entry.isSymbolicLink() && SOURCE_EXTENSIONS.some(ext => entry.name.endsWith(ext))) {\n      // SEC-003: Skip symlinks to prevent reading arbitrary files\n      fileCount.count++;\n      try {\n        // SEC-002: Skip files that are too large\n        if (!await isFileSizeWithinLimit(fullPath)) {continue;}\n        const content = await fsp.readFile(fullPath, 'utf-8');\n        extractRoutesFromContent(content, fullPath, routeMap);\n      } catch {\n        // Skip unreadable files\n      }\n    }\n  }\n}\n\nfunction extractRoutesFromContent(\n  content: string,\n  source: string,\n  routeMap: Map<string, DiscoveredRoute>\n): void {\n  for (const pattern of Object.values(ROUTE_PATTERNS)) {\n    if (typeof pattern === 'function') {continue;} // Skip non-regex patterns\n\n    pattern.lastIndex = 0;\n    let match: RegExpExecArray | null;\n\n    let iterations = 0;\n    while ((match = pattern.exec(content)) !== null) {\n      if (++iterations > MAX_REGEX_ITERATIONS) {break;} // SEC-004\n      const routePath = match[1];\n      if (!routePath || routePath === '*' || routePath === '**') {continue;}\n\n      // Normalize path\n      const normalizedPath = routePath.startsWith('/') ? routePath : `/${routePath}`;\n\n      // Skip API routes (focus on UI routes)\n      if (normalizedPath.startsWith('/api/')) {continue;}\n\n      // Extract route name from path\n      const name = pathToName(normalizedPath);\n\n      // Extract parameters\n      const params = extractRouteParams(normalizedPath);\n\n      if (!routeMap.has(normalizedPath)) {\n        routeMap.set(normalizedPath, {\n          path: normalizedPath,\n          name,\n          params: params.length > 0 ? params : undefined,\n          component: source,\n        });\n      }\n    }\n  }\n}\n\nasync function extractNextJsPages(\n  dir: string,\n  routeMap: Map<string, DiscoveredRoute>,\n  basePath: string\n): Promise<void> {\n  let entries: fs.Dirent[];\n  try {\n    entries = await fsp.readdir(dir, { withFileTypes: true });\n  } catch {\n    return;\n  }\n\n  for (const entry of entries) {\n    const fullPath = path.join(dir, entry.name);\n\n    if (entry.isDirectory()) {\n      if (!entry.name.startsWith('_') && !entry.name.startsWith('.')) {\n        // Handle dynamic routes [param]\n        const segment = entry.name.startsWith('[') && entry.name.endsWith(']')\n          ? `:${entry.name.slice(1, -1)}`\n          : entry.name;\n        await extractNextJsPages(fullPath, routeMap, `${basePath}/${segment}`);\n      }\n    } else if (entry.isFile()) {\n      const ext = path.extname(entry.name);\n      const base = path.basename(entry.name, ext);\n\n      if (['.tsx', '.ts', '.jsx', '.js'].includes(ext) && !base.startsWith('_')) {\n        let routePath: string;\n        if (base === 'index') {\n          routePath = basePath || '/';\n        } else if (base.startsWith('[') && base.endsWith(']')) {\n          routePath = `${basePath}/:${base.slice(1, -1)}`;\n        } else {\n          routePath = `${basePath}/${base}`;\n        }\n\n        const name = pathToName(routePath);\n        const params = extractRouteParams(routePath);\n\n        routeMap.set(routePath, {\n          path: routePath,\n          name,\n          params: params.length > 0 ? params : undefined,\n          component: fullPath,\n        });\n      }\n    }\n  }\n}\n\nasync function extractNextJsAppRoutes(\n  dir: string,\n  routeMap: Map<string, DiscoveredRoute>,\n  basePath: string\n): Promise<void> {\n  let entries: fs.Dirent[];\n  try {\n    entries = await fsp.readdir(dir, { withFileTypes: true });\n  } catch {\n    return;\n  }\n\n  for (const entry of entries) {\n    const fullPath = path.join(dir, entry.name);\n\n    if (entry.isDirectory()) {\n      if (!entry.name.startsWith('_') && !entry.name.startsWith('.')) {\n        // Handle dynamic routes [param] and groups (group)\n        let segment: string;\n        if (entry.name.startsWith('(') && entry.name.endsWith(')')) {\n          segment = ''; // Route groups don't add to path\n        } else if (entry.name.startsWith('[') && entry.name.endsWith(']')) {\n          segment = `:${entry.name.slice(1, -1)}`;\n        } else {\n          segment = entry.name;\n        }\n        const newPath = segment ? `${basePath}/${segment}` : basePath;\n        await extractNextJsAppRoutes(fullPath, routeMap, newPath);\n      }\n    } else if (entry.name === 'page.tsx' || entry.name === 'page.ts' ||\n               entry.name === 'page.jsx' || entry.name === 'page.js') {\n      const routePath = basePath || '/';\n      const name = pathToName(routePath);\n      const params = extractRouteParams(routePath);\n\n      routeMap.set(routePath, {\n        path: routePath,\n        name,\n        params: params.length > 0 ? params : undefined,\n        component: fullPath,\n      });\n    }\n  }\n}\n\nfunction pathToName(routePath: string): string {\n  if (routePath === '/') {return 'Home';}\n\n  const segments = routePath.split('/').filter(s => s && !s.startsWith(':'));\n  if (segments.length === 0) {return 'Home';}\n\n  // Convert last segment to title case\n  const lastSegment = segments[segments.length - 1]!;\n  return lastSegment\n    .split('-')\n    .map(word => word.charAt(0).toUpperCase() + word.slice(1))\n    .join(' ');\n}\n\nfunction extractRouteParams(routePath: string): string[] {\n  const params: string[] = [];\n  const paramPattern = /:(\\w+)/g;\n  let match: RegExpExecArray | null;\n\n  let iterations = 0;\n  while ((match = paramPattern.exec(routePath)) !== null) {\n    if (++iterations > MAX_REGEX_ITERATIONS) {break;} // SEC-004\n    params.push(match[1]!);\n  }\n\n  return params;\n}\n\n// =============================================================================\n// Form Mining\n// =============================================================================\n\n/**\n * Patterns to extract forms from code\n */\nconst FORM_PATTERNS = {\n  // Zod schema - SEC-F01 FIX: Bounded match (max 2000 chars) to prevent ReDoS.\n  // Uses [\\s\\S]{0,2000}? lazy quantifier with length cap (supports nested braces).\n  zodSchema: /z\\.object\\s*\\(\\s*\\{([\\s\\S]{0,2000}?)\\}\\s*\\)/g,\n  // BUG-003 FIX: Handle chained methods like z.string().email().min(1)\n  // SEC-F01 FIX: Limit chained methods to max 5 to prevent backtracking\n  zodField: /(\\w+)\\s*:\\s*z\\.(\\w+)(?:\\([^)]*\\))?(?:\\.\\w+(?:\\([^)]*\\))?){0,5}/g,\n\n  // Yup schema - same SEC-F01 fixes applied (bounded lazy match, supports nested braces)\n  yupSchema: /(?:yup|Yup)\\.object\\s*\\(\\s*\\{([\\s\\S]{0,2000}?)\\}\\s*\\)/g,\n  yupField: /(\\w+)\\s*:\\s*(?:yup|Yup)\\.(\\w+)(?:\\([^)]*\\))?(?:\\.\\w+(?:\\([^)]*\\))?){0,5}/g,\n\n  // React Hook Form\n  rhfRegister: /register\\s*\\(\\s*['\"](\\w+)['\"]/g,\n  rhfControl: /name:\\s*['\"](\\w+)['\"]/g,\n\n  // Formik Field\n  formikField: /<Field\\s+[^>]*name\\s*=\\s*['\"]([\\w.]+)['\"]/gi,\n  formikInitial: /initialValues\\s*[:=]\\s*\\{([^}]+)\\}/g,\n\n  // HTML form elements - BUG-005 FIX: Handle attributes in any order\n  // Pattern 1: name before type\n  htmlInputNameFirst: /<input[^>]+name\\s*=\\s*['\"](\\w+)['\"][^>]*(?:type\\s*=\\s*['\"](\\w+)['\"])?/gi,\n  // Pattern 2: type before name\n  htmlInputTypeFirst: /<input[^>]+type\\s*=\\s*['\"](\\w+)['\"][^>]+name\\s*=\\s*['\"](\\w+)['\"]/gi,\n  htmlSelect: /<select[^>]+name\\s*=\\s*['\"](\\w+)['\"]/gi,\n  htmlTextarea: /<textarea[^>]+name\\s*=\\s*['\"](\\w+)['\"]/gi,\n\n  // Form component patterns\n  formComponent: /(?:Form|form)\\s*(?:name|id)\\s*=\\s*['\"](\\w+)['\"]/gi,\n};\n\n/**\n * Mine forms from a project directory.\n *\n * NOTE: This function does NOT use the MiningCache and scans a subset of directories.\n * For better performance with caching and full directory coverage, use `mineElements()`\n * which implements ARCH-002 (file caching) and ARCH-003 (unified directories).\n *\n * @deprecated Use `mineElements()` instead for caching and full directory coverage.\n * @param projectRoot - Path to the project root directory\n * @param options - Mining options (maxDepth, maxFiles)\n * @returns Array of discovered forms\n */\nexport async function mineForms(\n  projectRoot: string,\n  options: { maxDepth?: number; maxFiles?: number } = {}\n): Promise<DiscoveredForm[]> {\n  // SEC-001: Resolve and validate project root\n  const resolvedRoot = path.resolve(projectRoot);\n\n  const maxDepth = options.maxDepth ?? MAX_SCAN_DEPTH;\n  const maxFiles = options.maxFiles ?? MAX_FILES_TO_SCAN;\n\n  const formMap = new Map<string, DiscoveredForm>();\n  const fileCount = { count: 0 };\n\n  // Scan source directories\n  const srcDirs = ['src', 'app', 'components', 'forms', 'schemas', 'validation'];\n\n  for (const dir of srcDirs) {\n    const fullPath = path.join(resolvedRoot, dir);\n    // SEC-001: Validate path is within project root\n    if (!validatePathWithinRoot(resolvedRoot, fullPath)) {continue;}\n    if (fs.existsSync(fullPath)) {\n      await scanForForms(fullPath, formMap, fileCount, 0, maxDepth, maxFiles);\n    }\n  }\n\n  return Array.from(formMap.values());\n}\n\nasync function scanForForms(\n  dir: string,\n  formMap: Map<string, DiscoveredForm>,\n  fileCount: { count: number },\n  depth: number,\n  maxDepth: number,\n  maxFiles: number\n): Promise<void> {\n  if (depth > maxDepth || fileCount.count > maxFiles) {return;}\n\n  let entries: fs.Dirent[];\n  try {\n    entries = await fsp.readdir(dir, { withFileTypes: true });\n  } catch {\n    return;\n  }\n\n  for (const entry of entries) {\n    if (fileCount.count > maxFiles) {break;}\n\n    const fullPath = path.join(dir, entry.name);\n\n    if (entry.isDirectory()) {\n      if (!entry.name.startsWith('.') &&\n          entry.name !== 'node_modules' &&\n          entry.name !== 'dist' &&\n          entry.name !== 'build' &&\n          !entry.isSymbolicLink()) {\n        await scanForForms(fullPath, formMap, fileCount, depth + 1, maxDepth, maxFiles);\n      }\n    } else if (entry.isFile() && !entry.isSymbolicLink() && SOURCE_EXTENSIONS.some(ext => entry.name.endsWith(ext))) {\n      // SEC-003: Skip symlinks to prevent reading arbitrary files\n      fileCount.count++;\n      try {\n        // SEC-002: Skip files that are too large\n        if (!await isFileSizeWithinLimit(fullPath)) {continue;}\n        const content = await fsp.readFile(fullPath, 'utf-8');\n        extractFormsFromContent(content, fullPath, formMap);\n      } catch {\n        // Skip unreadable files\n      }\n    }\n  }\n}\n\nfunction extractFormsFromContent(\n  content: string,\n  source: string,\n  formMap: Map<string, DiscoveredForm>\n): void {\n  // Try to extract form name from filename\n  const fileName = path.basename(source, path.extname(source));\n  const formNameFromFile = fileName.replace(/(?:Form|Schema|Validation)$/i, '');\n\n  const fields: FormField[] = [];\n\n  // Extract Zod fields\n  const zodMatch = FORM_PATTERNS.zodSchema.exec(content);\n  if (zodMatch) {\n    FORM_PATTERNS.zodField.lastIndex = 0;\n    let fieldMatch: RegExpExecArray | null;\n    let fieldIter = 0;\n    while ((fieldMatch = FORM_PATTERNS.zodField.exec(zodMatch[1]!)) !== null) {\n      if (++fieldIter > MAX_REGEX_ITERATIONS) {break;} // SEC-004\n      fields.push({\n        name: fieldMatch[1]!,\n        type: zodTypeToHtmlType(fieldMatch[2]!),\n        label: fieldNameToLabel(fieldMatch[1]!),\n      });\n    }\n    FORM_PATTERNS.zodSchema.lastIndex = 0;\n  }\n\n  // Extract Yup fields\n  const yupMatch = FORM_PATTERNS.yupSchema.exec(content);\n  if (yupMatch) {\n    FORM_PATTERNS.yupField.lastIndex = 0;\n    let fieldMatch: RegExpExecArray | null;\n    let yupIter = 0;\n    while ((fieldMatch = FORM_PATTERNS.yupField.exec(yupMatch[1]!)) !== null) {\n      if (++yupIter > MAX_REGEX_ITERATIONS) {break;} // SEC-004\n      const existingField = fields.find(f => f.name === fieldMatch![1]!);\n      if (!existingField) {\n        fields.push({\n          name: fieldMatch[1]!,\n          type: yupTypeToHtmlType(fieldMatch[2]!),\n          label: fieldNameToLabel(fieldMatch[1]!),\n        });\n      }\n    }\n    FORM_PATTERNS.yupSchema.lastIndex = 0;\n  }\n\n  // Extract React Hook Form fields\n  FORM_PATTERNS.rhfRegister.lastIndex = 0;\n  let rhfMatch: RegExpExecArray | null;\n  let rhfIter = 0;\n  while ((rhfMatch = FORM_PATTERNS.rhfRegister.exec(content)) !== null) {\n    if (++rhfIter > MAX_REGEX_ITERATIONS) {break;} // SEC-004\n    const existingField = fields.find(f => f.name === rhfMatch![1]!);\n    if (!existingField) {\n      fields.push({\n        name: rhfMatch[1]!,\n        type: 'text',\n        label: fieldNameToLabel(rhfMatch[1]!),\n      });\n    }\n  }\n\n  // Extract HTML input fields - BUG-005 FIX: Check both attribute orders\n  // Pattern 1: name before type\n  FORM_PATTERNS.htmlInputNameFirst.lastIndex = 0;\n  let htmlMatch: RegExpExecArray | null;\n  let htmlIter = 0;\n  while ((htmlMatch = FORM_PATTERNS.htmlInputNameFirst.exec(content)) !== null) {\n    if (++htmlIter > MAX_REGEX_ITERATIONS) {break;} // SEC-004\n    const existingField = fields.find(f => f.name === htmlMatch![1]!);\n    if (!existingField) {\n      fields.push({\n        name: htmlMatch[1]!,\n        type: htmlMatch[2] || 'text',\n        label: fieldNameToLabel(htmlMatch[1]!),\n      });\n    }\n  }\n\n  // Pattern 2: type before name\n  FORM_PATTERNS.htmlInputTypeFirst.lastIndex = 0;\n  let htmlIter2 = 0;\n  while ((htmlMatch = FORM_PATTERNS.htmlInputTypeFirst.exec(content)) !== null) {\n    if (++htmlIter2 > MAX_REGEX_ITERATIONS) {break;} // SEC-004\n    // Note: capture groups are reversed - [1]=type, [2]=name\n    const existingField = fields.find(f => f.name === htmlMatch![2]!);\n    if (!existingField) {\n      fields.push({\n        name: htmlMatch[2]!,\n        type: htmlMatch[1]! || 'text',\n        label: fieldNameToLabel(htmlMatch[2]!),\n      });\n    }\n  }\n\n  // Only add form if we found fields\n  if (fields.length > 0) {\n    const formId = formNameFromFile.toLowerCase();\n    const formName = fieldNameToLabel(formNameFromFile);\n\n    if (!formMap.has(formId)) {\n      formMap.set(formId, {\n        id: formId,\n        name: formName,\n        fields,\n        schema: source,\n      });\n    }\n  }\n}\n\nfunction zodTypeToHtmlType(zodType: string): string {\n  const typeMap: Record<string, string> = {\n    string: 'text',\n    email: 'email',\n    number: 'number',\n    boolean: 'checkbox',\n    date: 'date',\n    enum: 'select',\n    password: 'password',\n  };\n  return typeMap[zodType.toLowerCase()] || 'text';\n}\n\nfunction yupTypeToHtmlType(yupType: string): string {\n  const typeMap: Record<string, string> = {\n    string: 'text',\n    email: 'email',\n    number: 'number',\n    boolean: 'checkbox',\n    date: 'date',\n    mixed: 'text',\n  };\n  return typeMap[yupType.toLowerCase()] || 'text';\n}\n\nfunction fieldNameToLabel(fieldName: string): string {\n  return fieldName\n    .replace(/([A-Z])/g, ' $1')\n    .replace(/[_-]/g, ' ')\n    .trim()\n    .split(' ')\n    .map(word => word.charAt(0).toUpperCase() + word.slice(1).toLowerCase())\n    .join(' ');\n}\n\n// =============================================================================\n// Table Mining\n// =============================================================================\n\n/**\n * Patterns to extract tables from code\n */\nconst TABLE_PATTERNS = {\n  // AG Grid\n  agGridColumns: /columnDefs\\s*[:=]\\s*\\[([^\\]]+)\\]/gs,\n  agGridField: /field:\\s*['\"](\\w+)['\"]/g,\n  agGridHeader: /headerName:\\s*['\"]([^'\"]+)['\"]/g,\n\n  // TanStack Table / React Table\n  tanstackColumn: /accessorKey:\\s*['\"](\\w+)['\"]/g,\n  tanstackHeader: /header:\\s*['\"]([^'\"]+)['\"]/g,\n\n  // MUI DataGrid\n  muiColumns: /columns\\s*[:=]\\s*\\[([^\\]]+)\\]/gs,\n  muiField: /field:\\s*['\"](\\w+)['\"]/g,\n  muiHeader: /headerName:\\s*['\"]([^'\"]+)['\"]/g,\n\n  // HTML table\n  htmlTh: /<th[^>]*>([^<]+)<\\/th>/gi,\n  htmlTable: /<table[^>]*(?:id|class)\\s*=\\s*['\"]([^'\"]+)['\"]/gi,\n\n  // Ant Design Table\n  antdDataIndex: /dataIndex:\\s*['\"](\\w+)['\"]/g,\n  antdTitle: /title:\\s*['\"]([^'\"]+)['\"]/g,\n};\n\n/**\n * Mine tables from a project directory.\n *\n * NOTE: This function does NOT use the MiningCache and scans a subset of directories.\n * For better performance with caching and full directory coverage, use `mineElements()`\n * which implements ARCH-002 (file caching) and ARCH-003 (unified directories).\n *\n * @deprecated Use `mineElements()` instead for caching and full directory coverage.\n * @param projectRoot - Path to the project root directory\n * @param options - Mining options (maxDepth, maxFiles)\n * @returns Array of discovered tables\n */\nexport async function mineTables(\n  projectRoot: string,\n  options: { maxDepth?: number; maxFiles?: number } = {}\n): Promise<DiscoveredTable[]> {\n  // SEC-001: Resolve and validate project root\n  const resolvedRoot = path.resolve(projectRoot);\n\n  const maxDepth = options.maxDepth ?? MAX_SCAN_DEPTH;\n  const maxFiles = options.maxFiles ?? MAX_FILES_TO_SCAN;\n\n  const tableMap = new Map<string, DiscoveredTable>();\n  const fileCount = { count: 0 };\n\n  // Scan source directories\n  const srcDirs = ['src', 'app', 'components', 'tables', 'grids', 'views'];\n\n  for (const dir of srcDirs) {\n    const fullPath = path.join(resolvedRoot, dir);\n    // SEC-001: Validate path is within project root\n    if (!validatePathWithinRoot(resolvedRoot, fullPath)) {continue;}\n    if (fs.existsSync(fullPath)) {\n      await scanForTables(fullPath, tableMap, fileCount, 0, maxDepth, maxFiles);\n    }\n  }\n\n  return Array.from(tableMap.values());\n}\n\nasync function scanForTables(\n  dir: string,\n  tableMap: Map<string, DiscoveredTable>,\n  fileCount: { count: number },\n  depth: number,\n  maxDepth: number,\n  maxFiles: number\n): Promise<void> {\n  if (depth > maxDepth || fileCount.count > maxFiles) {return;}\n\n  let entries: fs.Dirent[];\n  try {\n    entries = await fsp.readdir(dir, { withFileTypes: true });\n  } catch {\n    return;\n  }\n\n  for (const entry of entries) {\n    if (fileCount.count > maxFiles) {break;}\n\n    const fullPath = path.join(dir, entry.name);\n\n    if (entry.isDirectory()) {\n      if (!entry.name.startsWith('.') &&\n          entry.name !== 'node_modules' &&\n          entry.name !== 'dist' &&\n          entry.name !== 'build' &&\n          !entry.isSymbolicLink()) {\n        await scanForTables(fullPath, tableMap, fileCount, depth + 1, maxDepth, maxFiles);\n      }\n    } else if (entry.isFile() && !entry.isSymbolicLink() && SOURCE_EXTENSIONS.some(ext => entry.name.endsWith(ext))) {\n      // SEC-003: Skip symlinks to prevent reading arbitrary files\n      fileCount.count++;\n      try {\n        // SEC-002: Skip files that are too large\n        if (!await isFileSizeWithinLimit(fullPath)) {continue;}\n        const content = await fsp.readFile(fullPath, 'utf-8');\n        extractTablesFromContent(content, fullPath, tableMap);\n      } catch {\n        // Skip unreadable files\n      }\n    }\n  }\n}\n\nfunction extractTablesFromContent(\n  content: string,\n  source: string,\n  tableMap: Map<string, DiscoveredTable>\n): void {\n  const fileName = path.basename(source, path.extname(source));\n  const tableNameFromFile = fileName.replace(/(?:Table|Grid|List|DataGrid)$/i, '');\n\n  const columns: string[] = [];\n\n  // Check if file contains table-related imports\n  const hasTableImport = /(?:AgGridReact|DataGrid|useReactTable|Table)/i.test(content);\n  if (!hasTableImport && !/<table/i.test(content)) {\n    return;\n  }\n\n  // Extract AG Grid / MUI DataGrid columns\n  const columnDefsMatch = TABLE_PATTERNS.agGridColumns.exec(content) ||\n                          TABLE_PATTERNS.muiColumns.exec(content);\n  if (columnDefsMatch) {\n    TABLE_PATTERNS.agGridField.lastIndex = 0;\n    TABLE_PATTERNS.muiField.lastIndex = 0;\n    let fieldMatch: RegExpExecArray | null;\n    let colIter = 0;\n\n    while ((fieldMatch = TABLE_PATTERNS.agGridField.exec(columnDefsMatch[1]!)) !== null) {\n      if (++colIter > MAX_REGEX_ITERATIONS) {break;} // SEC-004\n      if (!columns.includes(fieldMatch[1]!)) {\n        columns.push(fieldMatch[1]!);\n      }\n    }\n    colIter = 0;\n    while ((fieldMatch = TABLE_PATTERNS.muiField.exec(columnDefsMatch[1]!)) !== null) {\n      if (++colIter > MAX_REGEX_ITERATIONS) {break;} // SEC-004\n      if (!columns.includes(fieldMatch[1]!)) {\n        columns.push(fieldMatch[1]!);\n      }\n    }\n    TABLE_PATTERNS.agGridColumns.lastIndex = 0;\n    TABLE_PATTERNS.muiColumns.lastIndex = 0;\n  }\n\n  // Extract TanStack Table columns\n  TABLE_PATTERNS.tanstackColumn.lastIndex = 0;\n  let tanstackMatch: RegExpExecArray | null;\n  let tanstackIter = 0;\n  while ((tanstackMatch = TABLE_PATTERNS.tanstackColumn.exec(content)) !== null) {\n    if (++tanstackIter > MAX_REGEX_ITERATIONS) {break;} // SEC-004\n    if (!columns.includes(tanstackMatch[1]!)) {\n      columns.push(tanstackMatch[1]!);\n    }\n  }\n\n  // Extract Ant Design columns\n  TABLE_PATTERNS.antdDataIndex.lastIndex = 0;\n  let antdMatch: RegExpExecArray | null;\n  let antdIter = 0;\n  while ((antdMatch = TABLE_PATTERNS.antdDataIndex.exec(content)) !== null) {\n    if (++antdIter > MAX_REGEX_ITERATIONS) {break;} // SEC-004\n    if (!columns.includes(antdMatch[1]!)) {\n      columns.push(antdMatch[1]!);\n    }\n  }\n\n  // Extract HTML table headers\n  TABLE_PATTERNS.htmlTh.lastIndex = 0;\n  let thMatch: RegExpExecArray | null;\n  let thIter = 0;\n  while ((thMatch = TABLE_PATTERNS.htmlTh.exec(content)) !== null) {\n    if (++thIter > MAX_REGEX_ITERATIONS) {break;} // SEC-004\n    const header = thMatch[1]!.trim();\n    if (header && !columns.includes(header)) {\n      columns.push(header);\n    }\n  }\n\n  // Only add table if we found columns\n  if (columns.length > 0) {\n    const tableId = tableNameFromFile.toLowerCase();\n    const tableName = fieldNameToLabel(tableNameFromFile);\n\n    if (!tableMap.has(tableId)) {\n      tableMap.set(tableId, {\n        id: tableId,\n        name: tableName || 'Data Table',\n        columns,\n      });\n    }\n  }\n}\n\n// =============================================================================\n// Modal Mining\n// =============================================================================\n\n/**\n * Patterns to extract modals from code\n */\nconst MODAL_PATTERNS = {\n  // MUI Dialog\n  muiDialog: /<Dialog[^>]*(?:open|onClose)[^>]*>/gi,\n  muiDialogTitle: /<DialogTitle[^>]*>([^<]+)<\\/DialogTitle>/gi,\n\n  // Radix Dialog\n  radixDialog: /<Dialog\\.Root/gi,\n  radixDialogTitle: /<Dialog\\.Title[^>]*>([^<]+)<\\/Dialog\\.Title>/gi,\n\n  // React Modal\n  reactModal: /<Modal[^>]*(?:isOpen|onRequestClose)[^>]*>/gi,\n\n  // Chakra Modal\n  chakraModal: /<Modal[^>]*(?:isOpen|onClose)[^>]*>/gi,\n  chakraModalHeader: /<ModalHeader[^>]*>([^<]+)<\\/ModalHeader>/gi,\n\n  // Ant Design Modal\n  antdModal: /<Modal[^>]*(?:open|visible|onCancel)[^>]*>/gi,\n  antdModalTitle: /title\\s*=\\s*[{'\"]([\\w\\s]+)['\"}]/gi,\n\n  // Generic modal patterns\n  modalComponent: /(?:Modal|Dialog|Popup|Overlay)\\s*(?:name|id|title)\\s*=\\s*['\"](\\w+)['\"]/gi,\n  openModal: /(?:open|show|toggle)(?:Modal|Dialog)\\s*\\(\\s*['\"]?(\\w+)/gi,\n};\n\n/**\n * Mine modals from a project directory.\n *\n * NOTE: This function does NOT use the MiningCache and scans a subset of directories.\n * For better performance with caching and full directory coverage, use `mineElements()`\n * which implements ARCH-002 (file caching) and ARCH-003 (unified directories).\n *\n * @deprecated Use `mineElements()` instead for caching and full directory coverage.\n * @param projectRoot - Path to the project root directory\n * @param options - Mining options (maxDepth, maxFiles)\n * @returns Array of discovered modals\n */\nexport async function mineModals(\n  projectRoot: string,\n  options: { maxDepth?: number; maxFiles?: number } = {}\n): Promise<DiscoveredModal[]> {\n  // SEC-001: Resolve and validate project root\n  const resolvedRoot = path.resolve(projectRoot);\n\n  const maxDepth = options.maxDepth ?? MAX_SCAN_DEPTH;\n  const maxFiles = options.maxFiles ?? MAX_FILES_TO_SCAN;\n\n  const modalMap = new Map<string, DiscoveredModal>();\n  const fileCount = { count: 0 };\n\n  // Scan source directories\n  const srcDirs = ['src', 'app', 'components', 'modals', 'dialogs'];\n\n  for (const dir of srcDirs) {\n    const fullPath = path.join(resolvedRoot, dir);\n    // SEC-001: Validate path is within project root\n    if (!validatePathWithinRoot(resolvedRoot, fullPath)) {continue;}\n    if (fs.existsSync(fullPath)) {\n      await scanForModals(fullPath, modalMap, fileCount, 0, maxDepth, maxFiles);\n    }\n  }\n\n  return Array.from(modalMap.values());\n}\n\nasync function scanForModals(\n  dir: string,\n  modalMap: Map<string, DiscoveredModal>,\n  fileCount: { count: number },\n  depth: number,\n  maxDepth: number,\n  maxFiles: number\n): Promise<void> {\n  if (depth > maxDepth || fileCount.count > maxFiles) {return;}\n\n  let entries: fs.Dirent[];\n  try {\n    entries = await fsp.readdir(dir, { withFileTypes: true });\n  } catch {\n    return;\n  }\n\n  for (const entry of entries) {\n    if (fileCount.count > maxFiles) {break;}\n\n    const fullPath = path.join(dir, entry.name);\n\n    if (entry.isDirectory()) {\n      if (!entry.name.startsWith('.') &&\n          entry.name !== 'node_modules' &&\n          entry.name !== 'dist' &&\n          entry.name !== 'build' &&\n          !entry.isSymbolicLink()) {\n        await scanForModals(fullPath, modalMap, fileCount, depth + 1, maxDepth, maxFiles);\n      }\n    } else if (entry.isFile() && !entry.isSymbolicLink() && SOURCE_EXTENSIONS.some(ext => entry.name.endsWith(ext))) {\n      // SEC-003: Skip symlinks to prevent reading arbitrary files\n      fileCount.count++;\n      try {\n        // SEC-002: Skip files that are too large\n        if (!await isFileSizeWithinLimit(fullPath)) {continue;}\n        const content = await fsp.readFile(fullPath, 'utf-8');\n        extractModalsFromContent(content, fullPath, modalMap);\n      } catch {\n        // Skip unreadable files\n      }\n    }\n  }\n}\n\nfunction extractModalsFromContent(\n  content: string,\n  source: string,\n  modalMap: Map<string, DiscoveredModal>\n): void {\n  const fileName = path.basename(source, path.extname(source));\n  const modalNameFromFile = fileName.replace(/(?:Modal|Dialog|Popup)$/i, '');\n\n  // Check if file contains modal-related patterns\n  const hasModal = Object.values(MODAL_PATTERNS).some(pattern => {\n    pattern.lastIndex = 0;\n    return pattern.test(content);\n  });\n\n  if (!hasModal) {return;}\n\n  // Try to extract modal title\n  let modalTitle: string | undefined;\n\n  // Check MUI Dialog title\n  MODAL_PATTERNS.muiDialogTitle.lastIndex = 0;\n  const muiTitleMatch = MODAL_PATTERNS.muiDialogTitle.exec(content);\n  if (muiTitleMatch) {\n    modalTitle = muiTitleMatch[1]!.trim();\n  }\n\n  // Check Chakra modal header\n  if (!modalTitle) {\n    MODAL_PATTERNS.chakraModalHeader.lastIndex = 0;\n    const chakraTitleMatch = MODAL_PATTERNS.chakraModalHeader.exec(content);\n    if (chakraTitleMatch) {\n      modalTitle = chakraTitleMatch[1]!.trim();\n    }\n  }\n\n  // Check Ant Design title\n  if (!modalTitle) {\n    MODAL_PATTERNS.antdModalTitle.lastIndex = 0;\n    const antdTitleMatch = MODAL_PATTERNS.antdModalTitle.exec(content);\n    if (antdTitleMatch) {\n      modalTitle = antdTitleMatch[1]!.trim();\n    }\n  }\n\n  const modalId = modalNameFromFile.toLowerCase();\n  const modalName = modalTitle || fieldNameToLabel(modalNameFromFile) || 'Modal';\n\n  if (!modalMap.has(modalId) && modalId) {\n    modalMap.set(modalId, {\n      id: modalId,\n      name: modalName,\n    });\n  }\n}\n\n// =============================================================================\n// ARCH-002/003: Internal extraction from pre-scanned files\n// =============================================================================\n\n/**\n * Extract entities from pre-scanned files (internal, uses cache).\n */\nfunction extractEntitiesFromFiles(\n  files: ScannedFile[],\n  entityMap: Map<string, { name: string; sources: string[]; endpoints: string[] }>\n): void {\n  for (const file of files) {\n    extractEntitiesFromContent(file.content, file.path, entityMap);\n  }\n}\n\n/**\n * Extract routes from pre-scanned files (internal, uses cache).\n */\nfunction extractRoutesFromFiles(\n  files: ScannedFile[],\n  routeMap: Map<string, DiscoveredRoute>\n): void {\n  for (const file of files) {\n    extractRoutesFromContent(file.content, file.path, routeMap);\n  }\n}\n\n/**\n * Extract forms from pre-scanned files (internal, uses cache).\n */\nfunction extractFormsFromFiles(\n  files: ScannedFile[],\n  formMap: Map<string, DiscoveredForm>\n): void {\n  for (const file of files) {\n    extractFormsFromContent(file.content, file.path, formMap);\n  }\n}\n\n/**\n * Extract tables from pre-scanned files (internal, uses cache).\n */\nfunction extractTablesFromFiles(\n  files: ScannedFile[],\n  tableMap: Map<string, DiscoveredTable>\n): void {\n  for (const file of files) {\n    extractTablesFromContent(file.content, file.path, tableMap);\n  }\n}\n\n/**\n * Extract modals from pre-scanned files (internal, uses cache).\n */\nfunction extractModalsFromFiles(\n  files: ScannedFile[],\n  modalMap: Map<string, DiscoveredModal>\n): void {\n  for (const file of files) {\n    extractModalsFromContent(file.content, file.path, modalMap);\n  }\n}\n\n// =============================================================================\n// Main Mining Function\n// =============================================================================\n\n/**\n * Result of mining operation\n */\nexport interface MiningResult {\n  elements: DiscoveredElements;\n  stats: {\n    entitiesFound: number;\n    routesFound: number;\n    formsFound: number;\n    tablesFound: number;\n    modalsFound: number;\n    totalElements: number;\n    filesScanned: number;\n    /** Cache statistics (ARCH-002) */\n    cacheHits?: number;\n    cacheMisses?: number;\n    cacheHitRate?: number;\n  };\n  duration: number;\n}\n\n/**\n * Mine all discoverable elements from a project\n *\n * This is the main entry point for zero-config pattern generation.\n * It scans the project for entities, routes, forms, tables, and modals,\n * then returns them in a format suitable for template multiplication.\n *\n * ARCH-002: Uses shared MiningCache to scan files only once\n * ARCH-003: Uses SOURCE_DIRECTORIES for consistent coverage\n *\n * @param projectRoot - Path to the project root directory\n * @param options - Mining options (maxDepth, maxFiles)\n * @returns Mining result with discovered elements and statistics\n */\nexport async function mineElements(\n  projectRoot: string,\n  options: { maxDepth?: number; maxFiles?: number } = {}\n): Promise<MiningResult> {\n  const startTime = Date.now();\n  const resolvedRoot = path.resolve(projectRoot);\n\n  // ARCH-002: Create shared cache for all mining operations\n  const cache = new MiningCache();\n\n  try {\n    // ARCH-003: Scan all source directories ONCE using unified list\n    const files = await scanAllSourceDirectories(resolvedRoot, cache, {\n      maxDepth: options.maxDepth ?? MAX_SCAN_DEPTH,\n      maxFiles: options.maxFiles ?? MAX_FILES_TO_SCAN,\n    });\n\n    // Create maps for each element type\n    const entityMap = new Map<string, { name: string; sources: string[]; endpoints: string[] }>();\n    const routeMap = new Map<string, DiscoveredRoute>();\n    const formMap = new Map<string, DiscoveredForm>();\n    const tableMap = new Map<string, DiscoveredTable>();\n    const modalMap = new Map<string, DiscoveredModal>();\n\n    // Extract all elements from the pre-scanned files (parallel-safe since maps are independent)\n    extractEntitiesFromFiles(files, entityMap);\n    extractRoutesFromFiles(files, routeMap);\n    extractFormsFromFiles(files, formMap);\n    extractTablesFromFiles(files, tableMap);\n    extractModalsFromFiles(files, modalMap);\n\n    // Also check Prisma schema (special case, not in source files)\n    const prismaPath = path.join(resolvedRoot, 'prisma', 'schema.prisma');\n    if (fs.existsSync(prismaPath)) {\n      await extractPrismaEntities(prismaPath, entityMap);\n    }\n\n    // Check Next.js file-based routing (special case)\n    const pagesDir = path.join(resolvedRoot, 'pages');\n    if (validatePathWithinRoot(resolvedRoot, pagesDir) && fs.existsSync(pagesDir)) {\n      await extractNextJsPages(pagesDir, routeMap, '');\n    }\n    const appDir = path.join(resolvedRoot, 'app');\n    if (validatePathWithinRoot(resolvedRoot, appDir) && fs.existsSync(appDir)) {\n      await extractNextJsAppRoutes(appDir, routeMap, '');\n    }\n\n    // Convert maps to arrays\n    const entities = Array.from(entityMap.values()).map(({ name, sources, endpoints }) => {\n      const singular = singularize(name);\n      const plural = pluralize(singular);\n      return {\n        name,\n        singular,\n        plural,\n        source: sources[0],\n        endpoint: endpoints[0],\n      };\n    });\n    const routes = Array.from(routeMap.values());\n    const forms = Array.from(formMap.values());\n    const tables = Array.from(tableMap.values());\n    const modals = Array.from(modalMap.values());\n\n    const elements: DiscoveredElements = {\n      entities,\n      routes,\n      forms,\n      tables,\n      modals,\n    };\n\n    // Get cache statistics\n    const cacheStats = cache.getStats();\n    const duration = Date.now() - startTime;\n\n    return {\n      elements,\n      stats: {\n        entitiesFound: entities.length,\n        routesFound: routes.length,\n        formsFound: forms.length,\n        tablesFound: tables.length,\n        modalsFound: modals.length,\n        totalElements: entities.length + routes.length + forms.length + tables.length + modals.length,\n        filesScanned: files.length,\n        // ARCH-002: Include cache statistics\n        cacheHits: cacheStats.hits,\n        cacheMisses: cacheStats.misses,\n        cacheHitRate: cache.getHitRate(),\n      },\n      duration,\n    };\n  } finally {\n    // ARCH-002: Always clear cache to free memory\n    cache.clear();\n  }\n}\n\n/**\n * Run full discovery pipeline: mine elements + generate patterns\n *\n * This combines mining with pattern generation for a complete\n * zero-config experience.\n *\n * @param projectRoot - Path to the project root directory\n * @param options - Mining and generation options\n * @returns Combined mining and generation results\n */\nexport async function runMiningPipeline(\n  projectRoot: string,\n  options: { maxDepth?: number; maxFiles?: number; confidence?: number } = {}\n): Promise<{\n  mining: MiningResult;\n  patterns: GenerationResult;\n}> {\n  // Import generateAllPatterns dynamically to avoid circular dependencies\n  const { generateAllPatterns } = await import('./template-generators.js');\n\n  // Mine all elements\n  const mining = await mineElements(projectRoot, options);\n\n  // Generate patterns from mined elements\n  const patterns = generateAllPatterns(mining.elements, options.confidence);\n\n  return {\n    mining,\n    patterns,\n  };\n}\n","/**\n * React Framework Pack\n *\n * Provides React-specific patterns for hooks, context, portals, suspense, etc.\n *\n * @module llkb/packs/react\n */\n\nimport type { FrameworkPack, PackPattern } from './types.js';\n\nconst REACT_PATTERNS: PackPattern[] = [\n  // Hooks\n  { text: 'wait for useEffect to complete', primitive: 'wait', category: 'timing' },\n  { text: 'verify useState update', primitive: 'assert', category: 'assertion' },\n  { text: 'trigger useCallback', primitive: 'click', category: 'ui-interaction' },\n  { text: 'wait for useMemo recalculation', primitive: 'wait', category: 'timing' },\n  { text: 'verify useReducer state', primitive: 'assert', category: 'assertion' },\n  { text: 'trigger useRef focus', primitive: 'click', category: 'ui-interaction' },\n  { text: 'wait for custom hook', primitive: 'wait', category: 'timing' },\n  { text: 'verify hook dependency update', primitive: 'assert', category: 'assertion' },\n\n  // Context\n  { text: 'verify context value', primitive: 'assert', category: 'assertion' },\n  { text: 'switch context provider', primitive: 'click', category: 'ui-interaction' },\n  { text: 'verify context consumer updates', primitive: 'assert', category: 'assertion' },\n  { text: 'wait for context propagation', primitive: 'wait', category: 'timing' },\n\n  // Portal\n  { text: 'interact with portal content', primitive: 'click', category: 'ui-interaction' },\n  { text: 'verify portal renders', primitive: 'assert', category: 'assertion' },\n  { text: 'close portal', primitive: 'click', category: 'ui-interaction' },\n  { text: 'wait for portal mount', primitive: 'wait', category: 'timing' },\n\n  // Suspense\n  { text: 'wait for lazy component to load', primitive: 'wait', category: 'timing' },\n  { text: 'verify suspense fallback', primitive: 'assert', category: 'assertion' },\n  { text: 'wait for suspense boundary', primitive: 'wait', category: 'timing' },\n  { text: 'verify lazy component rendered', primitive: 'assert', category: 'assertion' },\n\n  // Event handling\n  { text: 'trigger onChange event', primitive: 'fill', category: 'ui-interaction' },\n  { text: 'trigger onSubmit event', primitive: 'click', category: 'ui-interaction' },\n  { text: 'trigger onClick event', primitive: 'click', category: 'ui-interaction' },\n  { text: 'trigger onBlur event', primitive: 'click', category: 'ui-interaction' },\n  { text: 'trigger onFocus event', primitive: 'click', category: 'ui-interaction' },\n  { text: 'trigger onKeyDown event', primitive: 'fill', category: 'ui-interaction' },\n  { text: 'trigger onMouseEnter event', primitive: 'hover', category: 'ui-interaction' },\n\n  // Refs\n  { text: 'verify ref is attached', primitive: 'assert', category: 'assertion' },\n  { text: 'focus ref element', primitive: 'click', category: 'ui-interaction' },\n  { text: 'scroll to ref element', primitive: 'scroll', category: 'ui-interaction' },\n  { text: 'verify ref value updates', primitive: 'assert', category: 'assertion' },\n\n  // Error boundaries\n  { text: 'verify error boundary catches error', primitive: 'assert', category: 'assertion' },\n  { text: 'trigger error boundary fallback', primitive: 'click', category: 'ui-interaction' },\n];\n\n/**\n * Get the React framework pack\n */\nexport function getReactPack(): FrameworkPack {\n  return {\n    name: 'react',\n    framework: 'react',\n    version: '1.0.0',\n    description: 'React-specific patterns for hooks, context, portals, suspense, and event handling',\n    patterns: REACT_PATTERNS,\n  };\n}\n","/**\n * Angular Framework Pack\n *\n * Provides Angular-specific patterns for directives, pipes, services, router, forms, and change detection.\n *\n * @module llkb/packs/angular\n */\n\nimport type { FrameworkPack, PackPattern } from './types.js';\n\nconst ANGULAR_PATTERNS: PackPattern[] = [\n  // Directives\n  { text: 'verify ngIf shows element', primitive: 'assert', category: 'assertion' },\n  { text: 'verify ngIf hides element', primitive: 'assert', category: 'assertion' },\n  { text: 'verify ngFor items', primitive: 'assert', category: 'assertion' },\n  { text: 'interact with ngSwitch', primitive: 'click', category: 'ui-interaction' },\n  { text: 'verify ngClass applied', primitive: 'assert', category: 'assertion' },\n  { text: 'verify ngStyle applied', primitive: 'assert', category: 'assertion' },\n  { text: 'trigger ngModel update', primitive: 'fill', category: 'ui-interaction' },\n\n  // Pipes\n  { text: 'verify async pipe output', primitive: 'assert', category: 'assertion' },\n  { text: 'verify date pipe format', primitive: 'assert', category: 'assertion' },\n  { text: 'verify currency pipe', primitive: 'assert', category: 'assertion' },\n  { text: 'verify decimal pipe', primitive: 'assert', category: 'assertion' },\n  { text: 'verify percent pipe', primitive: 'assert', category: 'assertion' },\n  { text: 'verify custom pipe output', primitive: 'assert', category: 'assertion' },\n\n  // Services\n  { text: 'wait for service response', primitive: 'wait', category: 'timing' },\n  { text: 'verify service call', primitive: 'assert', category: 'assertion' },\n  { text: 'trigger service method', primitive: 'click', category: 'ui-interaction' },\n  { text: 'verify dependency injection', primitive: 'assert', category: 'assertion' },\n\n  // Router\n  { text: 'navigate to angular route', primitive: 'navigate', category: 'navigation' },\n  { text: 'verify router outlet', primitive: 'assert', category: 'assertion' },\n  { text: 'verify activated route', primitive: 'assert', category: 'assertion' },\n  { text: 'verify route params', primitive: 'assert', category: 'assertion' },\n  { text: 'verify route guards', primitive: 'assert', category: 'assertion' },\n  { text: 'trigger route navigation', primitive: 'click', category: 'navigation' },\n\n  // Forms - Reactive\n  { text: 'verify reactive form valid', primitive: 'assert', category: 'assertion' },\n  { text: 'verify reactive form invalid', primitive: 'assert', category: 'assertion' },\n  { text: 'fill reactive form control', primitive: 'fill', category: 'ui-interaction' },\n  { text: 'verify form control errors', primitive: 'assert', category: 'assertion' },\n  { text: 'submit reactive form', primitive: 'click', category: 'ui-interaction' },\n\n  // Forms - Template-driven\n  { text: 'verify template-driven form', primitive: 'assert', category: 'assertion' },\n  { text: 'fill template form field', primitive: 'fill', category: 'ui-interaction' },\n  { text: 'submit template form', primitive: 'click', category: 'ui-interaction' },\n\n  // Change Detection\n  { text: 'trigger change detection', primitive: 'click', category: 'ui-interaction' },\n  { text: 'wait for zone stable', primitive: 'wait', category: 'timing' },\n  { text: 'verify change detection ran', primitive: 'assert', category: 'assertion' },\n  { text: 'wait for async operation', primitive: 'wait', category: 'timing' },\n];\n\n/**\n * Get the Angular framework pack\n */\nexport function getAngularPack(): FrameworkPack {\n  return {\n    name: 'angular',\n    framework: 'angular',\n    version: '1.0.0',\n    description: 'Angular-specific patterns for directives, pipes, services, router, forms, and change detection',\n    patterns: ANGULAR_PATTERNS,\n  };\n}\n","/**\n * Material-UI (MUI) Framework Pack\n *\n * Provides MUI-specific patterns for DataGrid, Dialog, Snackbar, Autocomplete, DatePicker, etc.\n *\n * @module llkb/packs/mui\n */\n\nimport type { FrameworkPack, PackPattern } from './types.js';\n\nconst MUI_PATTERNS: PackPattern[] = [\n  // DataGrid\n  {\n    text: 'sort MUI DataGrid column',\n    primitive: 'click',\n    category: 'ui-interaction',\n    selectorHints: [{ strategy: 'css', value: '.MuiDataGrid-columnHeader' }],\n  },\n  {\n    text: 'filter MUI DataGrid',\n    primitive: 'fill',\n    category: 'ui-interaction',\n    selectorHints: [{ strategy: 'css', value: '.MuiDataGrid-filterForm' }],\n  },\n  {\n    text: 'select DataGrid row',\n    primitive: 'click',\n    category: 'ui-interaction',\n    selectorHints: [{ strategy: 'css', value: '.MuiDataGrid-row' }],\n  },\n  {\n    text: 'paginate DataGrid',\n    primitive: 'click',\n    category: 'ui-interaction',\n    selectorHints: [{ strategy: 'css', value: '.MuiTablePagination-actions button' }],\n  },\n  {\n    text: 'expand DataGrid row',\n    primitive: 'click',\n    category: 'ui-interaction',\n    selectorHints: [{ strategy: 'css', value: '.MuiDataGrid-detailPanelToggle' }],\n  },\n  {\n    text: 'edit DataGrid cell',\n    primitive: 'fill',\n    category: 'ui-interaction',\n    selectorHints: [{ strategy: 'css', value: '.MuiDataGrid-cell--editable' }],\n  },\n\n  // Dialog\n  {\n    text: 'open MUI dialog',\n    primitive: 'click',\n    category: 'ui-interaction',\n    selectorHints: [{ strategy: 'css', value: '[aria-haspopup=\"dialog\"]' }],\n  },\n  {\n    text: 'close MUI dialog',\n    primitive: 'click',\n    category: 'ui-interaction',\n    selectorHints: [{ strategy: 'css', value: '.MuiDialog-root [aria-label=\"close\"]' }],\n  },\n  {\n    text: 'confirm MUI dialog',\n    primitive: 'click',\n    category: 'ui-interaction',\n    selectorHints: [{ strategy: 'css', value: '.MuiDialogActions-root button:last-child' }],\n  },\n  {\n    text: 'verify MUI dialog open',\n    primitive: 'assert',\n    category: 'assertion',\n    selectorHints: [{ strategy: 'role', value: 'dialog' }],\n  },\n\n  // Snackbar\n  {\n    text: 'verify MUI snackbar message',\n    primitive: 'assert',\n    category: 'assertion',\n    selectorHints: [{ strategy: 'css', value: '.MuiSnackbar-root' }],\n  },\n  {\n    text: 'dismiss MUI snackbar',\n    primitive: 'click',\n    category: 'ui-interaction',\n    selectorHints: [{ strategy: 'css', value: '.MuiSnackbar-root [aria-label=\"close\"]' }],\n  },\n\n  // Autocomplete\n  {\n    text: 'type in MUI autocomplete',\n    primitive: 'fill',\n    category: 'ui-interaction',\n    selectorHints: [{ strategy: 'css', value: '.MuiAutocomplete-input' }],\n  },\n  {\n    text: 'select MUI autocomplete option',\n    primitive: 'click',\n    category: 'ui-interaction',\n    selectorHints: [{ strategy: 'css', value: '.MuiAutocomplete-option' }],\n  },\n  {\n    text: 'clear MUI autocomplete',\n    primitive: 'click',\n    category: 'ui-interaction',\n    selectorHints: [{ strategy: 'css', value: '.MuiAutocomplete-clearIndicator' }],\n  },\n\n  // DatePicker\n  {\n    text: 'open MUI date picker',\n    primitive: 'click',\n    category: 'ui-interaction',\n    selectorHints: [{ strategy: 'css', value: '.MuiPickersPopper-root' }],\n  },\n  {\n    text: 'select date in picker',\n    primitive: 'click',\n    category: 'ui-interaction',\n    selectorHints: [{ strategy: 'css', value: '.MuiPickersDay-root' }],\n  },\n  {\n    text: 'navigate picker month',\n    primitive: 'click',\n    category: 'ui-interaction',\n    selectorHints: [{ strategy: 'css', value: '.MuiPickersCalendarHeader-switchViewButton' }],\n  },\n\n  // Select\n  {\n    text: 'open MUI select',\n    primitive: 'click',\n    category: 'ui-interaction',\n    selectorHints: [{ strategy: 'css', value: '.MuiSelect-select' }],\n  },\n  {\n    text: 'select MUI option',\n    primitive: 'click',\n    category: 'ui-interaction',\n    selectorHints: [{ strategy: 'css', value: '.MuiMenuItem-root' }],\n  },\n\n  // TextField\n  {\n    text: 'fill MUI text field',\n    primitive: 'fill',\n    category: 'ui-interaction',\n    selectorHints: [{ strategy: 'css', value: '.MuiTextField-root input' }],\n  },\n  {\n    text: 'verify MUI text field error',\n    primitive: 'assert',\n    category: 'assertion',\n    selectorHints: [{ strategy: 'css', value: '.MuiFormHelperText-root.Mui-error' }],\n  },\n\n  // Menu\n  {\n    text: 'open MUI menu',\n    primitive: 'click',\n    category: 'ui-interaction',\n    selectorHints: [{ strategy: 'role', value: 'button', name: 'menu' }],\n  },\n  {\n    text: 'select MUI menu item',\n    primitive: 'click',\n    category: 'ui-interaction',\n    selectorHints: [{ strategy: 'role', value: 'menuitem' }],\n  },\n\n  // Tabs\n  {\n    text: 'click MUI tab',\n    primitive: 'click',\n    category: 'ui-interaction',\n    selectorHints: [{ strategy: 'role', value: 'tab' }],\n  },\n  {\n    text: 'verify MUI tab selected',\n    primitive: 'assert',\n    category: 'assertion',\n    selectorHints: [{ strategy: 'css', value: '.MuiTab-root[aria-selected=\"true\"]' }],\n  },\n];\n\n/**\n * Get the MUI framework pack\n */\nexport function getMuiPack(): FrameworkPack {\n  return {\n    name: 'mui',\n    framework: 'mui',\n    version: '1.0.0',\n    description: 'Material-UI specific patterns for DataGrid, Dialog, Snackbar, Autocomplete, DatePicker, and more',\n    patterns: MUI_PATTERNS,\n  };\n}\n","/**\n * Ant Design Framework Pack\n *\n * Provides Ant Design-specific patterns for Table, Modal, Message, Select, Form, etc.\n *\n * @module llkb/packs/antd\n */\n\nimport type { FrameworkPack, PackPattern } from './types.js';\n\nconst ANTD_PATTERNS: PackPattern[] = [\n  // Table\n  {\n    text: 'sort Ant table column',\n    primitive: 'click',\n    category: 'ui-interaction',\n    selectorHints: [{ strategy: 'css', value: '.ant-table-column-sorters' }],\n  },\n  {\n    text: 'filter Ant table',\n    primitive: 'click',\n    category: 'ui-interaction',\n    selectorHints: [{ strategy: 'css', value: '.ant-table-filter-trigger' }],\n  },\n  {\n    text: 'expand Ant table row',\n    primitive: 'click',\n    category: 'ui-interaction',\n    selectorHints: [{ strategy: 'css', value: '.ant-table-row-expand-icon' }],\n  },\n  {\n    text: 'select Ant table row',\n    primitive: 'click',\n    category: 'ui-interaction',\n    selectorHints: [{ strategy: 'css', value: '.ant-table-row' }],\n  },\n  {\n    text: 'paginate Ant table',\n    primitive: 'click',\n    category: 'ui-interaction',\n    selectorHints: [{ strategy: 'css', value: '.ant-pagination-item' }],\n  },\n  {\n    text: 'search Ant table',\n    primitive: 'fill',\n    category: 'ui-interaction',\n    selectorHints: [{ strategy: 'css', value: '.ant-table-filter-dropdown input' }],\n  },\n\n  // Modal\n  {\n    text: 'open Ant modal',\n    primitive: 'click',\n    category: 'ui-interaction',\n    selectorHints: [{ strategy: 'css', value: '[data-trigger-modal]' }],\n  },\n  {\n    text: 'close Ant modal',\n    primitive: 'click',\n    category: 'ui-interaction',\n    selectorHints: [{ strategy: 'css', value: '.ant-modal-close' }],\n  },\n  {\n    text: 'confirm Ant modal',\n    primitive: 'click',\n    category: 'ui-interaction',\n    selectorHints: [{ strategy: 'css', value: '.ant-modal-footer .ant-btn-primary' }],\n  },\n  {\n    text: 'cancel Ant modal',\n    primitive: 'click',\n    category: 'ui-interaction',\n    selectorHints: [{ strategy: 'css', value: '.ant-modal-footer .ant-btn-default' }],\n  },\n\n  // Message & Notification\n  {\n    text: 'verify Ant message',\n    primitive: 'assert',\n    category: 'assertion',\n    selectorHints: [{ strategy: 'css', value: '.ant-message' }],\n  },\n  {\n    text: 'verify Ant notification',\n    primitive: 'assert',\n    category: 'assertion',\n    selectorHints: [{ strategy: 'css', value: '.ant-notification' }],\n  },\n  {\n    text: 'close Ant notification',\n    primitive: 'click',\n    category: 'ui-interaction',\n    selectorHints: [{ strategy: 'css', value: '.ant-notification-close-icon' }],\n  },\n\n  // Select\n  {\n    text: 'open Ant select dropdown',\n    primitive: 'click',\n    category: 'ui-interaction',\n    selectorHints: [{ strategy: 'css', value: '.ant-select-selector' }],\n  },\n  {\n    text: 'search Ant select',\n    primitive: 'fill',\n    category: 'ui-interaction',\n    selectorHints: [{ strategy: 'css', value: '.ant-select-selection-search-input' }],\n  },\n  {\n    text: 'select Ant option',\n    primitive: 'click',\n    category: 'ui-interaction',\n    selectorHints: [{ strategy: 'css', value: '.ant-select-item-option' }],\n  },\n  {\n    text: 'clear Ant select',\n    primitive: 'click',\n    category: 'ui-interaction',\n    selectorHints: [{ strategy: 'css', value: '.ant-select-clear' }],\n  },\n\n  // Form\n  {\n    text: 'submit Ant form',\n    primitive: 'click',\n    category: 'ui-interaction',\n    selectorHints: [{ strategy: 'css', value: '.ant-form button[type=\"submit\"]' }],\n  },\n  {\n    text: 'verify Ant form validation',\n    primitive: 'assert',\n    category: 'assertion',\n    selectorHints: [{ strategy: 'css', value: '.ant-form-item-explain-error' }],\n  },\n  {\n    text: 'fill Ant input',\n    primitive: 'fill',\n    category: 'ui-interaction',\n    selectorHints: [{ strategy: 'css', value: '.ant-input' }],\n  },\n  {\n    text: 'reset Ant form',\n    primitive: 'click',\n    category: 'ui-interaction',\n    selectorHints: [{ strategy: 'css', value: '.ant-form button[type=\"reset\"]' }],\n  },\n\n  // DatePicker\n  {\n    text: 'open Ant date picker',\n    primitive: 'click',\n    category: 'ui-interaction',\n    selectorHints: [{ strategy: 'css', value: '.ant-picker' }],\n  },\n  {\n    text: 'select Ant date',\n    primitive: 'click',\n    category: 'ui-interaction',\n    selectorHints: [{ strategy: 'css', value: '.ant-picker-cell' }],\n  },\n\n  // Drawer\n  {\n    text: 'open Ant drawer',\n    primitive: 'click',\n    category: 'ui-interaction',\n    selectorHints: [{ strategy: 'css', value: '[data-trigger-drawer]' }],\n  },\n  {\n    text: 'close Ant drawer',\n    primitive: 'click',\n    category: 'ui-interaction',\n    selectorHints: [{ strategy: 'css', value: '.ant-drawer-close' }],\n  },\n];\n\n/**\n * Get the Ant Design framework pack\n */\nexport function getAntdPack(): FrameworkPack {\n  return {\n    name: 'antd',\n    framework: 'antd',\n    version: '1.0.0',\n    description: 'Ant Design specific patterns for Table, Modal, Message, Select, Form, and more',\n    patterns: ANTD_PATTERNS,\n  };\n}\n","/**\n * Chakra UI Framework Pack\n *\n * Provides Chakra UI-specific patterns for Modal, Toast, Menu, Drawer, Tabs, etc.\n *\n * @module llkb/packs/chakra\n */\n\nimport type { FrameworkPack, PackPattern } from './types.js';\n\nconst CHAKRA_PATTERNS: PackPattern[] = [\n  // Modal\n  {\n    text: 'open Chakra modal',\n    primitive: 'click',\n    category: 'ui-interaction',\n    selectorHints: [{ strategy: 'css', value: '[data-chakra-modal-trigger]' }],\n  },\n  {\n    text: 'close Chakra modal',\n    primitive: 'click',\n    category: 'ui-interaction',\n    selectorHints: [{ strategy: 'css', value: '[aria-label=\"Close\"]' }],\n  },\n  {\n    text: 'verify Chakra modal open',\n    primitive: 'assert',\n    category: 'assertion',\n    selectorHints: [{ strategy: 'role', value: 'dialog' }],\n  },\n  {\n    text: 'confirm Chakra modal',\n    primitive: 'click',\n    category: 'ui-interaction',\n    selectorHints: [{ strategy: 'css', value: '[role=\"dialog\"] footer button:last-child' }],\n  },\n\n  // Toast\n  {\n    text: 'verify Chakra toast',\n    primitive: 'assert',\n    category: 'assertion',\n    selectorHints: [{ strategy: 'role', value: 'status' }],\n  },\n  {\n    text: 'dismiss Chakra toast',\n    primitive: 'click',\n    category: 'ui-interaction',\n    selectorHints: [{ strategy: 'css', value: '[role=\"status\"] button[aria-label=\"Close\"]' }],\n  },\n  {\n    text: 'verify Chakra toast message',\n    primitive: 'assert',\n    category: 'assertion',\n    selectorHints: [{ strategy: 'css', value: '[role=\"status\"]' }],\n  },\n\n  // Menu\n  {\n    text: 'open Chakra menu',\n    primitive: 'click',\n    category: 'ui-interaction',\n    selectorHints: [{ strategy: 'role', value: 'button', name: 'menu' }],\n  },\n  {\n    text: 'select Chakra menu item',\n    primitive: 'click',\n    category: 'ui-interaction',\n    selectorHints: [{ strategy: 'role', value: 'menuitem' }],\n  },\n  {\n    text: 'close Chakra menu',\n    primitive: 'click',\n    category: 'ui-interaction',\n    selectorHints: [{ strategy: 'css', value: 'body' }],\n  },\n\n  // Drawer\n  {\n    text: 'open Chakra drawer',\n    primitive: 'click',\n    category: 'ui-interaction',\n    selectorHints: [{ strategy: 'css', value: '[data-chakra-drawer-trigger]' }],\n  },\n  {\n    text: 'close Chakra drawer',\n    primitive: 'click',\n    category: 'ui-interaction',\n    selectorHints: [{ strategy: 'css', value: '[role=\"dialog\"] [aria-label=\"Close\"]' }],\n  },\n  {\n    text: 'verify Chakra drawer open',\n    primitive: 'assert',\n    category: 'assertion',\n    selectorHints: [{ strategy: 'role', value: 'dialog' }],\n  },\n\n  // Tabs\n  {\n    text: 'switch Chakra tab',\n    primitive: 'click',\n    category: 'ui-interaction',\n    selectorHints: [{ strategy: 'role', value: 'tab' }],\n  },\n  {\n    text: 'verify Chakra tab content',\n    primitive: 'assert',\n    category: 'assertion',\n    selectorHints: [{ strategy: 'role', value: 'tabpanel' }],\n  },\n  {\n    text: 'verify Chakra tab selected',\n    primitive: 'assert',\n    category: 'assertion',\n    selectorHints: [{ strategy: 'css', value: '[role=\"tab\"][aria-selected=\"true\"]' }],\n  },\n\n  // Form\n  {\n    text: 'fill Chakra input',\n    primitive: 'fill',\n    category: 'ui-interaction',\n    selectorHints: [{ strategy: 'css', value: 'input' }],\n  },\n  {\n    text: 'verify Chakra form error',\n    primitive: 'assert',\n    category: 'assertion',\n    selectorHints: [{ strategy: 'css', value: '[role=\"alert\"]' }],\n  },\n  {\n    text: 'submit Chakra form',\n    primitive: 'click',\n    category: 'ui-interaction',\n    selectorHints: [{ strategy: 'css', value: 'button[type=\"submit\"]' }],\n  },\n\n  // Popover\n  {\n    text: 'open Chakra popover',\n    primitive: 'click',\n    category: 'ui-interaction',\n    selectorHints: [{ strategy: 'css', value: '[data-chakra-popover-trigger]' }],\n  },\n  {\n    text: 'close Chakra popover',\n    primitive: 'click',\n    category: 'ui-interaction',\n    selectorHints: [{ strategy: 'css', value: '[role=\"tooltip\"] [aria-label=\"Close\"]' }],\n  },\n];\n\n/**\n * Get the Chakra UI framework pack\n */\nexport function getChakraPack(): FrameworkPack {\n  return {\n    name: 'chakra',\n    framework: 'chakra',\n    version: '1.0.0',\n    description: 'Chakra UI specific patterns for Modal, Toast, Menu, Drawer, Tabs, and more',\n    patterns: CHAKRA_PATTERNS,\n  };\n}\n","/**\n * LLKB Framework Packs Registry\n *\n * Central registry for framework-specific pattern packs with lazy loading.\n *\n * @module llkb/packs\n */\n\nimport type { DiscoveredPattern, FrameworkPack, PackPattern, PackRegistryEntry } from './types.js';\nimport { getReactPack } from './react.js';\nimport { getAngularPack } from './angular.js';\nimport { getMuiPack } from './mui.js';\nimport { getAntdPack } from './antd.js';\nimport { getChakraPack } from './chakra.js';\nimport { randomUUID } from 'crypto';\n\n/**\n * Default confidence for pack patterns (if not specified)\n */\nconst DEFAULT_PACK_CONFIDENCE = 0.65;\n\n/**\n * Pack registry with lazy loading\n * Each entry maps framework signals to their pack loaders\n */\nconst PACK_REGISTRY: PackRegistryEntry[] = [\n  {\n    name: 'react',\n    frameworks: ['react', 'nextjs'],\n    loader: getReactPack,\n  },\n  {\n    name: 'angular',\n    frameworks: ['angular'],\n    loader: getAngularPack,\n  },\n  {\n    name: 'mui',\n    frameworks: ['mui'],\n    loader: getMuiPack,\n  },\n  {\n    name: 'antd',\n    frameworks: ['antd'],\n    loader: getAntdPack,\n  },\n  {\n    name: 'chakra',\n    frameworks: ['chakra'],\n    loader: getChakraPack,\n  },\n];\n\n/**\n * Get the pack registry\n *\n * @returns Array of pack registry entries\n */\nexport function getPackRegistry(): PackRegistryEntry[] {\n  return PACK_REGISTRY;\n}\n\n/**\n * Load packs for given framework signals\n *\n * @param frameworks - Array of framework names detected in the app\n * @returns Array of loaded framework packs\n */\nexport function loadPacksForFrameworks(frameworks: string[]): FrameworkPack[] {\n  const packs: FrameworkPack[] = [];\n  const loadedPackNames = new Set<string>();\n\n  // Normalize framework names to lowercase for matching\n  const normalizedFrameworks = frameworks.map(f => f.toLowerCase());\n\n  for (const entry of PACK_REGISTRY) {\n    // Check if any of the entry's frameworks match the detected frameworks\n    const shouldLoad = entry.frameworks.some(f =>\n      normalizedFrameworks.includes(f.toLowerCase())\n    );\n\n    if (shouldLoad && !loadedPackNames.has(entry.name)) {\n      const pack = entry.loader();\n      packs.push(pack);\n      loadedPackNames.add(entry.name);\n    }\n  }\n\n  return packs;\n}\n\n/**\n * Convert a PackPattern to a DiscoveredPattern\n *\n * @param packPattern - The pack pattern to convert\n * @param packName - Name of the pack this pattern came from\n * @returns Discovered pattern ready for LLKB integration\n */\nfunction packPatternToDiscovered(\n  packPattern: PackPattern,\n  packName: string\n): DiscoveredPattern {\n  return {\n    id: `DP-${randomUUID().slice(0, 8)}`,\n    normalizedText: packPattern.text.toLowerCase(),\n    originalText: packPattern.text,\n    mappedPrimitive: packPattern.primitive,\n    selectorHints: packPattern.selectorHints || [],\n    confidence: packPattern.confidence || DEFAULT_PACK_CONFIDENCE,\n    layer: 'framework',\n    category: packPattern.category,\n    sourceJourneys: [],\n    successCount: 0,\n    failCount: 0,\n    templateSource: 'static',\n    entityName: packName,\n  };\n}\n\n/**\n * Convert all patterns in a pack to DiscoveredPattern format\n *\n * @param pack - The framework pack to convert\n * @returns Array of discovered patterns\n */\nexport function packPatternsToDiscovered(pack: FrameworkPack): DiscoveredPattern[] {\n  return pack.patterns.map(pattern => packPatternToDiscovered(pattern, pack.name));\n}\n\n/**\n * Load and convert all packs for given frameworks\n *\n * This is a convenience function that loads packs and converts them to\n * DiscoveredPattern format in one step.\n *\n * @param frameworks - Array of framework names detected in the app\n * @returns Array of discovered patterns from all applicable packs\n */\nexport function loadDiscoveredPatternsForFrameworks(frameworks: string[]): DiscoveredPattern[] {\n  const packs = loadPacksForFrameworks(frameworks);\n  const patterns: DiscoveredPattern[] = [];\n\n  for (const pack of packs) {\n    patterns.push(...packPatternsToDiscovered(pack));\n  }\n\n  return patterns;\n}\n\n/**\n * Re-export types for convenience\n */\nexport type {\n  PackPattern,\n  FrameworkPack,\n  PackRegistryEntry,\n  DiscoveredPattern,\n  SelectorHint,\n} from './types.js';\n","/**\n * LLKB i18n Mining Module\n *\n * Extracts internationalization (i18n) keys from source code to generate\n * test patterns for text verification.\n *\n * Supports:\n * - react-i18next\n * - angular-translate\n * - vue-i18n\n * - next-intl\n *\n * @module llkb/mining/i18n-mining\n */\n\nimport * as fsp from 'fs/promises';\nimport * as path from 'path';\nimport { type MiningCache, scanAllSourceDirectories, type ScannedFile } from '../mining-cache.js';\nimport type { DiscoveredPattern } from '../pattern-generation.js';\nimport { randomUUID } from 'crypto';\n\n// =============================================================================\n// Constants\n// =============================================================================\n\n/** Maximum regex iterations to prevent ReDoS */\nconst MAX_REGEX_ITERATIONS = 10_000;\n\n/** Default confidence for i18n patterns */\nconst I18N_PATTERN_CONFIDENCE = 0.75;\n\n// =============================================================================\n// Type Definitions\n// =============================================================================\n\n/**\n * An i18n key discovered in source code\n */\nexport interface I18nKey {\n  /** Translation key */\n  key: string;\n  /** Optional namespace */\n  namespace?: string;\n  /** Optional default value */\n  defaultValue?: string;\n  /** Source file where key was found */\n  source: string;\n}\n\n/**\n * Result of i18n mining operation\n */\nexport interface I18nMiningResult {\n  /** Detected i18n library */\n  library: 'react-i18next' | 'angular-translate' | 'vue-i18n' | 'next-intl' | 'unknown';\n  /** Discovered i18n keys */\n  keys: I18nKey[];\n  /** Locale files found */\n  localeFiles: string[];\n}\n\n// =============================================================================\n// Detection Patterns\n// =============================================================================\n\n/**\n * Patterns to detect i18n library usage\n */\nconst I18N_LIBRARY_PATTERNS = {\n  'react-i18next': /(?:import|from)\\s+['\"]react-i18next['\"]|useTranslation\\(/g,\n  'angular-translate': /\\$translate\\.get\\(|translate\\s+filter|\\|\\s*translate/g,\n  'vue-i18n': /(?:import|from)\\s+['\"]vue-i18n['\"]|createI18n\\(|\\$t\\(/g,\n  'next-intl': /(?:import|from)\\s+['\"]next-intl['\"]|useTranslations\\(/g,\n};\n\n/**\n * Patterns to extract i18n keys from source code\n */\nconst I18N_KEY_PATTERNS = {\n  // react-i18next: t('key'), t('namespace:key'), t('key', { defaultValue: '...' })\n  reactI18next: /\\bt\\s*\\(\\s*['\"`]([^'\"`]+)['\"`]\\s*(?:,\\s*\\{[^}]*defaultValue\\s*:\\s*['\"`]([^'\"`]+)['\"`][^}]*\\})?\\)/g,\n\n  // Trans component: <Trans i18nKey=\"key\">...</Trans>\n  transComponent: /<Trans\\s+i18nKey\\s*=\\s*['\"`]([^'\"`]+)['\"`]/g,\n\n  // angular-translate: {{ 'key' | translate }}, $translate.get('key')\n  angularTranslate: /(?:\\{\\{\\s*['\"`]([^'\"`]+)['\"`]\\s*\\|\\s*translate\\s*\\}\\}|\\$translate\\.get\\s*\\(\\s*['\"`]([^'\"`]+)['\"`]\\))/g,\n\n  // vue-i18n: $t('key'), t('key') in setup\n  vueI18n: /\\$t\\s*\\(\\s*['\"`]([^'\"`]+)['\"`]\\)|(?:^|[^\\w])t\\s*\\(\\s*['\"`]([^'\"`]+)['\"`]\\)/g,\n\n  // next-intl: t('key')\n  nextIntl: /\\bt\\s*\\(\\s*['\"`]([^'\"`]+)['\"`]\\)/g,\n};\n\n// =============================================================================\n// Mining Functions\n// =============================================================================\n\n/**\n * Mine i18n keys from a project\n *\n * @param projectRoot - Project root directory\n * @param cache - Optional mining cache\n * @returns i18n mining result\n */\nexport async function mineI18nKeys(\n  projectRoot: string,\n  cache?: MiningCache\n): Promise<I18nMiningResult> {\n  const resolvedRoot = path.resolve(projectRoot);\n\n  // Create cache if not provided\n  const miningCache = cache ?? new (await import('../mining-cache.js')).MiningCache();\n  const shouldCleanup = !cache;\n\n  try {\n    // Scan all source files\n    const files = await scanAllSourceDirectories(resolvedRoot, miningCache);\n\n    // Detect which i18n library is being used\n    const library = detectI18nLibrary(files);\n\n    // Extract keys based on detected library\n    const keys = extractI18nKeys(files, library);\n\n    // Find locale files\n    const localeFiles = await findLocaleFiles(resolvedRoot);\n\n    return {\n      library,\n      keys,\n      localeFiles,\n    };\n  } finally {\n    // Clean up cache if we created it\n    if (shouldCleanup) {\n      miningCache.clear();\n    }\n  }\n}\n\n/**\n * Detect which i18n library is being used\n */\nfunction detectI18nLibrary(\n  files: ScannedFile[]\n): 'react-i18next' | 'angular-translate' | 'vue-i18n' | 'next-intl' | 'unknown' {\n  const detectionScores: Record<string, number> = {\n    'react-i18next': 0,\n    'angular-translate': 0,\n    'vue-i18n': 0,\n    'next-intl': 0,\n  };\n\n  for (const file of files) {\n    for (const [library, pattern] of Object.entries(I18N_LIBRARY_PATTERNS)) {\n      pattern.lastIndex = 0;\n      if (pattern.test(file.content)) {\n        detectionScores[library]!++;\n      }\n    }\n  }\n\n  // Return library with highest score\n  let maxScore = 0;\n  let detectedLibrary: I18nMiningResult['library'] = 'unknown';\n\n  for (const [library, score] of Object.entries(detectionScores)) {\n    if (score > maxScore) {\n      maxScore = score;\n      detectedLibrary = library as I18nMiningResult['library'];\n    }\n  }\n\n  return detectedLibrary;\n}\n\n/**\n * Extract i18n keys from source files\n */\nfunction extractI18nKeys(\n  files: ScannedFile[],\n  _library: I18nMiningResult['library']\n): I18nKey[] {\n  const keys: I18nKey[] = [];\n  const seenKeys = new Set<string>();\n\n  for (const file of files) {\n    // Try all patterns (library detection is a hint, not strict)\n    for (const [patternName, pattern] of Object.entries(I18N_KEY_PATTERNS)) {\n      pattern.lastIndex = 0;\n      let match: RegExpExecArray | null;\n      let iterations = 0;\n\n      while ((match = pattern.exec(file.content)) !== null) {\n        if (++iterations > MAX_REGEX_ITERATIONS) {break;}\n\n        // Extract key from first non-empty capture group\n        const key = match[1] || match[2];\n        if (!key) {continue;}\n\n        // Skip if already seen\n        const keyId = `${key}:${file.path}`;\n        if (seenKeys.has(keyId)) {continue;}\n        seenKeys.add(keyId);\n\n        // Parse namespace if present (format: 'namespace:key')\n        let namespace: string | undefined;\n        let cleanKey = key;\n\n        if (key.includes(':')) {\n          const parts = key.split(':');\n          if (parts.length === 2) {\n            namespace = parts[0]!;\n            cleanKey = parts[1]!;\n          }\n        } else if (key.includes('.')) {\n          // Handle dotted keys like 'login.title' -> extract 'title'\n          const parts = key.split('.');\n          cleanKey = parts[parts.length - 1]!;\n        }\n\n        // Extract default value if present (for react-i18next pattern)\n        const defaultValue = match[2] && patternName === 'reactI18next' ? match[2] : undefined;\n\n        keys.push({\n          key: cleanKey,\n          namespace,\n          defaultValue,\n          source: file.path,\n        });\n      }\n    }\n  }\n\n  return keys;\n}\n\n/**\n * Find locale/translation files in the project\n */\nasync function findLocaleFiles(projectRoot: string): Promise<string[]> {\n  const localeFiles: string[] = [];\n  const localeDirs = ['locales', 'i18n', 'translations', 'lang', 'public/locales'];\n\n  for (const dir of localeDirs) {\n    const fullPath = path.join(projectRoot, dir);\n\n    try {\n      const stat = await fsp.lstat(fullPath);\n      if (stat.isSymbolicLink()) {continue;}\n      if (!stat.isDirectory()) {continue;}\n\n      const files = await findJsonFilesRecursive(fullPath);\n      localeFiles.push(...files);\n    } catch {\n      // Directory doesn't exist, skip\n      continue;\n    }\n  }\n\n  return localeFiles;\n}\n\n/**\n * Recursively find JSON files in a directory\n */\nasync function findJsonFilesRecursive(\n  dir: string,\n  depth: number = 0,\n  maxDepth: number = 5\n): Promise<string[]> {\n  if (depth > maxDepth) {return [];}\n\n  const files: string[] = [];\n\n  try {\n    const entries = await fsp.readdir(dir, { withFileTypes: true });\n\n    for (const entry of entries) {\n      if (entry.isSymbolicLink()) {continue;}\n\n      const fullPath = path.join(dir, entry.name);\n\n      if (entry.isDirectory()) {\n        const subFiles = await findJsonFilesRecursive(fullPath, depth + 1, maxDepth);\n        files.push(...subFiles);\n      } else if (entry.isFile() && entry.name.endsWith('.json')) {\n        files.push(fullPath);\n      }\n    }\n  } catch {\n    // Ignore errors\n  }\n\n  return files;\n}\n\n// =============================================================================\n// Pattern Generation\n// =============================================================================\n\n/**\n * Generate test patterns from i18n mining result\n *\n * @param result - i18n mining result\n * @returns Array of discovered patterns\n */\nexport function generateI18nPatterns(result: I18nMiningResult): DiscoveredPattern[] {\n  const patterns: DiscoveredPattern[] = [];\n  const seenPatterns = new Set<string>();\n\n  for (const i18nKey of result.keys) {\n    // Generate label from key (convert snake_case/camelCase to Title Case)\n    const label = keyToLabel(i18nKey.key);\n\n    // Pattern 1: \"verify {label} text\"\n    const verifyTextPattern = `verify ${label} text`;\n    const verifyTextKey = `${verifyTextPattern}:assert`;\n\n    if (!seenPatterns.has(verifyTextKey)) {\n      seenPatterns.add(verifyTextKey);\n      patterns.push({\n        id: `DP-${randomUUID().slice(0, 8)}`,\n        normalizedText: verifyTextPattern.toLowerCase(),\n        originalText: verifyTextPattern,\n        mappedPrimitive: 'assert',\n        selectorHints: [\n          {\n            strategy: 'text',\n            value: i18nKey.defaultValue || i18nKey.key,\n            confidence: I18N_PATTERN_CONFIDENCE,\n          },\n        ],\n        confidence: I18N_PATTERN_CONFIDENCE,\n        layer: 'app-specific',\n        category: 'assertion',\n        sourceJourneys: [],\n        successCount: 0,\n        failCount: 0,\n        templateSource: 'static',\n      });\n    }\n\n    // Pattern 2: \"verify {label} is visible\"\n    const verifyVisiblePattern = `verify ${label} is visible`;\n    const verifyVisibleKey = `${verifyVisiblePattern}:assert`;\n\n    if (!seenPatterns.has(verifyVisibleKey)) {\n      seenPatterns.add(verifyVisibleKey);\n      patterns.push({\n        id: `DP-${randomUUID().slice(0, 8)}`,\n        normalizedText: verifyVisiblePattern.toLowerCase(),\n        originalText: verifyVisiblePattern,\n        mappedPrimitive: 'assert',\n        selectorHints: [\n          {\n            strategy: 'text',\n            value: i18nKey.defaultValue || i18nKey.key,\n            confidence: I18N_PATTERN_CONFIDENCE,\n          },\n        ],\n        confidence: I18N_PATTERN_CONFIDENCE,\n        layer: 'app-specific',\n        category: 'assertion',\n        sourceJourneys: [],\n        successCount: 0,\n        failCount: 0,\n        templateSource: 'static',\n      });\n    }\n  }\n\n  return patterns;\n}\n\n/**\n * Convert i18n key to human-readable label\n */\nfunction keyToLabel(key: string): string {\n  return key\n    .replace(/[_-]/g, ' ')\n    .replace(/([A-Z])/g, ' $1')\n    .trim()\n    .split(/\\s+/)\n    .map((word) => word.charAt(0).toUpperCase() + word.slice(1).toLowerCase())\n    .join(' ');\n}\n","/**\n * LLKB Analytics Mining Module\n *\n * Extracts analytics event tracking calls from source code to generate\n * test patterns for event verification.\n *\n * Supports:\n * - Google Analytics 4 (GA4/gtag)\n * - Mixpanel\n * - Segment\n * - Amplitude\n * - Custom analytics implementations\n *\n * @module llkb/mining/analytics-mining\n */\n\nimport { type MiningCache, scanAllSourceDirectories, type ScannedFile } from '../mining-cache.js';\nimport type { DiscoveredPattern } from '../pattern-generation.js';\nimport { randomUUID } from 'crypto';\nimport * as path from 'path';\n\n// =============================================================================\n// Constants\n// =============================================================================\n\n/** Maximum regex iterations to prevent ReDoS */\nconst MAX_REGEX_ITERATIONS = 10_000;\n\n/** Default confidence for analytics patterns */\nconst ANALYTICS_PATTERN_CONFIDENCE = 0.70;\n\n// =============================================================================\n// Type Definitions\n// =============================================================================\n\n/**\n * An analytics event discovered in source code\n */\nexport interface AnalyticsEvent {\n  /** Event name */\n  name: string;\n  /** Analytics provider */\n  provider: string;\n  /** Optional event properties */\n  properties?: string[];\n  /** Source file where event was found */\n  source: string;\n}\n\n/**\n * Result of analytics mining operation\n */\nexport interface AnalyticsMiningResult {\n  /** Detected analytics provider */\n  provider: 'ga4' | 'mixpanel' | 'segment' | 'amplitude' | 'custom' | 'unknown';\n  /** Discovered analytics events */\n  events: AnalyticsEvent[];\n}\n\n// =============================================================================\n// Detection Patterns\n// =============================================================================\n\n/**\n * Patterns to detect analytics provider usage\n */\nconst ANALYTICS_PROVIDER_PATTERNS = {\n  ga4: /gtag\\s*\\(\\s*['\"]event['\"]|ReactGA\\.event\\(|window\\.gtag\\(/g,\n  mixpanel: /mixpanel\\.track\\(|import.*mixpanel|from\\s+['\"]mixpanel['\"]/g,\n  segment: /analytics\\.track\\(|window\\.analytics\\.track\\(|import.*@segment/g,\n  amplitude: /amplitude\\.logEvent\\(|import.*@amplitude|Amplitude\\.getInstance\\(\\)/g,\n};\n\n/**\n * Patterns to extract analytics event calls\n */\nconst ANALYTICS_EVENT_PATTERNS = {\n  // GA4/gtag: gtag('event', 'eventName', {...})\n  ga4Gtag: /gtag\\s*\\(\\s*['\"]event['\"]\\s*,\\s*['\"]([^'\"]+)['\"]/g,\n\n  // React GA: ReactGA.event({ category: '...', action: '...' })\n  reactGa: /ReactGA\\.event\\s*\\(\\s*\\{[^}]*action\\s*:\\s*['\"]([^'\"]+)['\"]/g,\n\n  // Mixpanel: mixpanel.track('eventName', {...})\n  mixpanel: /mixpanel\\.track\\s*\\(\\s*['\"]([^'\"]+)['\"]/g,\n\n  // Segment: analytics.track('eventName', {...})\n  segment: /analytics\\.track\\s*\\(\\s*['\"]([^'\"]+)['\"]/g,\n\n  // Amplitude: amplitude.logEvent('eventName', {...})\n  amplitude: /amplitude\\.logEvent\\s*\\(\\s*['\"]([^'\"]+)['\"]/g,\n\n  // Custom analytics: trackEvent('eventName'), logEvent('eventName')\n  custom: /(?:trackEvent|logEvent|sendEvent)\\s*\\(\\s*['\"]([^'\"]+)['\"]/g,\n};\n\n/**\n * Patterns to extract event properties\n */\nconst EVENT_PROPERTIES_PATTERN = /\\{\\s*([^}]+)\\s*\\}/g;\n\n// =============================================================================\n// Mining Functions\n// =============================================================================\n\n/**\n * Mine analytics events from a project\n *\n * @param projectRoot - Project root directory\n * @param cache - Optional mining cache\n * @returns Analytics mining result\n */\nexport async function mineAnalyticsEvents(\n  projectRoot: string,\n  cache?: MiningCache\n): Promise<AnalyticsMiningResult> {\n  const resolvedRoot = path.resolve(projectRoot);\n\n  // Create cache if not provided\n  const miningCache = cache ?? new (await import('../mining-cache.js')).MiningCache();\n  const shouldCleanup = !cache;\n\n  try {\n    // Scan all source files\n    const files = await scanAllSourceDirectories(resolvedRoot, miningCache);\n\n    // Detect which analytics provider is being used\n    const provider = detectAnalyticsProvider(files);\n\n    // Extract events based on detected provider\n    const events = extractAnalyticsEvents(files, provider);\n\n    return {\n      provider,\n      events,\n    };\n  } finally {\n    // Clean up cache if we created it\n    if (shouldCleanup) {\n      miningCache.clear();\n    }\n  }\n}\n\n/**\n * Detect which analytics provider is being used\n */\nfunction detectAnalyticsProvider(\n  files: ScannedFile[]\n): 'ga4' | 'mixpanel' | 'segment' | 'amplitude' | 'custom' | 'unknown' {\n  const detectionScores: Record<string, number> = {\n    ga4: 0,\n    mixpanel: 0,\n    segment: 0,\n    amplitude: 0,\n    custom: 0,\n  };\n\n  for (const file of files) {\n    for (const [provider, pattern] of Object.entries(ANALYTICS_PROVIDER_PATTERNS)) {\n      pattern.lastIndex = 0;\n      if (pattern.test(file.content)) {\n        detectionScores[provider]!++;\n      }\n    }\n\n    // Check for custom analytics patterns\n    const customPattern = /(?:trackEvent|logEvent|sendEvent)\\s*\\(/g;\n    customPattern.lastIndex = 0;\n    if (customPattern.test(file.content)) {\n      detectionScores.custom!++;\n    }\n  }\n\n  // Return provider with highest score\n  let maxScore = 0;\n  let detectedProvider: AnalyticsMiningResult['provider'] = 'unknown';\n\n  for (const [provider, score] of Object.entries(detectionScores)) {\n    if (score > maxScore) {\n      maxScore = score;\n      detectedProvider = provider as AnalyticsMiningResult['provider'];\n    }\n  }\n\n  return detectedProvider;\n}\n\n/**\n * Extract analytics events from source files\n */\nfunction extractAnalyticsEvents(\n  files: ScannedFile[],\n  provider: AnalyticsMiningResult['provider']\n): AnalyticsEvent[] {\n  const events: AnalyticsEvent[] = [];\n  const seenEvents = new Set<string>();\n\n  for (const file of files) {\n    // Try all patterns (provider detection is a hint, not strict)\n    for (const [patternName, pattern] of Object.entries(ANALYTICS_EVENT_PATTERNS)) {\n      pattern.lastIndex = 0;\n      let match: RegExpExecArray | null;\n      let iterations = 0;\n\n      while ((match = pattern.exec(file.content)) !== null) {\n        if (++iterations > MAX_REGEX_ITERATIONS) {break;}\n\n        const eventName = match[1];\n        if (!eventName) {continue;}\n\n        // Skip if already seen\n        const eventId = `${eventName}:${file.path}`;\n        if (seenEvents.has(eventId)) {continue;}\n        seenEvents.add(eventId);\n\n        // Try to extract event properties\n        const properties = extractEventProperties(file.content, match.index);\n\n        // Determine provider from pattern name\n        let eventProvider = provider;\n        if (patternName.includes('ga4') || patternName.includes('reactGa')) {\n          eventProvider = 'ga4';\n        } else if (patternName.includes('mixpanel')) {\n          eventProvider = 'mixpanel';\n        } else if (patternName.includes('segment')) {\n          eventProvider = 'segment';\n        } else if (patternName.includes('amplitude')) {\n          eventProvider = 'amplitude';\n        } else if (patternName.includes('custom')) {\n          eventProvider = 'custom';\n        }\n\n        events.push({\n          name: eventName,\n          provider: eventProvider,\n          properties,\n          source: file.path,\n        });\n      }\n    }\n  }\n\n  return events;\n}\n\n/**\n * Extract event properties from the code near a match\n */\nfunction extractEventProperties(content: string, matchIndex: number): string[] | undefined {\n  // Look for object literal after the event name (within 200 chars)\n  const searchEnd = Math.min(matchIndex + 200, content.length);\n  const snippet = content.slice(matchIndex, searchEnd);\n\n  EVENT_PROPERTIES_PATTERN.lastIndex = 0;\n  const propsMatch = EVENT_PROPERTIES_PATTERN.exec(snippet);\n\n  if (!propsMatch) {return undefined;}\n\n  // Extract property names (simple extraction, may not be perfect)\n  const propsText = propsMatch[1]!;\n  const propertyPattern = /(\\w+)\\s*:/g;\n  const properties: string[] = [];\n\n  let propMatch: RegExpExecArray | null;\n  let iterations = 0;\n\n  while ((propMatch = propertyPattern.exec(propsText)) !== null) {\n    if (++iterations > MAX_REGEX_ITERATIONS) {break;}\n    properties.push(propMatch[1]!);\n  }\n\n  return properties.length > 0 ? properties : undefined;\n}\n\n// =============================================================================\n// Pattern Generation\n// =============================================================================\n\n/**\n * Generate test patterns from analytics mining result\n *\n * @param result - Analytics mining result\n * @returns Array of discovered patterns\n */\nexport function generateAnalyticsPatterns(result: AnalyticsMiningResult): DiscoveredPattern[] {\n  const patterns: DiscoveredPattern[] = [];\n  const seenPatterns = new Set<string>();\n\n  for (const event of result.events) {\n    // Generate label from event name\n    const label = eventNameToLabel(event.name);\n\n    // Pattern 1: \"verify {event} tracked\"\n    const verifyTrackedPattern = `verify ${label} tracked`;\n    const verifyTrackedKey = `${verifyTrackedPattern}:assert`;\n\n    if (!seenPatterns.has(verifyTrackedKey)) {\n      seenPatterns.add(verifyTrackedKey);\n      patterns.push({\n        id: `DP-${randomUUID().slice(0, 8)}`,\n        normalizedText: verifyTrackedPattern.toLowerCase(),\n        originalText: verifyTrackedPattern,\n        mappedPrimitive: 'assert',\n        selectorHints: [],\n        confidence: ANALYTICS_PATTERN_CONFIDENCE,\n        layer: 'app-specific',\n        category: 'assertion',\n        sourceJourneys: [],\n        successCount: 0,\n        failCount: 0,\n        templateSource: 'static',\n      });\n    }\n\n    // Pattern 2: \"trigger {event} event\"\n    const triggerEventPattern = `trigger ${label} event`;\n    const triggerEventKey = `${triggerEventPattern}:click`;\n\n    if (!seenPatterns.has(triggerEventKey)) {\n      seenPatterns.add(triggerEventKey);\n      patterns.push({\n        id: `DP-${randomUUID().slice(0, 8)}`,\n        normalizedText: triggerEventPattern.toLowerCase(),\n        originalText: triggerEventPattern,\n        mappedPrimitive: 'click',\n        selectorHints: [],\n        confidence: ANALYTICS_PATTERN_CONFIDENCE,\n        layer: 'app-specific',\n        category: 'ui-interaction',\n        sourceJourneys: [],\n        successCount: 0,\n        failCount: 0,\n        templateSource: 'static',\n      });\n    }\n  }\n\n  return patterns;\n}\n\n/**\n * Convert event name to human-readable label\n */\nfunction eventNameToLabel(eventName: string): string {\n  return eventName\n    .replace(/[_-]/g, ' ')\n    .replace(/([A-Z])/g, ' $1')\n    .trim()\n    .split(/\\s+/)\n    .map((word) => word.charAt(0).toUpperCase() + word.slice(1).toLowerCase())\n    .join(' ');\n}\n","/**\n * LLKB Feature Flag Mining Module\n *\n * Extracts feature flag configurations from source code to generate\n * test patterns for feature toggle scenarios.\n *\n * Supports:\n * - LaunchDarkly\n * - Split.io\n * - Flagsmith\n * - Unleash\n * - Custom feature flag implementations\n * - Environment variable flags (FEATURE_*)\n *\n * @module llkb/mining/feature-flag-mining\n */\n\nimport { type MiningCache, scanAllSourceDirectories, type ScannedFile } from '../mining-cache.js';\nimport type { DiscoveredPattern } from '../pattern-generation.js';\nimport { randomUUID } from 'crypto';\nimport * as path from 'path';\n\n// =============================================================================\n// Constants\n// =============================================================================\n\n/** Maximum regex iterations to prevent ReDoS */\nconst MAX_REGEX_ITERATIONS = 10_000;\n\n/** Default confidence for feature flag patterns */\nconst FEATURE_FLAG_PATTERN_CONFIDENCE = 0.70;\n\n// =============================================================================\n// Type Definitions\n// =============================================================================\n\n/**\n * A feature flag discovered in source code\n */\nexport interface FeatureFlag {\n  /** Flag name */\n  name: string;\n  /** Feature flag provider */\n  provider: string;\n  /** Optional default value */\n  defaultValue?: boolean;\n  /** Source file where flag was found */\n  source: string;\n}\n\n/**\n * Result of feature flag mining operation\n */\nexport interface FeatureFlagMiningResult {\n  /** Detected feature flag provider */\n  provider: 'launchdarkly' | 'split' | 'flagsmith' | 'unleash' | 'custom' | 'unknown';\n  /** Discovered feature flags */\n  flags: FeatureFlag[];\n}\n\n// =============================================================================\n// Detection Patterns\n// =============================================================================\n\n/**\n * Patterns to detect feature flag provider usage\n */\nconst FEATURE_FLAG_PROVIDER_PATTERNS = {\n  launchdarkly: /useFlags\\s*\\(|ldClient\\.variation\\(|useLDClient\\(|import.*launchdarkly|from\\s+['\"]launchdarkly['\"]/g,\n  split: /splitClient\\.getTreatment\\(|import.*@splitsoftware|from\\s+['\"]@splitsoftware['\"]/g,\n  flagsmith: /flagsmith\\.hasFeature\\(|flagsmith\\.getValue\\(|import.*flagsmith|from\\s+['\"]flagsmith['\"]/g,\n  unleash: /useFlag\\s*\\(|unleash\\.isEnabled\\(|import.*unleash-proxy|from\\s+['\"]unleash-proxy['\"]/g,\n};\n\n/**\n * Patterns to extract feature flag references\n */\nconst FEATURE_FLAG_PATTERNS = {\n  // LaunchDarkly: useFlags(), ldClient.variation('flagName', defaultValue)\n  launchDarklyVariation: /ldClient\\?\\.variation\\s*\\(\\s*['\"]([^'\"]+)['\"]\\s*(?:,\\s*(true|false))?\\)/g,\n  launchDarklyUseFlags: /flags\\[['\"]([^'\"]+)['\"]\\]/g,\n\n  // Split.io: splitClient.getTreatment('flagName')\n  split: /getTreatment\\s*\\(\\s*['\"]([^'\"]+)['\"]/g,\n\n  // Flagsmith: flagsmith.hasFeature('flagName'), flagsmith.getValue('flagName')\n  flagsmith: /(?:hasFeature|getValue)\\s*\\(\\s*['\"]([^'\"]+)['\"]/g,\n\n  // Unleash: useFlag('flagName'), unleash.isEnabled('flagName')\n  unleash: /(?:useFlag|isEnabled)\\s*\\(\\s*['\"]([^'\"]+)['\"]/g,\n\n  // Custom: featureFlags.isEnabled('flagName'), isFeatureEnabled('flagName')\n  custom: /(?:featureFlags|features)\\.(?:isEnabled|enabled|has)\\s*\\(\\s*['\"]([^'\"]+)['\"]/g,\n  customFunction: /isFeatureEnabled\\s*\\(\\s*['\"]([^'\"]+)['\"]/g,\n\n  // Environment variables: process.env.FEATURE_FLAG_NAME, import.meta.env.FEATURE_FLAG_NAME\n  envVar: /(?:process\\.env|import\\.meta\\.env)\\.FEATURE_(\\w+)/g,\n};\n\n// =============================================================================\n// Mining Functions\n// =============================================================================\n\n/**\n * Mine feature flags from a project\n *\n * @param projectRoot - Project root directory\n * @param cache - Optional mining cache\n * @returns Feature flag mining result\n */\nexport async function mineFeatureFlags(\n  projectRoot: string,\n  cache?: MiningCache\n): Promise<FeatureFlagMiningResult> {\n  const resolvedRoot = path.resolve(projectRoot);\n\n  // Create cache if not provided\n  const miningCache = cache ?? new (await import('../mining-cache.js')).MiningCache();\n  const shouldCleanup = !cache;\n\n  try {\n    // Scan all source files\n    const files = await scanAllSourceDirectories(resolvedRoot, miningCache);\n\n    // Detect which feature flag provider is being used\n    const provider = detectFeatureFlagProvider(files);\n\n    // Extract flags based on detected provider\n    const flags = extractFeatureFlags(files, provider);\n\n    return {\n      provider,\n      flags,\n    };\n  } finally {\n    // Clean up cache if we created it\n    if (shouldCleanup) {\n      miningCache.clear();\n    }\n  }\n}\n\n/**\n * Detect which feature flag provider is being used\n */\nfunction detectFeatureFlagProvider(\n  files: ScannedFile[]\n): 'launchdarkly' | 'split' | 'flagsmith' | 'unleash' | 'custom' | 'unknown' {\n  const detectionScores: Record<string, number> = {\n    launchdarkly: 0,\n    split: 0,\n    flagsmith: 0,\n    unleash: 0,\n    custom: 0,\n  };\n\n  for (const file of files) {\n    for (const [provider, pattern] of Object.entries(FEATURE_FLAG_PROVIDER_PATTERNS)) {\n      pattern.lastIndex = 0;\n      if (pattern.test(file.content)) {\n        detectionScores[provider]!++;\n      }\n    }\n\n    // Check for custom feature flag patterns\n    const customPattern = /(?:featureFlags|isFeatureEnabled)\\s*[.(]/g;\n    customPattern.lastIndex = 0;\n    if (customPattern.test(file.content)) {\n      detectionScores.custom!++;\n    }\n  }\n\n  // Return provider with highest score\n  let maxScore = 0;\n  let detectedProvider: FeatureFlagMiningResult['provider'] = 'unknown';\n\n  for (const [provider, score] of Object.entries(detectionScores)) {\n    if (score > maxScore) {\n      maxScore = score;\n      detectedProvider = provider as FeatureFlagMiningResult['provider'];\n    }\n  }\n\n  return detectedProvider;\n}\n\n/**\n * Extract feature flags from source files\n */\nfunction extractFeatureFlags(\n  files: ScannedFile[],\n  provider: FeatureFlagMiningResult['provider']\n): FeatureFlag[] {\n  const flags: FeatureFlag[] = [];\n  const seenFlags = new Set<string>();\n\n  for (const file of files) {\n    // Try all patterns (provider detection is a hint, not strict)\n    for (const [patternName, pattern] of Object.entries(FEATURE_FLAG_PATTERNS)) {\n      pattern.lastIndex = 0;\n      let match: RegExpExecArray | null;\n      let iterations = 0;\n\n      while ((match = pattern.exec(file.content)) !== null) {\n        if (++iterations > MAX_REGEX_ITERATIONS) {break;}\n\n        const flagName = match[1];\n        if (!flagName) {continue;}\n\n        // Skip if already seen\n        const flagId = `${flagName}:${file.path}`;\n        if (seenFlags.has(flagId)) {continue;}\n        seenFlags.add(flagId);\n\n        // Extract default value if present (LaunchDarkly pattern)\n        let defaultValue: boolean | undefined;\n        if (match[2] !== undefined && patternName === 'launchDarklyVariation') {\n          defaultValue = match[2] === 'true';\n        }\n\n        // Determine provider from pattern name\n        let flagProvider = provider;\n        if (patternName.includes('launchDarkly')) {\n          flagProvider = 'launchdarkly';\n        } else if (patternName.includes('split')) {\n          flagProvider = 'split';\n        } else if (patternName.includes('flagsmith')) {\n          flagProvider = 'flagsmith';\n        } else if (patternName.includes('unleash')) {\n          flagProvider = 'unleash';\n        } else {\n          flagProvider = 'custom';\n        }\n\n        flags.push({\n          name: flagName,\n          provider: flagProvider,\n          defaultValue,\n          source: file.path,\n        });\n      }\n    }\n  }\n\n  return flags;\n}\n\n// =============================================================================\n// Pattern Generation\n// =============================================================================\n\n/**\n * Generate test patterns from feature flag mining result\n *\n * @param result - Feature flag mining result\n * @returns Array of discovered patterns\n */\nexport function generateFeatureFlagPatterns(result: FeatureFlagMiningResult): DiscoveredPattern[] {\n  const patterns: DiscoveredPattern[] = [];\n  const seenPatterns = new Set<string>();\n\n  for (const flag of result.flags) {\n    // Generate label from flag name\n    const label = flagNameToLabel(flag.name);\n\n    // Pattern 1: \"ensure {feature} visible\"\n    const ensureVisiblePattern = `ensure ${label} visible`;\n    const ensureVisibleKey = `${ensureVisiblePattern}:assert`;\n\n    if (!seenPatterns.has(ensureVisibleKey)) {\n      seenPatterns.add(ensureVisibleKey);\n      patterns.push({\n        id: `DP-${randomUUID().slice(0, 8)}`,\n        normalizedText: ensureVisiblePattern.toLowerCase(),\n        originalText: ensureVisiblePattern,\n        mappedPrimitive: 'assert',\n        selectorHints: [],\n        confidence: FEATURE_FLAG_PATTERN_CONFIDENCE,\n        layer: 'app-specific',\n        category: 'assertion',\n        sourceJourneys: [],\n        successCount: 0,\n        failCount: 0,\n        templateSource: 'static',\n      });\n    }\n\n    // Pattern 2: \"verify {feature} enabled\"\n    const verifyEnabledPattern = `verify ${label} enabled`;\n    const verifyEnabledKey = `${verifyEnabledPattern}:assert`;\n\n    if (!seenPatterns.has(verifyEnabledKey)) {\n      seenPatterns.add(verifyEnabledKey);\n      patterns.push({\n        id: `DP-${randomUUID().slice(0, 8)}`,\n        normalizedText: verifyEnabledPattern.toLowerCase(),\n        originalText: verifyEnabledPattern,\n        mappedPrimitive: 'assert',\n        selectorHints: [],\n        confidence: FEATURE_FLAG_PATTERN_CONFIDENCE,\n        layer: 'app-specific',\n        category: 'assertion',\n        sourceJourneys: [],\n        successCount: 0,\n        failCount: 0,\n        templateSource: 'static',\n      });\n    }\n\n    // Pattern 3: \"test with {feature} disabled\"\n    const testDisabledPattern = `test with ${label} disabled`;\n    const testDisabledKey = `${testDisabledPattern}:navigate`;\n\n    if (!seenPatterns.has(testDisabledKey)) {\n      seenPatterns.add(testDisabledKey);\n      patterns.push({\n        id: `DP-${randomUUID().slice(0, 8)}`,\n        normalizedText: testDisabledPattern.toLowerCase(),\n        originalText: testDisabledPattern,\n        mappedPrimitive: 'navigate',\n        selectorHints: [],\n        confidence: FEATURE_FLAG_PATTERN_CONFIDENCE,\n        layer: 'app-specific',\n        category: 'navigation',\n        sourceJourneys: [],\n        successCount: 0,\n        failCount: 0,\n        templateSource: 'static',\n      });\n    }\n  }\n\n  return patterns;\n}\n\n/**\n * Convert flag name to human-readable label\n */\nfunction flagNameToLabel(flagName: string): string {\n  return flagName\n    .replace(/[_-]/g, ' ')\n    .replace(/([A-Z])/g, ' $1')\n    .trim()\n    .split(/\\s+/)\n    .map((word) => word.charAt(0).toUpperCase() + word.slice(1).toLowerCase())\n    .join(' ');\n}\n","/**\n * LLKB Full Discovery Pipeline Orchestrator\n *\n * Wires together all discovery phases into a single callable function:\n * 1. runDiscovery() - Framework/auth/selector detection\n * 2. mineElements() - Entity/route/form/table/modal extraction\n * 3. loadDiscoveredPatternsForFrameworks() - Framework pack patterns\n * 4. Mining modules - i18n, analytics, feature flag patterns\n * 5. Quality controls - Deduplication, confidence threshold, boosting\n * 6. Persistence - Save to discovered-patterns.json and discovered-profile.json\n *\n * This module addresses CRITICAL review finding: \"No Pipeline Orchestrator\".\n *\n * @module llkb/pipeline\n */\n\nimport { type DiscoveredProfile, type DiscoveryResult, runDiscovery, saveDiscoveredProfile } from './discovery.js';\nimport { mineElements, type MiningResult } from './mining.js';\nimport { generateAllPatterns } from './template-generators.js';\nimport {\n  createDiscoveredPatternsFile,\n  type DiscoveredPattern,\n  type DiscoveredPatternsFile,\n  generatePatterns,\n  saveDiscoveredPatterns,\n} from './pattern-generation.js';\nimport { loadDiscoveredPatternsForFrameworks } from './packs/index.js';\nimport { generateI18nPatterns, mineI18nKeys } from './mining/i18n-mining.js';\nimport { generateAnalyticsPatterns, mineAnalyticsEvents } from './mining/analytics-mining.js';\nimport { generateFeatureFlagPatterns, mineFeatureFlags } from './mining/feature-flag-mining.js';\nimport { applyAllQualityControls, applySignalWeighting, type QualityControlResult } from './quality-controls.js';\nimport { MiningCache } from './mining-cache.js';\n\n// =============================================================================\n// Constants\n// =============================================================================\n\n/** Spec AC3: confidence threshold for F12 export */\nconst SPEC_CONFIDENCE_THRESHOLD = 0.7;\n\n/** Maximum patterns to retain after all generation (safety cap) */\nconst MAX_PIPELINE_PATTERNS = 2000;\n\n/** Spec target: minimum patterns expected for a typical project */\nconst SPEC_PATTERN_TARGET = 360;\n\n// =============================================================================\n// Type Definitions\n// =============================================================================\n\n/**\n * Options for the full discovery pipeline\n */\nexport interface PipelineOptions {\n  /** Confidence threshold for quality controls (default: 0.7 per spec AC3) */\n  confidenceThreshold?: number;\n  /** Maximum scan depth for file discovery */\n  maxDepth?: number;\n  /** Maximum files to scan */\n  maxFiles?: number;\n  /** Maximum patterns to generate (safety cap, default: 2000) */\n  maxPatterns?: number;\n  /** Skip framework pack loading */\n  skipPacks?: boolean;\n  /** Skip mining modules (i18n, analytics, feature flags) */\n  skipMiningModules?: boolean;\n  /** Output directory for persistence (default: llkbDir) */\n  outputDir?: string;\n  /**\n   * Optional shared MiningCache instance for file content caching.\n   * When provided, mining modules will reuse this cache.\n   * NOTE (P-02): Discovery phase currently uses its own file scanning and does not\n   * share a cache with mining. A future optimization could integrate discovery's\n   * scanDirectoryForSelectors/scanForAuthPatterns with MiningCache.\n   */\n  cache?: MiningCache;\n}\n\n/**\n * Result of the full discovery pipeline\n */\nexport interface PipelineResult {\n  /** Whether the pipeline succeeded */\n  success: boolean;\n  /** Generated app profile */\n  profile: DiscoveredProfile | null;\n  /** Final patterns file (after QC) */\n  patternsFile: DiscoveredPatternsFile | null;\n  /** Pipeline statistics */\n  stats: PipelineStats;\n  /** Warnings from the pipeline */\n  warnings: string[];\n  /** Errors from the pipeline */\n  errors: string[];\n}\n\n/**\n * Detailed pipeline statistics\n */\nexport interface PipelineStats {\n  /** Total pipeline duration in ms */\n  durationMs: number;\n  /** Patterns from each source */\n  patternSources: {\n    discovery: number;\n    templates: number;\n    frameworkPacks: number;\n    i18n: number;\n    analytics: number;\n    featureFlags: number;\n  };\n  /** Total patterns before QC */\n  totalBeforeQC: number;\n  /** Total patterns after QC */\n  totalAfterQC: number;\n  /** Quality control metrics */\n  qualityControls: QualityControlResult | null;\n  /** Mining statistics */\n  mining: {\n    entitiesFound: number;\n    routesFound: number;\n    formsFound: number;\n    tablesFound: number;\n    modalsFound: number;\n    filesScanned: number;\n  } | null;\n}\n\n// =============================================================================\n// Pipeline Orchestrator\n// =============================================================================\n\n/**\n * Run the full LLKB discovery pipeline.\n *\n * This is the main entry point that orchestrates all discovery phases:\n * 1. Framework/auth/selector detection via runDiscovery()\n * 2. Zero-config element mining via mineElements()\n * 3. Template-based pattern generation from mined elements\n * 4. Framework pack patterns (React, Angular, MUI, etc.)\n * 5. Mining module patterns (i18n, analytics, feature flags)\n * 6. Quality controls (dedup, threshold, cross-source boost)\n * 7. Persistence to discovered-patterns.json and discovered-profile.json\n *\n * @param projectRoot - Path to the project root directory\n * @param llkbDir - Path to the LLKB directory (e.g., .artk/llkb/)\n * @param options - Pipeline options\n * @returns Pipeline result with profile, patterns, and statistics\n */\nexport async function runFullDiscoveryPipeline(\n  projectRoot: string,\n  llkbDir: string,\n  options: PipelineOptions = {}\n): Promise<PipelineResult> {\n  const startTime = Date.now();\n  const warnings: string[] = [];\n  const errors: string[] = [];\n\n  const threshold = options.confidenceThreshold ?? SPEC_CONFIDENCE_THRESHOLD;\n  const maxPatterns = options.maxPatterns ?? MAX_PIPELINE_PATTERNS;\n\n  // Collect all patterns from all sources\n  const allPatterns: DiscoveredPattern[] = [];\n  const patternSources = {\n    discovery: 0,\n    templates: 0,\n    frameworkPacks: 0,\n    i18n: 0,\n    analytics: 0,\n    featureFlags: 0,\n  };\n\n  // Signal weighting: track pattern IDs by source strength (spec section 3.5)\n  const strongIds: string[] = []; // routes, schemas, discovery\n  const mediumIds: string[] = []; // i18n, framework packs\n  const weakIds: string[] = [];   // analytics, feature flags\n\n  let profile: DiscoveredProfile | null = null;\n  let miningStats: PipelineStats['mining'] = null;\n\n  // =========================================================================\n  // Phase 1: Discovery (framework/auth/selector detection)\n  // =========================================================================\n\n  let discoveryResult: DiscoveryResult;\n  try {\n    discoveryResult = await runDiscovery(projectRoot);\n    profile = discoveryResult.profile;\n    warnings.push(...discoveryResult.warnings);\n\n    if (!discoveryResult.success) {\n      errors.push(...discoveryResult.errors);\n    }\n  } catch (e) {\n    errors.push(`Discovery failed: ${String(e)}`);\n    discoveryResult = { success: false, profile: null, errors: [], warnings: [] };\n  }\n\n  // =========================================================================\n  // Phase 2: Generate discovery-based patterns (from profile + signals)\n  // =========================================================================\n\n  if (profile) {\n    try {\n      const discoveryPatterns = generatePatterns(profile, profile.selectorSignals);\n      allPatterns.push(...discoveryPatterns);\n      patternSources.discovery = discoveryPatterns.length;\n      strongIds.push(...discoveryPatterns.map(p => p.id));\n    } catch (e) {\n      warnings.push(`Discovery pattern generation failed: ${String(e)}`);\n    }\n  }\n\n  // =========================================================================\n  // Phase 3: Mine elements and generate template patterns\n  // =========================================================================\n\n  try {\n    const miningResult: MiningResult = await mineElements(projectRoot, {\n      maxDepth: options.maxDepth,\n      maxFiles: options.maxFiles,\n    });\n\n    miningStats = {\n      entitiesFound: miningResult.stats.entitiesFound,\n      routesFound: miningResult.stats.routesFound,\n      formsFound: miningResult.stats.formsFound,\n      tablesFound: miningResult.stats.tablesFound,\n      modalsFound: miningResult.stats.modalsFound,\n      filesScanned: miningResult.stats.filesScanned,\n    };\n\n    // Generate template patterns from mined elements\n    const templateResult = generateAllPatterns(miningResult.elements);\n    allPatterns.push(...templateResult.patterns);\n    patternSources.templates = templateResult.patterns.length;\n    // Templates are heuristic (regex-mined)  classify as medium, not strong\n    mediumIds.push(...templateResult.patterns.map(p => p.id));\n  } catch (e) {\n    warnings.push(`Mining/template generation failed: ${String(e)}`);\n  }\n\n  // =========================================================================\n  // Phase 4: Load framework pack patterns\n  // =========================================================================\n\n  if (!options.skipPacks && profile) {\n    try {\n      // Collect all detected framework and UI library names\n      const frameworkNames = [\n        ...profile.frameworks.map(f => f.name),\n        ...profile.uiLibraries.map(l => l.name),\n      ];\n\n      if (frameworkNames.length > 0) {\n        const packPatterns = loadDiscoveredPatternsForFrameworks(frameworkNames);\n        allPatterns.push(...packPatterns);\n        patternSources.frameworkPacks = packPatterns.length;\n        mediumIds.push(...packPatterns.map(p => p.id));\n      }\n    } catch (e) {\n      warnings.push(`Framework pack loading failed: ${String(e)}`);\n    }\n  }\n\n  // =========================================================================\n  // Phase 5: Mining module patterns (i18n, analytics, feature flags)\n  // =========================================================================\n\n  if (!options.skipMiningModules) {\n    // Share a single mining cache across all mining modules for efficiency\n    // P-02: Accept external cache if provided, otherwise create a new one\n    const cache = options.cache ?? new MiningCache();\n    const ownsCache = !options.cache;\n\n    try {\n      // i18n patterns\n      try {\n        const i18nResult = await mineI18nKeys(projectRoot, cache);\n        if (i18nResult.keys.length > 0) {\n          const i18nPatterns = generateI18nPatterns(i18nResult);\n          allPatterns.push(...i18nPatterns);\n          patternSources.i18n = i18nPatterns.length;\n          mediumIds.push(...i18nPatterns.map(p => p.id));\n        }\n      } catch (e) {\n        warnings.push(`i18n mining failed: ${String(e)}`);\n      }\n\n      // Analytics patterns\n      try {\n        const analyticsResult = await mineAnalyticsEvents(projectRoot, cache);\n        if (analyticsResult.events.length > 0) {\n          const analyticsPatterns = generateAnalyticsPatterns(analyticsResult);\n          allPatterns.push(...analyticsPatterns);\n          patternSources.analytics = analyticsPatterns.length;\n          weakIds.push(...analyticsPatterns.map(p => p.id));\n        }\n      } catch (e) {\n        warnings.push(`Analytics mining failed: ${String(e)}`);\n      }\n\n      // Feature flag patterns\n      try {\n        const ffResult = await mineFeatureFlags(projectRoot, cache);\n        if (ffResult.flags.length > 0) {\n          const ffPatterns = generateFeatureFlagPatterns(ffResult);\n          allPatterns.push(...ffPatterns);\n          patternSources.featureFlags = ffPatterns.length;\n          weakIds.push(...ffPatterns.map(p => p.id));\n        }\n      } catch (e) {\n        warnings.push(`Feature flag mining failed: ${String(e)}`);\n      }\n    } finally {\n      // Only clear if we created the cache (don't clear caller's cache)\n      if (ownsCache) {\n        cache.clear();\n      }\n    }\n  }\n\n  // =========================================================================\n  // Phase 6: Signal weighting + quality controls (spec section 3.5)\n  // =========================================================================\n\n  // Apply signal weighting: assign base confidence from source strength\n  const signalStrengths = new Map<string, 'strong' | 'medium' | 'weak'>();\n  for (const id of strongIds) {signalStrengths.set(id, 'strong');}\n  for (const id of mediumIds) {signalStrengths.set(id, 'medium');}\n  for (const id of weakIds) {signalStrengths.set(id, 'weak');}\n\n  const weightedPatterns = signalStrengths.size > 0\n    ? applySignalWeighting(allPatterns, signalStrengths)\n    : allPatterns;\n\n  const totalBeforeQC = weightedPatterns.length;\n  let finalPatterns: DiscoveredPattern[];\n  let qcResult: QualityControlResult | null = null;\n\n  try {\n    const { patterns: validated, result } = applyAllQualityControls(weightedPatterns, {\n      threshold,\n    });\n\n    finalPatterns = validated;\n    qcResult = result;\n  } catch (e) {\n    warnings.push(`Quality controls failed, using unvalidated patterns: ${String(e)}`);\n    finalPatterns = weightedPatterns;\n  }\n\n  // F-05: Warn if pattern count is below spec target\n  if (finalPatterns.length < SPEC_PATTERN_TARGET) {\n    warnings.push(\n      `Pattern count (${finalPatterns.length}) is below spec target (${SPEC_PATTERN_TARGET}). ` +\n      `Consider adding framework packs or mining modules to increase coverage.`\n    );\n  }\n\n  // F-04: Note that runtime validation of generated patterns is not yet implemented\n  warnings.push(\n    'Runtime validation of generated patterns against a live app is not yet implemented. ' +\n    'Patterns are validated structurally only.'\n  );\n\n  // Apply safety cap\n  if (finalPatterns.length > maxPatterns) {\n    // Sort by confidence descending, keep top N\n    finalPatterns.sort((a, b) => b.confidence - a.confidence);\n    finalPatterns = finalPatterns.slice(0, maxPatterns);\n    warnings.push(\n      `Pattern count (${totalBeforeQC}) exceeded cap (${maxPatterns}), truncated to top ${maxPatterns} by confidence`\n    );\n  }\n\n  // =========================================================================\n  // Phase 7: Persistence\n  // =========================================================================\n\n  const outputDir = options.outputDir ?? llkbDir;\n  let patternsFile: DiscoveredPatternsFile | null = null;\n\n  if (profile) {\n    try {\n      const durationMs = Date.now() - startTime;\n      patternsFile = createDiscoveredPatternsFile(finalPatterns, profile, durationMs);\n      saveDiscoveredPatterns(patternsFile, outputDir);\n      saveDiscoveredProfile(profile, outputDir);\n    } catch (e) {\n      errors.push(`Persistence failed: ${String(e)}`);\n    }\n  }\n\n  // =========================================================================\n  // Build result\n  // =========================================================================\n\n  const durationMs = Date.now() - startTime;\n\n  return {\n    success: errors.length === 0,\n    profile,\n    patternsFile,\n    stats: {\n      durationMs,\n      patternSources,\n      totalBeforeQC,\n      totalAfterQC: finalPatterns.length,\n      qualityControls: qcResult,\n      mining: miningStats,\n    },\n    warnings,\n    errors,\n  };\n}\n"]}