{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://artk.dev/schemas/llkb/app-profile.json",
  "title": "LLKB App Profile",
  "description": "Application profile generated by LLKB Pattern Discovery (F12)",
  "type": "object",
  "required": ["version", "generatedAt", "projectRoot", "frameworks", "uiLibraries", "selectorSignals", "auth", "runtime"],
  "properties": {
    "version": {
      "type": "string",
      "description": "Schema version",
      "pattern": "^\\d+\\.\\d+$"
    },
    "generatedAt": {
      "type": "string",
      "format": "date-time",
      "description": "ISO 8601 timestamp when profile was generated"
    },
    "projectRoot": {
      "type": "string",
      "description": "Absolute path to the project root directory"
    },
    "frameworks": {
      "type": "array",
      "description": "Detected frameworks",
      "items": {
        "$ref": "#/definitions/FrameworkSignal"
      }
    },
    "uiLibraries": {
      "type": "array",
      "description": "Detected UI libraries",
      "items": {
        "$ref": "#/definitions/UiLibrarySignal"
      }
    },
    "selectorSignals": {
      "$ref": "#/definitions/SelectorSignals"
    },
    "auth": {
      "$ref": "#/definitions/AuthHints"
    },
    "runtime": {
      "$ref": "#/definitions/RuntimeValidation"
    }
  },
  "definitions": {
    "FrameworkSignal": {
      "type": "object",
      "required": ["name", "confidence", "evidence"],
      "properties": {
        "name": {
          "type": "string",
          "description": "Framework name",
          "enum": ["react", "angular", "vue", "nextjs", "svelte"]
        },
        "version": {
          "type": "string",
          "description": "Detected version"
        },
        "confidence": {
          "type": "number",
          "minimum": 0,
          "maximum": 1,
          "description": "Confidence score (0.0 - 1.0)"
        },
        "evidence": {
          "type": "array",
          "items": { "type": "string" },
          "description": "Evidence that led to detection"
        }
      }
    },
    "UiLibrarySignal": {
      "type": "object",
      "required": ["name", "confidence", "evidence"],
      "properties": {
        "name": {
          "type": "string",
          "description": "Library name",
          "enum": ["mui", "antd", "chakra", "ag-grid", "tailwind", "bootstrap"]
        },
        "confidence": {
          "type": "number",
          "minimum": 0,
          "maximum": 1,
          "description": "Confidence score (0.0 - 1.0)"
        },
        "evidence": {
          "type": "array",
          "items": { "type": "string" },
          "description": "Evidence that led to detection"
        },
        "hasEnterprise": {
          "type": "boolean",
          "description": "Whether enterprise version is detected"
        }
      }
    },
    "SelectorSignals": {
      "type": "object",
      "required": ["primaryAttribute", "namingConvention", "coverage"],
      "properties": {
        "primaryAttribute": {
          "type": "string",
          "description": "Most commonly used selector attribute"
        },
        "namingConvention": {
          "type": "string",
          "enum": ["kebab-case", "camelCase", "snake_case", "mixed"],
          "description": "Detected naming convention"
        },
        "coverage": {
          "type": "object",
          "description": "Coverage percentage for each selector type",
          "additionalProperties": {
            "type": "number",
            "minimum": 0,
            "maximum": 1
          }
        },
        "totalComponentsAnalyzed": {
          "type": "integer",
          "minimum": 0,
          "description": "Total source files analyzed"
        },
        "sampleSelectors": {
          "type": "array",
          "items": { "type": "string" },
          "description": "Sample selectors found"
        }
      }
    },
    "AuthHints": {
      "type": "object",
      "required": ["detected"],
      "properties": {
        "detected": {
          "type": "boolean",
          "description": "Whether authentication was detected"
        },
        "type": {
          "type": "string",
          "enum": ["form", "oidc", "oauth", "sso", "basic"],
          "description": "Type of authentication"
        },
        "loginRoute": {
          "type": "string",
          "description": "Login route path"
        },
        "selectors": {
          "type": "object",
          "description": "Detected selectors for auth elements",
          "additionalProperties": { "type": "string" }
        },
        "bypassAvailable": {
          "type": "boolean",
          "description": "Whether bypass mechanism is available"
        },
        "bypassMethod": {
          "type": "string",
          "description": "How to bypass auth for testing"
        }
      }
    },
    "RuntimeValidation": {
      "type": "object",
      "required": ["validated"],
      "properties": {
        "validated": {
          "type": "boolean",
          "description": "Whether runtime validation was performed"
        },
        "scanUrl": {
          "type": ["string", "null"],
          "description": "URL used for runtime scanning"
        },
        "domSampleCount": {
          "type": "integer",
          "minimum": 0,
          "description": "Number of DOM samples collected"
        }
      }
    }
  }
}
