{"version":3,"sources":["../errors/config-error.ts","../utils/logger.ts","../errors/auth-error.ts","../auth/credentials.ts","../config/env.ts","../config/timeouts.ts","../config/defaults.ts","../config/schema.ts","../config/migrate.ts","../config/loader.ts","../fixtures/base.ts","../version.json","../config/index.ts","../auth/index.ts","../errors/storage-state-error.ts","../auth/storage-state.ts","../auth/oidc/flow.ts","../auth/oidc/providers/keycloak.ts","../auth/oidc/providers/azure-ad.ts","../auth/oidc/providers/okta.ts","../auth/oidc/providers/generic.ts","../auth/providers/base.ts","../auth/providers/oidc.ts","../auth/providers/form.ts","../auth/providers/token.ts","../auth/setup-factory.ts","../fixtures/auth.ts","../fixtures/api.ts","../data/namespace.ts","../data/cleanup.ts","../fixtures/data.ts","../fixtures/index.ts","../locators/strategies.ts","../locators/testid.ts","../locators/factory.ts","../assertions/toast.ts","../assertions/table.ts","../assertions/form.ts","../assertions/loading.ts","../data/api-client.ts","../reporters/journey-reporter.ts","../reporters/artk-reporter.ts","../harness/projects.ts","../harness/reporters.ts","../harness/playwright.config.base.ts","../harness/browser-validator.ts","../grid/types.ts","../grid/ag-grid/config.ts","../grid/ag-grid/selectors.ts","../grid/ag-grid/locators.ts","../grid/ag-grid/wait.ts","../grid/ag-grid/cell-renderers.ts","../grid/ag-grid/row-data.ts","../grid/ag-grid/state.ts","../grid/ag-grid/assertions.ts","../grid/ag-grid/helper.ts","../grid/ag-grid/factory.ts","../errors/index.ts","../utils/index.ts","../utils/retry.ts"],"names":["ARTKConfigError","ARTKAuthError","logger","path","z","join","existsSync","readFileSync","parseYaml","envName","envConfig","resolve","resolveOptions","getStorageStateDirectory","base","getStorageStatePath","fs","authenticator","body","token","headerName","headerPrefix","getStorageStatePathForRole","playwrightRequest","randomBytes","generateRunId","expect","test","dirname","path3","path4","promisify","exec","DEFAULT_TIMEOUTS","byTestId","normalizeForComparison"],"mappings":"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","file":"index.cjs","sourcesContent":["/**\n * Configuration validation error\n *\n * Thrown when configuration validation fails, providing detailed information\n * about the invalid field and suggested fixes.\n *\n * @example\n * ```typescript\n * throw new ARTKConfigError(\n *   'Invalid auth provider',\n *   'auth.provider',\n *   'Did you mean: oidc, form, token, custom?'\n * );\n * ```\n */\nexport class ARTKConfigError extends Error {\n  /**\n   * JSON path to the invalid field (e.g., 'auth.oidc.idpType')\n   */\n  public readonly field: string;\n\n  /**\n   * Optional suggestion for fixing the error\n   */\n  public readonly suggestion?: string;\n\n  constructor(message: string, field: string, suggestion?: string) {\n    super(message);\n    this.name = 'ARTKConfigError';\n    this.field = field;\n    this.suggestion = suggestion;\n\n    // Maintain proper stack trace for where error was thrown (V8 only)\n    if (Error.captureStackTrace) {\n      Error.captureStackTrace(this, ARTKConfigError);\n    }\n  }\n\n  /**\n   * Format error as a human-readable string with field path and suggestion\n   */\n  public override toString(): string {\n    let result = `${this.name}: ${this.message} (field: ${this.field})`;\n    if (this.suggestion) {\n      result += `\\n  Suggestion: ${this.suggestion}`;\n    }\n    return result;\n  }\n}\n","/**\n * Structured logger utility\n *\n * Provides structured JSON logging with verbosity levels (debug, info, warn, error)\n * as required by NFR-001, NFR-002, and NFR-003.\n *\n * All logs include module, operation, and timestamp for filtering and aggregation.\n *\n * @example\n * ```typescript\n * import { createLogger } from './logger.js';\n *\n * const logger = createLogger('config', 'loadConfig');\n * logger.info('Loading configuration', { path: 'artk.config.yml' });\n * logger.error('Validation failed', { errors: [...] });\n * ```\n */\n\n/**\n * Log levels in order of severity\n */\nexport type LogLevel = 'debug' | 'info' | 'warn' | 'error';\n\n/**\n * Log output format\n */\nexport type LogFormat = 'json' | 'pretty';\n\n/**\n * Structured log entry\n */\nexport interface LogEntry {\n  level: LogLevel;\n  module: string;\n  operation: string;\n  timestamp: string;\n  message: string;\n  context?: Record<string, unknown>;\n}\n\n/**\n * Logger configuration\n */\nexport interface LoggerConfig {\n  minLevel: LogLevel;\n  format: LogFormat;\n  output: (entry: LogEntry) => void;\n}\n\n/**\n * Log level numeric values for comparison\n */\nconst LOG_LEVELS: Record<LogLevel, number> = {\n  debug: 0,\n  info: 1,\n  warn: 2,\n  error: 3,\n};\n\n/**\n * Format log entry as pretty text\n *\n * @param entry - Log entry to format\n * @returns Formatted string\n */\nfunction formatPretty(entry: LogEntry): string {\n  // Extract time from ISO timestamp (HH:MM:SS)\n  const time = entry.timestamp.split('T')[1]?.split('.')[0] || '00:00:00';\n\n  // Format level (uppercase, padded to 5 chars for alignment)\n  const level = entry.level.toUpperCase().padEnd(5);\n\n  // Format context if present\n  const context = entry.context ? ` ${JSON.stringify(entry.context)}` : '';\n\n  return `[${time}] ${level} [${entry.module}] ${entry.message}${context}`;\n}\n\n/**\n * Global logger configuration\n */\nlet globalConfig: LoggerConfig = {\n  minLevel: 'info',\n  format: 'json',\n  output: (entry: LogEntry): void => {\n    // eslint-disable-next-line no-console\n    const target = entry.level === 'error' ? console.error : console.log;\n\n    if (globalConfig.format === 'pretty') {\n      target(formatPretty(entry));\n    } else {\n      target(JSON.stringify(entry));\n    }\n  },\n};\n\n/**\n * Configure global logger settings\n *\n * @param config - Logger configuration\n *\n * @example\n * ```typescript\n * // JSON format (default, for production)\n * configureLogger({\n *   minLevel: 'debug',\n *   format: 'json'\n * });\n *\n * // Pretty format (for local development)\n * configureLogger({\n *   minLevel: 'debug',\n *   format: 'pretty'\n * });\n *\n * // Custom output\n * configureLogger({\n *   output: (entry) => fs.appendFileSync('artk.log', JSON.stringify(entry) + '\\n')\n * });\n * ```\n */\nexport function configureLogger(config: Partial<LoggerConfig>): void {\n  globalConfig = { ...globalConfig, ...config };\n}\n\n/**\n * Get current logger configuration\n */\nexport function getLoggerConfig(): Readonly<LoggerConfig> {\n  return { ...globalConfig };\n}\n\n/**\n * Logger interface\n */\nexport interface Logger {\n  debug(message: string, context?: Record<string, unknown>): void;\n  info(message: string, context?: Record<string, unknown>): void;\n  warn(message: string, context?: Record<string, unknown>): void;\n  error(message: string, context?: Record<string, unknown>): void;\n}\n\n/**\n * Create a logger for a specific module and operation\n *\n * @param module - Module name (e.g., 'config', 'auth', 'fixtures')\n * @param operation - Operation name (e.g., 'loadConfig', 'saveStorageState')\n * @returns Logger instance\n *\n * @example\n * ```typescript\n * const logger = createLogger('auth', 'oidcLogin');\n * logger.info('Starting OIDC login flow', { role: 'admin' });\n * ```\n */\nexport function createLogger(module: string, operation: string): Logger {\n  const log = (level: LogLevel, message: string, context?: Record<string, unknown>): void => {\n    // Check if this log level should be output\n    if (LOG_LEVELS[level] < LOG_LEVELS[globalConfig.minLevel]) {\n      return;\n    }\n\n    const entry: LogEntry = {\n      level,\n      module,\n      operation,\n      timestamp: new Date().toISOString(),\n      message,\n      context,\n    };\n\n    globalConfig.output(entry);\n  };\n\n  return {\n    debug: (message: string, context?: Record<string, unknown>): void => log('debug', message, context),\n    info: (message: string, context?: Record<string, unknown>): void => log('info', message, context),\n    warn: (message: string, context?: Record<string, unknown>): void => log('warn', message, context),\n    error: (message: string, context?: Record<string, unknown>): void => log('error', message, context),\n  };\n}\n\n/**\n * Parse log level from string (case-insensitive)\n *\n * @param level - Log level string\n * @returns Parsed log level or undefined if invalid\n *\n * @example\n * ```typescript\n * const level = parseLogLevel(process.env.LOG_LEVEL);\n * if (level) {\n *   configureLogger({ minLevel: level });\n * }\n * ```\n */\nexport function parseLogLevel(level: string | undefined): LogLevel | undefined {\n  if (!level) {\n    return undefined;\n  }\n\n  const normalized = level.toLowerCase() as LogLevel;\n  if (normalized in LOG_LEVELS) {\n    return normalized;\n  }\n\n  return undefined;\n}\n","/**\n * Authentication failure error\n *\n * Thrown when authentication fails, providing detailed information about\n * the failure phase, role, IdP response, and remediation steps.\n *\n * @example\n * ```typescript\n * throw new ARTKAuthError(\n *   'Failed to authenticate user',\n *   'admin',\n *   'credentials',\n *   'Invalid username or password',\n *   'Verify ADMIN_USERNAME and ADMIN_PASSWORD environment variables are set correctly'\n * );\n * ```\n */\nexport class ARTKAuthError extends Error {\n  /**\n   * Role that failed to authenticate\n   */\n  public readonly role: string;\n\n  /**\n   * Phase where authentication failed\n   */\n  public readonly phase: 'navigation' | 'credentials' | 'mfa' | 'callback';\n\n  /**\n   * Optional IdP response or error message\n   */\n  public readonly idpResponse?: string;\n\n  /**\n   * Optional remediation steps to fix the error\n   */\n  public readonly remediation?: string;\n\n  constructor(\n    message: string,\n    role: string,\n    phase: 'navigation' | 'credentials' | 'mfa' | 'callback',\n    idpResponse?: string,\n    remediation?: string\n  ) {\n    super(message);\n    this.name = 'ARTKAuthError';\n    this.role = role;\n    this.phase = phase;\n    this.idpResponse = idpResponse;\n    this.remediation = remediation;\n\n    // Maintain proper stack trace for where error was thrown (V8 only)\n    if (Error.captureStackTrace) {\n      Error.captureStackTrace(this, ARTKAuthError);\n    }\n  }\n\n  /**\n   * Format error as a human-readable string with context\n   */\n  public override toString(): string {\n    let result = `${this.name}: ${this.message}\\n`;\n    result += `  Role: ${this.role}\\n`;\n    result += `  Phase: ${this.phase}`;\n\n    if (this.idpResponse) {\n      result += `\\n  IdP Response: ${this.idpResponse}`;\n    }\n\n    if (this.remediation) {\n      result += `\\n  Remediation: ${this.remediation}`;\n    }\n\n    return result;\n  }\n}\n","/**\n * Credential management for ARTK Auth\n *\n * Provides secure credential loading from environment variables.\n *\n * FR-011: System MUST read credentials from environment variables (never hardcoded)\n *\n * @module auth/credentials\n * @example\n * ```typescript\n * import { getCredentials } from './credentials.js';\n *\n * // Given config: roles.admin.credentialsEnv = { username: 'ADMIN_USER', password: 'ADMIN_PASS' }\n * const creds = getCredentials('admin', config);\n * // Returns: { username: process.env.ADMIN_USER, password: process.env.ADMIN_PASS }\n * ```\n */\n\nimport type { Credentials } from './types.js';\nimport type { AuthConfig, RoleConfig } from '../config/types.js';\nimport { ARTKAuthError } from '../errors/auth-error.js';\nimport { createLogger } from '../utils/logger.js';\n\nconst logger = createLogger('auth', 'credentials');\n\n// =============================================================================\n// Types\n// =============================================================================\n\n/**\n * Options for credential loading\n */\nexport interface GetCredentialsOptions {\n  /**\n   * Environment variables to read from\n   * @default process.env\n   */\n  readonly env?: Record<string, string | undefined>;\n\n  /**\n   * Whether to mask password in logs\n   * @default true\n   */\n  readonly maskPassword?: boolean;\n}\n\n// =============================================================================\n// Functions\n// =============================================================================\n\n/**\n * Get credentials for a role from environment variables\n *\n * Reads the environment variable names from the role configuration\n * and returns the actual credential values from the environment.\n *\n * @param role - Role name as defined in config (e.g., 'admin', 'standardUser')\n * @param authConfig - Authentication configuration containing role definitions\n * @param options - Optional configuration\n * @returns Credentials object with username and password\n * @throws ARTKAuthError if role is not found or env vars are not set\n *\n * @example\n * ```typescript\n * // Config defines:\n * // auth.roles.admin.credentialsEnv = { username: 'ADMIN_USER', password: 'ADMIN_PASS' }\n *\n * // Environment has:\n * // ADMIN_USER=admin@example.com\n * // ADMIN_PASS=secret123\n *\n * const creds = getCredentials('admin', authConfig);\n * // Returns: { username: 'admin@example.com', password: 'secret123' }\n * ```\n */\nexport function getCredentials(\n  role: string,\n  authConfig: AuthConfig,\n  options: GetCredentialsOptions = {}\n): Credentials {\n  const env = options.env ?? process.env;\n  const maskPassword = options.maskPassword ?? true;\n\n  logger.debug('Getting credentials for role', { role });\n\n  // Get role configuration\n  const roleConfig = authConfig.roles[role];\n  if (!roleConfig) {\n    const availableRoles = Object.keys(authConfig.roles).join(', ');\n    logger.error('Role not found in configuration', { role, availableRoles });\n    throw new ARTKAuthError(\n      `Role \"${role}\" not found in auth configuration. Available roles: ${availableRoles}`,\n      role,\n      'credentials',\n      undefined,\n      `Check that the role \"${role}\" is defined in auth.roles in your artk.config.yml`\n    );\n  }\n\n  // Get environment variable names\n  const { username: usernameEnvVar, password: passwordEnvVar } = roleConfig.credentialsEnv;\n\n  // Read username from environment\n  const username = env[usernameEnvVar];\n  if (!username) {\n    logger.error('Username environment variable not set', {\n      role,\n      envVar: usernameEnvVar,\n    });\n    throw new ARTKAuthError(\n      `Environment variable \"${usernameEnvVar}\" for role \"${role}\" username is not set`,\n      role,\n      'credentials',\n      undefined,\n      `Set the ${usernameEnvVar} environment variable with the username for the \"${role}\" role`\n    );\n  }\n\n  // Read password from environment\n  const password = env[passwordEnvVar];\n  if (!password) {\n    logger.error('Password environment variable not set', {\n      role,\n      envVar: passwordEnvVar,\n    });\n    throw new ARTKAuthError(\n      `Environment variable \"${passwordEnvVar}\" for role \"${role}\" password is not set`,\n      role,\n      'credentials',\n      undefined,\n      `Set the ${passwordEnvVar} environment variable with the password for the \"${role}\" role`\n    );\n  }\n\n  logger.info('Credentials loaded successfully', {\n    role,\n    username,\n    password: maskPassword ? '***' : password,\n  });\n\n  return { username, password };\n}\n\n/**\n * Get credentials for a role using role config directly\n *\n * Lower-level function that takes role config instead of full auth config.\n *\n * @param role - Role name for error messages\n * @param roleConfig - Role configuration with credentialsEnv\n * @param options - Optional configuration\n * @returns Credentials object\n * @throws ARTKAuthError if env vars are not set\n */\nexport function getCredentialsFromRoleConfig(\n  role: string,\n  roleConfig: RoleConfig,\n  options: GetCredentialsOptions = {}\n): Credentials {\n  const env = options.env ?? process.env;\n  const maskPassword = options.maskPassword ?? true;\n\n  const { username: usernameEnvVar, password: passwordEnvVar } = roleConfig.credentialsEnv;\n\n  const username = env[usernameEnvVar];\n  if (!username) {\n    throw new ARTKAuthError(\n      `Environment variable \"${usernameEnvVar}\" for role \"${role}\" username is not set`,\n      role,\n      'credentials',\n      undefined,\n      `Set the ${usernameEnvVar} environment variable`\n    );\n  }\n\n  const password = env[passwordEnvVar];\n  if (!password) {\n    throw new ARTKAuthError(\n      `Environment variable \"${passwordEnvVar}\" for role \"${role}\" password is not set`,\n      role,\n      'credentials',\n      undefined,\n      `Set the ${passwordEnvVar} environment variable`\n    );\n  }\n\n  logger.debug('Credentials loaded from role config', {\n    role,\n    username,\n    password: maskPassword ? '***' : password,\n  });\n\n  return { username, password };\n}\n\n/**\n * Validate that all required credentials are available for a set of roles\n *\n * Checks all roles without throwing, returns list of missing credentials.\n *\n * @param roles - Array of role names to validate\n * @param authConfig - Authentication configuration\n * @param env - Environment variables (defaults to process.env)\n * @returns Array of missing credential info (empty if all valid)\n *\n * @example\n * ```typescript\n * const missing = validateCredentials(['admin', 'user'], authConfig);\n * if (missing.length > 0) {\n *   console.error('Missing credentials:', missing);\n * }\n * ```\n */\nexport function validateCredentials(\n  roles: readonly string[],\n  authConfig: AuthConfig,\n  env: Record<string, string | undefined> = process.env\n): ReadonlyArray<MissingCredential> {\n  const missing: MissingCredential[] = [];\n\n  for (const role of roles) {\n    const roleConfig = authConfig.roles[role];\n    if (!roleConfig) {\n      missing.push({\n        role,\n        type: 'role',\n        message: `Role \"${role}\" not found in configuration`,\n      });\n      continue;\n    }\n\n    const { username: usernameEnvVar, password: passwordEnvVar } = roleConfig.credentialsEnv;\n\n    if (!env[usernameEnvVar]) {\n      missing.push({\n        role,\n        type: 'username',\n        envVar: usernameEnvVar,\n        message: `Environment variable \"${usernameEnvVar}\" not set`,\n      });\n    }\n\n    if (!env[passwordEnvVar]) {\n      missing.push({\n        role,\n        type: 'password',\n        envVar: passwordEnvVar,\n        message: `Environment variable \"${passwordEnvVar}\" not set`,\n      });\n    }\n  }\n\n  return missing;\n}\n\n/**\n * Information about missing credentials\n */\nexport interface MissingCredential {\n  /** Role name */\n  readonly role: string;\n\n  /** Type of missing item */\n  readonly type: 'role' | 'username' | 'password';\n\n  /** Environment variable name (if applicable) */\n  readonly envVar?: string;\n\n  /** Human-readable message */\n  readonly message: string;\n}\n\n/**\n * Create a formatted error message for missing credentials\n *\n * @param missing - Array of missing credentials from validateCredentials\n * @returns Formatted error message\n */\nexport function formatMissingCredentialsError(\n  missing: ReadonlyArray<MissingCredential>\n): string {\n  if (missing.length === 0) {\n    return '';\n  }\n\n  const lines: string[] = ['Missing credentials:'];\n\n  // Group by role\n  const byRole = new Map<string, MissingCredential[]>();\n  for (const m of missing) {\n    const existing = byRole.get(m.role) ?? [];\n    existing.push(m);\n    byRole.set(m.role, existing);\n  }\n\n  for (const [role, items] of byRole) {\n    lines.push(`  Role \"${role}\":`);\n    for (const item of items) {\n      if (item.type === 'role') {\n        lines.push(`    - ${item.message}`);\n      } else {\n        lines.push(`    - ${item.type}: ${item.envVar} (${item.message})`);\n      }\n    }\n  }\n\n  lines.push('');\n  lines.push('To fix, set the required environment variables:');\n\n  const envVars = missing\n    .filter((m) => m.envVar)\n    .map((m) => m.envVar);\n  const uniqueEnvVars = [...new Set(envVars)];\n\n  for (const envVar of uniqueEnvVars) {\n    lines.push(`  export ${envVar}=\"<value>\"`);\n  }\n\n  return lines.join('\\n');\n}\n\n/**\n * Check if credentials are available for a role (without throwing)\n *\n * @param role - Role name\n * @param authConfig - Auth configuration\n * @param env - Environment variables\n * @returns true if credentials are available\n */\nexport function hasCredentials(\n  role: string,\n  authConfig: AuthConfig,\n  env: Record<string, string | undefined> = process.env\n): boolean {\n  const roleConfig = authConfig.roles[role];\n  if (!roleConfig) {\n    return false;\n  }\n\n  const { username: usernameEnvVar, password: passwordEnvVar } = roleConfig.credentialsEnv;\n  return Boolean(env[usernameEnvVar]) && Boolean(env[passwordEnvVar]);\n}\n\n/**\n * Validate that credentials environment variables are set for all roles\n *\n * This function checks that all required environment variables for role credentials\n * are present at config load time, providing early failure with clear error messages.\n *\n * @param roles - Record of role configurations from auth config\n * @param env - Environment variables to check (defaults to process.env)\n * @throws ARTKAuthError if any required environment variables are missing\n *\n * @example\n * ```typescript\n * // Validate all roles from config\n * validateCredentialsConfig(config.auth.roles);\n *\n * // Skip validation (for dry-run scenarios)\n * // Don't call this function\n * ```\n */\nexport function validateCredentialsConfig(\n  roles: Record<string, RoleConfig>,\n  env: Record<string, string | undefined> = process.env\n): void {\n  const missingVars: string[] = [];\n\n  for (const [roleName, roleConfig] of Object.entries(roles)) {\n    const { username, password } = roleConfig.credentialsEnv;\n\n    if (!env[username]) {\n      missingVars.push(`${username} (for role '${roleName}')`);\n    }\n    if (!env[password]) {\n      missingVars.push(`${password} (for role '${roleName}')`);\n    }\n  }\n\n  if (missingVars.length > 0) {\n    throw new ARTKAuthError(\n      `Missing required environment variables:\\n` +\n      missingVars.map(v => `  - ${v}`).join('\\n') +\n      `\\n\\nSet these variables before running tests.`,\n      'credentials',\n      'credentials',\n      undefined,\n      'Export the missing environment variables or set them in your .env file'\n    );\n  }\n\n  logger.debug('All credential environment variables validated', {\n    roleCount: Object.keys(roles).length,\n  });\n}\n","/**\n * Environment variable resolver for ARTK configuration\n *\n * Supports resolving environment variables in configuration values using:\n * - ${VAR_NAME} - Simple variable reference (throws if undefined)\n * - ${VAR_NAME:-default} - Variable with default value\n *\n * This implements FR-003: Resolve env vars using ${VAR_NAME} and ${VAR_NAME:-default} syntax\n *\n * @module config/env\n */\n\nimport { ARTKConfigError } from '../errors/config-error.js';\nimport { createLogger } from '../utils/logger.js';\n\nconst logger = createLogger('config', 'envResolver');\n\n/**\n * Regular expression to match environment variable patterns:\n * - ${VAR_NAME} - Simple reference\n * - ${VAR_NAME:-default} - With default value\n *\n * Groups:\n * - Group 1: Variable name\n * - Group 2: Default value (optional, includes the leading :-)\n *\n * Note: We don't use a global constant regex here because global regexes\n * maintain state (lastIndex) which can cause issues with repeated calls.\n */\n\n/**\n * Error thrown when a required environment variable is not defined\n */\nexport class EnvVarNotFoundError extends Error {\n  constructor(\n    public readonly varName: string,\n    public readonly fieldPath?: string\n  ) {\n    super(`Environment variable \"${varName}\" is not defined`);\n    this.name = 'EnvVarNotFoundError';\n\n    if (Error.captureStackTrace) {\n      Error.captureStackTrace(this, EnvVarNotFoundError);\n    }\n  }\n}\n\n/**\n * Result of parsing an environment variable reference\n */\nexport interface EnvVarRef {\n  /** Original match (e.g., \"${VAR_NAME:-default}\") */\n  readonly match: string;\n\n  /** Variable name */\n  readonly varName: string;\n\n  /** Default value if specified */\n  readonly defaultValue?: string;\n\n  /** Whether a default value was specified */\n  readonly hasDefault: boolean;\n}\n\n/**\n * Parse an environment variable reference string\n *\n * @param ref - The reference string (e.g., \"${VAR_NAME:-default}\")\n * @returns Parsed reference or undefined if not a valid env var reference\n *\n * @example\n * ```typescript\n * parseEnvVarRef(\"${BASE_URL}\")\n * // { match: \"${BASE_URL}\", varName: \"BASE_URL\", hasDefault: false }\n *\n * parseEnvVarRef(\"${PORT:-8080}\")\n * // { match: \"${PORT:-8080}\", varName: \"PORT\", defaultValue: \"8080\", hasDefault: true }\n * ```\n */\nexport function parseEnvVarRef(ref: string): EnvVarRef | undefined {\n  const singleMatch = /^\\$\\{([A-Z_][A-Z0-9_]*)(:-([^}]*))?\\}$/i.exec(ref);\n\n  if (!singleMatch) {\n    return undefined;\n  }\n\n  const varName = singleMatch[1];\n  const defaultValue = singleMatch[3];\n\n  if (varName === undefined) {\n    return undefined;\n  }\n\n  return {\n    match: ref,\n    varName,\n    defaultValue,\n    hasDefault: singleMatch[2] !== undefined,\n  };\n}\n\n/**\n * Find all environment variable references in a string\n *\n * @param value - String to search for env var references\n * @returns Array of parsed references\n *\n * @example\n * ```typescript\n * findEnvVarRefs(\"http://${HOST:-localhost}:${PORT}\")\n * // [\n * //   { match: \"${HOST:-localhost}\", varName: \"HOST\", defaultValue: \"localhost\", hasDefault: true },\n * //   { match: \"${PORT}\", varName: \"PORT\", hasDefault: false }\n * // ]\n * ```\n */\nexport function findEnvVarRefs(value: string): readonly EnvVarRef[] {\n  const refs: EnvVarRef[] = [];\n  const pattern = /\\$\\{([A-Z_][A-Z0-9_]*)(:-([^}]*))?\\}/gi;\n\n  let match: RegExpExecArray | null;\n  while ((match = pattern.exec(value)) !== null) {\n    const varName = match[1];\n\n    if (varName === undefined) {\n      continue;\n    }\n\n    refs.push({\n      match: match[0],\n      varName,\n      defaultValue: match[3],\n      hasDefault: match[2] !== undefined,\n    });\n  }\n\n  return refs;\n}\n\n/**\n * Options for resolving environment variables\n */\nexport interface ResolveOptions {\n  /**\n   * Field path for error messages (e.g., \"auth.oidc.loginUrl\")\n   */\n  fieldPath?: string;\n\n  /**\n   * Custom environment object (defaults to process.env)\n   */\n  env?: Record<string, string | undefined>;\n\n  /**\n   * Whether to throw on missing variables without defaults\n   * @default true\n   */\n  throwOnMissing?: boolean;\n}\n\n/**\n * Resolve a single environment variable reference\n *\n * @param ref - Parsed env var reference\n * @param options - Resolution options\n * @returns Resolved value\n * @throws EnvVarNotFoundError if variable is not defined and has no default\n *\n * @example\n * ```typescript\n * // With env: { PORT: \"3000\" }\n * resolveEnvVarRef({ varName: \"PORT\", hasDefault: false, match: \"${PORT}\" })\n * // \"3000\"\n *\n * // With env: {} (PORT not defined)\n * resolveEnvVarRef({ varName: \"PORT\", hasDefault: true, defaultValue: \"8080\", match: \"${PORT:-8080}\" })\n * // \"8080\"\n * ```\n */\nexport function resolveEnvVarRef(\n  ref: EnvVarRef,\n  options: ResolveOptions = {}\n): string {\n  const { env = process.env, fieldPath, throwOnMissing = true } = options;\n  const value = env[ref.varName];\n\n  if (value !== undefined && value !== '') {\n    logger.debug(`Resolved env var ${ref.varName}`, {\n      fieldPath,\n      hasValue: true,\n    });\n    return value;\n  }\n\n  if (ref.hasDefault && ref.defaultValue !== undefined) {\n    logger.debug(`Using default for ${ref.varName}`, {\n      fieldPath,\n      defaultValue: ref.defaultValue,\n    });\n    return ref.defaultValue;\n  }\n\n  if (throwOnMissing) {\n    throw new EnvVarNotFoundError(ref.varName, fieldPath);\n  }\n\n  return ref.match;\n}\n\n/**\n * Resolve all environment variable references in a string\n *\n * Replaces ${VAR_NAME} and ${VAR_NAME:-default} patterns with their values.\n *\n * @param value - String containing env var references\n * @param options - Resolution options\n * @returns String with all env vars resolved\n * @throws EnvVarNotFoundError if any variable is not defined and has no default\n *\n * @example\n * ```typescript\n * // With env: { HOST: \"api.example.com\", PORT: \"3000\" }\n * resolveEnvVars(\"https://${HOST}:${PORT:-8080}/api\")\n * // \"https://api.example.com:3000/api\"\n *\n * // With env: { HOST: \"api.example.com\" }\n * resolveEnvVars(\"https://${HOST}:${PORT:-8080}/api\")\n * // \"https://api.example.com:8080/api\"\n * ```\n */\nexport function resolveEnvVars(\n  value: string,\n  options: ResolveOptions = {}\n): string {\n  const refs = findEnvVarRefs(value);\n\n  if (refs.length === 0) {\n    return value;\n  }\n\n  let result = value;\n\n  for (const ref of refs) {\n    const resolved = resolveEnvVarRef(ref, options);\n    result = result.replace(ref.match, resolved);\n  }\n\n  return result;\n}\n\n/**\n * Check if a string contains environment variable references\n *\n * @param value - String to check\n * @returns True if the string contains env var references\n *\n * @example\n * ```typescript\n * hasEnvVarRefs(\"${BASE_URL}/api\")  // true\n * hasEnvVarRefs(\"https://example.com\")  // false\n * ```\n */\nexport function hasEnvVarRefs(value: string): boolean {\n  // Create a new regex to avoid global state issues with lastIndex\n  const pattern = /\\$\\{[A-Z_][A-Z0-9_]*(:-[^}]*)?\\}/i;\n  return pattern.test(value);\n}\n\n/**\n * Recursively resolve environment variables in an object\n *\n * Walks through all string values in an object (including nested objects\n * and arrays) and resolves environment variable references.\n *\n * @param obj - Object to resolve\n * @param options - Resolution options\n * @param currentPath - Current path in the object (for error messages)\n * @returns New object with all env vars resolved\n *\n * @example\n * ```typescript\n * // With env: { DB_HOST: \"localhost\", DB_PORT: \"5432\" }\n * resolveEnvVarsInObject({\n *   database: {\n *     host: \"${DB_HOST}\",\n *     port: \"${DB_PORT:-5432}\"\n *   }\n * })\n * // {\n * //   database: {\n * //     host: \"localhost\",\n * //     port: \"5432\"\n * //   }\n * // }\n * ```\n */\nexport function resolveEnvVarsInObject<T>(\n  obj: T,\n  options: ResolveOptions = {},\n  currentPath: string = ''\n): T {\n  if (obj === null || obj === undefined) {\n    return obj;\n  }\n\n  if (typeof obj === 'string') {\n    return resolveEnvVars(obj, {\n      ...options,\n      fieldPath: currentPath || options.fieldPath,\n    }) as T;\n  }\n\n  if (Array.isArray(obj)) {\n    const resolved: unknown[] = obj.map((item: unknown, index: number) =>\n      resolveEnvVarsInObject(item, options, `${currentPath}[${index}]`)\n    );\n    return resolved as T;\n  }\n\n  if (typeof obj === 'object') {\n    const result: Record<string, unknown> = {};\n\n    for (const [key, value] of Object.entries(obj as Record<string, unknown>)) {\n      const path = currentPath ? `${currentPath}.${key}` : key;\n      result[key] = resolveEnvVarsInObject(value, options, path);\n    }\n\n    return result as T;\n  }\n\n  return obj;\n}\n\n/**\n * Get all missing environment variables from a string or object\n *\n * Useful for validation before attempting to load configuration.\n *\n * @param value - String or object to check\n * @param env - Environment object (defaults to process.env)\n * @returns Array of missing variable names with their field paths\n *\n * @example\n * ```typescript\n * // With env: { DB_HOST: \"localhost\" } (DB_PORT not defined)\n * getMissingEnvVars({\n *   host: \"${DB_HOST}\",\n *   port: \"${DB_PORT}\"  // No default\n * })\n * // [{ varName: \"DB_PORT\", fieldPath: \"port\" }]\n * ```\n */\nexport function getMissingEnvVars(\n  value: unknown,\n  env: Record<string, string | undefined> = process.env\n): readonly { varName: string; fieldPath: string }[] {\n  const missing: { varName: string; fieldPath: string }[] = [];\n\n  function check(val: unknown, path: string): void {\n    if (typeof val === 'string') {\n      const refs = findEnvVarRefs(val);\n      for (const ref of refs) {\n        if (!ref.hasDefault && (env[ref.varName] === undefined || env[ref.varName] === '')) {\n          missing.push({ varName: ref.varName, fieldPath: path });\n        }\n      }\n    } else if (Array.isArray(val)) {\n      val.forEach((item, index) => check(item, `${path}[${index}]`));\n    } else if (val !== null && typeof val === 'object') {\n      for (const [key, childVal] of Object.entries(val)) {\n        check(childVal, path ? `${path}.${key}` : key);\n      }\n    }\n  }\n\n  check(value, '');\n  return missing;\n}\n\n/**\n * Convert missing env vars to ARTKConfigError\n *\n * @param missing - Array of missing variables\n * @returns ARTKConfigError with details\n */\nexport function createMissingEnvVarsError(\n  missing: readonly { varName: string; fieldPath: string }[]\n): ARTKConfigError {\n  const varNames = [...new Set(missing.map((m) => m.varName))];\n  const fieldPaths = missing.map((m) => m.fieldPath);\n\n  const firstMissing = missing[0];\n  const message =\n    missing.length === 1 && firstMissing\n      ? `Missing required environment variable: ${firstMissing.varName}`\n      : `Missing required environment variables: ${varNames.join(', ')}`;\n\n  const suggestion =\n    missing.length === 1 && firstMissing\n      ? `Set the ${firstMissing.varName} environment variable or provide a default value using \\${${firstMissing.varName}:-default}`\n      : `Set these environment variables or provide default values using \\${VAR:-default} syntax`;\n\n  return new ARTKConfigError(message, fieldPaths.join(', '), suggestion);\n}\n","/**\n * Centralized timeout constants\n *\n * All timeout values used throughout ARTK Core are defined here\n * for easy auditing and global adjustments.\n *\n * @module config/timeouts\n */\n\n/**\n * Timeout constants in milliseconds\n */\nexport const TIMEOUTS = {\n  // =============================================================================\n  // Authentication Timeouts\n  // =============================================================================\n\n  /** Navigation timeout for auth pages */\n  AUTH_NAVIGATION_MS: 30000,\n\n  /** Timeout for submitting credentials */\n  AUTH_SUBMIT_MS: 10000,\n\n  /** Timeout for detecting successful authentication */\n  AUTH_SUCCESS_MS: 5000,\n\n  /** Timeout for MFA push notification approval */\n  AUTH_MFA_PUSH_MS: 60000,\n\n  /** Total timeout for complete login flow */\n  AUTH_LOGIN_FLOW_MS: 30000,\n\n  /** Timeout for IdP redirect */\n  AUTH_IDP_REDIRECT_MS: 10000,\n\n  /** Timeout for OAuth callback processing */\n  AUTH_CALLBACK_MS: 5000,\n\n  // =============================================================================\n  // OIDC Specific Timeouts\n  // =============================================================================\n\n  /** Timeout for OIDC success URL detection */\n  OIDC_SUCCESS_MS: 5000,\n\n  // =============================================================================\n  // Assertion Timeouts\n  // =============================================================================\n\n  /** Default timeout for toast notifications */\n  TOAST_DEFAULT_MS: 5000,\n\n  /** Default timeout for loading indicators */\n  LOADING_DEFAULT_MS: 30000,\n\n  /** Default timeout for form validation */\n  FORM_VALIDATION_MS: 5000,\n\n  // =============================================================================\n  // API Timeouts\n  // =============================================================================\n\n  /** Timeout for API requests */\n  API_REQUEST_MS: 30000,\n\n  /** Timeout for acquiring tokens */\n  TOKEN_ACQUIRE_MS: 10000,\n} as const;\n\n/**\n * Type-safe timeout keys\n */\nexport type TimeoutKey = keyof typeof TIMEOUTS;\n\n/**\n * Get timeout value by key\n *\n * @param key - Timeout constant key\n * @returns Timeout value in milliseconds\n *\n * @example\n * ```typescript\n * const timeout = getTimeout('AUTH_LOGIN_FLOW_MS');\n * await page.waitForURL('/dashboard', { timeout });\n * ```\n */\nexport function getTimeout(key: TimeoutKey): number {\n  return TIMEOUTS[key];\n}\n","/**\n * Default values for optional configuration fields\n *\n * These defaults are applied when fields are not explicitly specified\n * in the artk.config.yml file.\n *\n * @module config/defaults\n */\n\nimport type {\n  AppType,\n  ArtifactsConfig,\n  AssertionsConfig,\n  BrowsersConfig,\n  CaptureMode,\n  DataConfig,\n  JourneysConfig,\n  LocatorStrategy,\n  MFAType,\n  ReporterOpenMode,\n  ReportersConfig,\n  ScreenshotMode,\n  SelectorsConfig,\n  StorageStateConfig,\n  TierConfig,\n} from './types.js';\nimport { TIMEOUTS } from './timeouts.js';\n\n// =============================================================================\n// Application Defaults\n// =============================================================================\n\n/** Default application type */\nexport const DEFAULT_APP_TYPE: AppType = 'spa';\n\n// =============================================================================\n// Storage State Defaults\n// =============================================================================\n\n/** Default storage state configuration */\nexport const DEFAULT_STORAGE_STATE: StorageStateConfig = {\n  directory: '.auth-states',\n  maxAgeMinutes: 60,\n  filePattern: '{role}.json',\n} as const;\n\n// =============================================================================\n// OIDC Defaults\n// =============================================================================\n\n/** Default OIDC success timeout in ms */\nexport const DEFAULT_OIDC_SUCCESS_TIMEOUT = TIMEOUTS.OIDC_SUCCESS_MS;\n\n/** Default MFA type */\nexport const DEFAULT_MFA_TYPE: MFAType = 'none';\n\n/** Default MFA enabled state */\nexport const DEFAULT_MFA_ENABLED = false;\n\n/** Default push timeout in ms */\nexport const DEFAULT_PUSH_TIMEOUT_MS = TIMEOUTS.AUTH_MFA_PUSH_MS;\n\n/** Default OIDC login flow timeout in ms */\nexport const DEFAULT_LOGIN_FLOW_MS = TIMEOUTS.AUTH_LOGIN_FLOW_MS;\n\n/** Default IdP redirect timeout in ms */\nexport const DEFAULT_IDP_REDIRECT_MS = TIMEOUTS.AUTH_IDP_REDIRECT_MS;\n\n/** Default callback timeout in ms */\nexport const DEFAULT_CALLBACK_MS = TIMEOUTS.AUTH_CALLBACK_MS;\n\n// =============================================================================\n// Selectors Defaults\n// =============================================================================\n\n/** Default locator strategy order */\nexport const DEFAULT_LOCATOR_STRATEGY: readonly LocatorStrategy[] = [\n  'role',\n  'label',\n  'placeholder',\n  'testid',\n  'text',\n  'css',\n] as const;\n\n/** Default test ID attribute */\nexport const DEFAULT_TEST_ID_ATTRIBUTE = 'data-testid';\n\n/** Default selectors configuration */\nexport const DEFAULT_SELECTORS: SelectorsConfig = {\n  testIdAttribute: DEFAULT_TEST_ID_ATTRIBUTE,\n  strategy: DEFAULT_LOCATOR_STRATEGY,\n} as const;\n\n// =============================================================================\n// Assertions Defaults\n// =============================================================================\n\n/** Default toast timeout in ms */\nexport const DEFAULT_TOAST_TIMEOUT = TIMEOUTS.TOAST_DEFAULT_MS;\n\n/** Default loading timeout in ms */\nexport const DEFAULT_LOADING_TIMEOUT = TIMEOUTS.LOADING_DEFAULT_MS;\n\n/** Default assertions configuration */\nexport const DEFAULT_ASSERTIONS: AssertionsConfig = {\n  toast: {\n    containerSelector: '[role=\"alert\"], .toast, .notification',\n    messageSelector: '.toast-message, .notification-message',\n    typeAttribute: 'data-type',\n    timeout: DEFAULT_TOAST_TIMEOUT,\n  },\n  loading: {\n    selectors: ['.loading', '.spinner', '[data-loading=\"true\"]'],\n    timeout: DEFAULT_LOADING_TIMEOUT,\n  },\n  form: {\n    errorSelector: '[data-error=\"{field}\"], .field-error[data-field=\"{field}\"]',\n    formErrorSelector: '.form-error, [role=\"alert\"].form-error',\n  },\n};\n\n// =============================================================================\n// Data Defaults\n// =============================================================================\n\n/** Default namespace prefix */\nexport const DEFAULT_NAMESPACE_PREFIX = '[artk-';\n\n/** Default namespace suffix */\nexport const DEFAULT_NAMESPACE_SUFFIX = ']';\n\n/** Default data configuration */\nexport const DEFAULT_DATA: DataConfig = {\n  namespace: {\n    prefix: DEFAULT_NAMESPACE_PREFIX,\n    suffix: DEFAULT_NAMESPACE_SUFFIX,\n  },\n  cleanup: {\n    enabled: true,\n    onFailure: true,\n    parallel: false,\n  },\n} as const;\n\n// =============================================================================\n// Tier Defaults\n// =============================================================================\n\n/** Default tier configurations */\nexport const DEFAULT_TIERS: Readonly<Record<string, TierConfig>> = {\n  smoke: {\n    retries: 0,\n    workers: 1,\n    timeout: 30000,\n    tag: '@smoke',\n  },\n  release: {\n    retries: 1,\n    workers: 2,\n    timeout: 60000,\n    tag: '@release',\n  },\n  regression: {\n    retries: 2,\n    workers: 4,\n    timeout: 120000,\n    tag: '@regression',\n  },\n} as const;\n\n// =============================================================================\n// Reporters Defaults\n// =============================================================================\n\n/** Default reporter open mode */\nexport const DEFAULT_REPORTER_OPEN: ReporterOpenMode = 'on-failure';\n\n/** Default reporters configuration */\nexport const DEFAULT_REPORTERS: ReportersConfig = {\n  html: {\n    enabled: true,\n    outputFolder: 'playwright-report',\n    open: DEFAULT_REPORTER_OPEN,\n  },\n  json: {\n    enabled: false,\n    outputFile: 'test-results.json',\n  },\n  junit: {\n    enabled: false,\n    outputFile: 'junit.xml',\n  },\n  artk: {\n    enabled: true,\n    outputFile: 'artk-report.json',\n    includeJourneyMapping: true,\n  },\n} as const;\n\n// =============================================================================\n// Artifacts Defaults\n// =============================================================================\n\n/** Default screenshot mode */\nexport const DEFAULT_SCREENSHOT_MODE: ScreenshotMode = 'only-on-failure';\n\n/** Default video/trace capture mode */\nexport const DEFAULT_CAPTURE_MODE: CaptureMode = 'retain-on-failure';\n\n/** Default artifacts configuration */\nexport const DEFAULT_ARTIFACTS: ArtifactsConfig = {\n  outputDir: 'test-results',\n  screenshots: {\n    mode: DEFAULT_SCREENSHOT_MODE,\n    fullPage: true,\n    maskPii: false,\n    piiSelectors: [\n      // Common PII input patterns\n      'input[type=\"password\"]',\n      'input[name*=\"ssn\"]',\n      'input[name*=\"social\"]',\n      'input[name*=\"credit\"]',\n      'input[name*=\"card\"]',\n      'input[name*=\"cvv\"]',\n      'input[name*=\"account\"]',\n      'input[autocomplete=\"cc-number\"]',\n      'input[autocomplete=\"cc-csc\"]',\n      // Data attribute markers\n      '[data-pii]',\n      '[data-sensitive]',\n      '[data-mask]',\n      // Common class patterns\n      '.pii-field',\n      '.sensitive-data',\n    ],\n  },\n  video: {\n    mode: DEFAULT_CAPTURE_MODE,\n  },\n  trace: {\n    mode: DEFAULT_CAPTURE_MODE,\n    screenshots: true,\n    snapshots: true,\n  },\n};\n\n// =============================================================================\n// Browsers Defaults\n// =============================================================================\n\n/** Default viewport width */\nexport const DEFAULT_VIEWPORT_WIDTH = 1280;\n\n/** Default viewport height */\nexport const DEFAULT_VIEWPORT_HEIGHT = 720;\n\n/** Default browsers configuration */\nexport const DEFAULT_BROWSERS: BrowsersConfig = {\n  enabled: ['chromium'],\n  channel: 'bundled',\n  strategy: 'auto',\n  viewport: {\n    width: DEFAULT_VIEWPORT_WIDTH,\n    height: DEFAULT_VIEWPORT_HEIGHT,\n  },\n  headless: true,\n};\n\n// =============================================================================\n// Journeys Defaults\n// =============================================================================\n\n/** Default journey ID prefix */\nexport const DEFAULT_JOURNEY_ID_PREFIX = 'JRN';\n\n/** Default journey ID width */\nexport const DEFAULT_JOURNEY_ID_WIDTH = 4;\n\n/** Default journeys configuration */\nexport const DEFAULT_JOURNEYS: JourneysConfig = {\n  id: {\n    prefix: DEFAULT_JOURNEY_ID_PREFIX,\n    width: DEFAULT_JOURNEY_ID_WIDTH,\n  },\n  layout: 'flat',\n  backlog: {\n    groupBy: 'tier',\n  },\n} as const;\n\n// =============================================================================\n// Config Version\n// =============================================================================\n\n/** Supported configuration schema version */\nexport const SUPPORTED_CONFIG_VERSION = 1;\n","/**\n * Zod validation schemas for ARTK configuration\n *\n * Provides runtime type checking and validation for configuration loaded\n * from artk.config.yml. All validation errors include field paths for\n * easy debugging (FR-002).\n *\n * @module config/schema\n */\n\nimport { z } from 'zod';\nimport {\n  DEFAULT_APP_TYPE,\n  DEFAULT_ARTIFACTS,\n  DEFAULT_ASSERTIONS,\n  DEFAULT_BROWSERS,\n  DEFAULT_CALLBACK_MS,\n  DEFAULT_CAPTURE_MODE,\n  DEFAULT_DATA,\n  DEFAULT_IDP_REDIRECT_MS,\n  DEFAULT_JOURNEYS,\n  DEFAULT_LOADING_TIMEOUT,\n  DEFAULT_LOCATOR_STRATEGY,\n  DEFAULT_LOGIN_FLOW_MS,\n  DEFAULT_MFA_ENABLED,\n  DEFAULT_MFA_TYPE,\n  DEFAULT_OIDC_SUCCESS_TIMEOUT,\n  DEFAULT_PUSH_TIMEOUT_MS,\n  DEFAULT_REPORTER_OPEN,\n  DEFAULT_REPORTERS,\n  DEFAULT_SCREENSHOT_MODE,\n  DEFAULT_STORAGE_STATE,\n  DEFAULT_TEST_ID_ATTRIBUTE,\n  DEFAULT_TIERS,\n  DEFAULT_TOAST_TIMEOUT,\n  SUPPORTED_CONFIG_VERSION,\n} from './defaults.js';\n\n// =============================================================================\n// Version Constants\n// =============================================================================\n\n/**\n * Current configuration version\n *\n * Used for schema migration. When breaking changes are made to the config\n * schema, this version is incremented and a migration is added to migrate.ts.\n */\nexport const CURRENT_CONFIG_VERSION = SUPPORTED_CONFIG_VERSION;\n\n// =============================================================================\n// Primitive Schemas\n// =============================================================================\n\n/** Non-empty string */\nconst nonEmptyString = z.string().min(1, 'Must not be empty');\n\n/** Positive integer */\nconst positiveInt = z.number().int().positive();\n\n/** Non-negative integer */\nconst nonNegativeInt = z.number().int().nonnegative();\n\n/** Positive number */\nconst positiveNumber = z.number().positive();\n\n// =============================================================================\n// Application Schemas\n// =============================================================================\n\n/** Application type schema */\nconst AppTypeSchema = z.enum(['spa', 'ssr', 'hybrid']);\n\n/** Application configuration schema */\nexport const AppConfigSchema = z.object({\n  name: nonEmptyString.describe('Application name'),\n  baseUrl: nonEmptyString.describe('Base URL with env var support'),\n  type: AppTypeSchema.default(DEFAULT_APP_TYPE),\n});\n\n// =============================================================================\n// Environment Schemas\n// =============================================================================\n\n/** Environment configuration schema */\nexport const EnvironmentConfigSchema = z.object({\n  baseUrl: nonEmptyString.describe('Environment base URL'),\n  apiUrl: z.string().optional(),\n});\n\n/** Environments record schema */\nexport const EnvironmentsSchema = z.record(z.string(), EnvironmentConfigSchema);\n\n// =============================================================================\n// Storage State Schemas\n// =============================================================================\n\n/** Storage state configuration schema */\nexport const StorageStateConfigSchema = z.object({\n  directory: z.string().default(DEFAULT_STORAGE_STATE.directory),\n  maxAgeMinutes: positiveNumber.default(DEFAULT_STORAGE_STATE.maxAgeMinutes),\n  filePattern: nonEmptyString.default(DEFAULT_STORAGE_STATE.filePattern),\n});\n\n// =============================================================================\n// Credentials Schemas\n// =============================================================================\n\n/** Credentials environment variable schema */\nexport const CredentialsEnvConfigSchema = z.object({\n  username: nonEmptyString.describe('Env var name for username'),\n  password: nonEmptyString.describe('Env var name for password'),\n});\n\n// =============================================================================\n// OIDC Schemas\n// =============================================================================\n\n/** OIDC IdP type schema */\nconst OIDCIdpTypeSchema = z.enum([\n  'keycloak',\n  'azure-ad',\n  'okta',\n  'auth0',\n  'generic',\n]);\n\n/** MFA type schema */\nconst MFATypeSchema = z.enum(['totp', 'push', 'sms', 'none']);\n\n/** OIDC success configuration schema */\nexport const OIDCSuccessConfigSchema = z\n  .object({\n    url: z.string().optional(),\n    selector: z.string().optional(),\n    timeout: positiveInt.default(DEFAULT_OIDC_SUCCESS_TIMEOUT),\n  })\n  .refine((data) => data.url !== undefined || data.selector !== undefined, {\n    message: 'Either success.url or success.selector is required',\n  });\n\n/** OIDC IdP selectors schema */\nexport const OIDCIdpSelectorsSchema = z\n  .object({\n    username: z.string().optional(),\n    password: z.string().optional(),\n    submit: z.string().optional(),\n    staySignedInNo: z.string().optional(),\n  })\n  .optional();\n\n/** MFA configuration schema */\nexport const MFAConfigSchema = z\n  .object({\n    enabled: z.boolean().default(DEFAULT_MFA_ENABLED),\n    type: MFATypeSchema.default(DEFAULT_MFA_TYPE),\n    totpSecretEnv: z.string().optional(),\n    pushTimeoutMs: positiveInt.default(DEFAULT_PUSH_TIMEOUT_MS),\n  })\n  .optional();\n\n/** OIDC timeouts schema */\nexport const OIDCTimeoutsSchema = z\n  .object({\n    loginFlowMs: positiveInt.default(DEFAULT_LOGIN_FLOW_MS),\n    idpRedirectMs: positiveInt.default(DEFAULT_IDP_REDIRECT_MS),\n    callbackMs: positiveInt.default(DEFAULT_CALLBACK_MS),\n  })\n  .optional();\n\n/** OIDC logout schema */\nexport const OIDCLogoutConfigSchema = z\n  .object({\n    url: z.string().optional(),\n    idpLogout: z.boolean().optional(),\n  })\n  .optional();\n\n/** OIDC configuration schema */\nexport const OIDCConfigSchema = z\n  .object({\n    idpType: OIDCIdpTypeSchema,\n    loginUrl: nonEmptyString.describe('Login initiation URL'),\n    idpLoginUrl: z.string().optional(),\n    success: OIDCSuccessConfigSchema,\n    idpSelectors: OIDCIdpSelectorsSchema,\n    mfa: MFAConfigSchema,\n    timeouts: OIDCTimeoutsSchema,\n    logout: OIDCLogoutConfigSchema,\n  })\n  .optional();\n\n// =============================================================================\n// Form Auth Schemas\n// =============================================================================\n\n/** Form auth selectors schema */\nexport const FormAuthSelectorsSchema = z.object({\n  username: nonEmptyString,\n  password: nonEmptyString,\n  submit: nonEmptyString,\n});\n\n/** Form auth success schema */\nexport const FormAuthSuccessConfigSchema = z.object({\n  url: z.string().optional(),\n  selector: z.string().optional(),\n});\n\n/** Form auth configuration schema */\nexport const FormAuthConfigSchema = z\n  .object({\n    loginUrl: nonEmptyString,\n    selectors: FormAuthSelectorsSchema,\n    success: FormAuthSuccessConfigSchema,\n  })\n  .optional();\n\n// =============================================================================\n// Role Schemas\n// =============================================================================\n\n/** Role configuration schema */\nexport const RoleConfigSchema = z.object({\n  credentialsEnv: CredentialsEnvConfigSchema,\n  description: z.string().optional(),\n  oidcOverrides: OIDCConfigSchema.optional(),\n});\n\n/** Roles record schema */\nexport const RolesSchema = z.record(z.string(), RoleConfigSchema);\n\n// =============================================================================\n// Auth Schemas\n// =============================================================================\n\n/** Auth provider type schema */\nconst AuthProviderTypeSchema = z.enum(['oidc', 'form', 'token', 'custom']);\n\n/** Auth bypass mode schema */\nconst AuthBypassModeSchema = z.enum([\n  'none',\n  'identityless',\n  'mock-identity',\n  'unknown',\n]);\n\n/** Auth bypass configuration schema */\nexport const AuthBypassConfigSchema = z.object({\n  mode: AuthBypassModeSchema.default('unknown'),\n  toggle: z.string().optional(),\n  environments: z.array(z.string()).optional(),\n});\n\n/** Auth configuration schema with provider-specific validation */\nexport const AuthConfigSchema = z\n  .object({\n    provider: AuthProviderTypeSchema,\n    storageState: StorageStateConfigSchema.default(DEFAULT_STORAGE_STATE),\n    roles: RolesSchema.refine((roles) => Object.keys(roles).length > 0, {\n      message: 'At least one role must be defined',\n    }),\n    bypass: AuthBypassConfigSchema.optional(),\n    oidc: OIDCConfigSchema,\n    form: FormAuthConfigSchema,\n  })\n  .superRefine((data, ctx) => {\n    // Validate provider-specific configuration\n    if (data.provider === 'oidc' && data.oidc === undefined) {\n      ctx.addIssue({\n        code: z.ZodIssueCode.custom,\n        message: 'OIDC configuration is required when provider is \"oidc\"',\n        path: ['oidc'],\n      });\n    }\n    if (data.provider === 'form' && data.form === undefined) {\n      ctx.addIssue({\n        code: z.ZodIssueCode.custom,\n        message: 'Form configuration is required when provider is \"form\"',\n        path: ['form'],\n      });\n    }\n  });\n\n// =============================================================================\n// Selectors Schemas\n// =============================================================================\n\n/** Locator strategy schema */\nconst LocatorStrategySchema = z.enum([\n  'role',\n  'label',\n  'placeholder',\n  'testid',\n  'text',\n  'css',\n]);\n\n/** Selectors configuration schema */\nexport const SelectorsConfigSchema = z.object({\n  testIdAttribute: z.string().default(DEFAULT_TEST_ID_ATTRIBUTE),\n  strategy: z.array(LocatorStrategySchema).default([...DEFAULT_LOCATOR_STRATEGY]),\n  customTestIds: z.array(z.string()).optional(),\n});\n\n// =============================================================================\n// Assertions Schemas\n// =============================================================================\n\n/** Toast assertion schema */\nexport const ToastAssertionConfigSchema = z.object({\n  containerSelector: nonEmptyString,\n  messageSelector: nonEmptyString,\n  typeAttribute: nonEmptyString,\n  timeout: positiveInt.default(DEFAULT_TOAST_TIMEOUT),\n});\n\n/** Loading assertion schema */\nexport const LoadingAssertionConfigSchema = z.object({\n  selectors: z.array(nonEmptyString).min(1, 'At least one loading selector required'),\n  timeout: positiveInt.default(DEFAULT_LOADING_TIMEOUT),\n});\n\n/** Form assertion schema */\nexport const FormAssertionConfigSchema = z.object({\n  errorSelector: nonEmptyString,\n  formErrorSelector: nonEmptyString,\n});\n\n/** Assertions configuration schema */\nexport const AssertionsConfigSchema = z.object({\n  toast: ToastAssertionConfigSchema.default(DEFAULT_ASSERTIONS.toast),\n  loading: LoadingAssertionConfigSchema.default(DEFAULT_ASSERTIONS.loading),\n  form: FormAssertionConfigSchema.default(DEFAULT_ASSERTIONS.form),\n});\n\n// =============================================================================\n// Data Schemas\n// =============================================================================\n\n/** Namespace configuration schema */\nexport const NamespaceConfigSchema = z.object({\n  prefix: z.string().default(DEFAULT_DATA.namespace.prefix),\n  suffix: z.string().default(DEFAULT_DATA.namespace.suffix),\n});\n\n/** Cleanup configuration schema */\nexport const CleanupConfigSchema = z.object({\n  enabled: z.boolean().default(DEFAULT_DATA.cleanup.enabled),\n  onFailure: z.boolean().default(DEFAULT_DATA.cleanup.onFailure),\n  parallel: z.boolean().default(DEFAULT_DATA.cleanup.parallel),\n});\n\n/** Data API configuration schema */\nexport const DataApiConfigSchema = z\n  .object({\n    baseUrl: nonEmptyString,\n    useMainAuth: z.boolean().default(true),\n  })\n  .optional();\n\n/** Data configuration schema */\nexport const DataConfigSchema = z.object({\n  namespace: NamespaceConfigSchema.default(DEFAULT_DATA.namespace),\n  cleanup: CleanupConfigSchema.default(DEFAULT_DATA.cleanup),\n  api: DataApiConfigSchema,\n});\n\n// =============================================================================\n// Fixtures Schemas\n// =============================================================================\n\n/** Fixtures API configuration schema */\nexport const FixturesApiConfigSchema = z\n  .object({\n    baseURL: nonEmptyString,\n    extraHTTPHeaders: z.record(z.string(), z.string()).optional(),\n  })\n  .optional();\n\n/** Fixtures configuration schema */\nexport const FixturesConfigSchema = z.object({\n  defaultRole: nonEmptyString,\n  roleFixtures: z.array(nonEmptyString).default([]),\n  api: FixturesApiConfigSchema,\n});\n\n// =============================================================================\n// Tier Schemas\n// =============================================================================\n\n/** Tier configuration schema */\nexport const TierConfigSchema = z.object({\n  retries: nonNegativeInt,\n  workers: positiveInt,\n  timeout: positiveInt,\n  tag: nonEmptyString,\n});\n\n/** Tiers record schema */\nexport const TiersSchema = z.record(z.string(), TierConfigSchema);\n\n// =============================================================================\n// Reporters Schemas\n// =============================================================================\n\n/** Reporter open mode schema */\nconst ReporterOpenModeSchema = z.enum(['always', 'never', 'on-failure']);\n\n/** HTML reporter schema */\nexport const HtmlReporterConfigSchema = z\n  .object({\n    enabled: z.boolean().default(true),\n    outputFolder: z.string().default('playwright-report'),\n    open: ReporterOpenModeSchema.default(DEFAULT_REPORTER_OPEN),\n  })\n  .optional();\n\n/** JSON reporter schema */\nexport const JsonReporterConfigSchema = z\n  .object({\n    enabled: z.boolean().default(false),\n    outputFile: z.string().default('test-results.json'),\n  })\n  .optional();\n\n/** JUnit reporter schema */\nexport const JunitReporterConfigSchema = z\n  .object({\n    enabled: z.boolean().default(false),\n    outputFile: z.string().default('junit.xml'),\n  })\n  .optional();\n\n/** ARTK reporter schema */\nexport const ArtkReporterConfigSchema = z\n  .object({\n    enabled: z.boolean().default(true),\n    outputFile: z.string().default('artk-report.json'),\n    includeJourneyMapping: z.boolean().default(true),\n  })\n  .optional();\n\n/** Reporters configuration schema */\nexport const ReportersConfigSchema = z.object({\n  html: HtmlReporterConfigSchema,\n  json: JsonReporterConfigSchema,\n  junit: JunitReporterConfigSchema,\n  artk: ArtkReporterConfigSchema,\n});\n\n// =============================================================================\n// Artifacts Schemas\n// =============================================================================\n\n/** Screenshot mode schema */\nconst ScreenshotModeSchema = z.enum(['off', 'on', 'only-on-failure']);\n\n/** Capture mode schema */\nconst CaptureModeSchema = z.enum([\n  'off',\n  'on',\n  'retain-on-failure',\n  'on-first-retry',\n]);\n\n/** Video size schema */\nexport const VideoSizeSchema = z\n  .object({\n    width: positiveInt,\n    height: positiveInt,\n  })\n  .optional();\n\n/** Screenshots configuration schema */\nexport const ScreenshotsConfigSchema = z.object({\n  mode: ScreenshotModeSchema.default(DEFAULT_SCREENSHOT_MODE),\n  fullPage: z.boolean().default(DEFAULT_ARTIFACTS.screenshots.fullPage),\n  maskPii: z.boolean().default(DEFAULT_ARTIFACTS.screenshots.maskPii),\n  piiSelectors: z.array(z.string()).default([]),\n});\n\n/** Video configuration schema */\nexport const VideoConfigSchema = z.object({\n  mode: CaptureModeSchema.default(DEFAULT_CAPTURE_MODE),\n  size: VideoSizeSchema,\n});\n\n/** Trace configuration schema */\nexport const TraceConfigSchema = z.object({\n  mode: CaptureModeSchema.default(DEFAULT_CAPTURE_MODE),\n  screenshots: z.boolean().default(true),\n  snapshots: z.boolean().default(true),\n});\n\n/** Artifacts configuration schema */\nexport const ArtifactsConfigSchema = z.object({\n  outputDir: z.string().default(DEFAULT_ARTIFACTS.outputDir),\n  screenshots: ScreenshotsConfigSchema.default(DEFAULT_ARTIFACTS.screenshots),\n  video: VideoConfigSchema.default(DEFAULT_ARTIFACTS.video),\n  trace: TraceConfigSchema.default(DEFAULT_ARTIFACTS.trace),\n});\n\n// =============================================================================\n// Browsers Schemas\n// =============================================================================\n\n/** Browser type schema */\nconst BrowserTypeSchema = z.enum(['chromium', 'firefox', 'webkit']);\n\n/** Browser channel schema */\nconst BrowserChannelSchema = z.enum(['bundled', 'msedge', 'chrome', 'chrome-beta', 'chrome-dev']);\n\n/** Browser strategy schema */\nconst BrowserStrategySchema = z.enum([\n  'auto',\n  'prefer-bundled',\n  'prefer-system',\n  'bundled-only',\n  'system-only',\n]);\n\n/** Viewport size schema */\nexport const ViewportSizeSchema = z.object({\n  width: positiveInt,\n  height: positiveInt,\n});\n\n/** Browsers configuration schema */\nexport const BrowsersConfigSchema = z\n  .object({\n    enabled: z.array(BrowserTypeSchema).min(1, 'At least one browser required').default(['chromium']),\n    channel: BrowserChannelSchema.optional().default(DEFAULT_BROWSERS.channel ?? 'bundled'),\n    strategy: BrowserStrategySchema.optional().default(DEFAULT_BROWSERS.strategy ?? 'auto'),\n    viewport: ViewportSizeSchema.default(DEFAULT_BROWSERS.viewport),\n    headless: z.boolean().default(DEFAULT_BROWSERS.headless),\n    slowMo: positiveInt.optional(),\n  })\n  .refine(\n    (config) => {\n      if (config.channel === 'msedge' || config.channel.startsWith('chrome')) {\n        return config.enabled.includes('chromium');\n      }\n      return true;\n    },\n    {\n      message: \"channel 'msedge' or 'chrome' requires 'chromium' in enabled browsers\",\n    }\n  );\n\n// =============================================================================\n// Journeys Schemas\n// =============================================================================\n\n/** Journey layout schema */\nconst JourneyLayoutSchema = z.enum(['flat', 'staged']);\n\n/** Journey group by schema */\nconst JourneyGroupBySchema = z.enum(['tier', 'status', 'scope']);\n\n/** Journey ID configuration schema */\nexport const JourneyIdConfigSchema = z.object({\n  prefix: z.string().default(DEFAULT_JOURNEYS.id.prefix),\n  width: positiveInt.default(DEFAULT_JOURNEYS.id.width),\n});\n\n/** Journey backlog configuration schema */\nexport const JourneyBacklogConfigSchema = z.object({\n  groupBy: JourneyGroupBySchema.default(DEFAULT_JOURNEYS.backlog.groupBy),\n  thenBy: JourneyGroupBySchema.optional(),\n});\n\n/** Journeys configuration schema */\nexport const JourneysConfigSchema = z.object({\n  id: JourneyIdConfigSchema.default(DEFAULT_JOURNEYS.id),\n  layout: JourneyLayoutSchema.default(DEFAULT_JOURNEYS.layout),\n  backlog: JourneyBacklogConfigSchema.default(DEFAULT_JOURNEYS.backlog),\n});\n\n// =============================================================================\n// Root Configuration Schema\n// =============================================================================\n\n/**\n * Root configuration schema with all validation rules\n *\n * Validates:\n * - version must equal SUPPORTED_CONFIG_VERSION (currently 1)\n * - app.baseUrl must be present (validated after env var resolution)\n * - auth.roles must have at least one role\n * - activeEnvironment must match a key in environments or be env var template\n * - Provider-specific configuration must be present\n */\nexport const ARTKConfigSchema = z\n  .object({\n    /**\n     * Configuration schema version (integer, not semver).\n     * Increment when making breaking changes to schema.\n     * Example: 1, 2, 3 (NOT \"1.0.0\")\n     */\n    version: z.number().int().min(1).optional().default(SUPPORTED_CONFIG_VERSION),\n    app: AppConfigSchema,\n    environments: EnvironmentsSchema.default({}),\n    activeEnvironment: z.string().default('default'),\n    auth: AuthConfigSchema,\n    selectors: SelectorsConfigSchema.default({\n      testIdAttribute: DEFAULT_TEST_ID_ATTRIBUTE,\n      strategy: [...DEFAULT_LOCATOR_STRATEGY],\n    }),\n    assertions: AssertionsConfigSchema.default(DEFAULT_ASSERTIONS),\n    data: DataConfigSchema.default(DEFAULT_DATA),\n    fixtures: FixturesConfigSchema,\n    tiers: TiersSchema.default(DEFAULT_TIERS),\n    reporters: ReportersConfigSchema.default(DEFAULT_REPORTERS),\n    artifacts: ArtifactsConfigSchema.default(DEFAULT_ARTIFACTS),\n    browsers: BrowsersConfigSchema.default(DEFAULT_BROWSERS),\n    journeys: JourneysConfigSchema.default(DEFAULT_JOURNEYS),\n  })\n  .superRefine((data, ctx) => {\n    // Validate activeEnvironment matches an environment key or is env var template\n    const isEnvVarTemplate =\n      data.activeEnvironment.startsWith('${') &&\n      data.activeEnvironment.includes('}');\n    const envKeys = Object.keys(data.environments);\n\n    // Validate activeEnvironment matches defined environments (only when environments is non-empty)\n    // Note: Empty environments with custom activeEnvironment is allowed for backward compatibility\n    // but may indicate misconfiguration - consider logging a warning at runtime\n    if (\n      !isEnvVarTemplate &&\n      envKeys.length > 0 &&\n      !envKeys.includes(data.activeEnvironment)\n    ) {\n      ctx.addIssue({\n        code: z.ZodIssueCode.custom,\n        message: `activeEnvironment \"${data.activeEnvironment}\" does not match any defined environment. Available: ${envKeys.join(', ')}`,\n        path: ['activeEnvironment'],\n      });\n    }\n\n    // Validate fixtures.defaultRole exists in auth.roles\n    const roleKeys = Object.keys(data.auth.roles);\n    if (!roleKeys.includes(data.fixtures.defaultRole)) {\n      ctx.addIssue({\n        code: z.ZodIssueCode.custom,\n        message: `fixtures.defaultRole \"${data.fixtures.defaultRole}\" does not match any defined role. Available: ${roleKeys.join(', ')}`,\n        path: ['fixtures', 'defaultRole'],\n      });\n    }\n\n    // Validate fixtures.roleFixtures all exist in auth.roles\n    for (const roleFixture of data.fixtures.roleFixtures) {\n      if (!roleKeys.includes(roleFixture)) {\n        ctx.addIssue({\n          code: z.ZodIssueCode.custom,\n          message: `fixtures.roleFixtures contains \"${roleFixture}\" which is not a defined role. Available: ${roleKeys.join(', ')}`,\n          path: ['fixtures', 'roleFixtures'],\n        });\n      }\n    }\n  });\n\n// =============================================================================\n// Type Exports\n// =============================================================================\n\n/** Inferred type from ARTKConfigSchema */\nexport type ARTKConfigInput = z.input<typeof ARTKConfigSchema>;\n\n/** Validated ARTKConfig type */\nexport type ARTKConfigOutput = z.output<typeof ARTKConfigSchema>;\n","/**\n * Configuration migration system\n *\n * Provides automatic migration of configuration files from older versions\n * to the current version. Each migration transforms the config object to\n * match the expected schema for the next version.\n *\n * @module config/migrate\n */\n\nimport { createLogger } from '../utils/logger.js';\nimport { CURRENT_CONFIG_VERSION } from './schema.js';\n\nconst logger = createLogger('config', 'migrate');\n\n// Re-export CURRENT_CONFIG_VERSION for use by loader.ts\nexport { CURRENT_CONFIG_VERSION } from './schema.js';\n\n// =============================================================================\n// Migration Types\n// =============================================================================\n\n/**\n * Function that transforms config from one version to the next\n */\nexport type MigrationFn = (config: Record<string, unknown>) => Record<string, unknown>;\n\n/**\n * Migration definition\n */\nexport interface Migration {\n  /** Starting version (config must be exactly this version) */\n  fromVersion: number;\n\n  /** Target version (result will be this version) */\n  toVersion: number;\n\n  /** Human-readable description of what changed */\n  description: string;\n\n  /** Migration function */\n  migrate: MigrationFn;\n}\n\n/**\n * Result of config migration\n */\nexport interface MigrationResult {\n  /** Final migrated configuration */\n  config: Record<string, unknown>;\n\n  /** Starting version number */\n  fromVersion: number;\n\n  /** Final version number */\n  toVersion: number;\n\n  /** List of migration descriptions that were applied */\n  migrationsApplied: string[];\n}\n\n// =============================================================================\n// Migration Registry\n// =============================================================================\n\n/**\n * Registry of all available migrations\n *\n * Migrations must be registered in sequential order (12, 23, etc.)\n * Each migration should be idempotent and defensive about missing fields.\n */\nconst MIGRATIONS = new Map<string, Migration>();\n\n/**\n * Register a migration\n *\n * @param migration - Migration to register\n * @throws Error if migration with same from/to version already exists\n */\nexport function registerMigration(migration: Migration): void {\n  const key = `${migration.fromVersion}-${migration.toVersion}`;\n\n  if (MIGRATIONS.has(key)) {\n    throw new Error(\n      `Migration from v${migration.fromVersion} to v${migration.toVersion} already registered`\n    );\n  }\n\n  // Validate sequential versions\n  if (migration.toVersion !== migration.fromVersion + 1) {\n    throw new Error(\n      `Migration must increment version by 1 (got ${migration.fromVersion}  ${migration.toVersion})`\n    );\n  }\n\n  MIGRATIONS.set(key, migration);\n  logger.debug(`Registered migration: ${migration.description}`, {\n    fromVersion: migration.fromVersion,\n    toVersion: migration.toVersion,\n  });\n}\n\n/**\n * Get migration for a specific version transition\n *\n * @param fromVersion - Starting version\n * @param toVersion - Target version\n * @returns Migration or undefined if not found\n */\nexport function getMigration(fromVersion: number, toVersion: number): Migration | undefined {\n  const key = `${fromVersion}-${toVersion}`;\n  return MIGRATIONS.get(key);\n}\n\n/**\n * Get all registered migrations\n *\n * @returns Array of migrations in registration order\n */\nexport function getAllMigrations(): Migration[] {\n  return Array.from(MIGRATIONS.values());\n}\n\n/**\n * Clear all registered migrations\n *\n * Useful for testing. Should not be used in production code.\n */\nexport function clearMigrations(): void {\n  MIGRATIONS.clear();\n}\n\n// =============================================================================\n// Migration Execution\n// =============================================================================\n\n/**\n * Check if a config needs migration\n *\n * @param config - Raw config object\n * @returns True if config version is less than current version\n */\nexport function needsMigration(config: Record<string, unknown>): boolean {\n  const version = (config.version as number | undefined) ?? 0;\n  return version < CURRENT_CONFIG_VERSION;\n}\n\n/**\n * Check if a version is supported\n *\n * @param version - Version number to check\n * @returns True if version can be migrated to current version\n */\nexport function isVersionSupported(version: number): boolean {\n  // Version 0 is allowed (legacy configs without version field)\n  return version >= 0 && version <= CURRENT_CONFIG_VERSION;\n}\n\n/**\n * Migrate configuration to current version\n *\n * Applies all necessary migrations in sequence to bring the config from\n * its current version to CURRENT_CONFIG_VERSION.\n *\n * @param config - Raw configuration object\n * @returns Migration result with final config and applied migrations\n * @throws Error if migration path is incomplete or version is unsupported\n *\n * @example\n * ```typescript\n * const rawConfig = { version: 0, ...oldSchema };\n * const result = migrateConfig(rawConfig);\n * console.log(`Migrated from v${result.fromVersion} to v${result.toVersion}`);\n * // Use result.config for validation\n * ```\n */\nexport function migrateConfig(config: Record<string, unknown>): MigrationResult {\n  const fromVersion = (config.version as number | undefined) ?? 0;\n  let currentConfig = { ...config };\n  const migrationsApplied: string[] = [];\n\n  logger.debug('Starting migration', {\n    fromVersion,\n    targetVersion: CURRENT_CONFIG_VERSION,\n  });\n\n  // Validate version is supported\n  if (!isVersionSupported(fromVersion)) {\n    throw new Error(\n      `Config version ${fromVersion} is not supported. ` +\n        `Supported versions: 0-${CURRENT_CONFIG_VERSION}`\n    );\n  }\n\n  // No migration needed if already at current version\n  if (fromVersion === CURRENT_CONFIG_VERSION) {\n    logger.debug('Config already at current version, no migration needed');\n    return {\n      config: currentConfig,\n      fromVersion,\n      toVersion: CURRENT_CONFIG_VERSION,\n      migrationsApplied: [],\n    };\n  }\n\n  // Apply migrations sequentially\n  let currentVersion = fromVersion;\n\n  while (currentVersion < CURRENT_CONFIG_VERSION) {\n    const nextVersion = currentVersion + 1;\n    const migration = getMigration(currentVersion, nextVersion);\n\n    if (!migration) {\n      throw new Error(\n        `No migration found from v${currentVersion} to v${nextVersion}. ` +\n          `Migration path is incomplete.`\n      );\n    }\n\n    logger.debug(`Applying migration: ${migration.description}`, {\n      fromVersion: currentVersion,\n      toVersion: nextVersion,\n    });\n\n    // Apply migration\n    currentConfig = migration.migrate(currentConfig);\n    migrationsApplied.push(migration.description);\n    currentVersion = nextVersion;\n  }\n\n  // Update version field to current version\n  currentConfig.version = CURRENT_CONFIG_VERSION;\n\n  logger.info('Migration completed', {\n    fromVersion,\n    toVersion: CURRENT_CONFIG_VERSION,\n    migrationsApplied: migrationsApplied.length,\n  });\n\n  return {\n    config: currentConfig,\n    fromVersion,\n    toVersion: CURRENT_CONFIG_VERSION,\n    migrationsApplied,\n  };\n}\n\n// =============================================================================\n// Built-in Migrations\n// =============================================================================\n\n/**\n * Migration from v0 (no version field) to v1 (first versioned config)\n *\n * This is a no-op migration that simply adds the version field.\n * All v0 configs are assumed to be compatible with v1 schema.\n */\nregisterMigration({\n  fromVersion: 0,\n  toVersion: 1,\n  description: 'Add version field to legacy config',\n  migrate: (config) => {\n    // Version 0 configs have no version field\n    // Version 1 schema is compatible with legacy configs\n    // Just return the config as-is (version will be set by migrateConfig)\n    return { ...config };\n  },\n});\n\n// Future migrations will be added here as the schema evolves\n// Example:\n//\n// registerMigration({\n//   fromVersion: 1,\n//   toVersion: 2,\n//   description: 'Rename selectorPolicy to locatorPolicy',\n//   migrate: (config) => {\n//     const updated = { ...config };\n//     if ('selectorPolicy' in updated) {\n//       updated.locatorPolicy = updated.selectorPolicy;\n//       delete updated.selectorPolicy;\n//     }\n//     return updated;\n//   },\n// });\n","/**\n * YAML configuration loader with validation\n *\n * Implements:\n * - FR-001: Load configuration from artk/artk.config.yml file\n * - FR-002: Validate configuration against defined schema and report all validation errors with field paths\n * - FR-003: Resolve environment variables (via env.ts)\n * - FR-004: Support named environment profiles switchable via ARTK_ENV\n * - FR-005: Provide typed access to all configuration sections\n *\n * @module config/loader\n */\n\nimport { existsSync, readFileSync } from 'node:fs';\nimport { dirname, join, resolve } from 'node:path';\nimport { parse as parseYaml } from 'yaml';\nimport type { ZodError, ZodIssue } from 'zod';\n\nimport { ARTKConfigError } from '../errors/config-error.js';\nimport { createLogger } from '../utils/logger.js';\nimport { validateCredentialsConfig } from '../auth/credentials.js';\nimport {\n  createMissingEnvVarsError,\n  getMissingEnvVars,\n  resolveEnvVars,\n  resolveEnvVarsInObject,\n  type ResolveOptions,\n} from './env.js';\nimport { CURRENT_CONFIG_VERSION, migrateConfig, needsMigration } from './migrate.js';\nimport { ARTKConfigSchema } from './schema.js';\nimport type {\n  AppConfig,\n  ArtifactsConfig,\n  ARTKConfig,\n  AssertionsConfig,\n  AuthConfig,\n  BrowsersConfig,\n  DataConfig,\n  EnvironmentConfig,\n  FixturesConfig,\n  JourneysConfig,\n  ReportersConfig,\n  SelectorsConfig,\n  TierConfig,\n} from './types.js';\n\nconst logger = createLogger('config', 'loader');\n\n// =============================================================================\n// Configuration State\n// =============================================================================\n\n/**\n * Cached configuration instance\n */\nlet cachedConfig: ARTKConfig | null = null;\n\n/**\n * Path to the loaded configuration file\n */\nlet configFilePath: string | null = null;\n\n// =============================================================================\n// Configuration Loading\n// =============================================================================\n\n/**\n * Default configuration file path relative to project root\n */\nexport const DEFAULT_CONFIG_PATH = 'artk/artk.config.yml';\n\n/**\n * Alternative configuration file names\n */\nexport const CONFIG_FILE_NAMES = [\n  'artk.config.yml',\n  'artk.config.yaml',\n  'artk.config.json',\n] as const;\n\n/**\n * Options for loading configuration\n */\nexport interface LoadConfigOptions {\n  /**\n   * Path to the configuration file\n   * @default 'artk/artk.config.yml'\n   */\n  configPath?: string;\n\n  /**\n   * Base directory for resolving relative paths\n   * @default process.cwd()\n   */\n  baseDir?: string;\n\n  /**\n   * Custom environment object for variable resolution\n   * @default process.env\n   */\n  env?: Record<string, string | undefined>;\n\n  /**\n   * Force reload even if configuration is cached\n   * @default false\n   */\n  forceReload?: boolean;\n\n  /**\n   * Active environment name override (defaults to ARTK_ENV or config value)\n   */\n  activeEnvironment?: string;\n\n  /**\n   * Skip credentials validation\n   * Useful for dry-run scenarios or when credentials are not yet set\n   * @default false\n   */\n  skipCredentialsValidation?: boolean;\n}\n\n/**\n * Result of configuration loading\n */\nexport interface LoadConfigResult {\n  /** Loaded and validated configuration */\n  config: ARTKConfig;\n\n  /** Path to the configuration file */\n  configPath: string;\n\n  /** Active environment name */\n  activeEnvironment: string;\n\n  /** Environment configuration (if applicable) */\n  environmentConfig?: EnvironmentConfig;\n}\n\n/**\n * Find the configuration file in standard locations\n *\n * @param baseDir - Base directory to search from\n * @returns Path to the configuration file or undefined if not found\n */\nexport function findConfigFile(baseDir: string = process.cwd()): string | undefined {\n  // First, check the default location\n  const defaultPath = join(baseDir, DEFAULT_CONFIG_PATH);\n  if (existsSync(defaultPath)) {\n    return defaultPath;\n  }\n\n  // Check alternative names in artk/ directory\n  const artkDir = join(baseDir, 'artk');\n  if (existsSync(artkDir)) {\n    for (const fileName of CONFIG_FILE_NAMES) {\n      const filePath = join(artkDir, fileName);\n      if (existsSync(filePath)) {\n        return filePath;\n      }\n    }\n  }\n\n  // Check alternative names in root directory\n  for (const fileName of CONFIG_FILE_NAMES) {\n    const filePath = join(baseDir, fileName);\n    if (existsSync(filePath)) {\n      return filePath;\n    }\n  }\n\n  return undefined;\n}\n\n/**\n * Load raw YAML content from a file\n *\n * @param filePath - Path to the YAML file\n * @returns Parsed YAML content as unknown\n * @throws ARTKConfigError if file cannot be read or parsed\n */\nexport function loadYamlFile(filePath: string): unknown {\n  try {\n    const content = readFileSync(filePath, 'utf-8');\n    return parseYaml(content);\n  } catch (error) {\n    if (error instanceof Error && 'code' in error && error.code === 'ENOENT') {\n      throw new ARTKConfigError(\n        `Configuration file not found: ${filePath}`,\n        'configPath',\n        `Create the file at ${filePath} or specify a different path`\n      );\n    }\n\n    if (error instanceof Error) {\n      throw new ARTKConfigError(\n        `Failed to parse configuration file: ${error.message}`,\n        'configPath',\n        'Check the YAML syntax in your configuration file'\n      );\n    }\n\n    throw error;\n  }\n}\n\n/**\n * Format Zod validation errors into a readable message\n *\n * @param error - Zod validation error\n * @returns Formatted error message with all issues\n */\nexport function formatZodError(error: ZodError): string {\n  const issues = error.issues.map((issue: ZodIssue) => {\n    const path = issue.path.join('.');\n    return `  - ${path || 'root'}: ${issue.message}`;\n  });\n\n  return `Configuration validation failed:\\n${issues.join('\\n')}`;\n}\n\n/**\n * Convert Zod errors to ARTKConfigError\n *\n * @param error - Zod validation error\n * @returns ARTKConfigError with details\n */\nexport function zodErrorToConfigError(error: ZodError): ARTKConfigError {\n  const firstIssue = error.issues[0];\n  const path = firstIssue ? firstIssue.path.join('.') : 'unknown';\n  const message = formatZodError(error);\n\n  let suggestion: string | undefined;\n  if (firstIssue) {\n    switch (firstIssue.code) {\n      case 'invalid_type':\n        suggestion = `Expected ${firstIssue.expected}, received ${firstIssue.received}`;\n        break;\n      case 'invalid_enum_value':\n        suggestion = `Valid values: ${firstIssue.options.join(', ')}`;\n        break;\n      case 'too_small':\n        suggestion =\n          firstIssue.type === 'string'\n            ? 'Value cannot be empty'\n            : `Minimum value is ${firstIssue.minimum}`;\n        break;\n      case 'custom':\n        suggestion = firstIssue.message;\n        break;\n    }\n  }\n\n  return new ARTKConfigError(message, path, suggestion);\n}\n\n/**\n * Load and validate configuration from a YAML file\n *\n * @param options - Loading options\n * @returns Loaded configuration result\n * @throws ARTKConfigError if configuration is invalid or cannot be loaded\n *\n * @example\n * ```typescript\n * // Load from default location\n * const { config, activeEnvironment } = await loadConfig();\n *\n * // Load from custom path\n * const { config } = await loadConfig({ configPath: './custom-config.yml' });\n *\n * // Load with custom environment\n * const { config } = await loadConfig({ activeEnvironment: 'staging' });\n * ```\n */\nexport function loadConfig(options: LoadConfigOptions = {}): LoadConfigResult {\n  const {\n    baseDir = process.cwd(),\n    env = process.env,\n    forceReload = false,\n    activeEnvironment: overrideEnv,\n    skipCredentialsValidation = false,\n  } = options;\n\n  // Return cached config if available and not forcing reload\n  if (!forceReload && cachedConfig !== null && configFilePath !== null) {\n    const envName = determineActiveEnvironment(cachedConfig, { env, override: overrideEnv });\n    const envConfig = cachedConfig.environments[envName];\n\n    logger.debug('Returning cached configuration', { path: configFilePath });\n\n    return {\n      config: cachedConfig,\n      configPath: configFilePath,\n      activeEnvironment: envName,\n      environmentConfig: envConfig,\n    };\n  }\n\n  // Find or use specified config path\n  let resolvedPath: string;\n  if (options.configPath) {\n    resolvedPath = resolve(baseDir, options.configPath);\n  } else {\n    const foundPath = findConfigFile(baseDir);\n    if (!foundPath) {\n      throw new ARTKConfigError(\n        `Configuration file not found in ${baseDir}`,\n        'configPath',\n        `Create ${DEFAULT_CONFIG_PATH} or specify a custom path`\n      );\n    }\n    resolvedPath = foundPath;\n  }\n\n  logger.info('Loading configuration', { path: resolvedPath });\n\n  // Load raw YAML\n  const rawConfig = loadYamlFile(resolvedPath);\n\n  if (typeof rawConfig !== 'object' || rawConfig === null) {\n    throw new ARTKConfigError(\n      'Configuration file must contain a YAML object',\n      'root',\n      'Ensure your configuration file starts with valid YAML'\n    );\n  }\n\n  // Check for missing environment variables before resolution\n  const resolveOptions: ResolveOptions = { env, throwOnMissing: false };\n  const missingVars = getMissingEnvVars(rawConfig, env);\n\n  if (missingVars.length > 0) {\n    throw createMissingEnvVarsError(missingVars);\n  }\n\n  // Resolve environment variables\n  let resolvedConfig = resolveEnvVarsInObject(rawConfig, resolveOptions) as Record<string, unknown>;\n\n  // Validate version is supported (reject future versions)\n  const configVersion = (resolvedConfig.version as number | undefined) ?? 0;\n  if (configVersion > CURRENT_CONFIG_VERSION) {\n    throw new ARTKConfigError(\n      `Configuration version ${configVersion} is not supported. Current version is ${CURRENT_CONFIG_VERSION}.`,\n      'version',\n      `Downgrade your configuration to version ${CURRENT_CONFIG_VERSION} or upgrade @artk/core`\n    );\n  }\n\n  // Check for migration\n  if (needsMigration(resolvedConfig)) {\n    const migrationResult = migrateConfig(resolvedConfig);\n\n    if (migrationResult.migrationsApplied.length > 0) {\n      logger.warn(\n        `Config migrated from v${migrationResult.fromVersion} to v${migrationResult.toVersion}:\\n` +\n        migrationResult.migrationsApplied.map(m => `  - ${m}`).join('\\n')\n      );\n    } else {\n      logger.info(\n        `Config version updated from v${migrationResult.fromVersion} to v${migrationResult.toVersion} (no schema changes)`\n      );\n    }\n\n    resolvedConfig = migrationResult.config;\n  }\n\n  // Validate against schema\n  const parseResult = ARTKConfigSchema.safeParse(resolvedConfig);\n\n  if (!parseResult.success) {\n    throw zodErrorToConfigError(parseResult.error);\n  }\n\n  const config = parseResult.data as ARTKConfig;\n\n  // Validate credentials at config load time (unless explicitly skipped)\n  if (!skipCredentialsValidation) {\n    logger.debug('Validating credentials configuration');\n    validateCredentialsConfig(config.auth.roles, env);\n  } else {\n    logger.debug('Skipping credentials validation (skipCredentialsValidation = true)');\n  }\n\n  // Determine active environment\n  const envName = determineActiveEnvironment(config, { env, override: overrideEnv });\n  const envConfig = config.environments[envName];\n\n  // Cache the loaded configuration\n  cachedConfig = config;\n  configFilePath = resolvedPath;\n\n  logger.info('Configuration loaded successfully', {\n    path: resolvedPath,\n    activeEnvironment: envName,\n    roles: Object.keys(config.auth.roles),\n  });\n\n  return {\n    config,\n    configPath: resolvedPath,\n    activeEnvironment: envName,\n    environmentConfig: envConfig,\n  };\n}\n\n/**\n * Options for determining active environment\n */\ninterface DetermineEnvOptions {\n  /** Custom environment object */\n  env?: Record<string, string | undefined>;\n\n  /** Override value (takes precedence) */\n  override?: string;\n}\n\n/**\n * Determine the active environment name\n *\n * Priority:\n * 1. Override parameter\n * 2. ARTK_ENV environment variable\n * 3. Config's activeEnvironment field\n *\n * @param config - Loaded configuration\n * @param options - Options\n * @returns Active environment name\n */\nfunction determineActiveEnvironment(\n  config: ARTKConfig,\n  options: DetermineEnvOptions = {}\n): string {\n  const { env = process.env, override } = options;\n\n  // 1. Override takes highest precedence\n  if (override) {\n    return resolveEnvVars(override, { env });\n  }\n\n  // 2. ARTK_ENV environment variable\n  const artkEnv = env['ARTK_ENV'];\n  if (artkEnv) {\n    return artkEnv;\n  }\n\n  // 3. Config's activeEnvironment field (may contain env var reference)\n  return resolveEnvVars(config.activeEnvironment, { env, throwOnMissing: false });\n}\n\n// =============================================================================\n// Configuration Clearing\n// =============================================================================\n\n/**\n * Clear the cached configuration\n *\n * Useful for testing or when the configuration file has changed.\n */\nexport function clearConfigCache(): void {\n  cachedConfig = null;\n  configFilePath = null;\n  logger.debug('Configuration cache cleared');\n}\n\n// =============================================================================\n// Configuration Accessors (FR-005)\n// =============================================================================\n\n/**\n * Get the current configuration or throw if not loaded\n *\n * @returns Loaded configuration\n * @throws ARTKConfigError if configuration is not loaded\n */\nexport function getConfig(): ARTKConfig {\n  if (cachedConfig === null) {\n    throw new ARTKConfigError(\n      'Configuration not loaded. Call loadConfig() first.',\n      'config',\n      'Ensure loadConfig() is called before accessing configuration'\n    );\n  }\n  return cachedConfig;\n}\n\n/**\n * Check if configuration is loaded\n *\n * @returns True if configuration is loaded\n */\nexport function isConfigLoaded(): boolean {\n  return cachedConfig !== null;\n}\n\n/**\n * Get application configuration\n *\n * @returns App configuration\n * @throws ARTKConfigError if configuration is not loaded\n */\nexport function getAppConfig(): AppConfig {\n  return getConfig().app;\n}\n\n/**\n * Get authentication configuration\n *\n * @returns Auth configuration\n * @throws ARTKConfigError if configuration is not loaded\n */\nexport function getAuthConfig(): AuthConfig {\n  return getConfig().auth;\n}\n\n/**\n * Get selectors configuration\n *\n * @returns Selectors configuration\n * @throws ARTKConfigError if configuration is not loaded\n */\nexport function getSelectorsConfig(): SelectorsConfig {\n  return getConfig().selectors;\n}\n\n/**\n * Get assertions configuration\n *\n * @returns Assertions configuration\n * @throws ARTKConfigError if configuration is not loaded\n */\nexport function getAssertionsConfig(): AssertionsConfig {\n  return getConfig().assertions;\n}\n\n/**\n * Get data configuration\n *\n * @returns Data configuration\n * @throws ARTKConfigError if configuration is not loaded\n */\nexport function getDataConfig(): DataConfig {\n  return getConfig().data;\n}\n\n/**\n * Get fixtures configuration\n *\n * @returns Fixtures configuration\n * @throws ARTKConfigError if configuration is not loaded\n */\nexport function getFixturesConfig(): FixturesConfig {\n  return getConfig().fixtures;\n}\n\n/**\n * Get tier configuration by name\n *\n * @param tierName - Tier name (e.g., 'smoke', 'release', 'regression')\n * @returns Tier configuration or undefined if not found\n * @throws ARTKConfigError if configuration is not loaded\n */\nexport function getTierConfig(tierName: string): TierConfig | undefined {\n  return getConfig().tiers[tierName];\n}\n\n/**\n * Get all tier configurations\n *\n * @returns Record of tier configurations\n * @throws ARTKConfigError if configuration is not loaded\n */\nexport function getTiersConfig(): Readonly<Record<string, TierConfig>> {\n  return getConfig().tiers;\n}\n\n/**\n * Get reporters configuration\n *\n * @returns Reporters configuration\n * @throws ARTKConfigError if configuration is not loaded\n */\nexport function getReportersConfig(): ReportersConfig {\n  return getConfig().reporters;\n}\n\n/**\n * Get artifacts configuration\n *\n * @returns Artifacts configuration\n * @throws ARTKConfigError if configuration is not loaded\n */\nexport function getArtifactsConfig(): ArtifactsConfig {\n  return getConfig().artifacts;\n}\n\n/**\n * Get browsers configuration\n *\n * @returns Browsers configuration\n * @throws ARTKConfigError if configuration is not loaded\n */\nexport function getBrowsersConfig(): BrowsersConfig {\n  return getConfig().browsers;\n}\n\n/**\n * Get journeys configuration\n *\n * @returns Journeys configuration\n * @throws ARTKConfigError if configuration is not loaded\n */\nexport function getJourneysConfig(): JourneysConfig {\n  return getConfig().journeys;\n}\n\n/**\n * Get environment configuration by name\n *\n * @param envName - Environment name\n * @returns Environment configuration or undefined if not found\n * @throws ARTKConfigError if configuration is not loaded\n */\nexport function getEnvironmentConfig(envName: string): EnvironmentConfig | undefined {\n  return getConfig().environments[envName];\n}\n\n/**\n * Get all environment configurations\n *\n * @returns Record of environment configurations\n * @throws ARTKConfigError if configuration is not loaded\n */\nexport function getEnvironmentsConfig(): Readonly<Record<string, EnvironmentConfig>> {\n  return getConfig().environments;\n}\n\n/**\n * Get the base URL for the current environment\n *\n * Resolves the base URL from:\n * 1. Active environment's baseUrl (if defined)\n * 2. App's baseUrl (fallback)\n *\n * @param activeEnvironment - Active environment name\n * @returns Base URL\n * @throws ARTKConfigError if configuration is not loaded\n */\nexport function getBaseUrl(activeEnvironment?: string): string {\n  const config = getConfig();\n  const envName = activeEnvironment ?? config.activeEnvironment;\n  const envConfig = config.environments[envName];\n\n  if (envConfig?.baseUrl) {\n    return envConfig.baseUrl;\n  }\n\n  return config.app.baseUrl;\n}\n\n/**\n * Get the API URL for the current environment\n *\n * @param activeEnvironment - Active environment name\n * @returns API URL or undefined if not configured\n * @throws ARTKConfigError if configuration is not loaded\n */\nexport function getApiUrl(activeEnvironment?: string): string | undefined {\n  const config = getConfig();\n  const envName = activeEnvironment ?? config.activeEnvironment;\n  const envConfig = config.environments[envName];\n\n  if (envConfig?.apiUrl) {\n    return envConfig.apiUrl;\n  }\n\n  // Fallback to data.api.baseUrl if configured\n  return config.data.api?.baseUrl;\n}\n\n/**\n * Get the storage state directory path\n *\n * @param baseDir - Base directory (defaults to config file directory)\n * @returns Absolute path to storage state directory\n * @throws ARTKConfigError if configuration is not loaded\n */\nexport function getStorageStateDir(baseDir?: string): string {\n  const config = getConfig();\n  const storageDir = config.auth.storageState.directory;\n\n  // If baseDir not provided, use config file directory\n  const resolvedBaseDir = baseDir ?? (configFilePath ? dirname(configFilePath) : process.cwd());\n\n  return resolve(resolvedBaseDir, storageDir);\n}\n\n/**\n * Get the storage state file path for a role\n *\n * @param role - Role name\n * @param env - Environment name (for pattern replacement)\n * @param baseDir - Base directory\n * @returns Absolute path to storage state file\n * @throws ARTKConfigError if configuration is not loaded\n */\nexport function getStorageStatePath(\n  role: string,\n  env?: string,\n  baseDir?: string\n): string {\n  const config = getConfig();\n  const pattern = config.auth.storageState.filePattern;\n  const envName = env ?? config.activeEnvironment;\n\n  // Replace pattern placeholders\n  const fileName = pattern\n    .replace('{role}', role)\n    .replace('{env}', envName);\n\n  return join(getStorageStateDir(baseDir), fileName);\n}\n","/**\n * Base Test Fixture with Config Loading (T049)\n *\n * Provides the base test fixture that loads ARTK configuration\n * and serves as the foundation for all other fixtures.\n *\n * @module fixtures/base\n * @see FR-005: Provide typed access to all configuration sections\n */\n\nimport { test as base } from '@playwright/test';\nimport { getConfig, isConfigLoaded, loadConfig } from '../config/loader.js';\nimport type { ARTKConfig } from '../config/types.js';\nimport { createLogger } from '../utils/logger.js';\n\nconst logger = createLogger('fixtures', 'base');\n\n// =============================================================================\n// Config Fixture\n// =============================================================================\n\n/**\n * Base fixtures with configuration only\n *\n * This is the foundation fixture that other fixtures depend on.\n * It ensures configuration is loaded before any test runs.\n */\nexport interface ConfigFixtures {\n  /** Loaded ARTK configuration */\n  readonly config: ARTKConfig;\n}\n\n/**\n * Base test extended with config fixture\n *\n * @example\n * ```typescript\n * import { testWithConfig } from '@artk/core/fixtures/base';\n *\n * testWithConfig('can access config', async ({ config }) => {\n *   console.log(`Testing ${config.app.name}`);\n * });\n * ```\n */\nexport const testWithConfig = base.extend<ConfigFixtures>({\n  config: async ({}, use) => {\n    logger.debug('Loading ARTK configuration');\n\n    // Load config if not already loaded\n    if (!isConfigLoaded()) {\n      loadConfig();\n    }\n\n    const config = getConfig();\n    logger.info('Configuration loaded', {\n      appName: config.app.name,\n      environment: config.activeEnvironment,\n      roles: Object.keys(config.auth.roles),\n    });\n\n    await use(config);\n  },\n});\n\n// =============================================================================\n// Config Loading Utilities\n// =============================================================================\n\n/**\n * Ensure configuration is loaded\n *\n * Call this in globalSetup or before running tests to ensure\n * configuration is available.\n *\n * @param options - Optional load config options\n * @returns Loaded configuration\n *\n * @example\n * ```typescript\n * // In global-setup.ts\n * import { ensureConfigLoaded } from '@artk/core/fixtures/base';\n *\n * export default async function globalSetup() {\n *   await ensureConfigLoaded();\n * }\n * ```\n */\nexport function ensureConfigLoaded(options?: Parameters<typeof loadConfig>[0]): ARTKConfig {\n  if (!isConfigLoaded()) {\n    loadConfig(options);\n  }\n  return getConfig();\n}\n\n/**\n * Get the storage state directory path from config\n *\n * @param config - ARTK configuration\n * @param baseDir - Optional base directory (defaults to cwd)\n * @returns Absolute path to storage state directory\n */\nexport function getStorageStateDirectory(\n  config: ARTKConfig,\n  baseDir: string = process.cwd()\n): string {\n  const { resolve } = require('node:path') as typeof import('node:path');\n  return resolve(baseDir, config.auth.storageState.directory);\n}\n\n/**\n * Get the storage state file path for a role\n *\n * @param config - ARTK configuration\n * @param role - Role name\n * @param baseDir - Optional base directory\n * @returns Absolute path to storage state file\n */\nexport function getStorageStatePathForRole(\n  config: ARTKConfig,\n  role: string,\n  baseDir?: string\n): string {\n  const { join } = require('node:path') as typeof import('node:path');\n  const directory = getStorageStateDirectory(config, baseDir);\n  const pattern = config.auth.storageState.filePattern;\n  const fileName = pattern\n    .replace('{role}', role)\n    .replace('{env}', config.activeEnvironment);\n\n  return join(directory, fileName);\n}\n\n/**\n * Check if storage state exists and is valid for a role\n *\n * @param config - ARTK configuration\n * @param role - Role name\n * @param baseDir - Optional base directory\n * @returns true if storage state is valid\n */\nexport async function isStorageStateValidForRole(\n  config: ARTKConfig,\n  role: string,\n  baseDir?: string\n): Promise<boolean> {\n  const { existsSync, statSync } = require('node:fs') as typeof import('node:fs');\n  const filePath = getStorageStatePathForRole(config, role, baseDir);\n\n  try {\n    if (!existsSync(filePath)) {\n      return false;\n    }\n\n    const stats = statSync(filePath);\n    const age = Date.now() - stats.mtimeMs;\n    const maxAge = config.auth.storageState.maxAgeMinutes * 60 * 1000;\n\n    return age <= maxAge;\n  } catch {\n    return false;\n  }\n}\n","{\n  \"version\": \"1.0.0\",\n  \"releaseDate\": \"2025-12-29\",\n  \"description\": \"ARTK Core v1 - Initial release with config-driven setup, OIDC auth, fixtures, locators, assertions, data harness, and reporters\",\n  \"minNodeVersion\": \"18.0.0\",\n  \"minPlaywrightVersion\": \"1.57.0\",\n  \"breakingChanges\": [],\n  \"features\": [\n    \"Config-driven test setup via artk.config.yml\",\n    \"OIDC authentication with storage state management\",\n    \"Pre-built fixtures (authenticatedPage, apiContext, testData, runId)\",\n    \"Accessibility-first locator utilities\",\n    \"Common assertion helpers (toast, table, form, loading)\",\n    \"Test data isolation and cleanup\",\n    \"Journey-aware reporting with PII masking\",\n    \"Vendorable library design for offline operation\"\n  ],\n  \"compatibilityNotes\": [\n    \"This is the initial v1 release - no backward compatibility requirements\"\n  ],\n  \"gitSha\": \"800150e\",\n  \"buildTime\": \"2025-12-30T09:48:45.861Z\"\n}\n","/**\n * ARTK Configuration Module\n *\n * Provides config-driven test infrastructure setup through a single YAML file.\n *\n * Key Features:\n * - FR-001: Load configuration from artk/artk.config.yml file\n * - FR-002: Validate configuration against defined schema with detailed error messages\n * - FR-003: Resolve environment variables using ${VAR_NAME} and ${VAR_NAME:-default} syntax\n * - FR-004: Support named environment profiles switchable via ARTK_ENV\n * - FR-005: Provide typed access to all configuration sections\n *\n * @module config\n *\n * @example\n * ```typescript\n * import {\n *   loadConfig,\n *   getConfig,\n *   getAuthConfig,\n *   getBaseUrl,\n * } from '@artk/core/config';\n *\n * // Load configuration\n * const { config, activeEnvironment } = loadConfig();\n *\n * // Access typed configuration sections\n * const authConfig = getAuthConfig();\n * const baseUrl = getBaseUrl(activeEnvironment);\n *\n * console.log(`Testing ${config.app.name} at ${baseUrl}`);\n * ```\n */\n\n// =============================================================================\n// Type Exports\n// =============================================================================\n\nexport type {\n  // Root configuration\n  ARTKConfig,\n\n  // Application\n  AppConfig,\n  AppType,\n\n  // Environment\n  EnvironmentConfig,\n\n  // Authentication\n  AuthConfig,\n  AuthProviderType,\n  StorageStateConfig,\n  RoleConfig,\n  CredentialsEnvConfig,\n\n  // OIDC\n  OIDCConfig,\n  OIDCIdpType,\n  OIDCSuccessConfig,\n  OIDCIdpSelectors,\n  OIDCTimeouts,\n  OIDCLogoutConfig,\n  MFAConfig,\n  MFAType,\n\n  // Form Auth\n  FormAuthConfig,\n  FormAuthSelectors,\n  FormAuthSuccessConfig,\n\n  // Selectors\n  SelectorsConfig,\n  LocatorStrategy,\n\n  // Assertions\n  AssertionsConfig,\n  ToastAssertionConfig,\n  LoadingAssertionConfig,\n  FormAssertionConfig,\n\n  // Data\n  DataConfig,\n  NamespaceConfig,\n  CleanupConfig,\n  DataApiConfig,\n\n  // Fixtures\n  FixturesConfig,\n  FixturesApiConfig,\n\n  // Tiers\n  TierConfig,\n\n  // Reporters\n  ReportersConfig,\n  HtmlReporterConfig,\n  JsonReporterConfig,\n  JunitReporterConfig,\n  ArtkReporterConfig,\n  ReporterOpenMode,\n\n  // Artifacts\n  ArtifactsConfig,\n  ScreenshotsConfig,\n  VideoConfig,\n  TraceConfig,\n  VideoSize,\n  ScreenshotMode,\n  CaptureMode,\n\n  // Browsers\n  BrowsersConfig,\n  BrowserType,\n  ViewportSize,\n\n  // Journeys\n  JourneysConfig,\n  JourneyIdConfig,\n  JourneyBacklogConfig,\n  JourneyLayout,\n  JourneyGroupBy,\n} from './types.js';\n\n// =============================================================================\n// Loader Exports\n// =============================================================================\n\nexport {\n  // Loading functions\n  loadConfig,\n  clearConfigCache,\n  findConfigFile,\n  loadYamlFile,\n  formatZodError,\n  zodErrorToConfigError,\n\n  // State checking\n  isConfigLoaded,\n\n  // Accessors\n  getConfig,\n  getAppConfig,\n  getAuthConfig,\n  getSelectorsConfig,\n  getAssertionsConfig,\n  getDataConfig,\n  getFixturesConfig,\n  getTierConfig,\n  getTiersConfig,\n  getReportersConfig,\n  getArtifactsConfig,\n  getBrowsersConfig,\n  getJourneysConfig,\n  getEnvironmentConfig,\n  getEnvironmentsConfig,\n  getBaseUrl,\n  getApiUrl,\n  getStorageStateDir,\n  getStorageStatePath,\n\n  // Constants\n  DEFAULT_CONFIG_PATH,\n  CONFIG_FILE_NAMES,\n\n  // Types\n  type LoadConfigOptions,\n  type LoadConfigResult,\n} from './loader.js';\n\n// =============================================================================\n// Environment Variable Exports\n// =============================================================================\n\nexport {\n  // Parsing\n  parseEnvVarRef,\n  findEnvVarRefs,\n  hasEnvVarRefs,\n\n  // Resolution\n  resolveEnvVars,\n  resolveEnvVarRef,\n  resolveEnvVarsInObject,\n\n  // Validation\n  getMissingEnvVars,\n  createMissingEnvVarsError,\n\n  // Error types\n  EnvVarNotFoundError,\n\n  // Types\n  type EnvVarRef,\n  type ResolveOptions,\n} from './env.js';\n\n// =============================================================================\n// Schema Exports\n// =============================================================================\n\nexport {\n  // Root schema\n  ARTKConfigSchema,\n\n  // Section schemas\n  AppConfigSchema,\n  EnvironmentConfigSchema,\n  EnvironmentsSchema,\n  AuthConfigSchema,\n  StorageStateConfigSchema,\n  CredentialsEnvConfigSchema,\n  RoleConfigSchema,\n  RolesSchema,\n  OIDCConfigSchema,\n  OIDCSuccessConfigSchema,\n  OIDCIdpSelectorsSchema,\n  MFAConfigSchema,\n  OIDCTimeoutsSchema,\n  OIDCLogoutConfigSchema,\n  FormAuthConfigSchema,\n  FormAuthSelectorsSchema,\n  FormAuthSuccessConfigSchema,\n  SelectorsConfigSchema,\n  AssertionsConfigSchema,\n  ToastAssertionConfigSchema,\n  LoadingAssertionConfigSchema,\n  FormAssertionConfigSchema,\n  DataConfigSchema,\n  NamespaceConfigSchema,\n  CleanupConfigSchema,\n  DataApiConfigSchema,\n  FixturesConfigSchema,\n  FixturesApiConfigSchema,\n  TierConfigSchema,\n  TiersSchema,\n  ReportersConfigSchema,\n  HtmlReporterConfigSchema,\n  JsonReporterConfigSchema,\n  JunitReporterConfigSchema,\n  ArtkReporterConfigSchema,\n  ArtifactsConfigSchema,\n  ScreenshotsConfigSchema,\n  VideoConfigSchema,\n  TraceConfigSchema,\n  VideoSizeSchema,\n  ViewportSizeSchema,\n  BrowsersConfigSchema,\n  JourneysConfigSchema,\n  JourneyIdConfigSchema,\n  JourneyBacklogConfigSchema,\n\n  // Inferred types\n  type ARTKConfigInput,\n  type ARTKConfigOutput,\n} from './schema.js';\n\n// =============================================================================\n// Defaults Exports\n// =============================================================================\n\nexport {\n  // Application defaults\n  DEFAULT_APP_TYPE,\n\n  // Storage state defaults\n  DEFAULT_STORAGE_STATE,\n\n  // OIDC defaults\n  DEFAULT_OIDC_SUCCESS_TIMEOUT,\n  DEFAULT_MFA_TYPE,\n  DEFAULT_MFA_ENABLED,\n  DEFAULT_PUSH_TIMEOUT_MS,\n  DEFAULT_LOGIN_FLOW_MS,\n  DEFAULT_IDP_REDIRECT_MS,\n  DEFAULT_CALLBACK_MS,\n\n  // Selector defaults\n  DEFAULT_LOCATOR_STRATEGY,\n  DEFAULT_TEST_ID_ATTRIBUTE,\n  DEFAULT_SELECTORS,\n\n  // Assertion defaults\n  DEFAULT_TOAST_TIMEOUT,\n  DEFAULT_LOADING_TIMEOUT,\n  DEFAULT_ASSERTIONS,\n\n  // Data defaults\n  DEFAULT_NAMESPACE_PREFIX,\n  DEFAULT_NAMESPACE_SUFFIX,\n  DEFAULT_DATA,\n\n  // Tier defaults\n  DEFAULT_TIERS,\n\n  // Reporter defaults\n  DEFAULT_REPORTER_OPEN,\n  DEFAULT_REPORTERS,\n\n  // Artifact defaults\n  DEFAULT_SCREENSHOT_MODE,\n  DEFAULT_CAPTURE_MODE,\n  DEFAULT_ARTIFACTS,\n\n  // Browser defaults\n  DEFAULT_VIEWPORT_WIDTH,\n  DEFAULT_VIEWPORT_HEIGHT,\n  DEFAULT_BROWSERS,\n\n  // Journey defaults\n  DEFAULT_JOURNEY_ID_PREFIX,\n  DEFAULT_JOURNEY_ID_WIDTH,\n  DEFAULT_JOURNEYS,\n\n  // Version\n  SUPPORTED_CONFIG_VERSION,\n} from './defaults.js';\n","/**\n * ARTK Auth Module\n *\n * Provides authentication infrastructure for Playwright tests including:\n * - OIDC authentication with multiple IdP support (Keycloak, Azure AD, Okta)\n * - Form-based authentication\n * - Token-based authentication\n * - Storage state persistence and validation\n * - MFA (TOTP) support\n * - Auth setup project generation\n *\n * @module auth\n * @see FR-006 to FR-011 in spec.md\n * @see NFR-007 to NFR-012 in spec.md\n *\n * @example\n * ```typescript\n * // Basic OIDC authentication\n * import { OIDCAuthProvider, getCredentials, saveStorageState } from '@artk/core/auth';\n *\n * const provider = new OIDCAuthProvider({\n *   idpType: 'keycloak',\n *   loginUrl: 'https://app.example.com/login',\n *   success: { url: '/dashboard' },\n * });\n *\n * const credentials = getCredentials('admin', authConfig);\n * await provider.login(page, credentials);\n * await saveStorageState(context, 'admin');\n * ```\n */\n\n// =============================================================================\n// Types\n// =============================================================================\n\nexport type {\n  // Core types\n  Credentials,\n  StorageStateMetadata,\n  StorageState,\n  StorageStateCookie,\n  StorageStateOrigin,\n  LocalStorageEntry,\n\n  // Provider interface\n  AuthProvider,\n  AuthRetryOptions,\n  AuthPhase,\n  AuthProviderType,\n  AuthProviderFactory,\n\n  // OIDC types\n  OIDCIdpType,\n  MFAType,\n  OIDCAuthProviderConfig,\n  OIDCSuccessConfig,\n  OIDCIdpSelectors,\n  OIDCMfaConfig,\n  OIDCTimeoutsConfig,\n  OIDCLogoutConfig,\n\n  // Form auth types\n  FormAuthProviderConfig,\n  FormAuthSelectors,\n  FormAuthSuccessConfig,\n  FormAuthTimeoutsConfig,\n\n  // Token auth types\n  TokenAuthProviderConfig,\n  TokenAuthRequestBody,\n\n  // Setup types\n  AuthSetupProject,\n  AuthSetupOptions,\n\n  // IdP handler types\n  IdpHandler,\n\n  // Cleanup types\n  CleanupResult,\n  CleanupError,\n} from './types.js';\n\n// =============================================================================\n// Credentials\n// =============================================================================\n\nexport {\n  getCredentials,\n  getCredentialsFromRoleConfig,\n  validateCredentials,\n  formatMissingCredentialsError,\n  hasCredentials,\n  type GetCredentialsOptions,\n  type MissingCredential,\n} from './credentials.js';\n\n// =============================================================================\n// Storage State\n// =============================================================================\n\nexport {\n  // Core functions\n  saveStorageState,\n  loadStorageState,\n  isStorageStateValid,\n  getStorageStateMetadata,\n  readStorageState,\n  clearStorageState,\n\n  // Cleanup functions (NFR-007, NFR-008)\n  cleanupExpiredStorageStates,\n  cleanupStorageStatesOlderThan,\n  CLEANUP_MAX_AGE_MS,\n\n  // Utilities\n  getRoleFromPath,\n  listStorageStates,\n\n  // Configuration\n  DEFAULT_STORAGE_STATE_CONFIG,\n  type StorageStateOptions,\n} from './storage-state.js';\n\n// =============================================================================\n// OIDC Flow\n// =============================================================================\n\nexport {\n  // TOTP functions (FR-010)\n  generateTOTPCode,\n  verifyTOTPCode,\n  getTimeUntilNextTOTPWindow,\n  waitForFreshTOTPWindow,\n\n  // Flow execution\n  executeOIDCFlow,\n  isOIDCSessionValid,\n\n  // Types\n  type OIDCFlowOptions,\n  type OIDCFlowResult,\n} from './oidc/flow.js';\n\n// =============================================================================\n// IdP Handlers\n// =============================================================================\n\nexport { keycloakHandler, isKeycloakLoginPage, getKeycloakErrorMessage } from './oidc/providers/keycloak.js';\nexport { azureAdHandler, isAzureAdLoginPage, getAzureAdErrorMessage, isAzureAdMfaRequired } from './oidc/providers/azure-ad.js';\nexport { oktaHandler, isOktaLoginPage, getOktaErrorMessage, isOktaFactorSelectionRequired } from './oidc/providers/okta.js';\nexport { genericHandler, createGenericHandler, detectIdpType, getGenericErrorMessage } from './oidc/providers/generic.js';\n\n// =============================================================================\n// Auth Providers\n// =============================================================================\n\n// Base provider\nexport { BaseAuthProvider, DEFAULT_AUTH_RETRY_OPTIONS, type LoginOptions, type LogoutOptions } from './providers/base.js';\n\n// OIDC provider\nexport { OIDCAuthProvider, createOIDCAuthProvider, getIdpHandler } from './providers/oidc.js';\n\n// Form provider\nexport { FormAuthProvider, createFormAuthProvider } from './providers/form.js';\n\n// Token provider\nexport { TokenAuthProvider, createTokenAuthProvider, getStoredToken } from './providers/token.js';\n\n// Custom provider base\nexport { CustomAuthProvider, ExampleCustomAuthProvider } from './providers/custom.js';\n\n// =============================================================================\n// Auth Setup Factory\n// =============================================================================\n\nexport {\n  // Setup creation\n  createAuthSetup,\n  createAllAuthSetups,\n  generateAuthSetupCode,\n\n  // Playwright config integration\n  generateAuthProjects,\n  type PlaywrightAuthProject,\n\n  // Factory\n  createAuthProviderFromConfig,\n  type AuthProviderLike,\n\n  // Utilities\n  getRoleNames,\n  getStorageStateDirectory,\n  hasRole,\n  getRoleConfig,\n} from './setup-factory.js';\n\n// =============================================================================\n// Errors (re-export from errors module)\n// =============================================================================\n\nexport { ARTKAuthError } from '../errors/auth-error.js';\nexport { ARTKStorageStateError } from '../errors/storage-state-error.js';\n","/**\n * Storage state error\n *\n * Thrown when storage state operations fail (loading, validation, corruption).\n *\n * @example\n * ```typescript\n * throw new ARTKStorageStateError(\n *   'Storage state file is expired',\n *   'admin',\n *   '.auth-states/admin.json',\n *   'expired'\n * );\n * ```\n */\nexport class ARTKStorageStateError extends Error {\n  /**\n   * Role associated with the storage state\n   */\n  public readonly role: string;\n\n  /**\n   * Path to the storage state file\n   */\n  public readonly path: string;\n\n  /**\n   * Cause of the storage state error\n   */\n  public readonly cause: 'missing' | 'expired' | 'corrupted' | 'invalid';\n\n  constructor(\n    message: string,\n    role: string,\n    path: string,\n    cause: 'missing' | 'expired' | 'corrupted' | 'invalid'\n  ) {\n    super(message);\n    this.name = 'ARTKStorageStateError';\n    this.role = role;\n    this.path = path;\n    this.cause = cause;\n\n    // Maintain proper stack trace for where error was thrown (V8 only)\n    if (Error.captureStackTrace) {\n      Error.captureStackTrace(this, ARTKStorageStateError);\n    }\n  }\n\n  /**\n   * Format error as a human-readable string with context\n   */\n  public override toString(): string {\n    return `${this.name}: ${this.message}\\n  Role: ${this.role}\\n  Path: ${this.path}\\n  Cause: ${this.cause}`;\n  }\n}\n","/**\n * Storage state management for ARTK Auth\n *\n * Handles persistence and validation of browser storage state across test runs.\n *\n * FR-007: System MUST persist authentication state to files and reuse valid state across test runs\n * FR-008: System MUST invalidate storage state based on configurable maximum age\n * NFR-007: System MUST automatically delete storage state files older than 24 hours on test run start\n * NFR-008: Auto-cleanup MUST run before auth setup to prevent stale state accumulation\n *\n * @module auth/storage-state\n * @example\n * ```typescript\n * import { saveStorageState, loadStorageState, isStorageStateValid } from './storage-state.js';\n *\n * // Save storage state after authentication\n * await saveStorageState(browserContext, 'admin', { directory: '.auth-states' });\n *\n * // Load and validate storage state\n * const statePath = await loadStorageState('admin', { directory: '.auth-states' });\n * if (statePath) {\n *   // Use existing state\n * } else {\n *   // Need fresh authentication\n * }\n * ```\n */\n\nimport type { BrowserContext } from '@playwright/test';\nimport * as fs from 'node:fs/promises';\nimport * as path from 'node:path';\nimport type { CleanupError, CleanupResult, StorageState, StorageStateMetadata } from './types.js';\nimport type { StorageStateConfig } from '../config/types.js';\nimport { ARTKStorageStateError } from '../errors/storage-state-error.js';\nimport { createLogger } from '../utils/logger.js';\n\nconst logger = createLogger('auth', 'storage-state');\n\n// =============================================================================\n// Configuration\n// =============================================================================\n\n/**\n * Default storage state configuration\n */\nexport const DEFAULT_STORAGE_STATE_CONFIG: StorageStateConfig = {\n  directory: '.auth-states',\n  maxAgeMinutes: 60,\n  filePattern: '{role}.json',\n};\n\n/**\n * Maximum age in milliseconds for auto-cleanup (24 hours)\n * NFR-007: Delete storage state files older than 24 hours\n */\nexport const CLEANUP_MAX_AGE_MS = 24 * 60 * 60 * 1000;\n\n/**\n * Options for storage state operations\n */\nexport interface StorageStateOptions {\n  /** Directory to store state files (relative to project root) */\n  readonly directory?: string;\n\n  /** Maximum age in minutes before state is considered expired */\n  readonly maxAgeMinutes?: number;\n\n  /** File naming pattern */\n  readonly filePattern?: string;\n\n  /** Project root directory */\n  readonly projectRoot?: string;\n\n  /** Environment name for file pattern */\n  readonly environment?: string;\n}\n\n// =============================================================================\n// Core Functions\n// =============================================================================\n\n/**\n * Save browser context storage state for a role\n *\n * FR-007: Persist storage state to files\n *\n * @param context - Playwright BrowserContext\n * @param role - Role name (e.g., 'admin', 'standardUser')\n * @param options - Storage options\n * @returns Path to saved storage state file\n *\n * @example\n * ```typescript\n * const statePath = await saveStorageState(context, 'admin', {\n *   directory: '.auth-states',\n *   filePattern: '{role}-{env}.json',\n *   environment: 'staging'\n * });\n * console.log(`Saved to: ${statePath}`);\n * ```\n */\nexport async function saveStorageState(\n  context: BrowserContext,\n  role: string,\n  options: StorageStateOptions = {}\n): Promise<string> {\n  const config = resolveOptions(options);\n  const filePath = getStorageStatePath(role, config);\n\n  logger.info('Saving storage state', { role, path: filePath });\n\n  try {\n    // Ensure directory exists\n    const dir = path.dirname(filePath);\n    await fs.mkdir(dir, { recursive: true });\n\n    // Save storage state\n    await context.storageState({ path: filePath });\n\n    logger.info('Storage state saved successfully', { role, path: filePath });\n    return filePath;\n  } catch (error) {\n    const message = error instanceof Error ? error.message : String(error);\n    logger.error('Failed to save storage state', { role, path: filePath, error: message });\n    throw new ARTKStorageStateError(\n      `Failed to save storage state for role \"${role}\": ${message}`,\n      role,\n      filePath,\n      'invalid'\n    );\n  }\n}\n\n/**\n * Load storage state path for a role if valid\n *\n * FR-007: Reuse valid state across test runs\n * FR-008: Invalidate state based on maxAge\n *\n * @param role - Role name\n * @param options - Storage options\n * @returns Path to storage state file, or undefined if not valid\n *\n * @example\n * ```typescript\n * const statePath = await loadStorageState('admin');\n * if (statePath) {\n *   await context.addCookies(/* from file *\\/);\n * }\n * ```\n */\nexport async function loadStorageState(\n  role: string,\n  options: StorageStateOptions = {}\n): Promise<string | undefined> {\n  const config = resolveOptions(options);\n  const filePath = getStorageStatePath(role, config);\n\n  logger.debug('Loading storage state', { role, path: filePath });\n\n  // Check if file exists and is valid\n  const valid = await isStorageStateValid(role, config);\n  if (!valid) {\n    logger.debug('Storage state not valid or not found', { role, path: filePath });\n    return undefined;\n  }\n\n  logger.info('Storage state loaded successfully', { role, path: filePath });\n  return filePath;\n}\n\n/**\n * Check if storage state is valid for a role\n *\n * FR-008: Invalidate state based on configurable maximum age\n *\n * @param role - Role name\n * @param options - Storage options\n * @returns true if storage state exists and is not expired\n *\n * @example\n * ```typescript\n * if (await isStorageStateValid('admin', { maxAgeMinutes: 30 })) {\n *   // Reuse existing state\n * }\n * ```\n */\nexport async function isStorageStateValid(\n  role: string,\n  options: StorageStateOptions = {}\n): Promise<boolean> {\n  const config = resolveOptions(options);\n  const filePath = getStorageStatePath(role, config);\n  const maxAgeMs = config.maxAgeMinutes * 60 * 1000;\n\n  try {\n    const stats = await fs.stat(filePath);\n    const age = Date.now() - stats.mtimeMs;\n\n    if (age > maxAgeMs) {\n      logger.debug('Storage state expired', {\n        role,\n        path: filePath,\n        ageMinutes: Math.round(age / 60000),\n        maxAgeMinutes: config.maxAgeMinutes,\n      });\n      return false;\n    }\n\n    // Also verify file is valid JSON\n    const content = await fs.readFile(filePath, 'utf-8');\n    JSON.parse(content);\n\n    logger.debug('Storage state is valid', {\n      role,\n      path: filePath,\n      ageMinutes: Math.round(age / 60000),\n    });\n    return true;\n  } catch (error) {\n    // File doesn't exist or isn't valid JSON\n    logger.debug('Storage state not found or invalid', { role, path: filePath });\n    return false;\n  }\n}\n\n/**\n * Get metadata about a storage state file\n *\n * @param role - Role name\n * @param options - Storage options\n * @returns Storage state metadata, or undefined if file doesn't exist\n */\nexport async function getStorageStateMetadata(\n  role: string,\n  options: StorageStateOptions = {}\n): Promise<StorageStateMetadata | undefined> {\n  const config = resolveOptions(options);\n  const filePath = getStorageStatePath(role, config);\n  const maxAgeMs = config.maxAgeMinutes * 60 * 1000;\n\n  try {\n    const stats = await fs.stat(filePath);\n    const age = Date.now() - stats.mtimeMs;\n\n    return {\n      role,\n      createdAt: stats.mtime,\n      path: filePath,\n      isValid: age <= maxAgeMs,\n    };\n  } catch {\n    return undefined;\n  }\n}\n\n/**\n * Read and parse storage state from file\n *\n * @param role - Role name\n * @param options - Storage options\n * @returns Parsed storage state\n * @throws ARTKStorageStateError if file doesn't exist or is invalid\n */\nexport async function readStorageState(\n  role: string,\n  options: StorageStateOptions = {}\n): Promise<StorageState> {\n  const config = resolveOptions(options);\n  const filePath = getStorageStatePath(role, config);\n\n  try {\n    const content = await fs.readFile(filePath, 'utf-8');\n    const state = JSON.parse(content) as StorageState;\n\n    // Basic validation\n    if (!Array.isArray(state.cookies) || !Array.isArray(state.origins)) {\n      throw new Error('Invalid storage state structure');\n    }\n\n    return state;\n  } catch (error) {\n    if ((error as NodeJS.ErrnoException).code === 'ENOENT') {\n      throw new ARTKStorageStateError(\n        `Storage state file not found for role \"${role}\"`,\n        role,\n        filePath,\n        'missing'\n      );\n    }\n\n    const message = error instanceof Error ? error.message : String(error);\n    if (message.includes('JSON')) {\n      throw new ARTKStorageStateError(\n        `Storage state file corrupted for role \"${role}\": ${message}`,\n        role,\n        filePath,\n        'corrupted'\n      );\n    }\n\n    throw new ARTKStorageStateError(\n      `Failed to read storage state for role \"${role}\": ${message}`,\n      role,\n      filePath,\n      'invalid'\n    );\n  }\n}\n\n/**\n * Clear storage state files\n *\n * FR-009: Support multiple named roles with separate credentials and storage states\n *\n * @param role - Optional role to clear (clears all if not specified)\n * @param options - Storage options\n * @returns Number of files deleted\n *\n * @example\n * ```typescript\n * // Clear single role\n * await clearStorageState('admin');\n *\n * // Clear all storage states\n * await clearStorageState();\n * ```\n */\nexport async function clearStorageState(\n  role?: string,\n  options: StorageStateOptions = {}\n): Promise<number> {\n  const config = resolveOptions(options);\n  const directory = getStorageStateDirectory(config);\n\n  if (role) {\n    // Clear single role\n    const filePath = getStorageStatePath(role, config);\n    try {\n      await fs.unlink(filePath);\n      logger.info('Storage state cleared', { role, path: filePath });\n      return 1;\n    } catch (error) {\n      if ((error as NodeJS.ErrnoException).code !== 'ENOENT') {\n        logger.warn('Failed to clear storage state', { role, error: String(error) });\n      }\n      return 0;\n    }\n  }\n\n  // Clear all storage states\n  try {\n    const files = await fs.readdir(directory);\n    let deletedCount = 0;\n\n    for (const file of files) {\n      if (file.endsWith('.json')) {\n        try {\n          await fs.unlink(path.join(directory, file));\n          deletedCount++;\n        } catch {\n          // Ignore errors for individual files\n        }\n      }\n    }\n\n    logger.info('All storage states cleared', { count: deletedCount });\n    return deletedCount;\n  } catch (error) {\n    if ((error as NodeJS.ErrnoException).code !== 'ENOENT') {\n      logger.warn('Failed to clear storage states', { error: String(error) });\n    }\n    return 0;\n  }\n}\n\n// =============================================================================\n// Cleanup Functions (T032)\n// =============================================================================\n\n/**\n * Clean up expired storage states (older than 24 hours)\n *\n * NFR-007: System MUST automatically delete storage state files older than 24 hours on test run start\n * NFR-008: Auto-cleanup MUST run before auth setup to prevent stale state accumulation\n * NFR-009: System MUST log cleanup actions at info verbosity level\n *\n * @param options - Storage options\n * @returns Cleanup result with counts and errors\n *\n * @example\n * ```typescript\n * // Run at test suite start\n * const result = await cleanupExpiredStorageStates();\n * console.log(`Deleted ${result.deletedCount} expired storage states`);\n * ```\n */\nexport async function cleanupExpiredStorageStates(\n  options: StorageStateOptions = {}\n): Promise<CleanupResult> {\n  const config = resolveOptions(options);\n  const directory = getStorageStateDirectory(config);\n  const deletedFiles: string[] = [];\n  const errors: CleanupError[] = [];\n\n  logger.info('Starting storage state cleanup', { directory, maxAgeHours: 24 });\n\n  try {\n    // Check if directory exists\n    try {\n      await fs.access(directory);\n    } catch {\n      logger.debug('Storage state directory does not exist, nothing to clean up');\n      return { deletedCount: 0, deletedFiles: [], errors: [] };\n    }\n\n    const files = await fs.readdir(directory);\n    const now = Date.now();\n\n    for (const file of files) {\n      if (!file.endsWith('.json')) {\n        continue;\n      }\n\n      const filePath = path.join(directory, file);\n\n      try {\n        const stats = await fs.stat(filePath);\n        const age = now - stats.mtimeMs;\n\n        if (age > CLEANUP_MAX_AGE_MS) {\n          await fs.unlink(filePath);\n          deletedFiles.push(filePath);\n          logger.debug('Deleted expired storage state', {\n            path: filePath,\n            ageHours: Math.round(age / 3600000),\n          });\n        }\n      } catch (error) {\n        const message = error instanceof Error ? error.message : String(error);\n        errors.push({ path: filePath, message });\n        logger.warn('Failed to process file during cleanup', { path: filePath, error: message });\n      }\n    }\n\n    logger.info('Storage state cleanup complete', {\n      deletedCount: deletedFiles.length,\n      errorCount: errors.length,\n    });\n\n    return {\n      deletedCount: deletedFiles.length,\n      deletedFiles,\n      errors,\n    };\n  } catch (error) {\n    const message = error instanceof Error ? error.message : String(error);\n    logger.error('Storage state cleanup failed', { error: message });\n    return {\n      deletedCount: 0,\n      deletedFiles: [],\n      errors: [{ path: directory, message }],\n    };\n  }\n}\n\n/**\n * Clean up storage states older than a custom age\n *\n * @param maxAgeMs - Maximum age in milliseconds\n * @param options - Storage options\n * @returns Cleanup result\n */\nexport async function cleanupStorageStatesOlderThan(\n  maxAgeMs: number,\n  options: StorageStateOptions = {}\n): Promise<CleanupResult> {\n  const config = resolveOptions(options);\n  const directory = getStorageStateDirectory(config);\n  const deletedFiles: string[] = [];\n  const errors: CleanupError[] = [];\n\n  try {\n    try {\n      await fs.access(directory);\n    } catch {\n      return { deletedCount: 0, deletedFiles: [], errors: [] };\n    }\n\n    const files = await fs.readdir(directory);\n    const now = Date.now();\n\n    for (const file of files) {\n      if (!file.endsWith('.json')) {\n        continue;\n      }\n\n      const filePath = path.join(directory, file);\n\n      try {\n        const stats = await fs.stat(filePath);\n        const age = now - stats.mtimeMs;\n\n        if (age > maxAgeMs) {\n          await fs.unlink(filePath);\n          deletedFiles.push(filePath);\n        }\n      } catch (error) {\n        const message = error instanceof Error ? error.message : String(error);\n        errors.push({ path: filePath, message });\n      }\n    }\n\n    return { deletedCount: deletedFiles.length, deletedFiles, errors };\n  } catch (error) {\n    const message = error instanceof Error ? error.message : String(error);\n    return {\n      deletedCount: 0,\n      deletedFiles: [],\n      errors: [{ path: directory, message }],\n    };\n  }\n}\n\n// =============================================================================\n// Helper Functions\n// =============================================================================\n\n/**\n * Resolve storage state options with defaults\n */\nfunction resolveOptions(options: StorageStateOptions): Required<Omit<StorageStateOptions, 'environment'>> & { environment?: string } {\n  return {\n    directory: options.directory ?? DEFAULT_STORAGE_STATE_CONFIG.directory,\n    maxAgeMinutes: options.maxAgeMinutes ?? DEFAULT_STORAGE_STATE_CONFIG.maxAgeMinutes,\n    filePattern: options.filePattern ?? DEFAULT_STORAGE_STATE_CONFIG.filePattern,\n    projectRoot: options.projectRoot ?? process.cwd(),\n    environment: options.environment,\n  };\n}\n\n/**\n * Get the full path to storage state directory\n */\nfunction getStorageStateDirectory(\n  config: Required<Omit<StorageStateOptions, 'environment'>> & { environment?: string }\n): string {\n  return path.join(config.projectRoot, config.directory);\n}\n\n/**\n * Get the full path to a storage state file\n */\nfunction getStorageStatePath(\n  role: string,\n  config: Required<Omit<StorageStateOptions, 'environment'>> & { environment?: string }\n): string {\n  const directory = getStorageStateDirectory(config);\n  let filename = config.filePattern\n    .replace('{role}', role)\n    .replace('{env}', config.environment ?? 'default');\n\n  // Ensure .json extension\n  if (!filename.endsWith('.json')) {\n    filename += '.json';\n  }\n\n  return path.join(directory, filename);\n}\n\n/**\n * Get role name from a storage state file path\n *\n * @param filePath - Path to storage state file\n * @param pattern - File naming pattern\n * @returns Role name or undefined if can't parse\n */\nexport function getRoleFromPath(filePath: string, pattern: string = '{role}.json'): string | undefined {\n  const filename = path.basename(filePath);\n\n  // Escape special regex characters first, then replace placeholders\n  let patternRegex = pattern\n    .replace(/\\./g, '\\\\.') // Escape all dots first\n    .replace('\\\\{role\\\\}', '([\\\\w-]+)') // Role: word chars and hyphens\n    .replace('\\\\{env\\\\}', '[\\\\w-]+'); // Env: word chars and hyphens\n\n  // Handle unescaped placeholders (in case dots weren't before them)\n  patternRegex = patternRegex\n    .replace('{role}', '([\\\\w-]+)')\n    .replace('{env}', '[\\\\w-]+');\n\n  const match = filename.match(new RegExp(`^${patternRegex}$`));\n  return match?.[1];\n}\n\n/**\n * List all storage state files\n *\n * @param options - Storage options\n * @returns Array of storage state metadata\n */\nexport async function listStorageStates(\n  options: StorageStateOptions = {}\n): Promise<StorageStateMetadata[]> {\n  const config = resolveOptions(options);\n  const directory = getStorageStateDirectory(config);\n  const maxAgeMs = config.maxAgeMinutes * 60 * 1000;\n  const results: StorageStateMetadata[] = [];\n\n  try {\n    const files = await fs.readdir(directory);\n\n    for (const file of files) {\n      if (!file.endsWith('.json')) {\n        continue;\n      }\n\n      const filePath = path.join(directory, file);\n      const role = getRoleFromPath(filePath, config.filePattern);\n\n      if (!role) {\n        continue;\n      }\n\n      try {\n        const stats = await fs.stat(filePath);\n        const age = Date.now() - stats.mtimeMs;\n\n        results.push({\n          role,\n          createdAt: stats.mtime,\n          path: filePath,\n          isValid: age <= maxAgeMs,\n        });\n      } catch {\n        // Skip files we can't stat\n      }\n    }\n  } catch {\n    // Directory doesn't exist\n  }\n\n  return results;\n}\n","/**\n * Generic OIDC flow handler\n *\n * Orchestrates the complete OIDC authentication flow:\n * 1. Navigate to app login URL\n * 2. Handle IdP redirect\n * 3. Fill credentials on IdP page\n * 4. Handle MFA (if enabled)\n * 5. Handle callback redirect\n * 6. Verify successful authentication\n *\n * FR-006: System MUST support OIDC with configurable Identity Provider handlers\n * FR-010: System MUST handle TOTP-based MFA by generating codes from configured secret\n *\n * @module auth/oidc/flow\n */\n\nimport type { Page } from '@playwright/test';\nimport { authenticator } from 'otplib';\nimport type {\n  AuthPhase,\n  Credentials,\n  IdpHandler,\n  OIDCAuthProviderConfig,\n  OIDCMfaConfig,\n} from '../types.js';\nimport { ARTKAuthError } from '../../errors/auth-error.js';\nimport { createLogger } from '../../utils/logger.js';\n\nconst logger = createLogger('auth', 'oidc-flow');\n\n// =============================================================================\n// TOTP Generation (T038)\n// =============================================================================\n\n/**\n * Generate TOTP code from a secret stored in environment variable\n *\n * FR-010: Handle TOTP-based MFA by generating codes from configured secret\n *\n * @param secretEnvVar - Name of environment variable containing TOTP secret\n * @param env - Environment variables (defaults to process.env)\n * @returns 6-digit TOTP code\n * @throws ARTKAuthError if env var not set or secret invalid\n *\n * @example\n * ```typescript\n * // Given: MFA_SECRET_ADMIN=JBSWY3DPEHPK3PXP\n * const code = generateTOTPCode('MFA_SECRET_ADMIN');\n * // Returns: '123456' (time-based code)\n * ```\n */\nexport function generateTOTPCode(\n  secretEnvVar: string,\n  env: Record<string, string | undefined> = process.env\n): string {\n  const secret = env[secretEnvVar];\n\n  if (!secret) {\n    logger.error('TOTP secret environment variable not set', { envVar: secretEnvVar });\n    throw new ARTKAuthError(\n      `TOTP secret environment variable \"${secretEnvVar}\" is not set`,\n      'unknown',\n      'mfa',\n      undefined,\n      `Set the ${secretEnvVar} environment variable with your TOTP secret`\n    );\n  }\n\n  try {\n    // Clean the secret (remove spaces, normalize case)\n    const cleanSecret = secret.replace(/\\s+/g, '').toUpperCase();\n\n    // Generate TOTP code\n    const code = authenticator.generate(cleanSecret);\n\n    logger.debug('Generated TOTP code', {\n      envVar: secretEnvVar,\n      codeLength: code.length,\n    });\n\n    return code;\n  } catch (error) {\n    const message = error instanceof Error ? error.message : String(error);\n    logger.error('Failed to generate TOTP code', { envVar: secretEnvVar, error: message });\n    throw new ARTKAuthError(\n      `Failed to generate TOTP code: ${message}`,\n      'unknown',\n      'mfa',\n      undefined,\n      `Verify that ${secretEnvVar} contains a valid base32-encoded TOTP secret`\n    );\n  }\n}\n\n/**\n * Verify a TOTP code against a secret\n *\n * @param code - 6-digit TOTP code to verify\n * @param secretEnvVar - Environment variable containing TOTP secret\n * @param env - Environment variables\n * @returns true if code is valid\n */\nexport function verifyTOTPCode(\n  code: string,\n  secretEnvVar: string,\n  env: Record<string, string | undefined> = process.env\n): boolean {\n  const secret = env[secretEnvVar];\n\n  if (!secret) {\n    return false;\n  }\n\n  try {\n    const cleanSecret = secret.replace(/\\s+/g, '').toUpperCase();\n    return authenticator.verify({ token: code, secret: cleanSecret });\n  } catch {\n    return false;\n  }\n}\n\n/**\n * Get time until next TOTP code window\n *\n * Useful for waiting if a code is about to expire.\n *\n * @returns Seconds until next TOTP window (0-30)\n */\nexport function getTimeUntilNextTOTPWindow(): number {\n  const step = authenticator.options.step ?? 30;\n  const now = Math.floor(Date.now() / 1000);\n  return step - (now % step);\n}\n\n/**\n * Wait for next TOTP window if current code is about to expire\n *\n * @param thresholdSeconds - If less than this many seconds remain, wait for next window\n * @returns Whether we waited\n */\nexport async function waitForFreshTOTPWindow(thresholdSeconds: number = 5): Promise<boolean> {\n  const remaining = getTimeUntilNextTOTPWindow();\n\n  if (remaining < thresholdSeconds) {\n    logger.debug('Waiting for fresh TOTP window', { remaining, threshold: thresholdSeconds });\n    await new Promise((resolve) => setTimeout(resolve, (remaining + 1) * 1000));\n    return true;\n  }\n\n  return false;\n}\n\n// =============================================================================\n// OIDC Flow Types\n// =============================================================================\n\n/**\n * Options for OIDC flow execution\n */\nexport interface OIDCFlowOptions {\n  /** IdP-specific handler */\n  readonly idpHandler: IdpHandler;\n\n  /** Whether to skip IdP redirect (for direct IdP login) */\n  readonly skipIdpRedirect?: boolean;\n\n  /** Custom role name for error messages */\n  readonly role?: string;\n}\n\n/**\n * Result of OIDC flow execution\n */\nexport interface OIDCFlowResult {\n  /** Whether authentication succeeded */\n  readonly success: boolean;\n\n  /** Final URL after authentication */\n  readonly finalUrl: string;\n\n  /** Duration of the flow in milliseconds */\n  readonly durationMs: number;\n\n  /** Phase where flow completed or failed */\n  readonly phase: AuthPhase;\n\n  /** Error if authentication failed */\n  readonly error?: ARTKAuthError;\n}\n\n// =============================================================================\n// OIDC Flow Implementation (T033)\n// =============================================================================\n\n/**\n * Execute complete OIDC authentication flow\n *\n * FR-006: Support OIDC with configurable Identity Provider handlers\n *\n * @param page - Playwright Page\n * @param config - OIDC provider configuration\n * @param credentials - User credentials\n * @param options - Flow options including IdP handler\n * @returns Flow result\n *\n * @example\n * ```typescript\n * const result = await executeOIDCFlow(\n *   page,\n *   oidcConfig,\n *   { username: 'admin', password: 'secret' },\n *   { idpHandler: keycloakHandler }\n * );\n *\n * if (!result.success) {\n *   throw result.error;\n * }\n * ```\n */\nexport async function executeOIDCFlow(\n  page: Page,\n  config: OIDCAuthProviderConfig,\n  credentials: Credentials,\n  options: OIDCFlowOptions\n): Promise<OIDCFlowResult> {\n  const startTime = Date.now();\n  const role = options.role ?? 'unknown';\n  const { idpHandler } = options;\n\n  logger.info('Starting OIDC flow', {\n    role,\n    idpType: config.idpType,\n    loginUrl: config.loginUrl,\n  });\n\n  try {\n    // Phase 1: Navigate to login URL\n    await navigateToLogin(page, config, role);\n\n    // Phase 2: Wait for IdP redirect (if not direct IdP login)\n    if (!options.skipIdpRedirect && config.loginUrl !== config.idpLoginUrl) {\n      await waitForIdPRedirect(page, config, role);\n    }\n\n    // Phase 3: Fill credentials on IdP page\n    await fillIdPCredentials(page, config, credentials, idpHandler, role);\n\n    // Phase 4: Submit login form\n    await submitIdPForm(page, config, idpHandler, role);\n\n    // Phase 5: Handle MFA (if enabled)\n    if (config.mfa?.enabled) {\n      await handleMFA(page, config.mfa, idpHandler, role);\n    }\n\n    // Phase 6: Handle post-login prompts (e.g., \"Stay signed in?\")\n    if (idpHandler.handlePostLoginPrompts) {\n      await idpHandler.handlePostLoginPrompts(page, config.idpSelectors);\n    }\n\n    // Phase 7: Wait for callback/success\n    await waitForSuccess(page, config, role);\n\n    const duration = Date.now() - startTime;\n    logger.info('OIDC flow completed successfully', {\n      role,\n      durationMs: duration,\n      finalUrl: page.url(),\n    });\n\n    return {\n      success: true,\n      finalUrl: page.url(),\n      durationMs: duration,\n      phase: 'callback',\n    };\n  } catch (error) {\n    const duration = Date.now() - startTime;\n    const authError = error instanceof ARTKAuthError\n      ? error\n      : new ARTKAuthError(\n          error instanceof Error ? error.message : String(error),\n          role,\n          'credentials'\n        );\n\n    logger.error('OIDC flow failed', {\n      role,\n      phase: authError.phase,\n      durationMs: duration,\n      error: authError.message,\n    });\n\n    return {\n      success: false,\n      finalUrl: page.url(),\n      durationMs: duration,\n      phase: authError.phase,\n      error: authError,\n    };\n  }\n}\n\n// =============================================================================\n// Flow Step Functions\n// =============================================================================\n\n/**\n * Navigate to the login initiation URL\n */\nasync function navigateToLogin(\n  page: Page,\n  config: OIDCAuthProviderConfig,\n  role: string\n): Promise<void> {\n  const timeout = config.timeouts?.loginFlowMs ?? 30000;\n\n  logger.debug('Navigating to login URL', { url: config.loginUrl });\n\n  try {\n    await page.goto(config.loginUrl, {\n      waitUntil: 'domcontentloaded',\n      timeout,\n    });\n  } catch (error) {\n    const message = error instanceof Error ? error.message : String(error);\n    throw new ARTKAuthError(\n      `Failed to navigate to login URL: ${message}`,\n      role,\n      'navigation',\n      undefined,\n      `Verify the login URL is correct and accessible: ${config.loginUrl}`\n    );\n  }\n}\n\n/**\n * Wait for redirect to IdP login page\n */\nasync function waitForIdPRedirect(\n  page: Page,\n  config: OIDCAuthProviderConfig,\n  role: string\n): Promise<void> {\n  const timeout = config.timeouts?.idpRedirectMs ?? 10000;\n\n  logger.debug('Waiting for IdP redirect');\n\n  // If we have an idpLoginUrl, wait for it specifically\n  if (config.idpLoginUrl) {\n    try {\n      await page.waitForURL((url) => url.toString().includes(new URL(config.idpLoginUrl!).host), {\n        timeout,\n      });\n    } catch (error) {\n      const message = error instanceof Error ? error.message : String(error);\n      throw new ARTKAuthError(\n        `Timeout waiting for IdP redirect: ${message}`,\n        role,\n        'navigation',\n        undefined,\n        'The application may not have redirected to the IdP login page'\n      );\n    }\n  } else {\n    // Wait for URL to change from the original login URL\n    const originalUrl = page.url();\n    try {\n      await page.waitForURL((url) => url.toString() !== originalUrl, { timeout });\n    } catch {\n      // URL may not change if it's a SPA, continue anyway\n      logger.debug('URL did not change, may be SPA behavior');\n    }\n  }\n}\n\n/**\n * Fill credentials on IdP login page\n */\nasync function fillIdPCredentials(\n  page: Page,\n  config: OIDCAuthProviderConfig,\n  credentials: Credentials,\n  idpHandler: IdpHandler,\n  role: string\n): Promise<void> {\n  logger.debug('Filling credentials on IdP page');\n\n  try {\n    await idpHandler.fillCredentials(page, credentials, config.idpSelectors);\n  } catch (error) {\n    const message = error instanceof Error ? error.message : String(error);\n    throw new ARTKAuthError(\n      `Failed to fill credentials on IdP page: ${message}`,\n      role,\n      'credentials',\n      undefined,\n      'Check if the IdP selectors are correct for username/password fields'\n    );\n  }\n}\n\n/**\n * Submit the IdP login form\n */\nasync function submitIdPForm(\n  page: Page,\n  config: OIDCAuthProviderConfig,\n  idpHandler: IdpHandler,\n  role: string\n): Promise<void> {\n  logger.debug('Submitting IdP login form');\n\n  try {\n    await idpHandler.submitForm(page, config.idpSelectors);\n  } catch (error) {\n    const message = error instanceof Error ? error.message : String(error);\n    throw new ARTKAuthError(\n      `Failed to submit login form: ${message}`,\n      role,\n      'credentials',\n      undefined,\n      'Check if the submit button selector is correct'\n    );\n  }\n}\n\n/**\n * Handle MFA challenge\n *\n * FR-010: Handle TOTP-based MFA by generating codes from configured secret\n */\nasync function handleMFA(\n  page: Page,\n  mfaConfig: OIDCMfaConfig,\n  idpHandler: IdpHandler,\n  role: string\n): Promise<void> {\n  logger.info('Handling MFA challenge', { type: mfaConfig.type });\n\n  switch (mfaConfig.type) {\n    case 'totp':\n      await handleTOTPMFA(page, mfaConfig, idpHandler, role);\n      break;\n\n    case 'push':\n      await handlePushMFA(page, mfaConfig, role);\n      break;\n\n    case 'sms':\n      throw new ARTKAuthError(\n        'SMS-based MFA is not supported for automated testing',\n        role,\n        'mfa',\n        undefined,\n        'Configure TOTP-based MFA for the test account instead'\n      );\n\n    case 'none':\n      logger.debug('MFA type is none, skipping');\n      break;\n\n    default:\n      // Use IdP handler if available\n      if (idpHandler.handleMFA) {\n        await idpHandler.handleMFA(page, mfaConfig);\n      }\n  }\n}\n\n/**\n * Handle TOTP MFA challenge\n */\nasync function handleTOTPMFA(\n  page: Page,\n  mfaConfig: OIDCMfaConfig,\n  idpHandler: IdpHandler,\n  role: string\n): Promise<void> {\n  if (!mfaConfig.totpSecretEnv) {\n    throw new ARTKAuthError(\n      'TOTP secret environment variable not configured',\n      role,\n      'mfa',\n      undefined,\n      'Configure mfa.totpSecretEnv in your artk.config.yml'\n    );\n  }\n\n  // Wait for fresh TOTP window if current code is about to expire\n  await waitForFreshTOTPWindow(5);\n\n  // Generate TOTP code\n  const code = generateTOTPCode(mfaConfig.totpSecretEnv);\n\n  // Find TOTP input and fill it\n  const totpSelector = mfaConfig.totpInputSelector ?? idpHandler.getDefaultSelectors().totpInput ?? 'input[name*=\"otp\"], input[name*=\"totp\"], input[name*=\"code\"]';\n  const submitSelector = mfaConfig.totpSubmitSelector ?? idpHandler.getDefaultSelectors().totpSubmit ?? 'button[type=\"submit\"]';\n\n  try {\n    // Wait for TOTP input to appear\n    await page.waitForSelector(totpSelector, { state: 'visible', timeout: 10000 });\n\n    // Fill the code\n    await page.fill(totpSelector, code);\n\n    // Submit\n    await page.click(submitSelector);\n\n    logger.debug('TOTP code submitted');\n  } catch (error) {\n    const message = error instanceof Error ? error.message : String(error);\n    throw new ARTKAuthError(\n      `Failed to complete TOTP MFA: ${message}`,\n      role,\n      'mfa',\n      undefined,\n      'Check TOTP input selector configuration and verify the secret is correct'\n    );\n  }\n}\n\n/**\n * Handle push notification MFA\n */\nasync function handlePushMFA(\n  page: Page,\n  mfaConfig: OIDCMfaConfig,\n  role: string\n): Promise<void> {\n  const timeout = mfaConfig.pushTimeoutMs ?? 30000;\n\n  logger.info('Waiting for push notification approval', { timeoutMs: timeout });\n\n  // Wait for either success URL or push approval indicator\n  // This is a best-effort approach - push MFA requires manual intervention\n  try {\n    await page.waitForURL((url) => {\n      // Check if we've moved past the MFA page\n      return !url.toString().includes('mfa') && !url.toString().includes('2fa');\n    }, { timeout });\n  } catch (error) {\n    throw new ARTKAuthError(\n      `Push MFA approval timeout after ${timeout}ms`,\n      role,\n      'mfa',\n      undefined,\n      'Approve the push notification on your device or configure TOTP instead'\n    );\n  }\n}\n\n/**\n * Wait for successful authentication callback\n */\nasync function waitForSuccess(\n  page: Page,\n  config: OIDCAuthProviderConfig,\n  role: string\n): Promise<void> {\n  const timeout = config.success.timeout ?? config.timeouts?.callbackMs ?? 10000;\n\n  logger.debug('Waiting for authentication success');\n\n  const { url, selector } = config.success;\n\n  if (!url && !selector) {\n    // No specific success criteria - wait for network idle\n    try {\n      await page.waitForLoadState('networkidle', { timeout });\n    } catch {\n      // Network may not go idle, that's okay\n    }\n    return;\n  }\n\n  try {\n    if (url && selector) {\n      // Wait for either condition\n      await Promise.race([\n        page.waitForURL(url, { timeout }),\n        page.waitForSelector(selector, { state: 'visible', timeout }),\n      ]);\n    } else if (url) {\n      await page.waitForURL(url, { timeout });\n    } else if (selector) {\n      await page.waitForSelector(selector, { state: 'visible', timeout });\n    }\n  } catch (error) {\n    // Check for common error indicators on page\n    const errorText = await detectAuthError(page);\n\n    throw new ARTKAuthError(\n      'Authentication callback failed',\n      role,\n      'callback',\n      errorText,\n      'Verify credentials are correct and the success URL/selector configuration'\n    );\n  }\n}\n\n/**\n * Attempt to detect authentication error messages on the page\n */\nasync function detectAuthError(page: Page): Promise<string | undefined> {\n  const errorSelectors = [\n    '.error-message',\n    '.alert-danger',\n    '.error',\n    '[role=\"alert\"]',\n    '.login-error',\n    '#error-message',\n  ];\n\n  for (const selector of errorSelectors) {\n    try {\n      const element = page.locator(selector).first();\n      if (await element.isVisible({ timeout: 500 })) {\n        return await element.textContent() ?? undefined;\n      }\n    } catch {\n      // Continue checking other selectors\n    }\n  }\n\n  return undefined;\n}\n\n// =============================================================================\n// Session Validation\n// =============================================================================\n\n/**\n * Check if current session is valid by looking for success indicators\n *\n * @param page - Playwright Page\n * @param config - OIDC configuration\n * @returns true if session appears valid\n */\nexport async function isOIDCSessionValid(\n  page: Page,\n  config: OIDCAuthProviderConfig\n): Promise<boolean> {\n  const { url, selector } = config.success;\n\n  // Check URL match\n  if (url) {\n    const currentUrl = page.url();\n    const urlMatches = typeof url === 'string'\n      ? currentUrl.includes(url)\n      : new RegExp(url).test(currentUrl);\n\n    if (!urlMatches) {\n      return false;\n    }\n  }\n\n  // Check selector presence\n  if (selector) {\n    try {\n      await page.waitForSelector(selector, { state: 'visible', timeout: 1000 });\n    } catch {\n      return false;\n    }\n  }\n\n  return true;\n}\n","/**\n * Keycloak IdP handler\n *\n * Handles Keycloak-specific login page interactions.\n * Keycloak is the primary IdP for ITSS and many enterprise applications.\n *\n * FR-006: Support OIDC with configurable Identity Provider handlers (Keycloak primary)\n *\n * @module auth/oidc/providers/keycloak\n */\n\nimport type { Page } from '@playwright/test';\nimport type {\n  Credentials,\n  IdpHandler,\n  OIDCIdpSelectors,\n  OIDCMfaConfig,\n} from '../../types.js';\nimport { generateTOTPCode } from '../flow.js';\nimport { createLogger } from '../../../utils/logger.js';\n\nconst logger = createLogger('auth', 'keycloak');\n\n// =============================================================================\n// Default Selectors\n// =============================================================================\n\n/**\n * Default Keycloak form selectors\n */\nconst DEFAULT_KEYCLOAK_SELECTORS: OIDCIdpSelectors = {\n  // Username can be on a separate page or same page as password\n  username: '#username, input[name=\"username\"], #kc-login input[name=\"username\"]',\n  password: '#password, input[name=\"password\"], #kc-login input[name=\"password\"]',\n  submit: '#kc-login, button[type=\"submit\"], input[type=\"submit\"]',\n  // TOTP/OTP selectors\n  totpInput: '#otp, input[name=\"otp\"], input[name=\"totp\"]',\n  totpSubmit: 'button[type=\"submit\"], input[type=\"submit\"]',\n};\n\n// =============================================================================\n// Keycloak Handler\n// =============================================================================\n\n/**\n * Keycloak Identity Provider handler\n *\n * Handles:\n * - Standard username/password login\n * - Two-step login (username then password)\n * - TOTP-based MFA\n * - Required actions (update password, verify email, etc.)\n */\nexport const keycloakHandler: IdpHandler = {\n  idpType: 'keycloak',\n\n  /**\n   * Fill credentials on Keycloak login page\n   *\n   * Handles both single-page and two-step login flows.\n   */\n  async fillCredentials(\n    page: Page,\n    credentials: Credentials,\n    selectors?: OIDCIdpSelectors\n  ): Promise<void> {\n    const { username: usernameSelector, password: passwordSelector } = {\n      ...DEFAULT_KEYCLOAK_SELECTORS,\n      ...selectors,\n    };\n\n    logger.debug('Filling Keycloak credentials');\n\n    // Wait for username field\n    await page.waitForSelector(usernameSelector!, { state: 'visible', timeout: 10000 });\n\n    // Check if password field is visible (single-page) or if we need to submit username first (two-step)\n    const isPasswordVisible = await page.locator(passwordSelector!).isVisible().catch(() => false);\n\n    if (isPasswordVisible) {\n      // Single-page login - fill both fields\n      await page.fill(usernameSelector!, credentials.username);\n      await page.fill(passwordSelector!, credentials.password);\n    } else {\n      // Two-step login - fill username, submit, then password\n      await page.fill(usernameSelector!, credentials.username);\n      logger.debug('Two-step login detected, submitting username first');\n    }\n  },\n\n  /**\n   * Submit the Keycloak login form\n   */\n  async submitForm(page: Page, selectors?: OIDCIdpSelectors): Promise<void> {\n    const { submit: submitSelector, password: passwordSelector } = {\n      ...DEFAULT_KEYCLOAK_SELECTORS,\n      ...selectors,\n    };\n\n    // Click submit button\n    await page.click(submitSelector!);\n\n    // Check if we need to handle two-step login (password page appears after username submit)\n    try {\n      // Wait a bit for potential page navigation\n      await page.waitForLoadState('domcontentloaded', { timeout: 3000 });\n\n      // Check if password field appeared (two-step flow)\n      const passwordField = page.locator(passwordSelector!);\n      const isPasswordVisible = await passwordField.isVisible({ timeout: 1000 });\n\n      if (isPasswordVisible) {\n        // Two-step flow - password page loaded, but we should have filled password already\n        // This handles the case where password was visible but we only filled username\n        logger.debug('Password field visible after submit, checking if needs input');\n\n        const passwordValue = await passwordField.inputValue();\n        if (!passwordValue) {\n          // This shouldn't happen in normal flow, but log it\n          logger.warn('Password field is empty after username submit - two-step flow may need handling');\n        }\n      }\n    } catch {\n      // Page may have navigated away or password field check timed out - that's fine\n    }\n\n    logger.debug('Keycloak form submitted');\n  },\n\n  /**\n   * Handle Keycloak MFA challenge\n   */\n  async handleMFA(page: Page, mfaConfig: OIDCMfaConfig): Promise<void> {\n    if (mfaConfig.type !== 'totp') {\n      logger.warn('Non-TOTP MFA type, attempting generic handling', { type: mfaConfig.type });\n      return;\n    }\n\n    const totpSelector = mfaConfig.totpInputSelector ?? DEFAULT_KEYCLOAK_SELECTORS.totpInput;\n    const submitSelector = mfaConfig.totpSubmitSelector ?? DEFAULT_KEYCLOAK_SELECTORS.totpSubmit;\n\n    logger.debug('Handling Keycloak TOTP MFA');\n\n    // Wait for OTP input\n    await page.waitForSelector(totpSelector!, { state: 'visible', timeout: 10000 });\n\n    // Generate and enter code\n    if (!mfaConfig.totpSecretEnv) {\n      throw new Error('TOTP secret environment variable not configured');\n    }\n\n    const code = generateTOTPCode(mfaConfig.totpSecretEnv);\n    await page.fill(totpSelector!, code);\n    await page.click(submitSelector!);\n\n    logger.debug('TOTP code submitted to Keycloak');\n  },\n\n  /**\n   * Handle Keycloak post-login prompts\n   *\n   * Keycloak may show required actions like:\n   * - Update password\n   * - Verify email\n   * - Configure OTP\n   */\n  async handlePostLoginPrompts(page: Page, _selectors?: OIDCIdpSelectors): Promise<void> {\n    // Check for required action pages\n    const requiredActionIndicators = [\n      '#kc-update-password',\n      '#kc-update-profile',\n      '#kc-verify-email',\n      '.required-action',\n    ];\n\n    for (const indicator of requiredActionIndicators) {\n      try {\n        const element = await page.waitForSelector(indicator, { timeout: 1000, state: 'visible' });\n        if (element) {\n          logger.warn('Keycloak required action detected', { indicator });\n          // We can't automatically handle required actions\n          throw new Error(`Keycloak required action page detected: ${indicator}. Please complete required actions manually first.`);\n        }\n      } catch (error) {\n        // Selector not found, continue checking\n        if (error instanceof Error && error.message.includes('required action')) {\n          throw error;\n        }\n      }\n    }\n  },\n\n  /**\n   * Get default Keycloak selectors\n   */\n  getDefaultSelectors(): OIDCIdpSelectors {\n    return { ...DEFAULT_KEYCLOAK_SELECTORS };\n  },\n};\n\n// =============================================================================\n// Utility Functions\n// =============================================================================\n\n/**\n * Check if current page is a Keycloak login page\n */\nexport function isKeycloakLoginPage(page: Page): boolean {\n  const url = page.url();\n  return (\n    url.includes('/auth/realms/') ||\n    url.includes('/realms/') ||\n    url.includes('/protocol/openid-connect/')\n  );\n}\n\n/**\n * Check if Keycloak shows an error message\n */\nexport async function getKeycloakErrorMessage(page: Page): Promise<string | undefined> {\n  const errorSelectors = [\n    '.alert-error',\n    '.kc-feedback-text',\n    '#input-error',\n    '.error-message',\n  ];\n\n  for (const selector of errorSelectors) {\n    try {\n      const element = page.locator(selector);\n      if (await element.isVisible({ timeout: 500 })) {\n        return await element.textContent() ?? undefined;\n      }\n    } catch {\n      // Continue\n    }\n  }\n\n  return undefined;\n}\n","/**\n * Azure AD / Entra ID handler\n *\n * Handles Microsoft Azure Active Directory (now Entra ID) login page interactions.\n *\n * FR-006: Support OIDC with configurable Identity Provider handlers (Azure AD)\n *\n * @module auth/oidc/providers/azure-ad\n */\n\nimport type { Page } from '@playwright/test';\nimport type {\n  Credentials,\n  IdpHandler,\n  OIDCIdpSelectors,\n  OIDCMfaConfig,\n} from '../../types.js';\nimport { generateTOTPCode } from '../flow.js';\nimport { createLogger } from '../../../utils/logger.js';\n\nconst logger = createLogger('auth', 'azure-ad');\n\n// =============================================================================\n// Default Selectors\n// =============================================================================\n\n/**\n * Default Azure AD form selectors\n *\n * Azure AD uses a multi-step login flow:\n * 1. Enter email/username\n * 2. Click Next\n * 3. Enter password\n * 4. Click Sign in\n * 5. (Optional) \"Stay signed in?\" prompt\n */\nconst DEFAULT_AZURE_AD_SELECTORS: OIDCIdpSelectors = {\n  // Username input (email field)\n  username: 'input[type=\"email\"], input[name=\"loginfmt\"], #i0116',\n  // Password input\n  password: 'input[type=\"password\"], input[name=\"passwd\"], #i0118, #passwordInput',\n  // Primary submit button (Next / Sign in)\n  submit: 'input[type=\"submit\"], #idSIButton9',\n  // \"No\" button on \"Stay signed in?\" prompt\n  staySignedInNo: '#idBtn_Back, input[value=\"No\"]',\n  // TOTP/OTP selectors\n  totpInput: 'input[name=\"otc\"], #idTxtBx_SAOTCC_OTC',\n  totpSubmit: 'input[type=\"submit\"], #idSubmit_SAOTCC_Continue',\n};\n\n// =============================================================================\n// Azure AD Handler\n// =============================================================================\n\n/**\n * Azure AD / Entra ID handler\n *\n * Handles:\n * - Multi-step username/password login\n * - \"Stay signed in?\" prompt\n * - TOTP-based MFA\n * - Conditional Access prompts\n */\nexport const azureAdHandler: IdpHandler = {\n  idpType: 'azure-ad',\n\n  /**\n   * Fill credentials on Azure AD login page\n   *\n   * Azure AD uses a two-step process:\n   * 1. Enter username, click Next\n   * 2. Enter password\n   */\n  async fillCredentials(\n    page: Page,\n    credentials: Credentials,\n    selectors?: OIDCIdpSelectors\n  ): Promise<void> {\n    const {\n      username: usernameSelector,\n      password: passwordSelector,\n      submit: submitSelector,\n    } = {\n      ...DEFAULT_AZURE_AD_SELECTORS,\n      ...selectors,\n    };\n\n    logger.debug('Filling Azure AD credentials (two-step flow)');\n\n    // Step 1: Enter username\n    await page.waitForSelector(usernameSelector!, { state: 'visible', timeout: 10000 });\n    await page.fill(usernameSelector!, credentials.username);\n\n    // Click Next to proceed to password page\n    await page.click(submitSelector!);\n\n    // Step 2: Wait for password page and enter password\n    await page.waitForSelector(passwordSelector!, { state: 'visible', timeout: 10000 });\n    await page.fill(passwordSelector!, credentials.password);\n  },\n\n  /**\n   * Submit the Azure AD login form (Sign in)\n   */\n  async submitForm(page: Page, selectors?: OIDCIdpSelectors): Promise<void> {\n    const { submit: submitSelector } = {\n      ...DEFAULT_AZURE_AD_SELECTORS,\n      ...selectors,\n    };\n\n    // Click Sign in\n    await page.click(submitSelector!);\n\n    // Wait for navigation or MFA page\n    await page.waitForLoadState('domcontentloaded', { timeout: 10000 });\n\n    logger.debug('Azure AD form submitted');\n  },\n\n  /**\n   * Handle \"Stay signed in?\" prompt\n   */\n  async handlePostLoginPrompts(page: Page, selectors?: OIDCIdpSelectors): Promise<void> {\n    const { staySignedInNo } = {\n      ...DEFAULT_AZURE_AD_SELECTORS,\n      ...selectors,\n    };\n\n    // Check for \"Stay signed in?\" prompt\n    try {\n      const noButton = page.locator(staySignedInNo!);\n      const isVisible = await noButton.isVisible({ timeout: 3000 });\n\n      if (isVisible) {\n        logger.debug('Handling \"Stay signed in?\" prompt');\n        await noButton.click();\n        await page.waitForLoadState('domcontentloaded', { timeout: 5000 });\n      }\n    } catch {\n      // Prompt not shown, continue\n      logger.debug('\"Stay signed in?\" prompt not shown');\n    }\n  },\n\n  /**\n   * Handle Azure AD MFA challenge\n   */\n  async handleMFA(page: Page, mfaConfig: OIDCMfaConfig): Promise<void> {\n    if (mfaConfig.type !== 'totp') {\n      logger.warn('Non-TOTP MFA type for Azure AD', { type: mfaConfig.type });\n      return;\n    }\n\n    const totpSelector = mfaConfig.totpInputSelector ?? DEFAULT_AZURE_AD_SELECTORS.totpInput;\n    const submitSelector = mfaConfig.totpSubmitSelector ?? DEFAULT_AZURE_AD_SELECTORS.totpSubmit;\n\n    logger.debug('Handling Azure AD TOTP MFA');\n\n    // Wait for OTP input\n    await page.waitForSelector(totpSelector!, { state: 'visible', timeout: 10000 });\n\n    // Generate and enter code\n    if (!mfaConfig.totpSecretEnv) {\n      throw new Error('TOTP secret environment variable not configured');\n    }\n\n    const code = generateTOTPCode(mfaConfig.totpSecretEnv);\n    await page.fill(totpSelector!, code);\n    await page.click(submitSelector!);\n\n    logger.debug('TOTP code submitted to Azure AD');\n  },\n\n  /**\n   * Get default Azure AD selectors\n   */\n  getDefaultSelectors(): OIDCIdpSelectors {\n    return { ...DEFAULT_AZURE_AD_SELECTORS };\n  },\n};\n\n// =============================================================================\n// Utility Functions\n// =============================================================================\n\n/**\n * Check if current page is an Azure AD login page\n */\nexport function isAzureAdLoginPage(page: Page): boolean {\n  const url = page.url();\n  return (\n    url.includes('login.microsoftonline.com') ||\n    url.includes('login.live.com') ||\n    url.includes('login.windows.net')\n  );\n}\n\n/**\n * Check if Azure AD shows an error message\n */\nexport async function getAzureAdErrorMessage(page: Page): Promise<string | undefined> {\n  const errorSelectors = [\n    '#usernameError',\n    '#passwordError',\n    '.error-text',\n    '#errorMessage',\n    '.alert-error',\n  ];\n\n  for (const selector of errorSelectors) {\n    try {\n      const element = page.locator(selector);\n      if (await element.isVisible({ timeout: 500 })) {\n        return await element.textContent() ?? undefined;\n      }\n    } catch {\n      // Continue\n    }\n  }\n\n  return undefined;\n}\n\n/**\n * Check if Azure AD requires MFA\n */\nexport async function isAzureAdMfaRequired(page: Page): Promise<boolean> {\n  const mfaIndicators = [\n    '#idTxtBx_SAOTCC_OTC', // TOTP input\n    '#idDiv_SAOTCC_Description', // MFA description\n    '.verifyInput', // Verification input\n  ];\n\n  for (const selector of mfaIndicators) {\n    try {\n      const element = page.locator(selector);\n      if (await element.isVisible({ timeout: 500 })) {\n        return true;\n      }\n    } catch {\n      // Continue\n    }\n  }\n\n  return false;\n}\n","/**\n * Okta IdP handler\n *\n * Handles Okta-specific login page interactions.\n *\n * FR-006: Support OIDC with configurable Identity Provider handlers (Okta)\n *\n * @module auth/oidc/providers/okta\n */\n\nimport type { Page } from '@playwright/test';\nimport type {\n  Credentials,\n  IdpHandler,\n  OIDCIdpSelectors,\n  OIDCMfaConfig,\n} from '../../types.js';\nimport { generateTOTPCode } from '../flow.js';\nimport { createLogger } from '../../../utils/logger.js';\n\nconst logger = createLogger('auth', 'okta');\n\n// =============================================================================\n// Default Selectors\n// =============================================================================\n\n/**\n * Default Okta form selectors\n *\n * Okta supports multiple login flows:\n * - Classic hosted login\n * - Okta Identity Engine (OIE)\n * - Custom login widgets\n */\nconst DEFAULT_OKTA_SELECTORS: OIDCIdpSelectors = {\n  // Username input\n  username: '#okta-signin-username, input[name=\"identifier\"], input[name=\"username\"]',\n  // Password input\n  password: '#okta-signin-password, input[name=\"credentials.passcode\"], input[name=\"password\"]',\n  // Submit button\n  submit: '#okta-signin-submit, input[type=\"submit\"], button[type=\"submit\"]',\n  // TOTP/OTP selectors\n  totpInput: 'input[name=\"credentials.passcode\"], input[name=\"answer\"], #input-container input',\n  totpSubmit: 'input[type=\"submit\"], button[type=\"submit\"]',\n};\n\n// =============================================================================\n// Okta Handler\n// =============================================================================\n\n/**\n * Okta Identity Provider handler\n *\n * Handles:\n * - Standard username/password login\n * - Okta Identity Engine flows\n * - TOTP-based MFA\n * - Push notification MFA (with timeout)\n */\nexport const oktaHandler: IdpHandler = {\n  idpType: 'okta',\n\n  /**\n   * Fill credentials on Okta login page\n   */\n  async fillCredentials(\n    page: Page,\n    credentials: Credentials,\n    selectors?: OIDCIdpSelectors\n  ): Promise<void> {\n    const { username: usernameSelector, password: passwordSelector } = {\n      ...DEFAULT_OKTA_SELECTORS,\n      ...selectors,\n    };\n\n    logger.debug('Filling Okta credentials');\n\n    // Wait for username field\n    await page.waitForSelector(usernameSelector!, { state: 'visible', timeout: 10000 });\n\n    // Check if this is OIE (two-step) or classic (single-page) flow\n    const passwordField = page.locator(passwordSelector!);\n    const isPasswordVisible = await passwordField.isVisible().catch(() => false);\n\n    if (isPasswordVisible) {\n      // Classic flow - both fields visible\n      await page.fill(usernameSelector!, credentials.username);\n      await page.fill(passwordSelector!, credentials.password);\n    } else {\n      // OIE flow - username first, then password\n      await page.fill(usernameSelector!, credentials.username);\n      // Submit will be called next, then password appears\n    }\n  },\n\n  /**\n   * Submit the Okta login form\n   */\n  async submitForm(page: Page, selectors?: OIDCIdpSelectors): Promise<void> {\n    const { submit: submitSelector, password: passwordSelector } = {\n      ...DEFAULT_OKTA_SELECTORS,\n      ...selectors,\n    };\n\n    // Click submit\n    await page.click(submitSelector!);\n\n    // Wait for potential page transition\n    await page.waitForLoadState('domcontentloaded', { timeout: 5000 }).catch(() => {});\n\n    // Check if password field appeared (OIE two-step flow)\n    try {\n      const passwordField = page.locator(passwordSelector!);\n      const isPasswordVisible = await passwordField.isVisible({ timeout: 2000 });\n\n      if (isPasswordVisible) {\n        const passwordValue = await passwordField.inputValue();\n        if (!passwordValue) {\n          logger.debug('OIE two-step flow detected, password page loaded');\n          // Note: Password should have been filled in fillCredentials\n          // This handles edge cases\n        }\n      }\n    } catch {\n      // Password field not visible, continue\n    }\n\n    logger.debug('Okta form submitted');\n  },\n\n  /**\n   * Handle Okta MFA challenge\n   */\n  async handleMFA(page: Page, mfaConfig: OIDCMfaConfig): Promise<void> {\n    if (mfaConfig.type !== 'totp') {\n      logger.warn('Non-TOTP MFA type for Okta', { type: mfaConfig.type });\n      // For push, we just wait\n      if (mfaConfig.type === 'push') {\n        await handleOktaPushMfa(page, mfaConfig);\n        return;\n      }\n      return;\n    }\n\n    const totpSelector = mfaConfig.totpInputSelector ?? DEFAULT_OKTA_SELECTORS.totpInput;\n    const submitSelector = mfaConfig.totpSubmitSelector ?? DEFAULT_OKTA_SELECTORS.totpSubmit;\n\n    logger.debug('Handling Okta TOTP MFA');\n\n    // Wait for OTP input\n    await page.waitForSelector(totpSelector!, { state: 'visible', timeout: 10000 });\n\n    // Generate and enter code\n    if (!mfaConfig.totpSecretEnv) {\n      throw new Error('TOTP secret environment variable not configured');\n    }\n\n    const code = generateTOTPCode(mfaConfig.totpSecretEnv);\n    await page.fill(totpSelector!, code);\n    await page.click(submitSelector!);\n\n    logger.debug('TOTP code submitted to Okta');\n  },\n\n  /**\n   * Get default Okta selectors\n   */\n  getDefaultSelectors(): OIDCIdpSelectors {\n    return { ...DEFAULT_OKTA_SELECTORS };\n  },\n};\n\n// =============================================================================\n// Helper Functions\n// =============================================================================\n\n/**\n * Handle Okta Push MFA\n */\nasync function handleOktaPushMfa(page: Page, mfaConfig: OIDCMfaConfig): Promise<void> {\n  const timeout = mfaConfig.pushTimeoutMs ?? 30000;\n\n  logger.info('Waiting for Okta Push approval', { timeoutMs: timeout });\n\n  // Wait for push to be approved (page navigates away from MFA)\n  try {\n    await page.waitForFunction(\n      () => {\n        const url = window.location.href;\n        return !url.includes('/signin/verify') && !url.includes('/mfa/');\n      },\n      { timeout }\n    );\n  } catch {\n    throw new Error(`Okta Push MFA approval timeout after ${timeout}ms`);\n  }\n}\n\n// =============================================================================\n// Utility Functions\n// =============================================================================\n\n/**\n * Check if current page is an Okta login page\n */\nexport function isOktaLoginPage(page: Page): boolean {\n  const url = page.url();\n  return (\n    url.includes('.okta.com') ||\n    url.includes('.oktapreview.com') ||\n    url.includes('/oauth2/') ||\n    url.includes('/login/login.htm')\n  );\n}\n\n/**\n * Check if Okta shows an error message\n */\nexport async function getOktaErrorMessage(page: Page): Promise<string | undefined> {\n  const errorSelectors = [\n    '.okta-form-infobox-error',\n    '.o-form-error-container',\n    '.error-box',\n    '[data-se=\"o-form-error-container\"]',\n  ];\n\n  for (const selector of errorSelectors) {\n    try {\n      const element = page.locator(selector);\n      if (await element.isVisible({ timeout: 500 })) {\n        return await element.textContent() ?? undefined;\n      }\n    } catch {\n      // Continue\n    }\n  }\n\n  return undefined;\n}\n\n/**\n * Check if Okta requires MFA factor selection\n */\nexport async function isOktaFactorSelectionRequired(page: Page): Promise<boolean> {\n  const factorSelectors = [\n    '.factor-list',\n    '[data-se=\"factor-list\"]',\n    '.authenticator-verify-list',\n  ];\n\n  for (const selector of factorSelectors) {\n    try {\n      const element = page.locator(selector);\n      if (await element.isVisible({ timeout: 500 })) {\n        return true;\n      }\n    } catch {\n      // Continue\n    }\n  }\n\n  return false;\n}\n","/**\n * Generic OIDC IdP handler\n *\n * Handles generic OIDC providers that don't have a specific handler.\n * Uses configurable selectors to interact with any OIDC login page.\n *\n * FR-006: Support OIDC with configurable Identity Provider handlers (Generic)\n *\n * @module auth/oidc/providers/generic\n */\n\nimport type { Page } from '@playwright/test';\nimport type {\n  Credentials,\n  IdpHandler,\n  OIDCIdpSelectors,\n  OIDCMfaConfig,\n} from '../../types.js';\nimport { generateTOTPCode } from '../flow.js';\nimport { createLogger } from '../../../utils/logger.js';\n\nconst logger = createLogger('auth', 'generic-idp');\n\n// =============================================================================\n// Default Selectors\n// =============================================================================\n\n/**\n * Default generic form selectors\n *\n * These are common patterns that work with many IdPs.\n * Override with specific selectors in config when needed.\n */\nconst DEFAULT_GENERIC_SELECTORS: OIDCIdpSelectors = {\n  // Common username/email input patterns\n  username: [\n    'input[type=\"email\"]',\n    'input[name=\"username\"]',\n    'input[name=\"email\"]',\n    'input[id*=\"username\"]',\n    'input[id*=\"email\"]',\n    'input[autocomplete=\"username\"]',\n  ].join(', '),\n\n  // Common password input patterns\n  password: [\n    'input[type=\"password\"]',\n    'input[name=\"password\"]',\n    'input[id*=\"password\"]',\n    'input[autocomplete=\"current-password\"]',\n  ].join(', '),\n\n  // Common submit button patterns\n  submit: [\n    'button[type=\"submit\"]',\n    'input[type=\"submit\"]',\n    'button:has-text(\"Sign in\")',\n    'button:has-text(\"Log in\")',\n    'button:has-text(\"Login\")',\n    'button:has-text(\"Submit\")',\n  ].join(', '),\n\n  // Common TOTP input patterns\n  totpInput: [\n    'input[name*=\"otp\"]',\n    'input[name*=\"totp\"]',\n    'input[name*=\"code\"]',\n    'input[name*=\"token\"]',\n    'input[type=\"tel\"][maxlength=\"6\"]',\n    'input[autocomplete=\"one-time-code\"]',\n  ].join(', '),\n\n  // Common TOTP submit patterns\n  totpSubmit: [\n    'button[type=\"submit\"]',\n    'input[type=\"submit\"]',\n    'button:has-text(\"Verify\")',\n    'button:has-text(\"Submit\")',\n  ].join(', '),\n};\n\n// =============================================================================\n// Generic Handler\n// =============================================================================\n\n/**\n * Generic OIDC Identity Provider handler\n *\n * Provides a flexible handler that works with most OIDC providers\n * using common selector patterns. Custom selectors can be provided\n * via configuration to handle specific IdP quirks.\n *\n * Handles:\n * - Single-page and two-step login flows\n * - TOTP-based MFA\n * - Common error detection\n */\nexport const genericHandler: IdpHandler = {\n  idpType: 'generic',\n\n  /**\n   * Fill credentials on generic IdP login page\n   */\n  async fillCredentials(\n    page: Page,\n    credentials: Credentials,\n    selectors?: OIDCIdpSelectors\n  ): Promise<void> {\n    const { username: usernameSelector, password: passwordSelector } = {\n      ...DEFAULT_GENERIC_SELECTORS,\n      ...selectors,\n    };\n\n    logger.debug('Filling credentials on generic IdP');\n\n    // Wait for username field\n    const usernameField = page.locator(usernameSelector!).first();\n    await usernameField.waitFor({ state: 'visible', timeout: 10000 });\n\n    // Check if password field is visible\n    const passwordField = page.locator(passwordSelector!).first();\n    const isPasswordVisible = await passwordField.isVisible().catch(() => false);\n\n    if (isPasswordVisible) {\n      // Single-page login - fill both fields\n      await usernameField.fill(credentials.username);\n      await passwordField.fill(credentials.password);\n      logger.debug('Filled both username and password (single-page flow)');\n    } else {\n      // Might be two-step - fill username only\n      await usernameField.fill(credentials.username);\n      logger.debug('Filled username (possible two-step flow)');\n    }\n  },\n\n  /**\n   * Submit the login form\n   */\n  async submitForm(page: Page, selectors?: OIDCIdpSelectors): Promise<void> {\n    const { submit: submitSelector, password: passwordSelector } = {\n      ...DEFAULT_GENERIC_SELECTORS,\n      ...selectors,\n    };\n\n    // Click submit button\n    const submitButton = page.locator(submitSelector!).first();\n    await submitButton.click();\n\n    // Wait for navigation\n    await page.waitForLoadState('domcontentloaded', { timeout: 5000 }).catch(() => {});\n\n    // Check for two-step flow (password appears after username submit)\n    try {\n      const passwordField = page.locator(passwordSelector!).first();\n      const isPasswordVisible = await passwordField.isVisible({ timeout: 2000 });\n\n      if (isPasswordVisible) {\n        const passwordValue = await passwordField.inputValue();\n        if (!passwordValue) {\n          logger.debug('Two-step flow detected, password field now visible');\n        }\n      }\n    } catch {\n      // Password field not visible or doesn't exist\n    }\n\n    logger.debug('Form submitted');\n  },\n\n  /**\n   * Handle MFA challenge\n   */\n  async handleMFA(page: Page, mfaConfig: OIDCMfaConfig): Promise<void> {\n    if (mfaConfig.type !== 'totp') {\n      logger.warn('Non-TOTP MFA type for generic handler', { type: mfaConfig.type });\n      return;\n    }\n\n    const totpSelector = mfaConfig.totpInputSelector ?? DEFAULT_GENERIC_SELECTORS.totpInput;\n    const submitSelector = mfaConfig.totpSubmitSelector ?? DEFAULT_GENERIC_SELECTORS.totpSubmit;\n\n    logger.debug('Handling generic TOTP MFA');\n\n    // Wait for OTP input\n    const totpField = page.locator(totpSelector!).first();\n    await totpField.waitFor({ state: 'visible', timeout: 10000 });\n\n    // Generate and enter code\n    if (!mfaConfig.totpSecretEnv) {\n      throw new Error('TOTP secret environment variable not configured');\n    }\n\n    const code = generateTOTPCode(mfaConfig.totpSecretEnv);\n    await totpField.fill(code);\n\n    // Submit\n    const submitButton = page.locator(submitSelector!).first();\n    await submitButton.click();\n\n    logger.debug('TOTP code submitted');\n  },\n\n  /**\n   * Handle post-login prompts (generic - does nothing by default)\n   */\n  async handlePostLoginPrompts(_page: Page, _selectors?: OIDCIdpSelectors): Promise<void> {\n    // Generic handler doesn't handle specific post-login prompts\n    // Specific IdP handlers should override this\n    logger.debug('No post-login prompt handling for generic IdP');\n  },\n\n  /**\n   * Get default generic selectors\n   */\n  getDefaultSelectors(): OIDCIdpSelectors {\n    return { ...DEFAULT_GENERIC_SELECTORS };\n  },\n};\n\n// =============================================================================\n// Factory Function\n// =============================================================================\n\n/**\n * Create a generic handler with custom selectors\n *\n * @param customSelectors - Custom selectors to merge with defaults\n * @returns Customized IdP handler\n *\n * @example\n * ```typescript\n * const myIdpHandler = createGenericHandler({\n *   username: '#my-username-field',\n *   password: '#my-password-field',\n *   submit: '#my-submit-button',\n * });\n * ```\n */\nexport function createGenericHandler(customSelectors: OIDCIdpSelectors): IdpHandler {\n  const mergedSelectors = {\n    ...DEFAULT_GENERIC_SELECTORS,\n    ...customSelectors,\n  };\n\n  return {\n    idpType: 'generic',\n\n    async fillCredentials(\n      page: Page,\n      credentials: Credentials,\n      selectors?: OIDCIdpSelectors\n    ): Promise<void> {\n      const finalSelectors = { ...mergedSelectors, ...selectors };\n      return genericHandler.fillCredentials(page, credentials, finalSelectors);\n    },\n\n    async submitForm(page: Page, selectors?: OIDCIdpSelectors): Promise<void> {\n      const finalSelectors = { ...mergedSelectors, ...selectors };\n      return genericHandler.submitForm(page, finalSelectors);\n    },\n\n    async handleMFA(page: Page, mfaConfig: OIDCMfaConfig): Promise<void> {\n      return genericHandler.handleMFA!(page, mfaConfig);\n    },\n\n    async handlePostLoginPrompts(page: Page, selectors?: OIDCIdpSelectors): Promise<void> {\n      const finalSelectors = { ...mergedSelectors, ...selectors };\n      return genericHandler.handlePostLoginPrompts!(page, finalSelectors);\n    },\n\n    getDefaultSelectors(): OIDCIdpSelectors {\n      return { ...mergedSelectors };\n    },\n  };\n}\n\n// =============================================================================\n// Utility Functions\n// =============================================================================\n\n/**\n * Try to detect which IdP type based on URL patterns\n *\n * @param page - Playwright Page\n * @returns Detected IdP type or 'generic'\n */\nexport function detectIdpType(page: Page): string {\n  const url = page.url().toLowerCase();\n\n  if (url.includes('keycloak') || url.includes('/auth/realms/')) {\n    return 'keycloak';\n  }\n\n  if (url.includes('login.microsoftonline.com') || url.includes('login.live.com')) {\n    return 'azure-ad';\n  }\n\n  if (url.includes('.okta.com') || url.includes('.oktapreview.com')) {\n    return 'okta';\n  }\n\n  if (url.includes('auth0.com')) {\n    return 'auth0';\n  }\n\n  return 'generic';\n}\n\n/**\n * Get generic error message from page\n */\nexport async function getGenericErrorMessage(page: Page): Promise<string | undefined> {\n  const errorSelectors = [\n    '.error',\n    '.error-message',\n    '.alert-danger',\n    '.alert-error',\n    '[role=\"alert\"]',\n    '.form-error',\n    '.login-error',\n  ];\n\n  for (const selector of errorSelectors) {\n    try {\n      const element = page.locator(selector).first();\n      if (await element.isVisible({ timeout: 500 })) {\n        return await element.textContent() ?? undefined;\n      }\n    } catch {\n      // Continue\n    }\n  }\n\n  return undefined;\n}\n","/**\n * Base AuthProvider abstract class\n *\n * Provides common functionality for all authentication providers including:\n * - Logging setup\n * - Retry configuration\n * - Session validation helpers\n *\n * @module auth/providers/base\n * @see data-model.md Section 2.1\n */\n\nimport type { Page } from '@playwright/test';\nimport type {\n  AuthProvider,\n  AuthRetryOptions,\n  Credentials,\n} from '../types.js';\nimport { createLogger, type Logger } from '../../utils/logger.js';\n\n// =============================================================================\n// Default Configuration\n// =============================================================================\n\n/**\n * Default retry options for authentication\n *\n * NFR-010: Retry authentication failures up to 2 times with exponential backoff\n */\nexport const DEFAULT_AUTH_RETRY_OPTIONS: Required<AuthRetryOptions> = {\n  maxRetries: 2,\n  initialDelayMs: 1000,\n  maxDelayMs: 10000,\n  backoffMultiplier: 2,\n  retryOnTimeout: true,\n  retryOnNetworkError: true,\n};\n\n// =============================================================================\n// Base Class\n// =============================================================================\n\n/**\n * Abstract base class for authentication providers\n *\n * Provides common functionality that all auth providers inherit:\n * - Logger instance\n * - Retry configuration\n * - Helper methods for common operations\n *\n * @example\n * ```typescript\n * class MyAuthProvider extends BaseAuthProvider {\n *   constructor() {\n *     super('my-auth');\n *   }\n *\n *   async login(page: Page, credentials: Credentials): Promise<void> {\n *     this.logger.info('Starting login');\n *     // Implementation...\n *   }\n * }\n * ```\n */\nexport abstract class BaseAuthProvider implements AuthProvider {\n  /**\n   * Logger instance for this provider\n   */\n  protected readonly logger: Logger;\n\n  /**\n   * Retry options for authentication operations\n   */\n  protected readonly retryOptions: Required<AuthRetryOptions>;\n\n  /**\n   * Provider name for logging\n   */\n  protected readonly providerName: string;\n\n  /**\n   * Create a new base auth provider\n   *\n   * @param providerName - Name for logging (e.g., 'oidc', 'form', 'token')\n   * @param retryOptions - Optional retry configuration override\n   */\n  constructor(\n    providerName: string,\n    retryOptions: AuthRetryOptions = {}\n  ) {\n    this.providerName = providerName;\n    this.logger = createLogger('auth', providerName);\n    this.retryOptions = {\n      ...DEFAULT_AUTH_RETRY_OPTIONS,\n      ...retryOptions,\n    };\n  }\n\n  /**\n   * Perform full login flow\n   *\n   * @param page - Playwright Page object\n   * @param credentials - Username and password\n   */\n  abstract login(page: Page, credentials: Credentials): Promise<void>;\n\n  /**\n   * Check if current session is still valid\n   *\n   * @param page - Playwright Page object\n   * @returns true if session is valid\n   */\n  abstract isSessionValid(page: Page): Promise<boolean>;\n\n  /**\n   * Perform logout\n   *\n   * @param page - Playwright Page object\n   */\n  abstract logout(page: Page): Promise<void>;\n\n  /**\n   * Attempt to refresh the session (optional)\n   *\n   * Default implementation returns false (refresh not supported).\n   * Override in subclasses that support session refresh.\n   *\n   * @param page - Playwright Page object\n   * @returns true if refresh succeeded, false if login required\n   */\n  refreshSession(_page: Page): Promise<boolean> {\n    this.logger.debug('Session refresh not supported by this provider');\n    return Promise.resolve(false);\n  }\n\n  // ===========================================================================\n  // Protected Helper Methods\n  // ===========================================================================\n\n  /**\n   * Wait for successful navigation after login\n   *\n   * Waits for either a URL pattern or element selector to indicate success.\n   *\n   * @param page - Playwright Page\n   * @param options - Success detection options\n   */\n  protected async waitForLoginSuccess(\n    page: Page,\n    options: {\n      url?: string;\n      selector?: string;\n      timeout?: number;\n    }\n  ): Promise<void> {\n    const timeout = options.timeout ?? 5000;\n\n    if (options.url && options.selector) {\n      // Wait for either URL or selector\n      await Promise.race([\n        page.waitForURL(options.url, { timeout }),\n        page.waitForSelector(options.selector, { timeout, state: 'visible' }),\n      ]);\n    } else if (options.url) {\n      await page.waitForURL(options.url, { timeout });\n    } else if (options.selector) {\n      await page.waitForSelector(options.selector, { timeout, state: 'visible' });\n    } else {\n      // No success criteria - just wait for load state\n      await page.waitForLoadState('networkidle', { timeout });\n    }\n  }\n\n  /**\n   * Fill a form field with retry on failure\n   *\n   * @param page - Playwright Page\n   * @param selector - Field selector\n   * @param value - Value to fill\n   * @param options - Fill options\n   */\n  protected async fillField(\n    page: Page,\n    selector: string,\n    value: string,\n    options: { timeout?: number; clearFirst?: boolean } = {}\n  ): Promise<void> {\n    const timeout = options.timeout ?? 5000;\n    const clearFirst = options.clearFirst ?? true;\n\n    const locator = page.locator(selector);\n    await locator.waitFor({ state: 'visible', timeout });\n\n    if (clearFirst) {\n      await locator.clear();\n    }\n\n    await locator.fill(value);\n  }\n\n  /**\n   * Click an element with retry on failure\n   *\n   * @param page - Playwright Page\n   * @param selector - Element selector\n   * @param options - Click options\n   */\n  protected async clickElement(\n    page: Page,\n    selector: string,\n    options: { timeout?: number; force?: boolean } = {}\n  ): Promise<void> {\n    const timeout = options.timeout ?? 5000;\n    const force = options.force ?? false;\n\n    const locator = page.locator(selector);\n    await locator.waitFor({ state: 'visible', timeout });\n    await locator.click({ force, timeout });\n  }\n\n  /**\n   * Check if an element is visible on page\n   *\n   * @param page - Playwright Page\n   * @param selector - Element selector\n   * @param timeout - How long to check for visibility\n   * @returns true if element is visible\n   */\n  protected async isElementVisible(\n    page: Page,\n    selector: string,\n    timeout: number = 1000\n  ): Promise<boolean> {\n    try {\n      await page.waitForSelector(selector, { state: 'visible', timeout });\n      return true;\n    } catch {\n      return false;\n    }\n  }\n\n  /**\n   * Get the current page URL\n   *\n   * @param page - Playwright Page\n   * @returns Current URL\n   */\n  protected getCurrentUrl(page: Page): string {\n    return page.url();\n  }\n\n  /**\n   * Check if current URL matches a pattern\n   *\n   * @param page - Playwright Page\n   * @param pattern - URL pattern (string or RegExp)\n   * @returns true if URL matches\n   */\n  protected urlMatches(page: Page, pattern: string | RegExp): boolean {\n    const url = this.getCurrentUrl(page);\n    if (typeof pattern === 'string') {\n      return url.includes(pattern);\n    }\n    return pattern.test(url);\n  }\n\n  /**\n   * Calculate delay for retry attempt using exponential backoff\n   *\n   * @param attempt - Current attempt number (0-indexed)\n   * @returns Delay in milliseconds\n   */\n  protected calculateRetryDelay(attempt: number): number {\n    const baseDelay = this.retryOptions.initialDelayMs;\n    const multiplier = this.retryOptions.backoffMultiplier;\n    const maxDelay = this.retryOptions.maxDelayMs;\n\n    const delay = baseDelay * Math.pow(multiplier, attempt);\n    return Math.min(delay, maxDelay);\n  }\n\n  /**\n   * Determine if an error should trigger a retry\n   *\n   * @param error - Error that occurred\n   * @returns true if should retry\n   */\n  protected shouldRetry(error: Error): boolean {\n    const message = error.message.toLowerCase();\n\n    // Retry on timeout\n    if (this.retryOptions.retryOnTimeout) {\n      if (message.includes('timeout') || message.includes('timed out')) {\n        return true;\n      }\n    }\n\n    // Retry on network errors\n    if (this.retryOptions.retryOnNetworkError) {\n      if (\n        message.includes('network') ||\n        message.includes('net::') ||\n        message.includes('econnrefused') ||\n        message.includes('enotfound')\n      ) {\n        return true;\n      }\n    }\n\n    return false;\n  }\n\n  /**\n   * Sleep for a specified duration\n   *\n   * @param ms - Duration in milliseconds\n   */\n  protected sleep(ms: number): Promise<void> {\n    return new Promise((resolve) => setTimeout(resolve, ms));\n  }\n}\n\n// =============================================================================\n// Utility Types\n// =============================================================================\n\n/**\n * Options for login operations\n */\nexport interface LoginOptions {\n  /** Timeout for the entire login flow in ms */\n  readonly timeout?: number;\n\n  /** Whether to skip session validation after login */\n  readonly skipValidation?: boolean;\n}\n\n/**\n * Options for logout operations\n */\nexport interface LogoutOptions {\n  /** Timeout for logout in ms */\n  readonly timeout?: number;\n\n  /** Whether to also logout from IdP (for OIDC) */\n  readonly idpLogout?: boolean;\n}\n","/**\n * OIDC Authentication Provider\n *\n * Implements the AuthProvider interface for OIDC authentication flows.\n * Supports multiple IdPs (Keycloak, Azure AD, Okta, generic) with retry logic.\n *\n * FR-006: Support OIDC with configurable Identity Provider handlers\n * NFR-010: Retry authentication failures up to 2 times with exponential backoff\n * NFR-011: After retry exhaustion, fail with actionable error message\n * NFR-012: Log each retry attempt at warn level\n *\n * @module auth/providers/oidc\n */\n\nimport type { Page } from '@playwright/test';\nimport type {\n  AuthRetryOptions,\n  Credentials,\n  IdpHandler,\n  OIDCAuthProviderConfig,\n} from '../types.js';\nimport { BaseAuthProvider } from './base.js';\nimport { ARTKAuthError } from '../../errors/auth-error.js';\nimport { executeOIDCFlow, isOIDCSessionValid } from '../oidc/flow.js';\nimport { keycloakHandler } from '../oidc/providers/keycloak.js';\nimport { azureAdHandler } from '../oidc/providers/azure-ad.js';\nimport { oktaHandler } from '../oidc/providers/okta.js';\nimport { genericHandler } from '../oidc/providers/generic.js';\n\n// =============================================================================\n// IdP Handler Registry\n// =============================================================================\n\n/**\n * Map of IdP types to their handlers\n */\nconst IDP_HANDLERS: Record<string, IdpHandler> = {\n  keycloak: keycloakHandler,\n  'azure-ad': azureAdHandler,\n  okta: oktaHandler,\n  auth0: genericHandler, // Auth0 uses generic handler with Auth0-specific selectors\n  generic: genericHandler,\n};\n\n/**\n * Get IdP handler for a given type\n *\n * @param idpType - Type of IdP\n * @returns IdP handler\n */\nexport function getIdpHandler(idpType: string): IdpHandler {\n  const handler = IDP_HANDLERS[idpType];\n  if (!handler) {\n    return genericHandler;\n  }\n  return handler;\n}\n\n// =============================================================================\n// OIDC Auth Provider\n// =============================================================================\n\n/**\n * OIDC Authentication Provider\n *\n * Handles OIDC login flows for various Identity Providers with:\n * - Automatic IdP handler selection based on type\n * - Retry logic with exponential backoff\n * - MFA handling (TOTP)\n * - Session validation\n *\n * @example\n * ```typescript\n * const provider = new OIDCAuthProvider({\n *   idpType: 'keycloak',\n *   loginUrl: 'https://app.example.com/login',\n *   success: { url: 'https://app.example.com/dashboard' },\n * });\n *\n * await provider.login(page, credentials);\n * ```\n */\nexport class OIDCAuthProvider extends BaseAuthProvider {\n  private readonly config: OIDCAuthProviderConfig;\n  private readonly idpHandler: IdpHandler;\n  private currentRole: string = 'unknown';\n\n  /**\n   * Create OIDC auth provider\n   *\n   * @param config - OIDC configuration\n   * @param retryOptions - Optional retry configuration\n   */\n  constructor(\n    config: OIDCAuthProviderConfig,\n    retryOptions: AuthRetryOptions = {}\n  ) {\n    super(`oidc-${config.idpType}`, retryOptions);\n    this.config = config;\n    this.idpHandler = getIdpHandler(config.idpType);\n  }\n\n  /**\n   * Set the role for error reporting\n   *\n   * @param role - Role name\n   */\n  setRole(role: string): void {\n    this.currentRole = role;\n  }\n\n  /**\n   * Perform OIDC login with retry\n   *\n   * NFR-010: Retry authentication failures up to 2 times with exponential backoff\n   * NFR-011: After retry exhaustion, fail with actionable error message\n   * NFR-012: Log each retry attempt at warn level\n   *\n   * @param page - Playwright Page\n   * @param credentials - User credentials\n   * @throws ARTKAuthError on login failure\n   */\n  async login(page: Page, credentials: Credentials): Promise<void> {\n    let lastError: ARTKAuthError | undefined;\n\n    for (let attempt = 0; attempt <= this.retryOptions.maxRetries; attempt++) {\n      try {\n        // Execute OIDC flow\n        const result = await executeOIDCFlow(page, this.config, credentials, {\n          idpHandler: this.idpHandler,\n          role: this.currentRole,\n        });\n\n        if (result.success) {\n          this.logger.info('OIDC login successful', {\n            role: this.currentRole,\n            idpType: this.config.idpType,\n            durationMs: result.durationMs,\n            attempts: attempt + 1,\n          });\n          return;\n        }\n\n        // Flow failed\n        lastError = result.error ?? new ARTKAuthError(\n          'OIDC login failed',\n          this.currentRole,\n          result.phase,\n          undefined,\n          'Check credentials and OIDC configuration'\n        );\n\n        // Check if should retry\n        if (attempt < this.retryOptions.maxRetries) {\n          const delay = this.calculateRetryDelay(attempt);\n\n          // NFR-012: Log each retry attempt at warn level\n          this.logger.warn(`OIDC login attempt ${attempt + 1} failed, retrying in ${delay}ms`, {\n            role: this.currentRole,\n            attempt: attempt + 1,\n            maxRetries: this.retryOptions.maxRetries,\n            delayMs: delay,\n            error: lastError.message,\n          });\n\n          await this.sleep(delay);\n        }\n      } catch (error) {\n        // Unexpected error\n        if (error instanceof ARTKAuthError) {\n          lastError = error;\n        } else {\n          lastError = new ARTKAuthError(\n            error instanceof Error ? error.message : String(error),\n            this.currentRole,\n            'credentials'\n          );\n        }\n\n        // Check if should retry\n        if (attempt < this.retryOptions.maxRetries && this.shouldRetry(lastError)) {\n          const delay = this.calculateRetryDelay(attempt);\n\n          this.logger.warn(`OIDC login error, retrying in ${delay}ms`, {\n            role: this.currentRole,\n            attempt: attempt + 1,\n            delayMs: delay,\n            error: lastError.message,\n          });\n\n          await this.sleep(delay);\n        }\n      }\n    }\n\n    // NFR-011: After retry exhaustion, fail with actionable error message\n    this.logger.error('OIDC login failed after all retries', {\n      role: this.currentRole,\n      maxRetries: this.retryOptions.maxRetries,\n      error: lastError?.message,\n    });\n\n    throw new ARTKAuthError(\n      `OIDC login failed after ${this.retryOptions.maxRetries + 1} attempts: ${lastError?.message ?? 'Unknown error'}`,\n      this.currentRole,\n      lastError?.phase ?? 'credentials',\n      lastError?.idpResponse,\n      `Verify credentials for role \"${this.currentRole}\" are correct. Check OIDC configuration and IdP status.`\n    );\n  }\n\n  /**\n   * Check if current session is valid\n   *\n   * @param page - Playwright Page\n   * @returns true if session is valid\n   */\n  async isSessionValid(page: Page): Promise<boolean> {\n    try {\n      // Navigate to a protected page or check for session indicators\n      const currentUrl = page.url();\n\n      // If we're on the login page, session is not valid\n      if (currentUrl.includes(this.config.loginUrl)) {\n        return false;\n      }\n\n      // Check for success indicators\n      return await isOIDCSessionValid(page, this.config);\n    } catch (error) {\n      this.logger.debug('Session validation failed', {\n        error: error instanceof Error ? error.message : String(error),\n      });\n      return false;\n    }\n  }\n\n  /**\n   * Attempt to refresh the session\n   *\n   * OIDC sessions are typically refreshed via silent renewal.\n   * This method attempts a simple page refresh to trigger token refresh.\n   *\n   * @param page - Playwright Page\n   * @returns true if session is still valid after refresh\n   */\n  async refreshSession(page: Page): Promise<boolean> {\n    try {\n      this.logger.debug('Attempting OIDC session refresh');\n\n      // Reload page to trigger any token refresh\n      await page.reload({ waitUntil: 'networkidle' });\n\n      // Check if we were redirected to login\n      if (page.url().includes(this.config.loginUrl)) {\n        this.logger.debug('Session refresh failed - redirected to login');\n        return false;\n      }\n\n      // Validate session\n      const isValid = await this.isSessionValid(page);\n\n      this.logger.debug('Session refresh result', { isValid });\n      return isValid;\n    } catch (error) {\n      this.logger.warn('Session refresh error', {\n        error: error instanceof Error ? error.message : String(error),\n      });\n      return false;\n    }\n  }\n\n  /**\n   * Perform logout\n   *\n   * @param page - Playwright Page\n   */\n  async logout(page: Page): Promise<void> {\n    this.logger.debug('Performing OIDC logout', { role: this.currentRole });\n\n    try {\n      const logoutConfig = this.config.logout;\n\n      if (logoutConfig?.url) {\n        // Navigate to logout URL\n        await page.goto(logoutConfig.url, { waitUntil: 'networkidle' });\n\n        // If IdP logout is configured, handle redirect\n        if (logoutConfig.idpLogout) {\n          // Wait for IdP logout to complete\n          await page.waitForLoadState('networkidle', { timeout: 10000 });\n        }\n      } else {\n        // Try common logout URLs\n        const baseUrl = new URL(this.config.loginUrl).origin;\n        const logoutUrls = [\n          `${baseUrl}/logout`,\n          `${baseUrl}/api/logout`,\n          `${baseUrl}/auth/logout`,\n        ];\n\n        for (const url of logoutUrls) {\n          try {\n            const response = await page.goto(url, { waitUntil: 'networkidle', timeout: 5000 });\n            if (response?.ok()) {\n              this.logger.debug('Logout successful', { url });\n              return;\n            }\n          } catch {\n            // Try next URL\n          }\n        }\n\n        // Clear cookies as fallback\n        await page.context().clearCookies();\n        this.logger.debug('Cleared cookies as logout fallback');\n      }\n    } catch (error) {\n      this.logger.warn('Logout error', {\n        error: error instanceof Error ? error.message : String(error),\n      });\n      // Clear cookies even if logout fails\n      await page.context().clearCookies();\n    }\n  }\n\n  /**\n   * Get the configured IdP handler\n   */\n  getIdpHandler(): IdpHandler {\n    return this.idpHandler;\n  }\n\n  /**\n   * Get the OIDC configuration\n   */\n  getConfig(): OIDCAuthProviderConfig {\n    return this.config;\n  }\n}\n\n// =============================================================================\n// Factory Function\n// =============================================================================\n\n/**\n * Create OIDC auth provider from config\n *\n * @param config - OIDC configuration\n * @param retryOptions - Optional retry configuration\n * @returns OIDC auth provider instance\n */\nexport function createOIDCAuthProvider(\n  config: OIDCAuthProviderConfig,\n  retryOptions?: AuthRetryOptions\n): OIDCAuthProvider {\n  return new OIDCAuthProvider(config, retryOptions);\n}\n","/**\n * Form-based Authentication Provider\n *\n * Implements the AuthProvider interface for direct form login (no OIDC redirect).\n * Useful for local development environments with basic auth.\n *\n * **MFA Support:** This provider does NOT support multi-factor authentication (MFA).\n * For applications requiring MFA (TOTP, push notifications, etc.), use the\n * OIDCAuthProvider instead, which supports MFA flows including TOTP generation\n * and push notification handling.\n *\n * **Use Cases:**\n * - Local development with basic username/password auth\n * - Simple authentication forms without OIDC\n * - Custom login pages in staging environments\n *\n * @module auth/providers/form\n */\n\nimport type { Page } from '@playwright/test';\nimport type { AuthRetryOptions, Credentials, FormAuthProviderConfig } from '../types.js';\nimport { BaseAuthProvider } from './base.js';\nimport { ARTKAuthError } from '../../errors/auth-error.js';\n\n// =============================================================================\n// Default Configuration\n// =============================================================================\n\n/**\n * Default timeouts for form auth\n */\nconst DEFAULT_TIMEOUTS = {\n  navigationMs: 30000,\n  submitMs: 10000,\n  successMs: 5000,\n};\n\n// =============================================================================\n// Form Auth Provider\n// =============================================================================\n\n/**\n * Form-based Authentication Provider\n *\n * Handles direct form login without OIDC redirect flows.\n * Suitable for:\n * - Local development environments\n * - Basic authentication forms\n * - Custom login pages\n *\n * @example\n * ```typescript\n * const provider = new FormAuthProvider({\n *   loginUrl: 'https://localhost:3000/login',\n *   selectors: {\n *     username: '#username',\n *     password: '#password',\n *     submit: 'button[type=\"submit\"]',\n *   },\n *   success: { url: '/dashboard' },\n * });\n *\n * await provider.login(page, credentials);\n * ```\n */\nexport class FormAuthProvider extends BaseAuthProvider {\n  private readonly config: FormAuthProviderConfig;\n  private currentRole: string = 'unknown';\n\n  /**\n   * Create form auth provider\n   *\n   * @param config - Form auth configuration\n   * @param retryOptions - Optional retry configuration\n   */\n  constructor(\n    config: FormAuthProviderConfig,\n    retryOptions: AuthRetryOptions = {}\n  ) {\n    super('form', retryOptions);\n    this.config = config;\n  }\n\n  /**\n   * Set the role for error reporting\n   */\n  setRole(role: string): void {\n    this.currentRole = role;\n  }\n\n  /**\n   * Perform form-based login\n   *\n   * @param page - Playwright Page\n   * @param credentials - User credentials\n   * @throws ARTKAuthError on login failure\n   */\n  async login(page: Page, credentials: Credentials): Promise<void> {\n    let lastError: ARTKAuthError | undefined;\n\n    for (let attempt = 0; attempt <= this.retryOptions.maxRetries; attempt++) {\n      try {\n        // Navigate to login page\n        await this.navigateToLogin(page);\n\n        // Fill credentials\n        await this.fillCredentials(page, credentials);\n\n        // Submit form\n        await this.submitForm(page);\n\n        // Wait for success\n        await this.waitForSuccess(page);\n\n        this.logger.info('Form login successful', {\n          role: this.currentRole,\n          attempts: attempt + 1,\n        });\n        return;\n      } catch (error) {\n        lastError = error instanceof ARTKAuthError\n          ? error\n          : new ARTKAuthError(\n              error instanceof Error ? error.message : String(error),\n              this.currentRole,\n              'credentials'\n            );\n\n        if (attempt < this.retryOptions.maxRetries && this.shouldRetry(lastError)) {\n          const delay = this.calculateRetryDelay(attempt);\n\n          this.logger.warn(`Form login attempt ${attempt + 1} failed, retrying in ${delay}ms`, {\n            role: this.currentRole,\n            attempt: attempt + 1,\n            delayMs: delay,\n            error: lastError.message,\n          });\n\n          await this.sleep(delay);\n        }\n      }\n    }\n\n    this.logger.error('Form login failed after all retries', {\n      role: this.currentRole,\n      maxRetries: this.retryOptions.maxRetries,\n      error: lastError?.message,\n    });\n\n    throw new ARTKAuthError(\n      `Form login failed after ${this.retryOptions.maxRetries + 1} attempts: ${lastError?.message ?? 'Unknown error'}`,\n      this.currentRole,\n      lastError?.phase ?? 'credentials',\n      undefined,\n      `Verify credentials for role \"${this.currentRole}\" are correct. Check login URL and form selectors.`\n    );\n  }\n\n  /**\n   * Navigate to the login page\n   */\n  private async navigateToLogin(page: Page): Promise<void> {\n    const timeout = this.config.timeouts?.navigationMs ?? DEFAULT_TIMEOUTS.navigationMs;\n\n    this.logger.debug('Navigating to login page', { url: this.config.loginUrl });\n\n    try {\n      await page.goto(this.config.loginUrl, {\n        waitUntil: 'domcontentloaded',\n        timeout,\n      });\n    } catch (error) {\n      const message = error instanceof Error ? error.message : String(error);\n      throw new ARTKAuthError(\n        `Failed to navigate to login page: ${message}`,\n        this.currentRole,\n        'navigation',\n        undefined,\n        `Verify the login URL is correct and accessible: ${this.config.loginUrl}`\n      );\n    }\n  }\n\n  /**\n   * Fill credentials in the login form\n   */\n  private async fillCredentials(page: Page, credentials: Credentials): Promise<void> {\n    const { selectors } = this.config;\n\n    this.logger.debug('Filling credentials');\n\n    try {\n      // Wait for and fill username\n      await this.fillField(page, selectors.username, credentials.username);\n\n      // Wait for and fill password\n      await this.fillField(page, selectors.password, credentials.password);\n    } catch (error) {\n      const message = error instanceof Error ? error.message : String(error);\n      throw new ARTKAuthError(\n        `Failed to fill credentials: ${message}`,\n        this.currentRole,\n        'credentials',\n        undefined,\n        'Check that username and password selectors are correct'\n      );\n    }\n  }\n\n  /**\n   * Submit the login form\n   */\n  private async submitForm(page: Page): Promise<void> {\n    const { selectors } = this.config;\n\n    this.logger.debug('Submitting login form');\n\n    try {\n      await this.clickElement(page, selectors.submit);\n    } catch (error) {\n      const message = error instanceof Error ? error.message : String(error);\n      throw new ARTKAuthError(\n        `Failed to submit login form: ${message}`,\n        this.currentRole,\n        'credentials',\n        undefined,\n        'Check that submit button selector is correct'\n      );\n    }\n  }\n\n  /**\n   * Wait for successful login\n   */\n  private async waitForSuccess(page: Page): Promise<void> {\n    const { success } = this.config;\n    const timeout = success.timeout ?? DEFAULT_TIMEOUTS.successMs;\n\n    this.logger.debug('Waiting for login success');\n\n    try {\n      await this.waitForLoginSuccess(page, {\n        url: success.url,\n        selector: success.selector,\n        timeout,\n      });\n    } catch (error) {\n      // Check for error messages on page\n      const errorText = await this.detectLoginError(page);\n\n      throw new ARTKAuthError(\n        'Login failed - success condition not met',\n        this.currentRole,\n        'callback',\n        errorText,\n        'Verify credentials are correct and success URL/selector configuration'\n      );\n    }\n  }\n\n  /**\n   * Detect login error messages on page\n   */\n  private async detectLoginError(page: Page): Promise<string | undefined> {\n    const errorSelectors = [\n      '.error-message',\n      '.alert-danger',\n      '.error',\n      '[role=\"alert\"]',\n      '.login-error',\n      '#error',\n    ];\n\n    for (const selector of errorSelectors) {\n      try {\n        const element = page.locator(selector).first();\n        if (await element.isVisible({ timeout: 500 })) {\n          return await element.textContent() ?? undefined;\n        }\n      } catch {\n        // Continue\n      }\n    }\n\n    return undefined;\n  }\n\n  /**\n   * Check if current session is valid\n   */\n  async isSessionValid(page: Page): Promise<boolean> {\n    const { success } = this.config;\n    const currentUrl = page.url();\n\n    // Check if on login page\n    if (currentUrl.includes(this.config.loginUrl)) {\n      return false;\n    }\n\n    // Check URL match\n    if (success.url && !currentUrl.includes(success.url)) {\n      return false;\n    }\n\n    // Check selector presence\n    if (success.selector) {\n      try {\n        await page.waitForSelector(success.selector, { state: 'visible', timeout: 1000 });\n      } catch {\n        return false;\n      }\n    }\n\n    return true;\n  }\n\n  /**\n   * Perform logout\n   */\n  async logout(page: Page): Promise<void> {\n    this.logger.debug('Performing form auth logout');\n\n    // Try common logout URLs\n    const baseUrl = new URL(this.config.loginUrl).origin;\n    const logoutUrls = [\n      `${baseUrl}/logout`,\n      `${baseUrl}/api/logout`,\n      `${baseUrl}/signout`,\n    ];\n\n    for (const url of logoutUrls) {\n      try {\n        const response = await page.goto(url, { waitUntil: 'networkidle', timeout: 5000 });\n        if (response?.ok()) {\n          this.logger.debug('Logout successful', { url });\n          return;\n        }\n      } catch {\n        // Try next\n      }\n    }\n\n    // Clear cookies as fallback\n    await page.context().clearCookies();\n    this.logger.debug('Cleared cookies as logout fallback');\n  }\n\n  /**\n   * Get the form auth configuration\n   */\n  getConfig(): FormAuthProviderConfig {\n    return this.config;\n  }\n}\n\n// =============================================================================\n// Factory Function\n// =============================================================================\n\n/**\n * Create form auth provider from config\n *\n * @param config - Form auth configuration\n * @param retryOptions - Optional retry configuration\n * @returns Form auth provider instance\n */\nexport function createFormAuthProvider(\n  config: FormAuthProviderConfig,\n  retryOptions?: AuthRetryOptions\n): FormAuthProvider {\n  return new FormAuthProvider(config, retryOptions);\n}\n","/**\n * Token-based Authentication Provider\n *\n * Implements the AuthProvider interface for API-based token acquisition.\n * Stores token in browser local storage for reuse across test requests.\n *\n * @module auth/providers/token\n */\n\nimport type { Page } from '@playwright/test';\nimport type { AuthRetryOptions, Credentials, TokenAuthProviderConfig } from '../types.js';\nimport { BaseAuthProvider } from './base.js';\nimport { ARTKAuthError } from '../../errors/auth-error.js';\n\n// =============================================================================\n// Default Configuration\n// =============================================================================\n\n/**\n * Default token auth configuration\n */\nconst DEFAULT_TOKEN_CONFIG = {\n  headerName: 'Authorization',\n  headerPrefix: 'Bearer ',\n  tokenField: 'access_token',\n  timeoutMs: 10000,\n  usernameField: 'username',\n  passwordField: 'password',\n};\n\n/**\n * Local storage key for storing token\n */\nconst TOKEN_STORAGE_KEY = 'artk_auth_token';\n\n// =============================================================================\n// Token Auth Provider\n// =============================================================================\n\n/**\n * Token-based Authentication Provider\n *\n * Handles API-based token acquisition:\n * 1. POST credentials to token endpoint\n * 2. Extract access token from response\n * 3. Store token in browser local storage\n *\n * The stored token can be used by apiContext fixtures for authenticated requests.\n *\n * @example\n * ```typescript\n * const provider = new TokenAuthProvider({\n *   tokenEndpoint: 'https://api.example.com/auth/token',\n *   headerName: 'Authorization',\n *   headerPrefix: 'Bearer ',\n * });\n *\n * await provider.login(page, credentials);\n * // Token is now stored in local storage\n * ```\n */\nexport class TokenAuthProvider extends BaseAuthProvider {\n  private readonly config: TokenAuthProviderConfig;\n  private currentRole: string = 'unknown';\n  private cachedToken: string | undefined;\n\n  /**\n   * Create token auth provider\n   *\n   * @param config - Token auth configuration\n   * @param retryOptions - Optional retry configuration\n   */\n  constructor(\n    config: TokenAuthProviderConfig,\n    retryOptions: AuthRetryOptions = {}\n  ) {\n    super('token', retryOptions);\n    this.config = config;\n  }\n\n  /**\n   * Set the role for error reporting\n   */\n  setRole(role: string): void {\n    this.currentRole = role;\n  }\n\n  /**\n   * Perform token-based login\n   *\n   * Acquires an access token from the token endpoint and stores it\n   * in the browser's local storage for use by test fixtures.\n   *\n   * @param page - Playwright Page\n   * @param credentials - User credentials\n   * @throws ARTKAuthError on login failure\n   */\n  async login(page: Page, credentials: Credentials): Promise<void> {\n    let lastError: ARTKAuthError | undefined;\n\n    for (let attempt = 0; attempt <= this.retryOptions.maxRetries; attempt++) {\n      try {\n        // Acquire token\n        const token = await this.acquireToken(page, credentials);\n\n        // Store token in local storage\n        await this.storeToken(page, token);\n\n        // Cache token for isSessionValid\n        this.cachedToken = token;\n\n        this.logger.info('Token login successful', {\n          role: this.currentRole,\n          attempts: attempt + 1,\n        });\n        return;\n      } catch (error) {\n        lastError = error instanceof ARTKAuthError\n          ? error\n          : new ARTKAuthError(\n              error instanceof Error ? error.message : String(error),\n              this.currentRole,\n              'credentials'\n            );\n\n        if (attempt < this.retryOptions.maxRetries && this.shouldRetry(lastError)) {\n          const delay = this.calculateRetryDelay(attempt);\n\n          this.logger.warn(`Token login attempt ${attempt + 1} failed, retrying in ${delay}ms`, {\n            role: this.currentRole,\n            attempt: attempt + 1,\n            delayMs: delay,\n            error: lastError.message,\n          });\n\n          await this.sleep(delay);\n        }\n      }\n    }\n\n    this.logger.error('Token login failed after all retries', {\n      role: this.currentRole,\n      maxRetries: this.retryOptions.maxRetries,\n      error: lastError?.message,\n    });\n\n    throw new ARTKAuthError(\n      `Token login failed after ${this.retryOptions.maxRetries + 1} attempts: ${lastError?.message ?? 'Unknown error'}`,\n      this.currentRole,\n      lastError?.phase ?? 'credentials',\n      undefined,\n      `Verify credentials for role \"${this.currentRole}\" are correct. Check token endpoint configuration.`\n    );\n  }\n\n  /**\n   * Acquire token from endpoint\n   */\n  private async acquireToken(page: Page, credentials: Credentials): Promise<string> {\n    const {\n      tokenEndpoint,\n      tokenField = DEFAULT_TOKEN_CONFIG.tokenField,\n      timeoutMs = DEFAULT_TOKEN_CONFIG.timeoutMs,\n      requestBody,\n    } = this.config;\n\n    const usernameField = requestBody?.usernameField ?? DEFAULT_TOKEN_CONFIG.usernameField;\n    const passwordField = requestBody?.passwordField ?? DEFAULT_TOKEN_CONFIG.passwordField;\n\n    this.logger.debug('Acquiring token', { endpoint: tokenEndpoint });\n\n    try {\n      // Build request body\n      const body: Record<string, string> = {\n        [usernameField]: credentials.username,\n        [passwordField]: credentials.password,\n        ...requestBody?.additionalFields,\n      };\n\n      // Use page.evaluate to make the request (works around CORS)\n      // Or use Playwright's request context\n      const response = await page.evaluate(\n        async ({ endpoint, body, timeout }): Promise<{ data?: Record<string, unknown>; error?: string }> => {\n          const controller = new AbortController();\n          const timeoutId = setTimeout(() => controller.abort(), timeout);\n\n          try {\n            const res = await fetch(endpoint, {\n              method: 'POST',\n              headers: {\n                'Content-Type': 'application/json',\n              },\n              body: JSON.stringify(body),\n              signal: controller.signal,\n            });\n\n            clearTimeout(timeoutId);\n\n            if (!res.ok) {\n              const text = await res.text().catch(() => '');\n              return { error: `HTTP ${res.status}: ${text}` };\n            }\n\n            return { data: await res.json() as Record<string, unknown> };\n          } catch (e) {\n            clearTimeout(timeoutId);\n            return { error: e instanceof Error ? e.message : String(e) };\n          }\n        },\n        { endpoint: tokenEndpoint, body, timeout: timeoutMs }\n      );\n\n      if (response.error) {\n        throw new ARTKAuthError(\n          `Token request failed: ${response.error}`,\n          this.currentRole,\n          'credentials',\n          response.error,\n          'Check credentials and token endpoint configuration'\n        );\n      }\n\n      // Extract token from response\n      const token = response.data?.[tokenField] as string | undefined;\n\n      if (!token) {\n        throw new ARTKAuthError(\n          `Token not found in response (expected field: ${tokenField})`,\n          this.currentRole,\n          'callback',\n          JSON.stringify(response.data).slice(0, 200),\n          `Check that token endpoint returns token in \"${tokenField}\" field`\n        );\n      }\n\n      return token;\n    } catch (error) {\n      if (error instanceof ARTKAuthError) {\n        throw error;\n      }\n\n      const message = error instanceof Error ? error.message : String(error);\n      throw new ARTKAuthError(\n        `Token acquisition failed: ${message}`,\n        this.currentRole,\n        'credentials',\n        undefined,\n        'Check token endpoint URL and network connectivity'\n      );\n    }\n  }\n\n  /**\n   * Store token in browser local storage\n   */\n  private async storeToken(page: Page, token: string): Promise<void> {\n    const {\n      headerName = DEFAULT_TOKEN_CONFIG.headerName,\n      headerPrefix = DEFAULT_TOKEN_CONFIG.headerPrefix,\n    } = this.config;\n\n    // Store token and header config\n    await page.evaluate(\n      ({ key, token, headerName, headerPrefix }) => {\n        localStorage.setItem(key, JSON.stringify({\n          token,\n          headerName,\n          headerPrefix,\n          timestamp: Date.now(),\n        }));\n      },\n      { key: TOKEN_STORAGE_KEY, token, headerName, headerPrefix }\n    );\n\n    this.logger.debug('Token stored in local storage');\n  }\n\n  /**\n   * Check if current session is valid\n   */\n  async isSessionValid(page: Page): Promise<boolean> {\n    try {\n      const stored = await page.evaluate((key): { token?: string } | null => {\n        const data = localStorage.getItem(key);\n        if (!data) {return null;}\n        return JSON.parse(data) as { token?: string };\n      }, TOKEN_STORAGE_KEY);\n\n      if (!stored?.token) {\n        return false;\n      }\n\n      // Token exists - could add JWT expiry check here\n      return true;\n    } catch {\n      return false;\n    }\n  }\n\n  /**\n   * Perform logout - clear stored token\n   */\n  async logout(page: Page): Promise<void> {\n    this.logger.debug('Performing token auth logout');\n\n    await page.evaluate((key) => {\n      localStorage.removeItem(key);\n    }, TOKEN_STORAGE_KEY);\n\n    this.cachedToken = undefined;\n    this.logger.debug('Token cleared from local storage');\n  }\n\n  /**\n   * Get the current cached token\n   */\n  getToken(): string | undefined {\n    return this.cachedToken;\n  }\n\n  /**\n   * Get the token auth configuration\n   */\n  getConfig(): TokenAuthProviderConfig {\n    return this.config;\n  }\n\n  /**\n   * Get the authorization header value\n   */\n  getAuthHeader(): string | undefined {\n    if (!this.cachedToken) {\n      return undefined;\n    }\n\n    const prefix = this.config.headerPrefix ?? DEFAULT_TOKEN_CONFIG.headerPrefix;\n    return `${prefix}${this.cachedToken}`;\n  }\n\n  /**\n   * Get the header name for authorization\n   */\n  getHeaderName(): string {\n    return this.config.headerName ?? DEFAULT_TOKEN_CONFIG.headerName;\n  }\n}\n\n// =============================================================================\n// Factory Function\n// =============================================================================\n\n/**\n * Create token auth provider from config\n *\n * @param config - Token auth configuration\n * @param retryOptions - Optional retry configuration\n * @returns Token auth provider instance\n */\nexport function createTokenAuthProvider(\n  config: TokenAuthProviderConfig,\n  retryOptions?: AuthRetryOptions\n): TokenAuthProvider {\n  return new TokenAuthProvider(config, retryOptions);\n}\n\n// =============================================================================\n// Utility Functions\n// =============================================================================\n\n/**\n * Get stored token from page local storage\n *\n * @param page - Playwright Page\n * @returns Stored token data or undefined\n */\nexport async function getStoredToken(page: Page): Promise<{\n  token: string;\n  headerName: string;\n  headerPrefix: string;\n  timestamp: number;\n} | undefined> {\n  try {\n    const stored = await page.evaluate((key) => {\n      const data = localStorage.getItem(key);\n      if (!data) {return null;}\n      return JSON.parse(data);\n    }, TOKEN_STORAGE_KEY);\n\n    return stored ?? undefined;\n  } catch {\n    return undefined;\n  }\n}\n","/**\n * Auth Setup Factory\n *\n * Creates Playwright auth setup project configurations for each role.\n * These projects run before browser tests to establish authenticated sessions.\n *\n * FR-007: Persist authentication state to files and reuse valid state across test runs\n * FR-009: Support multiple named roles with separate credentials and storage states\n *\n * @module auth/setup-factory\n */\n\nimport * as path from 'node:path';\nimport type { AuthSetupOptions, AuthSetupProject } from './types.js';\nimport type { ARTKConfig, AuthConfig, RoleConfig } from '../config/types.js';\nimport { DEFAULT_STORAGE_STATE_CONFIG } from './storage-state.js';\nimport { createLogger } from '../utils/logger.js';\n\nconst logger = createLogger('auth', 'setup-factory');\n\n// =============================================================================\n// Default Configuration\n// =============================================================================\n\n/**\n * Default auth setup options\n */\nconst DEFAULT_AUTH_SETUP_OPTIONS: Required<AuthSetupOptions> = {\n  outputDir: DEFAULT_STORAGE_STATE_CONFIG.directory,\n  filePattern: DEFAULT_STORAGE_STATE_CONFIG.filePattern,\n  forceReauth: false,\n};\n\n// =============================================================================\n// Auth Setup Factory\n// =============================================================================\n\n/**\n * Create Playwright auth setup project configuration for a role\n *\n * Creates a project configuration that:\n * 1. Runs before browser tests\n * 2. Checks for valid existing storage state\n * 3. Authenticates and saves storage state if needed\n *\n * @param role - Role name (e.g., 'admin', 'standardUser')\n * @param authConfig - Authentication configuration\n * @param options - Optional setup configuration\n * @returns Playwright project configuration with name, testMatch, and setup paths\n */\nexport function createAuthSetup(\n  role: string,\n  authConfig: AuthConfig,\n  _options: AuthSetupOptions = {}\n): AuthSetupProject {\n  logger.debug('Creating auth setup for role', { role });\n\n  // Validate role exists\n  const roleConfig = authConfig.roles[role];\n  if (!roleConfig) {\n    throw new Error(`Role \"${role}\" not found in auth configuration`);\n  }\n\n  // Generate project name\n  const projectName = `auth-setup-${role}`;\n\n  return {\n    name: projectName,\n    testMatch: '**/auth.setup.ts',\n    setup: `auth/setup/${role}.setup.ts`,\n  };\n}\n\n/**\n * Create auth setup projects for all configured roles\n *\n * FR-009: Support multiple named roles with separate credentials and storage states\n *\n * @param authConfig - Authentication configuration\n * @param options - Optional setup configuration\n * @returns Array of Playwright project configurations for all roles\n */\nexport function createAllAuthSetups(\n  authConfig: AuthConfig,\n  options: AuthSetupOptions = {}\n): AuthSetupProject[] {\n  const roles = Object.keys(authConfig.roles);\n\n  logger.debug('Creating auth setups for all roles', { roles });\n\n  return roles.map((role) => createAuthSetup(role, authConfig, options));\n}\n\n/**\n * Create auth setup code for a role\n *\n * Generates the TypeScript code for an auth setup file that can be\n * imported into Playwright's globalSetup.\n *\n * @param role - Role name\n * @param authConfig - Authentication configuration\n * @returns TypeScript code as string\n */\nexport function generateAuthSetupCode(role: string, authConfig: AuthConfig): string {\n  const roleConfig = authConfig.roles[role];\n  if (!roleConfig) {\n    throw new Error(`Role \"${role}\" not found in auth configuration`);\n  }\n\n  return `/**\n * Auth Setup for role: ${role}\n *\n * This file is auto-generated by ARTK.\n * It runs before browser tests to establish an authenticated session.\n */\n\nimport { chromium } from '@playwright/test';\nimport {\n  getCredentials,\n  saveStorageState,\n  loadStorageState,\n  cleanupExpiredStorageStates,\n  createAuthProviderFromConfig,\n} from '@artk/core/auth';\nimport { loadConfig } from '@artk/core/config';\n\nasync function setup() {\n  // Load configuration\n  const config = await loadConfig();\n\n  // Cleanup expired storage states (NFR-007)\n  await cleanupExpiredStorageStates();\n\n  // Check for valid existing storage state\n  const existingState = await loadStorageState('${role}', {\n    directory: config.auth.storageState.directory,\n    maxAgeMinutes: config.auth.storageState.maxAgeMinutes,\n  });\n\n  if (existingState) {\n    console.log('Reusing existing storage state for role: ${role}');\n    return;\n  }\n\n  console.log('Authenticating for role: ${role}');\n\n  // Get credentials\n  const credentials = getCredentials('${role}', config.auth);\n\n  // Create auth provider\n  const provider = createAuthProviderFromConfig(config.auth, '${role}');\n\n  // Launch browser\n  const browser = await chromium.launch();\n  const context = await browser.newContext();\n  const page = await context.newPage();\n\n  try {\n    // Perform login\n    await provider.login(page, credentials);\n\n    // Save storage state\n    await saveStorageState(context, '${role}', {\n      directory: config.auth.storageState.directory,\n      filePattern: config.auth.storageState.filePattern,\n    });\n\n    console.log('Authentication successful for role: ${role}');\n  } finally {\n    await browser.close();\n  }\n}\n\nexport default setup;\n`;\n}\n\n// =============================================================================\n// Playwright Config Integration\n// =============================================================================\n\n/**\n * Generate Playwright project configurations for auth setup\n *\n * Creates the full project configuration array needed for playwright.config.ts\n * including dependencies between auth setups and browser tests.\n *\n * Use these projects in playwright.config.ts by spreading them into the projects\n * array and setting browser test projects to depend on them.\n *\n * @param config - Full ARTK configuration\n * @returns Array of Playwright project configurations with name, testMatch, and metadata\n */\nexport function generateAuthProjects(config: ARTKConfig): PlaywrightAuthProject[] {\n  const authConfig = config.auth;\n  const roles = Object.keys(authConfig.roles);\n\n  return roles.map((role) => ({\n    name: `auth-setup-${role}`,\n    testMatch: /auth\\.setup\\.ts$/,\n    metadata: {\n      role,\n      storageStatePath: getStorageStatePath(role, {\n        outputDir: authConfig.storageState.directory,\n        filePattern: authConfig.storageState.filePattern,\n      }),\n    },\n  }));\n}\n\n/**\n * Get storage state file path for a role\n */\nfunction getStorageStatePath(role: string, options: AuthSetupOptions): string {\n  const directory = options.outputDir ?? DEFAULT_AUTH_SETUP_OPTIONS.outputDir;\n  const pattern = options.filePattern ?? DEFAULT_AUTH_SETUP_OPTIONS.filePattern;\n\n  const filename = pattern.replace('{role}', role).replace('{env}', 'default');\n  return path.join(directory, filename.endsWith('.json') ? filename : `${filename}.json`);\n}\n\n/**\n * Playwright project configuration for auth\n */\nexport interface PlaywrightAuthProject {\n  name: string;\n  testMatch: RegExp;\n  metadata: {\n    role: string;\n    storageStatePath: string;\n  };\n}\n\n// =============================================================================\n// Auth Provider Factory\n// =============================================================================\n\n/**\n * Create an auth provider from configuration\n *\n * Factory function that creates the appropriate AuthProvider based on\n * the configuration's provider type.\n *\n * @param authConfig - Authentication configuration\n * @param role - Role name for provider setup\n * @returns AuthProvider instance\n */\nexport function createAuthProviderFromConfig(\n  authConfig: AuthConfig,\n  role: string\n): AuthProviderLike {\n  const roleConfig = authConfig.roles[role];\n  if (!roleConfig) {\n    throw new Error(`Role \"${role}\" not found in auth configuration`);\n  }\n\n  const providerType = authConfig.provider;\n\n  // Lazy import to avoid circular dependencies\n  switch (providerType) {\n    case 'oidc': {\n      // Dynamic import would be ideal, but for now we return a factory pattern\n      return {\n        type: 'oidc',\n        role,\n        config: authConfig.oidc!,\n        roleOverrides: roleConfig.oidcOverrides,\n      } as AuthProviderLike;\n    }\n\n    case 'form': {\n      return {\n        type: 'form',\n        role,\n        config: authConfig.form!,\n      } as AuthProviderLike;\n    }\n\n    case 'token': {\n      return {\n        type: 'token',\n        role,\n        // Token config would be in a similar structure\n      } as AuthProviderLike;\n    }\n\n    case 'custom': {\n      return {\n        type: 'custom',\n        role,\n      } as AuthProviderLike;\n    }\n\n    default:\n      throw new Error(`Unknown auth provider type: ${providerType}`);\n  }\n}\n\n/**\n * Auth provider-like object for lazy instantiation\n */\nexport interface AuthProviderLike {\n  type: 'oidc' | 'form' | 'token' | 'custom';\n  role: string;\n  config?: unknown;\n  roleOverrides?: unknown;\n}\n\n// =============================================================================\n// Helper Functions\n// =============================================================================\n\n/**\n * Get all configured role names\n */\nexport function getRoleNames(authConfig: AuthConfig): string[] {\n  return Object.keys(authConfig.roles);\n}\n\n/**\n * Get storage state directory path\n */\nexport function getStorageStateDirectory(authConfig: AuthConfig, projectRoot: string = process.cwd()): string {\n  return path.join(projectRoot, authConfig.storageState.directory);\n}\n\n/**\n * Check if a role is configured\n */\nexport function hasRole(role: string, authConfig: AuthConfig): boolean {\n  return role in authConfig.roles;\n}\n\n/**\n * Get role configuration\n */\nexport function getRoleConfig(role: string, authConfig: AuthConfig): RoleConfig | undefined {\n  return authConfig.roles[role];\n}\n","/**\n * Authenticated Page Fixtures (T050, T051)\n *\n * Provides pre-authenticated page fixtures for different roles:\n * - authenticatedPage: Page for default role\n * - adminPage: Page for admin role\n * - userPage: Page for standardUser role\n *\n * @module fixtures/auth\n * @see FR-006: OIDC authentication support\n * @see FR-007: Storage state persistence\n */\n\nimport type { Browser, BrowserContext, Page } from '@playwright/test';\nimport { getStorageStatePathForRole, isStorageStateValidForRole, testWithConfig } from './base.js';\nimport type { ARTKConfig } from '../config/types.js';\nimport { createLogger } from '../utils/logger.js';\n\nconst logger = createLogger('fixtures', 'auth');\n\n// =============================================================================\n// Authenticated Page Fixtures\n// =============================================================================\n\n/**\n * Fixtures providing authenticated pages for different roles\n */\nexport interface AuthPageFixtures {\n  /** Page authenticated as the default role (from fixtures.defaultRole) */\n  authenticatedPage: Page;\n\n  /** Page authenticated as admin role */\n  adminPage: Page;\n\n  /** Page authenticated as standardUser role */\n  userPage: Page;\n}\n\n/**\n * Create an authenticated browser context for a role\n *\n * @param browser - Playwright Browser instance\n * @param config - ARTK configuration\n * @param role - Role to authenticate as\n * @returns Authenticated BrowserContext\n */\nasync function createAuthenticatedContext(\n  browser: Browser,\n  config: ARTKConfig,\n  role: string\n): Promise<BrowserContext> {\n  const storageStatePath = getStorageStatePathForRole(config, role);\n  const isValid = await isStorageStateValidForRole(config, role);\n\n  if (!isValid) {\n    logger.warn('Storage state not valid or missing for role', {\n      role,\n      path: storageStatePath,\n      suggestion: 'Run auth setup before tests',\n    });\n  }\n\n  logger.debug('Creating authenticated context', { role, storageStatePath });\n\n  // Try to use storage state if it exists\n  const { existsSync } = await import('node:fs');\n  const contextOptions: Parameters<Browser['newContext']>[0] = {};\n\n  if (existsSync(storageStatePath)) {\n    contextOptions.storageState = storageStatePath;\n    logger.info('Using storage state for role', { role, path: storageStatePath });\n  } else {\n    logger.warn('Storage state file not found', {\n      role,\n      path: storageStatePath,\n      hint: 'Tests may fail if authentication is required',\n    });\n  }\n\n  // Apply browser configuration from config\n  if (config.browsers) {\n    contextOptions.viewport = config.browsers.viewport;\n  }\n\n  return browser.newContext(contextOptions);\n}\n\n/**\n * Create an authenticated page for a role\n *\n * @param browser - Playwright Browser instance\n * @param config - ARTK configuration\n * @param role - Role to authenticate as\n * @returns Object with page and cleanup function\n */\nasync function createAuthenticatedPage(\n  browser: Browser,\n  config: ARTKConfig,\n  role: string\n): Promise<{ page: Page; cleanup: () => Promise<void> }> {\n  const context = await createAuthenticatedContext(browser, config, role);\n  const page = await context.newPage();\n\n  return {\n    page,\n    cleanup: async () => {\n      await page.close();\n      await context.close();\n    },\n  };\n}\n\n/**\n * Create a role-specific page fixture\n *\n * This factory creates fixture definitions for specific roles.\n * Used internally to generate adminPage, userPage, etc.\n *\n * @param role - Role name from config\n * @returns Fixture definition for use in test.extend()\n *\n * @example\n * ```typescript\n * // Creating a custom role fixture\n * const managerPageFixture = createRolePageFixture('manager');\n *\n * const test = baseTest.extend({\n *   managerPage: managerPageFixture,\n * });\n * ```\n */\nexport function createRolePageFixture(role: string) {\n  return async (\n    { browser, config }: { browser: Browser; config: ARTKConfig },\n    use: (page: Page) => Promise<void>\n  ): Promise<void> => {\n    // Validate role exists in config\n    if (!config.auth.roles[role]) {\n      const availableRoles = Object.keys(config.auth.roles).join(', ');\n      throw new Error(\n        `Role \"${role}\" not found in auth configuration. Available roles: ${availableRoles}`\n      );\n    }\n\n    logger.debug('Creating page fixture for role', { role });\n    const { page, cleanup } = await createAuthenticatedPage(browser, config, role);\n\n    try {\n      await use(page);\n    } finally {\n      await cleanup();\n    }\n  };\n}\n\n/**\n * Test extended with authenticated page fixtures\n *\n * @example\n * ```typescript\n * import { testWithAuthPages } from '@artk/core/fixtures/auth';\n *\n * testWithAuthPages('admin can access dashboard', async ({ authenticatedPage }) => {\n *   await authenticatedPage.goto('/dashboard');\n * });\n *\n * testWithAuthPages('admin vs user comparison', async ({ adminPage, userPage }) => {\n *   // Both pages are authenticated with different roles\n * });\n * ```\n */\nexport const testWithAuthPages = testWithConfig.extend<AuthPageFixtures>({\n  // Default authenticated page - uses fixtures.defaultRole from config\n  authenticatedPage: async ({ browser, config }, use) => {\n    const defaultRole = config.fixtures.defaultRole;\n\n    if (!config.auth.roles[defaultRole]) {\n      throw new Error(\n        `Default role \"${defaultRole}\" not found in auth.roles. ` +\n        `Update fixtures.defaultRole in your config to a valid role.`\n      );\n    }\n\n    const { page, cleanup } = await createAuthenticatedPage(browser, config, defaultRole);\n\n    try {\n      await use(page);\n    } finally {\n      await cleanup();\n    }\n  },\n\n  // Admin page fixture\n  adminPage: async ({ browser, config }, use) => {\n    const role = 'admin';\n\n    // Check if admin role exists, fall back to first available role if not\n    const effectiveRole = config.auth.roles[role] ? role : Object.keys(config.auth.roles)[0];\n\n    if (!effectiveRole) {\n      throw new Error('No roles defined in auth configuration');\n    }\n\n    if (effectiveRole !== role) {\n      logger.warn('admin role not found, using fallback', { fallback: effectiveRole });\n    }\n\n    const { page, cleanup } = await createAuthenticatedPage(browser, config, effectiveRole);\n\n    try {\n      await use(page);\n    } finally {\n      await cleanup();\n    }\n  },\n\n  // User page fixture (standardUser or similar)\n  userPage: async ({ browser, config }, use) => {\n    // Try common user role names\n    const userRoleNames = ['standardUser', 'user', 'viewer', 'member'];\n    let effectiveRole: string | undefined;\n\n    for (const roleName of userRoleNames) {\n      if (config.auth.roles[roleName]) {\n        effectiveRole = roleName;\n        break;\n      }\n    }\n\n    // Fall back to any non-admin role, or admin if nothing else\n    if (!effectiveRole) {\n      const availableRoles = Object.keys(config.auth.roles);\n      effectiveRole = availableRoles.find(r => r !== 'admin') ?? availableRoles[0];\n    }\n\n    if (!effectiveRole) {\n      throw new Error('No roles defined in auth configuration');\n    }\n\n    logger.debug('Using user role', { role: effectiveRole });\n    const { page, cleanup } = await createAuthenticatedPage(browser, config, effectiveRole);\n\n    try {\n      await use(page);\n    } finally {\n      await cleanup();\n    }\n  },\n});\n\n// =============================================================================\n// Dynamic Role Fixture Factory\n// =============================================================================\n\n/**\n * Create fixtures for all configured role fixtures\n *\n * Uses fixtures.roleFixtures from config to generate named page fixtures.\n *\n * @param config - ARTK configuration\n * @returns Object with fixture definitions for each role\n *\n * @example\n * ```typescript\n * const roleFixtures = createDynamicRoleFixtures(config);\n * // Returns { adminPage: fixture, viewerPage: fixture, ... }\n * ```\n */\nexport function createDynamicRoleFixtures(\n  config: ARTKConfig\n): Record<string, ReturnType<typeof createRolePageFixture>> {\n  const fixtures: Record<string, ReturnType<typeof createRolePageFixture>> = {};\n\n  // Get configured role fixtures\n  const roleFixtureNames = config.fixtures.roleFixtures ?? [];\n\n  for (const role of roleFixtureNames) {\n    // Create PascalCase fixture name: admin -> adminPage\n    const fixtureName = `${role}Page`;\n    fixtures[fixtureName] = createRolePageFixture(role);\n  }\n\n  return fixtures;\n}\n\n/**\n * Get all available role names from config\n *\n * @param config - ARTK configuration\n * @returns Array of role names\n */\nexport function getAvailableRoles(config: ARTKConfig): readonly string[] {\n  return Object.keys(config.auth.roles);\n}\n","/**\n * API Context Fixtures (T052)\n *\n * Provides pre-authenticated API request context for making\n * authenticated API calls in tests.\n *\n * @module fixtures/api\n * @see FR-021: API context with authentication headers\n */\n\nimport { type APIRequestContext, request as playwrightRequest } from '@playwright/test';\nimport { testWithAuthPages } from './auth.js';\nimport type { ARTKConfig } from '../config/types.js';\nimport { createLogger } from '../utils/logger.js';\n\nconst logger = createLogger('fixtures', 'api');\n\n// =============================================================================\n// API Context Fixtures\n// =============================================================================\n\n/**\n * Fixtures providing authenticated API context\n */\nexport interface APIContextFixtures {\n  /** API request context with authentication */\n  apiContext: APIRequestContext;\n}\n\n/**\n * Options for creating an API context (mutable version for internal use)\n */\ninterface MutableAPIContextOptions {\n  baseURL?: string;\n  extraHTTPHeaders?: Record<string, string>;\n  storageState?: string;\n}\n\n/**\n * Create API context options from config\n *\n * @param config - ARTK configuration\n * @param storageStatePath - Optional path to storage state for cookie auth\n * @returns API context options\n */\nfunction createAPIContextOptions(\n  config: ARTKConfig,\n  storageStatePath?: string\n): MutableAPIContextOptions {\n  const options: MutableAPIContextOptions = {};\n\n  // Use fixtures.api.baseURL if configured, otherwise use data.api.baseUrl or app.baseUrl\n  if (config.fixtures.api?.baseURL) {\n    options.baseURL = config.fixtures.api.baseURL;\n  } else if (config.data.api?.baseUrl) {\n    options.baseURL = config.data.api.baseUrl;\n  } else {\n    // Resolve base URL from active environment or app config\n    const envConfig = config.environments[config.activeEnvironment];\n    options.baseURL = envConfig?.apiUrl ?? envConfig?.baseUrl ?? config.app.baseUrl;\n  }\n\n  // Merge extra HTTP headers\n  const headers: Record<string, string> = {};\n\n  if (config.fixtures.api?.extraHTTPHeaders) {\n    Object.assign(headers, config.fixtures.api.extraHTTPHeaders);\n  }\n\n  if (Object.keys(headers).length > 0) {\n    options.extraHTTPHeaders = headers;\n  }\n\n  // Add storage state for cookie-based auth\n  if (storageStatePath) {\n    options.storageState = storageStatePath;\n  }\n\n  return options;\n}\n\n/**\n * Create an authenticated API context\n *\n * @param config - ARTK configuration\n * @param storageStatePath - Optional storage state path\n * @returns APIRequestContext instance\n *\n * @example\n * ```typescript\n * const apiContext = await createAPIContext(config, storageStatePath);\n * const response = await apiContext.get('/api/users');\n * await apiContext.dispose();\n * ```\n */\nexport async function createAPIContext(\n  config: ARTKConfig,\n  storageStatePath?: string\n): Promise<APIRequestContext> {\n  const options = createAPIContextOptions(config, storageStatePath);\n\n  logger.debug('Creating API context', {\n    baseURL: options.baseURL,\n    hasStorageState: !!options.storageState,\n    headerCount: Object.keys(options.extraHTTPHeaders ?? {}).length,\n  });\n\n  return playwrightRequest.newContext({\n    baseURL: options.baseURL,\n    extraHTTPHeaders: options.extraHTTPHeaders,\n    storageState: options.storageState,\n  });\n}\n\n/**\n * Create a new API context with custom options\n *\n * @param options - Custom API context options\n * @returns New APIRequestContext with custom configuration\n */\nexport async function createCustomAPIContext(\n  options: MutableAPIContextOptions\n): Promise<APIRequestContext> {\n  logger.debug('Creating custom API context', {\n    baseURL: options.baseURL,\n    hasStorageState: !!options.storageState,\n  });\n\n  return playwrightRequest.newContext({\n    baseURL: options.baseURL,\n    extraHTTPHeaders: options.extraHTTPHeaders,\n    storageState: options.storageState,\n  });\n}\n\n/**\n * Test extended with API context fixture\n *\n * @example\n * ```typescript\n * import { testWithAPIContext } from '@artk/core/fixtures/api';\n *\n * testWithAPIContext('can call API', async ({ apiContext }) => {\n *   const response = await apiContext.get('/api/status');\n *   expect(response.ok()).toBe(true);\n * });\n * ```\n */\nexport const testWithAPIContext = testWithAuthPages.extend<APIContextFixtures>({\n  apiContext: async ({ config }, use) => {\n    // Get storage state path for default role (for cookie-based auth)\n    const { getStorageStatePathForRole } = await import('./base.js');\n    const { existsSync } = await import('node:fs');\n\n    const defaultRole = config.fixtures.defaultRole;\n    const storageStatePath = getStorageStatePathForRole(config, defaultRole);\n    const storageStateExists = existsSync(storageStatePath);\n\n    // Resolve base URL\n    const envConfig = config.environments[config.activeEnvironment];\n    const apiBaseUrl = config.fixtures.api?.baseURL\n      ?? config.data.api?.baseUrl\n      ?? envConfig?.apiUrl\n      ?? envConfig?.baseUrl\n      ?? config.app.baseUrl;\n\n    // Build context options\n    const contextOptions: MutableAPIContextOptions = {\n      baseURL: apiBaseUrl,\n    };\n\n    // Add extra headers if configured\n    if (config.fixtures.api?.extraHTTPHeaders) {\n      contextOptions.extraHTTPHeaders = config.fixtures.api.extraHTTPHeaders as Record<string, string>;\n    }\n\n    // Add storage state for cookie-based auth\n    if (storageStateExists) {\n      contextOptions.storageState = storageStatePath;\n    }\n\n    logger.info('Creating API context', {\n      baseURL: apiBaseUrl,\n      hasStorageState: storageStateExists,\n      role: defaultRole,\n    });\n\n    const apiContext = await playwrightRequest.newContext({\n      baseURL: contextOptions.baseURL,\n      extraHTTPHeaders: contextOptions.extraHTTPHeaders,\n      storageState: contextOptions.storageState,\n    });\n\n    try {\n      await use(apiContext);\n    } finally {\n      await apiContext.dispose();\n    }\n  },\n});\n\n// =============================================================================\n// API Helper Functions\n// =============================================================================\n\n/**\n * Extract auth token from storage state\n *\n * Useful for APIs that require Bearer token authentication\n * rather than cookie-based auth.\n *\n * @param storageStatePath - Path to storage state file\n * @param tokenKey - Key to look for in localStorage (default: 'auth_token')\n * @returns Token string or undefined if not found\n */\nexport async function extractAuthToken(\n  storageStatePath: string,\n  tokenKey: string = 'auth_token'\n): Promise<string | undefined> {\n  const { readFile } = await import('node:fs/promises');\n\n  try {\n    const content = await readFile(storageStatePath, 'utf-8');\n    const state = JSON.parse(content) as {\n      origins?: Array<{\n        origin: string;\n        localStorage: Array<{ name: string; value: string }>;\n      }>;\n    };\n\n    // Search localStorage in all origins\n    for (const origin of state.origins ?? []) {\n      const tokenEntry = origin.localStorage.find(item => item.name === tokenKey);\n      if (tokenEntry) {\n        return tokenEntry.value;\n      }\n    }\n\n    return undefined;\n  } catch (error) {\n    logger.warn('Failed to extract auth token', {\n      path: storageStatePath,\n      error: String(error),\n    });\n    return undefined;\n  }\n}\n\n/**\n * Create API context with Bearer token authentication\n *\n * @param config - ARTK configuration\n * @param token - Bearer token\n * @returns APIRequestContext with Bearer auth header\n */\nexport async function createAPIContextWithToken(\n  config: ARTKConfig,\n  token: string\n): Promise<APIRequestContext> {\n  const options = createAPIContextOptions(config);\n\n  // Add Authorization header\n  const headers = {\n    ...(options.extraHTTPHeaders ?? {}),\n    Authorization: `Bearer ${token}`,\n  };\n\n  logger.debug('Creating API context with token auth');\n\n  return playwrightRequest.newContext({\n    baseURL: options.baseURL,\n    extraHTTPHeaders: headers,\n  });\n}\n","/**\n * Test Data Namespacing Utilities\n *\n * Provides unique run ID generation and namespacing functions for test isolation.\n * Implements FR-025 and FR-026 from spec.md.\n */\n\nimport { randomBytes } from 'node:crypto';\nimport type { NamespaceConfig } from './types.js';\n\n/**\n * Default namespace configuration\n */\nconst DEFAULT_CONFIG: NamespaceConfig = {\n  prefix: '[artk-',\n  suffix: ']',\n};\n\n/**\n * Generate a unique run ID for test isolation\n *\n * @returns Unique identifier (8 character hex string)\n *\n * @example\n * const runId = generateRunId();\n * // => \"a1b2c3d4\"\n */\nexport function generateRunId(): string {\n  return randomBytes(4).toString('hex');\n}\n\n/**\n * Append namespace identifier to a value for test isolation\n *\n * @param value - Original value to namespace\n * @param runId - Unique run ID\n * @param config - Optional namespace configuration\n * @returns Namespaced value with run ID\n *\n * @example\n * namespace('Test Order', 'abc123');\n * // => \"Test Order [artk-abc123]\"\n *\n * namespace('Test Order', 'abc123', { prefix: '(test-', suffix: ')' });\n * // => \"Test Order (test-abc123)\"\n */\nexport function namespace(\n  value: string,\n  runId: string,\n  config: NamespaceConfig = DEFAULT_CONFIG,\n): string {\n  return `${value} ${config.prefix}${runId}${config.suffix}`;\n}\n\n/**\n * Parse namespaced value to extract original value and run ID\n *\n * @param namespacedValue - Value with namespace identifier\n * @param config - Optional namespace configuration\n * @returns Object with original value and run ID, or null if not namespaced\n *\n * @example\n * parseNamespace('Test Order [artk-abc123]');\n * // => { value: 'Test Order', runId: 'abc123' }\n *\n * parseNamespace('Test Order');\n * // => null\n */\nexport function parseNamespace(\n  namespacedValue: string,\n  config: NamespaceConfig = DEFAULT_CONFIG,\n): { value: string; runId: string } | null {\n  // Escape special regex characters in prefix and suffix\n  const escapeRegex = (str: string): string =>\n    str.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&');\n\n  const escapedPrefix = escapeRegex(config.prefix);\n  const escapedSuffix = escapeRegex(config.suffix);\n\n  // Pattern: \"anything space prefix runId suffix\" at end of string\n  const pattern = new RegExp(\n    `^(.+)\\\\s${escapedPrefix}([a-f0-9]+)${escapedSuffix}$`,\n  );\n\n  const match = namespacedValue.match(pattern);\n\n  if (!match || !match[1] || !match[2]) {\n    return null;\n  }\n\n  return {\n    value: match[1],\n    runId: match[2],\n  };\n}\n\n/**\n * Check if a value is namespaced\n *\n * @param value - Value to check\n * @param config - Optional namespace configuration\n * @returns True if value contains namespace identifier\n *\n * @example\n * isNamespaced('Test Order [artk-abc123]');\n * // => true\n *\n * isNamespaced('Test Order');\n * // => false\n */\nexport function isNamespaced(\n  value: string,\n  config: NamespaceConfig = DEFAULT_CONFIG,\n): boolean {\n  return parseNamespace(value, config) !== null;\n}\n","/**\n * Cleanup Manager\n *\n * Manages cleanup operations for test data with priority ordering and error handling.\n * Implements FR-027 and FR-028 from spec.md.\n */\n\nimport { createLogger } from '../utils/logger.js';\nimport type { CleanupEntry, CleanupOptions } from './types.js';\n\n/**\n * Polyfill for AggregateError for Node.js 14 (ES2020) compatibility.\n * AggregateError was introduced in ES2021/Node 15.\n */\ndeclare const AggregateError: {\n  new (errors: Iterable<unknown>, message?: string): Error & { errors: unknown[] };\n} | undefined;\n\nconst AggregateErrorPolyfill: new (\n  errors: Iterable<unknown>,\n  message?: string,\n) => Error & { errors: unknown[] } =\n  typeof AggregateError !== 'undefined'\n    ? AggregateError\n    : class extends Error {\n        errors: unknown[];\n        constructor(errors: Iterable<unknown>, message?: string) {\n          super(message);\n          this.name = 'AggregateError';\n          this.errors = Array.from(errors);\n        }\n      };\n\nconst logger = createLogger('data', 'CleanupManager');\n\n/**\n * Manages cleanup operations for test data lifecycle\n *\n * Features:\n * - Priority-based execution (lower priority runs first)\n * - Continues execution even when cleanup functions fail\n * - Logs all cleanup operations and errors\n * - Supports labeled cleanups for debugging\n *\n * @example\n * const manager = new CleanupManager();\n *\n * manager.register(async () => {\n *   await deleteUser(userId);\n * }, { priority: 10, label: 'Delete user' });\n *\n * manager.register(async () => {\n *   await deleteOrganization(orgId);\n * }, { priority: 20, label: 'Delete organization' });\n *\n * await manager.runAll(); // Deletes user first (priority 10), then org (priority 20)\n */\nexport class CleanupManager {\n  private readonly entries: CleanupEntry[] = [];\n  private cleanupRun = false;\n\n  /**\n   * Register a cleanup function\n   *\n   * @param fn - Async cleanup function\n   * @param options - Optional priority and label\n   */\n  register(fn: () => Promise<void>, options: CleanupOptions = {}): void {\n    const { priority = 100, label } = options;\n\n    if (this.cleanupRun) {\n      logger.warn('Cleanup already run, new registration will be ignored', {\n        label,\n        priority,\n      });\n      return;\n    }\n\n    this.entries.push({\n      fn,\n      priority,\n      label,\n    });\n\n    logger.debug('Cleanup registered', {\n      priority,\n      label: label ?? 'unlabeled',\n      totalEntries: this.entries.length,\n    });\n  }\n\n  /**\n   * Execute all registered cleanup functions\n   *\n   * - Runs in priority order (lower values first)\n   * - Continues execution even if individual cleanups fail\n   * - Logs success and failure for each cleanup\n   * - Throws aggregate error if any cleanups failed\n   *\n   * @throws {AggregateError} If any cleanup functions fail (after all have run)\n   */\n  async runAll(): Promise<void> {\n    if (this.cleanupRun) {\n      logger.warn('Cleanup already executed, skipping duplicate run');\n      return;\n    }\n\n    this.cleanupRun = true;\n\n    if (this.entries.length === 0) {\n      logger.debug('No cleanup entries to execute');\n      return;\n    }\n\n    // Sort by priority (lower values first)\n    const sorted = [...this.entries].sort((a, b) => a.priority - b.priority);\n\n    logger.info(`Executing ${sorted.length} cleanup operations`, {\n      entries: sorted.map((e) => ({\n        priority: e.priority,\n        label: e.label ?? 'unlabeled',\n      })),\n    });\n\n    const errors: Error[] = [];\n\n    for (const entry of sorted) {\n      const label = entry.label ?? 'unlabeled';\n\n      try {\n        logger.debug(`Running cleanup: ${label}`, {\n          priority: entry.priority,\n        });\n\n        await entry.fn();\n\n        logger.debug(`Cleanup succeeded: ${label}`);\n      } catch (error) {\n        const errorMessage = error instanceof Error ? error.message : String(error);\n\n        logger.error(`Cleanup failed: ${label}`, {\n          priority: entry.priority,\n          error: errorMessage,\n        });\n\n        errors.push(\n          new Error(`Cleanup \"${label}\" (priority ${entry.priority}) failed: ${errorMessage}`),\n        );\n\n        // Continue with remaining cleanups despite error\n      }\n    }\n\n    if (errors.length > 0) {\n      logger.error(`${errors.length} cleanup operations failed`, {\n        failedCount: errors.length,\n        totalCount: sorted.length,\n      });\n\n      throw new AggregateErrorPolyfill(\n        errors,\n        `${errors.length} of ${sorted.length} cleanup operations failed`,\n      );\n    }\n\n    logger.info('All cleanup operations completed successfully', {\n      totalCount: sorted.length,\n    });\n  }\n\n  /**\n   * Get count of registered cleanups\n   *\n   * @returns Number of registered cleanup entries\n   */\n  count(): number {\n    return this.entries.length;\n  }\n\n  /**\n   * Check if cleanup has been executed\n   *\n   * @returns True if runAll() has been called\n   */\n  hasRun(): boolean {\n    return this.cleanupRun;\n  }\n\n  /**\n   * Clear all registered cleanups (useful for testing)\n   *\n   * NOTE: Does not reset cleanupRun flag\n   */\n  clear(): void {\n    this.entries.length = 0;\n    logger.debug('All cleanup entries cleared');\n  }\n}\n","/**\n * Data Fixtures (T053, T054)\n *\n * Provides test data isolation and cleanup fixtures:\n * - runId: Unique identifier for test isolation\n * - testData: Manager for cleanup registration\n *\n * @module fixtures/data\n * @see FR-025: Unique run ID generation\n * @see FR-026: Namespacing utilities\n * @see FR-027: Cleanup registration\n * @see FR-028: Cleanup execution\n */\n\nimport { testWithAPIContext } from './api.js';\nimport type { TestDataManager } from './types.js';\nimport type { ARTKConfig } from '../config/types.js';\nimport type { CleanupOptions } from '../data/types.js';\nimport { namespace as dataNamespace, generateRunId as generateDataRunId } from '../data/namespace.js';\nimport { CleanupManager } from '../data/cleanup.js';\nimport { createLogger } from '../utils/logger.js';\n\nconst logger = createLogger('fixtures', 'data');\n\n// =============================================================================\n// Data Fixtures\n// =============================================================================\n\n/**\n * Fixtures providing test data isolation and cleanup\n */\nexport interface DataFixtures {\n  /** Unique run ID for test isolation (8-char hex) */\n  runId: string;\n\n  /** Test data manager for cleanup registration */\n  testData: TestDataManager;\n}\n\n/**\n * Generate a unique run ID for test isolation\n *\n * Format: 8 character hexadecimal string\n *\n * @returns Unique identifier string\n *\n * @example\n * ```typescript\n * const runId = generateRunId(); // 'a1b2c3d4'\n * ```\n */\nexport function generateRunId(): string {\n  return generateDataRunId();\n}\n\n/**\n * Create a test data manager instance\n *\n * @param runId - Run ID for namespacing\n * @param config - ARTK configuration\n * @returns TestDataManager instance\n *\n * @example\n * ```typescript\n * const manager = createTestDataManager('abc123', config);\n * manager.cleanup(async () => { await deleteOrder(orderId); });\n * await manager.runCleanup();\n * ```\n */\nexport function createTestDataManager(\n  runId: string,\n  _config: ARTKConfig\n): TestDataManager {\n  const cleanupManager = new CleanupManager();\n  const pendingApiCleanups: Array<{\n    method: string;\n    url: string;\n    matcher?: Record<string, unknown>;\n  }> = [];\n\n  return {\n    runId,\n\n    cleanup(fn: () => Promise<void>, options?: CleanupOptions): void {\n      cleanupManager.register(fn, options);\n      logger.debug('Cleanup registered', {\n        runId,\n        label: options?.label ?? 'unlabeled',\n        priority: options?.priority ?? 100,\n      });\n    },\n\n    cleanupApi(method: string, url: string, matcher?: Record<string, unknown>): void {\n      pendingApiCleanups.push({ method, url, matcher });\n      logger.debug('API cleanup registered', {\n        runId,\n        method,\n        url,\n      });\n    },\n\n    async runCleanup(): Promise<void> {\n      logger.info('Running cleanups', {\n        runId,\n        registeredCount: cleanupManager.count(),\n        apiCleanupCount: pendingApiCleanups.length,\n      });\n\n      // Run API cleanups first (converted to regular cleanup functions)\n      // Note: API cleanups would need an API context to execute\n      // For now, we log a warning if there are pending API cleanups\n      if (pendingApiCleanups.length > 0) {\n        logger.warn('API cleanups registered but not executed', {\n          count: pendingApiCleanups.length,\n          hint: 'Use cleanup() with async function for actual API calls',\n        });\n      }\n\n      // Run registered cleanups\n      await cleanupManager.runAll();\n    },\n  };\n}\n\n/**\n * Test extended with data fixtures\n *\n * @example\n * ```typescript\n * import { testWithData } from '@artk/core/fixtures/data';\n *\n * testWithData('creates order with cleanup', async ({ testData, runId }) => {\n *   const orderName = `Test Order [${runId}]`;\n *   const order = await createOrder({ name: orderName });\n *\n *   testData.cleanup(async () => {\n *     await deleteOrder(order.id);\n *   }, { priority: 10, label: 'Delete order' });\n *\n *   // Test assertions...\n * });\n * ```\n */\nexport const testWithData = testWithAPIContext.extend<DataFixtures>({\n  // Unique run ID per test\n  runId: async ({}, use) => {\n    const id = generateRunId();\n    logger.debug('Generated run ID', { runId: id });\n    await use(id);\n  },\n\n  // Test data manager with cleanup registration\n  testData: async ({ runId, config }, use) => {\n    const manager = createTestDataManager(runId, config);\n\n    logger.info('Test data manager created', { runId });\n\n    try {\n      await use(manager);\n    } finally {\n      // Always run cleanup, even if test failed\n      const shouldCleanup = config.data.cleanup.enabled;\n      const cleanupOnFailure = config.data.cleanup.onFailure;\n\n      if (shouldCleanup) {\n        logger.debug('Running cleanup after test', {\n          runId,\n          cleanupEnabled: shouldCleanup,\n          cleanupOnFailure,\n        });\n\n        try {\n          await manager.runCleanup();\n        } catch (error) {\n          // Log but don't fail the test if cleanup fails\n          logger.error('Cleanup failed', {\n            runId,\n            error: String(error),\n          });\n        }\n      } else {\n        logger.debug('Cleanup disabled in config', { runId });\n      }\n    }\n  },\n});\n\n// =============================================================================\n// Test Data Utilities\n// =============================================================================\n\n/**\n * Namespace a value with the run ID\n *\n * @param value - Original value\n * @param runId - Run ID\n * @param config - ARTK configuration (for namespace settings)\n * @returns Namespaced value\n *\n * @example\n * ```typescript\n * const name = namespaceValue('Test Order', runId, config);\n * // Returns: 'Test Order [artk-abc123]'\n * ```\n */\nexport function namespaceValue(\n  value: string,\n  runId: string,\n  config: ARTKConfig\n): string {\n  return dataNamespace(value, runId, {\n    prefix: config.data.namespace.prefix,\n    suffix: config.data.namespace.suffix,\n  });\n}\n\n/**\n * Create a unique test name with run ID\n *\n * @param baseName - Base name for the test item\n * @param runId - Run ID\n * @returns Unique name including run ID\n *\n * @example\n * ```typescript\n * const uniqueName = createUniqueName('Order', runId);\n * // Returns: 'Order-abc123'\n * ```\n */\nexport function createUniqueName(baseName: string, runId: string): string {\n  return `${baseName}-${runId}`;\n}\n\n/**\n * Create a unique email address for test data\n *\n * @param prefix - Email prefix\n * @param runId - Run ID\n * @param domain - Email domain (default: 'test.example.com')\n * @returns Unique email address\n *\n * @example\n * ```typescript\n * const email = createUniqueEmail('user', runId);\n * // Returns: 'user-abc123@test.example.com'\n * ```\n */\nexport function createUniqueEmail(\n  prefix: string,\n  runId: string,\n  domain: string = 'test.example.com'\n): string {\n  return `${prefix}-${runId}@${domain}`;\n}\n\n/**\n * Check if cleanup should run based on config and test status\n *\n * @param config - ARTK configuration\n * @param testPassed - Whether the test passed\n * @returns true if cleanup should run\n */\nexport function shouldRunCleanup(config: ARTKConfig, testPassed: boolean): boolean {\n  if (!config.data.cleanup.enabled) {\n    return false;\n  }\n\n  if (!testPassed && !config.data.cleanup.onFailure) {\n    return false;\n  }\n\n  return true;\n}\n","/**\n * ARTK Fixtures Module (T055)\n *\n * Provides pre-built Playwright fixtures for authenticated testing.\n *\n * Key Features:\n * - config: ARTK configuration access\n * - authenticatedPage: Page with default role authentication\n * - adminPage / userPage: Role-specific authenticated pages\n * - apiContext: Authenticated API request context\n * - testData: Cleanup registration with unique run ID\n * - runId: Unique identifier for test isolation\n *\n * @module fixtures\n * @see fixtures.contract.ts for public API contract\n *\n * @example\n * ```typescript\n * // Import the extended test and expect\n * import { test, expect } from '@artk/core/fixtures';\n *\n * test('authenticated user can see dashboard', async ({ authenticatedPage, config }) => {\n *   await authenticatedPage.goto('/dashboard');\n *   await expect(authenticatedPage.locator('h1')).toHaveText(`Welcome to ${config.app.name}`);\n * });\n *\n * test('create order with cleanup', async ({ testData, runId, apiContext }) => {\n *   const order = await apiContext.post('/api/orders', {\n *     data: { name: `Test Order ${runId}` }\n *   });\n *\n *   testData.cleanup(async () => {\n *     await apiContext.delete(`/api/orders/${order.id}`);\n *   });\n *\n *   expect(order.ok()).toBe(true);\n * });\n * ```\n */\n\nimport { expect } from '@playwright/test';\nimport { testWithData } from './data.js';\nimport type { ARTKTestType } from './types.js';\n\n// =============================================================================\n// Extended Test Export\n// =============================================================================\n\n/**\n * Extended Playwright test with all ARTK fixtures\n *\n * This is the primary test export that includes:\n * - config: ARTK configuration\n * - authenticatedPage: Page authenticated as default role\n * - adminPage: Page authenticated as admin role\n * - userPage: Page authenticated as user role\n * - apiContext: Authenticated API request context\n * - testData: Test data manager with cleanup\n * - runId: Unique test run identifier\n *\n * @example\n * ```typescript\n * import { test, expect } from '@artk/core/fixtures';\n *\n * test.describe('Dashboard', () => {\n *   test('shows user info', async ({ authenticatedPage }) => {\n *     await authenticatedPage.goto('/dashboard');\n *     await expect(authenticatedPage.locator('[data-testid=\"user-name\"]')).toBeVisible();\n *   });\n * });\n * ```\n */\nexport const test: ARTKTestType = testWithData;\n\n/**\n * Re-exported expect from Playwright\n *\n * Use this expect for consistency with the extended test.\n */\nexport { expect };\n\n// =============================================================================\n// Type Exports\n// =============================================================================\n\nexport type {\n  // Core fixture types\n  ARTKFixtures,\n  ARTKTestArgs,\n  ARTKTestType,\n  ARTKWorkerArgs,\n  TestDataManager,\n  APIContextOptions,\n  RolePageFixtureConfig,\n  FixtureDefinition,\n  BaseFixtureOptions,\n  AuthenticatedPageOptions,\n  APIContextFixtureOptions,\n} from './types.js';\n\n// =============================================================================\n// Base Fixture Exports\n// =============================================================================\n\nexport {\n  // Base test with config only\n  testWithConfig,\n  type ConfigFixtures,\n\n  // Config utilities\n  ensureConfigLoaded,\n  getStorageStateDirectory,\n  getStorageStatePathForRole,\n  isStorageStateValidForRole,\n} from './base.js';\n\n// =============================================================================\n// Auth Fixture Exports\n// =============================================================================\n\nexport {\n  // Test with authenticated pages\n  testWithAuthPages,\n  type AuthPageFixtures,\n\n  // Fixture factories\n  createRolePageFixture,\n  createDynamicRoleFixtures,\n  getAvailableRoles,\n} from './auth.js';\n\n// =============================================================================\n// API Context Exports\n// =============================================================================\n\nexport {\n  // Test with API context\n  testWithAPIContext,\n  type APIContextFixtures,\n\n  // API context creation\n  createAPIContext,\n  createCustomAPIContext,\n  createAPIContextWithToken,\n\n  // Utilities\n  extractAuthToken,\n} from './api.js';\n\n// =============================================================================\n// Data Fixture Exports\n// =============================================================================\n\nexport {\n  // Test with data fixtures\n  testWithData,\n  type DataFixtures,\n\n  // Run ID generation\n  generateRunId,\n\n  // Test data manager factory\n  createTestDataManager,\n\n  // Utilities\n  namespaceValue,\n  createUniqueName,\n  createUniqueEmail,\n  shouldRunCleanup,\n} from './data.js';\n\n// =============================================================================\n// Re-exports from Core Modules\n// =============================================================================\n\n// Re-export namespace utilities from data module\nexport { namespace, parseNamespace, isNamespaced } from '../data/namespace.js';\n\n// Re-export CleanupManager from data module\nexport { CleanupManager } from '../data/cleanup.js';\n\n// Re-export config types commonly used with fixtures\nexport type {\n  ARTKConfig,\n  FixturesConfig,\n  FixturesApiConfig,\n  AuthConfig,\n  RoleConfig,\n} from '../config/types.js';\n","/**\n * Locator strategy implementations\n *\n * Implements FR-017: Support for role, label, placeholder, text, CSS strategies\n *\n * Provides accessibility-first locator strategies that prioritize\n * semantic HTML and ARIA attributes over brittle CSS selectors.\n *\n * @module locators/strategies\n */\n\nimport type { Locator, Page } from '@playwright/test';\nimport type { ByRoleOptions } from './types.js';\n\n// =============================================================================\n// Accessibility-First Strategy Functions\n// =============================================================================\n\n/**\n * Locate element by ARIA role\n *\n * Uses Playwright's getByRole which queries based on ARIA role attribute.\n * This is the most robust strategy for interactive elements.\n *\n * @param page - Playwright Page object\n * @param role - ARIA role name\n * @param options - Additional role-based filters\n * @returns Locator for matching elements\n *\n * @example\n * ```ts\n * // Locate button by role\n * byRole(page, 'button', { name: 'Submit' })\n *\n * // Locate heading by role and level\n * byRole(page, 'heading', { level: 1 })\n *\n * // Locate checkbox by role and state\n * byRole(page, 'checkbox', { name: 'Accept terms', checked: true })\n * ```\n */\nexport function byRole(\n  page: Page,\n  role: string,\n  options?: ByRoleOptions\n): Locator {\n  // Convert our options to Playwright's format\n  const playwrightOptions: Parameters<Page['getByRole']>[1] = {};\n\n  if (options) {\n    if (options.name !== undefined) {\n      playwrightOptions.name = options.name;\n    }\n    if (options.checked !== undefined) {\n      playwrightOptions.checked = options.checked;\n    }\n    if (options.disabled !== undefined) {\n      playwrightOptions.disabled = options.disabled;\n    }\n    if (options.expanded !== undefined) {\n      playwrightOptions.expanded = options.expanded;\n    }\n    if (options.level !== undefined) {\n      playwrightOptions.level = options.level;\n    }\n    if (options.pressed !== undefined) {\n      playwrightOptions.pressed = options.pressed;\n    }\n    if (options.selected !== undefined) {\n      playwrightOptions.selected = options.selected;\n    }\n    if (options.exact !== undefined) {\n      playwrightOptions.exact = options.exact;\n    }\n    if (options.includeHidden !== undefined) {\n      playwrightOptions.includeHidden = options.includeHidden;\n    }\n  }\n\n  return page.getByRole(\n    role as Parameters<Page['getByRole']>[0],\n    playwrightOptions\n  );\n}\n\n/**\n * Locate element by associated label text\n *\n * Uses Playwright's getByLabel which finds form controls by their\n * associated <label> element text.\n *\n * @param page - Playwright Page object\n * @param label - Label text (exact match or regex)\n * @param options - Additional options\n * @returns Locator for matching form control\n *\n * @example\n * ```ts\n * // Locate input by label text\n * byLabel(page, 'Email address')\n *\n * // Locate input by label with regex\n * byLabel(page, /email/i)\n *\n * // Locate input by label with exact match\n * byLabel(page, 'Username', { exact: true })\n * ```\n */\nexport function byLabel(\n  page: Page,\n  label: string | RegExp,\n  options?: { exact?: boolean }\n): Locator {\n  return page.getByLabel(label, options);\n}\n\n/**\n * Locate input element by placeholder text\n *\n * Uses Playwright's getByPlaceholder which finds input elements\n * by their placeholder attribute.\n *\n * @param page - Playwright Page object\n * @param placeholder - Placeholder text (exact match or regex)\n * @param options - Additional options\n * @returns Locator for matching input element\n *\n * @example\n * ```ts\n * // Locate input by placeholder\n * byPlaceholder(page, 'Enter your email')\n *\n * // Locate input by placeholder with regex\n * byPlaceholder(page, /search/i)\n *\n * // Locate input by placeholder with exact match\n * byPlaceholder(page, 'Search...', { exact: true })\n * ```\n */\nexport function byPlaceholder(\n  page: Page,\n  placeholder: string | RegExp,\n  options?: { exact?: boolean }\n): Locator {\n  return page.getByPlaceholder(placeholder, options);\n}\n\n/**\n * Locate element by visible text content\n *\n * Uses Playwright's getByText which finds elements containing\n * the specified text. Use sparingly as text can change frequently.\n *\n * @param page - Playwright Page object\n * @param text - Text content (exact match or regex)\n * @param options - Additional options\n * @returns Locator for matching elements\n *\n * @example\n * ```ts\n * // Locate element by text\n * byText(page, 'Click here')\n *\n * // Locate element by text with regex\n * byText(page, /click/i)\n *\n * // Locate element by exact text match\n * byText(page, 'Submit', { exact: true })\n * ```\n */\nexport function byText(\n  page: Page,\n  text: string | RegExp,\n  options?: { exact?: boolean }\n): Locator {\n  return page.getByText(text, options);\n}\n\n/**\n * Locate element by CSS selector\n *\n * Fallback strategy using standard CSS selector.\n * Use only when semantic strategies are not applicable.\n *\n * @param page - Playwright Page object\n * @param selector - CSS selector string\n * @returns Locator for matching elements\n *\n * @example\n * ```ts\n * // Locate by CSS class\n * byCss(page, '.submit-button')\n *\n * // Locate by ID\n * byCss(page, '#login-form')\n *\n * // Locate by complex selector\n * byCss(page, 'form > div.field:nth-child(2) input')\n * ```\n */\nexport function byCss(page: Page, selector: string): Locator {\n  return page.locator(selector);\n}\n\n// =============================================================================\n// Combined Strategy Resolution\n// =============================================================================\n\n/**\n * Try to locate element using specified strategy\n *\n * Returns null if strategy cannot be applied or element not found.\n * Used internally by the locate() function for strategy chaining.\n *\n * @param page - Playwright Page object\n * @param strategy - Strategy name to try\n * @param selector - Selector value appropriate for the strategy\n * @param options - Strategy-specific options\n * @returns Locator if found, null if strategy inapplicable\n *\n * @internal\n */\nexport function tryStrategy(\n  page: Page,\n  strategy: string,\n  selector: string,\n  options?: ByRoleOptions | { exact?: boolean }\n): Locator | null {\n  try {\n    switch (strategy) {\n      case 'role':\n        return byRole(page, selector, options as ByRoleOptions | undefined);\n      case 'label':\n        return byLabel(\n          page,\n          selector,\n          options as { exact?: boolean } | undefined\n        );\n      case 'placeholder':\n        return byPlaceholder(\n          page,\n          selector,\n          options as { exact?: boolean } | undefined\n        );\n      case 'text':\n        return byText(\n          page,\n          selector,\n          options as { exact?: boolean } | undefined\n        );\n      case 'css':\n        return byCss(page, selector);\n      default:\n        return null;\n    }\n  } catch {\n    return null;\n  }\n}\n","/**\n * Test ID locator utilities with custom attribute support\n *\n * Implements FR-019: Custom test ID attribute configuration\n *\n * Provides flexible test ID locator resolution that supports:\n * - Primary test ID attribute (default: 'data-testid')\n * - Multiple custom test ID attributes\n * - Fallback mechanism across configured attributes\n *\n * @module locators/testid\n */\n\nimport type { Locator, Page } from '@playwright/test';\nimport type { LocatorFactoryConfig } from './types.js';\n\n// =============================================================================\n// Test ID Locator Functions\n// =============================================================================\n\n/**\n * Locate element by test ID using configured attribute\n *\n * Tries primary testIdAttribute first, then falls back to customTestIds\n * if configured. Returns first matching element.\n *\n * @param page - Playwright Page object\n * @param testId - Test ID value to locate\n * @param config - Locator factory configuration\n * @returns Locator for the element\n *\n * @example\n * ```ts\n * const config = {\n *   testIdAttribute: 'data-testid',\n *   customTestIds: ['data-test', 'data-qa'],\n *   strategies: ['testid', 'role']\n * };\n *\n * // Tries: [data-testid=\"submit\"], [data-test=\"submit\"], [data-qa=\"submit\"]\n * const button = byTestId(page, 'submit', config);\n * ```\n */\nexport function byTestId(\n  page: Page,\n  testId: string,\n  config: LocatorFactoryConfig\n): Locator {\n  // Try primary test ID attribute first\n  const primarySelector = `[${config.testIdAttribute}=\"${testId}\"]`;\n  const primaryLocator = page.locator(primarySelector);\n\n  // If no custom test IDs configured, return primary locator\n  if (!config.customTestIds || config.customTestIds.length === 0) {\n    return primaryLocator;\n  }\n\n  // Build CSS selector that matches any configured test ID attribute\n  const allSelectors = [\n    config.testIdAttribute,\n    ...(config.customTestIds || []),\n  ].map((attr) => `[${attr}=\"${testId}\"]`);\n\n  const combinedSelector = allSelectors.join(', ');\n\n  return page.locator(combinedSelector).first();\n}\n\n/**\n * Check if element has test ID using any configured attribute\n *\n * Useful for validating element presence or debugging locator issues.\n *\n * @param locator - Playwright Locator to check\n * @param testId - Expected test ID value\n * @param config - Locator factory configuration\n * @returns Promise resolving to true if element has the test ID\n *\n * @example\n * ```ts\n * const button = page.locator('button').first();\n * const hasTestId = await hasTestIdAttribute(button, 'submit', config);\n * ```\n */\nexport async function hasTestIdAttribute(\n  locator: Locator,\n  testId: string,\n  config: LocatorFactoryConfig\n): Promise<boolean> {\n  // Build list of all test ID attributes to check\n  const attributes = [\n    config.testIdAttribute,\n    ...(config.customTestIds || []),\n  ];\n\n  // Check each attribute\n  for (const attr of attributes) {\n    try {\n      const value = await locator.getAttribute(attr);\n      if (value === testId) {\n        return true;\n      }\n    } catch {\n      // Attribute doesn't exist on element, continue to next\n      continue;\n    }\n  }\n\n  return false;\n}\n\n/**\n * Get test ID value from element using any configured attribute\n *\n * Returns the first test ID value found, checking attributes in order:\n * 1. Primary testIdAttribute\n * 2. Custom test ID attributes (if configured)\n *\n * @param locator - Playwright Locator to inspect\n * @param config - Locator factory configuration\n * @returns Promise resolving to test ID value or null if not found\n *\n * @example\n * ```ts\n * const button = page.locator('button').first();\n * const testId = await getTestIdValue(button, config);\n * console.log(`Button test ID: ${testId}`);\n * ```\n */\nexport async function getTestIdValue(\n  locator: Locator,\n  config: LocatorFactoryConfig\n): Promise<string | null> {\n  // Build list of all test ID attributes to check\n  const attributes = [\n    config.testIdAttribute,\n    ...(config.customTestIds || []),\n  ];\n\n  // Check each attribute in order\n  for (const attr of attributes) {\n    try {\n      const value = await locator.getAttribute(attr);\n      if (value) {\n        return value;\n      }\n    } catch {\n      // Attribute doesn't exist on element, continue to next\n      continue;\n    }\n  }\n\n  return null;\n}\n\n/**\n * Create test ID selector string for use in CSS selectors\n *\n * Generates attribute selector for primary test ID attribute.\n * Useful for combining with other CSS selectors.\n *\n * @param testId - Test ID value\n * @param config - Locator factory configuration\n * @returns CSS attribute selector string\n *\n * @example\n * ```ts\n * const selector = createTestIdSelector('submit', config);\n * // Returns: '[data-testid=\"submit\"]'\n *\n * const complexSelector = `form ${selector}`;\n * // Use in page.locator(complexSelector)\n * ```\n */\nexport function createTestIdSelector(\n  testId: string,\n  config: LocatorFactoryConfig\n): string {\n  return `[${config.testIdAttribute}=\"${testId}\"]`;\n}\n\n/**\n * Create combined test ID selector matching any configured attribute\n *\n * Generates CSS selector that matches test ID on any configured attribute.\n * Useful for exhaustive matching when test ID attribute might vary.\n *\n * @param testId - Test ID value\n * @param config - Locator factory configuration\n * @returns CSS selector matching any configured test ID attribute\n *\n * @example\n * ```ts\n * const selector = createCombinedTestIdSelector('submit', {\n *   testIdAttribute: 'data-testid',\n *   customTestIds: ['data-test', 'data-qa'],\n *   strategies: ['testid']\n * });\n * // Returns: '[data-testid=\"submit\"], [data-test=\"submit\"], [data-qa=\"submit\"]'\n * ```\n */\nexport function createCombinedTestIdSelector(\n  testId: string,\n  config: LocatorFactoryConfig\n): string {\n  const allAttributes = [\n    config.testIdAttribute,\n    ...(config.customTestIds || []),\n  ];\n\n  const selectors = allAttributes.map((attr) => `[${attr}=\"${testId}\"]`);\n\n  return selectors.join(', ');\n}\n","/**\n * Locator factory with strategy chaining and scoped locators\n *\n * Implements:\n * - FR-018: Strategy chain resolution (first match wins)\n * - FR-020: Scoped locators for forms, tables, sections\n *\n * @module locators/factory\n */\n\nimport type { Locator, Page } from '@playwright/test';\nimport type {\n  ByRoleOptions,\n  FormLocators,\n  LocatorFactoryConfig,\n  LocatorStrategy,\n  SectionLocators,\n  TableLocators,\n} from './types.js';\nimport { byTestId } from './testid.js';\nimport { byCss, byLabel, byPlaceholder, byRole, byText } from './strategies.js';\n\n// =============================================================================\n// Strategy Chain Resolution (FR-018)\n// =============================================================================\n\n/**\n * Locate element using configured strategy chain\n *\n * Tries strategies in configured order until a match is found.\n * Returns the first locator that matches an element.\n *\n * @param page - Playwright Page object\n * @param selector - Selector value (interpretation depends on strategy)\n * @param config - Locator factory configuration\n * @param options - Strategy-specific options\n * @returns Locator for the element\n *\n * @example\n * ```ts\n * const config = {\n *   strategies: ['role', 'testid', 'css'],\n *   testIdAttribute: 'data-testid'\n * };\n *\n * // Tries: role=\"button\", [data-testid=\"submit\"], CSS selector\n * const button = locate(page, 'submit', config);\n * ```\n */\nexport function locate(\n  page: Page,\n  selector: string,\n  config: LocatorFactoryConfig,\n  options?: ByRoleOptions | { exact?: boolean }\n): Locator {\n  // Try each strategy in configured order\n  for (const strategy of config.strategies) {\n    try {\n      switch (strategy) {\n        case 'role':\n          return byRole(page, selector, options);\n        case 'label':\n          return byLabel(page, selector, options);\n        case 'placeholder':\n          return byPlaceholder(page, selector, options);\n        case 'testid':\n          return byTestId(page, selector, config);\n        case 'text':\n          return byText(page, selector, options);\n        case 'css':\n          return byCss(page, selector);\n      }\n    } catch {\n      // Strategy failed, try next one\n      continue;\n    }\n  }\n\n  // Fallback to CSS if all strategies fail\n  return byCss(page, selector);\n}\n\n// =============================================================================\n// Form Scoped Locators (FR-020)\n// =============================================================================\n\n/**\n * Create form-scoped locators within a form element\n *\n * Provides convenient methods for locating form fields, buttons,\n * and error messages within a specific form context.\n *\n * @param formLocator - Locator for the form element\n * @param config - Locator factory configuration\n * @returns FormLocators interface with scoped methods\n *\n * @example\n * ```ts\n * const loginForm = page.locator('form#login');\n * const form = withinForm(loginForm, config);\n *\n * await form.field('username').fill('user@example.com');\n * await form.fieldByLabel('Password').fill('secret');\n * await form.submit().click();\n * ```\n */\nexport function withinForm(\n  formLocator: Locator,\n  config: LocatorFactoryConfig\n): FormLocators {\n  return {\n    field(name: string): Locator {\n      // Try by name attribute first\n      const byName = formLocator.locator(`[name=\"${name}\"]`);\n      if (byName) {\n        return byName;\n      }\n\n      // Fallback to test ID\n      return byTestId(\n        formLocator.page(),\n        name,\n        config\n      ).and(formLocator.locator('input, select, textarea'));\n    },\n\n    fieldByLabel(label: string): Locator {\n      // Use Playwright's getByLabel within form scope\n      return formLocator.getByLabel(label);\n    },\n\n    submit(): Locator {\n      // Try button[type=\"submit\"] first, fallback to input[type=\"submit\"]\n      return formLocator.locator(\n        'button[type=\"submit\"], input[type=\"submit\"]'\n      );\n    },\n\n    cancel(): Locator {\n      // Try role-based locator for cancel button\n      return formLocator.getByRole('button', { name: /cancel|close/i });\n    },\n\n    error(field: string): Locator {\n      // Common error message patterns\n      return formLocator.locator(\n        `[data-field=\"${field}\"][role=\"alert\"], ` +\n          `[data-field=\"${field}\"].error, ` +\n          `#${field}-error, ` +\n          `.${field}-error`\n      );\n    },\n  };\n}\n\n// =============================================================================\n// Table Scoped Locators (FR-020)\n// =============================================================================\n\n/**\n * Create table-scoped locators within a table element\n *\n * Provides methods for locating rows, cells, and headers\n * within a specific table context.\n *\n * @param tableLocator - Locator for the table element\n * @returns TableLocators interface with scoped methods\n *\n * @example\n * ```ts\n * const dataTable = page.locator('table#users');\n * const table = withinTable(dataTable);\n *\n * const firstRow = table.row(0);\n * const emailCell = table.cell(0, 'Email');\n * const matchingRow = table.rowContaining('john@example.com');\n * ```\n */\nexport function withinTable(tableLocator: Locator): TableLocators {\n  return {\n    row(index: number): Locator {\n      // Select row by index (0-based)\n      return tableLocator.locator('tbody tr').nth(index);\n    },\n\n    rowContaining(text: string): Locator {\n      // Find first row containing text\n      return tableLocator.locator('tbody tr').filter({ hasText: text });\n    },\n\n    cell(row: number, column: number | string): Locator {\n      const rowLocator = tableLocator.locator('tbody tr').nth(row);\n\n      if (typeof column === 'number') {\n        // Select cell by column index (0-based)\n        return rowLocator.locator('td').nth(column);\n      } else {\n        // Select cell by column name using header text\n        // Note: This is a simplified implementation\n        // Ideally, we would compute the column index dynamically\n        // For now, we use a locator that finds the cell with the matching header\n        return rowLocator\n          .locator('td')\n          .filter({\n            has: tableLocator.locator(`thead th:has-text(\"${column}\")`),\n          })\n          .first();\n      }\n    },\n\n    header(column: number | string): Locator {\n      if (typeof column === 'number') {\n        // Select header by column index (0-based)\n        return tableLocator.locator('thead th').nth(column);\n      } else {\n        // Select header by text content\n        return tableLocator.locator('thead th').filter({ hasText: column });\n      }\n    },\n  };\n}\n\n// =============================================================================\n// Section Scoped Locators (FR-020)\n// =============================================================================\n\n/**\n * Create section-scoped locators within a page section\n *\n * Provides a scoped context for locating elements within\n * a specific section, region, or container.\n *\n * @param sectionLocator - Locator for the section element\n * @param config - Locator factory configuration\n * @returns SectionLocators interface with scoped methods\n *\n * @example\n * ```ts\n * const sidebar = page.locator('aside#sidebar');\n * const section = withinSection(sidebar, config);\n *\n * const navLink = section.byRole('link', { name: 'Dashboard' });\n * const searchBox = section.byTestId('sidebar-search');\n * ```\n */\nexport function withinSection(\n  sectionLocator: Locator,\n  config: LocatorFactoryConfig\n): SectionLocators {\n  return {\n    locator(selector: string): Locator {\n      return sectionLocator.locator(selector);\n    },\n\n    byTestId(testId: string): Locator {\n      // Use configured test ID attributes within section scope\n      const selector = `[${config.testIdAttribute}=\"${testId}\"]`;\n\n      // Scope to within section\n      return sectionLocator.locator(selector);\n    },\n\n    byRole(role: string, options?: ByRoleOptions): Locator {\n      return sectionLocator.getByRole(\n        role as Parameters<Locator['getByRole']>[0],\n        options\n      );\n    },\n  };\n}\n\n// =============================================================================\n// Utility Functions\n// =============================================================================\n\n/**\n * Create default locator factory configuration\n *\n * Provides sensible defaults for strategy order and test ID attributes.\n *\n * @returns Default configuration\n *\n * @example\n * ```ts\n * const config = createDefaultConfig();\n * // {\n * //   strategies: ['role', 'label', 'placeholder', 'testid', 'text', 'css'],\n * //   testIdAttribute: 'data-testid'\n * // }\n * ```\n */\nexport function createDefaultConfig(): LocatorFactoryConfig {\n  return {\n    strategies: ['role', 'label', 'placeholder', 'testid', 'text', 'css'],\n    testIdAttribute: 'data-testid',\n    customTestIds: [],\n  };\n}\n\n/**\n * Create config from SelectorsConfig (from artk.config.yml)\n *\n * Converts SelectorsConfig from ARTK config into LocatorFactoryConfig.\n *\n * @param selectorsConfig - SelectorsConfig from ARTK config\n * @returns LocatorFactoryConfig for use with locator functions\n *\n * @example\n * ```ts\n * import { loadConfig } from '@artk/core/config';\n *\n * const artkConfig = await loadConfig();\n * const locatorConfig = createConfigFromSelectors(artkConfig.selectors);\n * ```\n */\nexport function createConfigFromSelectors(selectorsConfig: {\n  testIdAttribute: string;\n  strategy: readonly LocatorStrategy[];\n  customTestIds?: readonly string[];\n}): LocatorFactoryConfig {\n  return {\n    strategies: selectorsConfig.strategy,\n    testIdAttribute: selectorsConfig.testIdAttribute,\n    customTestIds: selectorsConfig.customTestIds,\n  };\n}\n","/**\n * Toast/notification assertion helpers\n *\n * Provides assertions for verifying toast notifications including type detection.\n * Implements FR-021: Toast/notification assertions with type detection\n *\n * @module assertions/toast\n */\n\nimport { expect, type Page } from '@playwright/test';\nimport type { ToastAssertionOptions } from './types.js';\nimport type { ARTKConfig } from '../config/types.js';\n\n/**\n * Assert that a toast notification with the given message appears\n *\n * @param page - Playwright page object\n * @param message - Expected toast message (supports partial match by default)\n * @param options - Toast assertion options\n * @param config - ARTK configuration (optional, will load from global if not provided)\n *\n * @example\n * ```typescript\n * // Basic toast assertion\n * await expectToast(page, 'Order created successfully');\n *\n * // Toast with type detection\n * await expectToast(page, 'Order created', { type: 'success' });\n *\n * // Exact message match\n * await expectToast(page, 'Order created successfully', { exact: true });\n *\n * // Custom timeout\n * await expectToast(page, 'Processing...', { timeout: 10000 });\n * ```\n */\nexport async function expectToast(\n  page: Page,\n  message: string,\n  options: ToastAssertionOptions = {},\n  config?: ARTKConfig\n): Promise<void> {\n  const { type, timeout = 5000, exact = false } = options;\n\n  // Load config if not provided\n  const toastConfig = config?.assertions?.toast ?? {\n    containerSelector: '[role=\"alert\"], .toast, .notification',\n    messageSelector: '.toast-message, .notification-message',\n    typeAttribute: 'data-type',\n  };\n\n  const { containerSelector, typeAttribute } = toastConfig;\n\n  // Wait for toast container to appear\n  const toastContainer = page.locator(containerSelector);\n  await expect(toastContainer).toBeVisible({ timeout });\n\n  // Check message content\n  if (exact) {\n    await expect(toastContainer).toHaveText(message, { timeout });\n  } else {\n    await expect(toastContainer).toContainText(message, { timeout });\n  }\n\n  // Check toast type if specified\n  if (type !== undefined) {\n    const actualType = await toastContainer.getAttribute(typeAttribute);\n    if (actualType !== type) {\n      throw new Error(\n        `Expected toast type \"${type}\" but got \"${actualType ?? 'none'}\"`\n      );\n    }\n  }\n}\n\n/**\n * Assert that no toast notification is currently visible\n *\n * @param page - Playwright page object\n * @param config - ARTK configuration (optional, will load from global if not provided)\n * @param timeout - Timeout in milliseconds (default: 5000)\n *\n * @example\n * ```typescript\n * // Assert no toasts are displayed\n * await expectNoToast(page);\n *\n * // With custom config\n * await expectNoToast(page, config);\n *\n * // With custom timeout\n * await expectNoToast(page, undefined, 2000);\n * ```\n */\nexport async function expectNoToast(\n  page: Page,\n  config?: ARTKConfig,\n  timeout: number = 5000\n): Promise<void> {\n  // Load config if not provided\n  const toastConfig = config?.assertions?.toast ?? {\n    containerSelector: '[role=\"alert\"], .toast, .notification',\n    messageSelector: '.toast-message, .notification-message',\n    typeAttribute: 'data-type',\n  };\n\n  const { containerSelector } = toastConfig;\n\n  // Assert toast container is not visible\n  const toastContainer = page.locator(containerSelector);\n  await expect(toastContainer).not.toBeVisible({ timeout });\n}\n\n/**\n * Wait for a toast to appear and then disappear\n *\n * Useful for transient notifications that auto-dismiss.\n *\n * @param page - Playwright page object\n * @param message - Expected toast message\n * @param options - Toast assertion options\n * @param config - ARTK configuration (optional, will load from global if not provided)\n *\n * @example\n * ```typescript\n * // Wait for success toast to appear and disappear\n * await waitForToastDismiss(page, 'Saved successfully', { type: 'success' });\n * ```\n */\nexport async function waitForToastDismiss(\n  page: Page,\n  message: string,\n  options: ToastAssertionOptions = {},\n  config?: ARTKConfig\n): Promise<void> {\n  // First assert toast appears\n  await expectToast(page, message, options, config);\n\n  // Load config if not provided\n  const toastConfig = config?.assertions?.toast ?? {\n    containerSelector: '[role=\"alert\"], .toast, .notification',\n    messageSelector: '.toast-message, .notification-message',\n    typeAttribute: 'data-type',\n  };\n\n  const { containerSelector } = toastConfig;\n  const { timeout = 5000 } = options;\n\n  // Wait for toast to disappear\n  const toastContainer = page.locator(containerSelector);\n  await expect(toastContainer).not.toBeVisible({ timeout: timeout * 2 });\n}\n","/**\n * Table assertion helpers\n *\n * Provides assertions for verifying table content and row data.\n * Implements FR-022: Table row assertions with column matching\n *\n * @module assertions/table\n */\n\nimport { expect, type Locator, type Page } from '@playwright/test';\nimport type { TableAssertionOptions, TableRowData } from './types.js';\n\n/**\n * Assert that a table contains a row matching the given data\n *\n * Searches for a table row where all specified column values match.\n * Column names should correspond to data-testid attributes or visible headers.\n *\n * @param page - Playwright page object\n * @param tableSelector - Selector for the table element (testid, role, or CSS)\n * @param rowData - Expected row data as column-value pairs\n * @param options - Table assertion options\n *\n * @example\n * ```typescript\n * // Match row by ID and status\n * await expectTableToContainRow(page, 'orders-table', {\n *   id: '12345',\n *   status: 'Active',\n *   amount: 99.99\n * });\n *\n * // Exact match\n * await expectTableToContainRow(page, 'users-table', {\n *   email: 'user@example.com'\n * }, { exact: true });\n *\n * // With custom timeout\n * await expectTableToContainRow(page, 'results-table', {\n *   name: 'Test Result'\n * }, { timeout: 10000 });\n * ```\n */\nexport async function expectTableToContainRow(\n  page: Page,\n  tableSelector: string,\n  rowData: TableRowData,\n  options: TableAssertionOptions = {}\n): Promise<void> {\n  const { timeout = 5000, exact = false } = options;\n\n  // Locate the table\n  const table = getTableLocator(page, tableSelector);\n\n  // Get all rows in the table body\n  const rows = table.locator('tbody tr, tr').filter({ has: page.locator('td') });\n\n  // First check if table exists and get row count\n  await expect(table).toBeAttached({ timeout });\n  const rowCount = await rows.count();\n\n  if (rowCount === 0) {\n    throw new Error(`Table \"${tableSelector}\" has no data rows`);\n  }\n\n  // Now verify table is visible (only after we know it has rows)\n  await expect(table).toBeVisible({ timeout });\n\n  // Search for matching row\n  let foundMatch = false;\n\n  for (let i = 0; i < rowCount; i++) {\n    const row = rows.nth(i);\n    const matches = await rowMatchesData(row, rowData, exact);\n\n    if (matches) {\n      foundMatch = true;\n      break;\n    }\n  }\n\n  if (!foundMatch) {\n    const rowDataStr = JSON.stringify(rowData);\n    throw new Error(\n      `Table \"${tableSelector}\" does not contain a row matching: ${rowDataStr}`\n    );\n  }\n}\n\n/**\n * Assert that a table has the expected number of rows\n *\n * @param page - Playwright page object\n * @param tableSelector - Selector for the table element\n * @param expectedCount - Expected number of rows\n * @param options - Table assertion options\n *\n * @example\n * ```typescript\n * // Assert table has exactly 10 rows\n * await expectTableRowCount(page, 'results-table', 10);\n *\n * // With custom timeout\n * await expectTableRowCount(page, 'orders-table', 5, { timeout: 10000 });\n * ```\n */\nexport async function expectTableRowCount(\n  page: Page,\n  tableSelector: string,\n  expectedCount: number,\n  options: TableAssertionOptions = {}\n): Promise<void> {\n  const { timeout = 5000 } = options;\n\n  // Locate the table\n  const table = getTableLocator(page, tableSelector);\n\n  // For empty tables, we don't need to check visibility\n  // (they might be hidden/collapsed when empty)\n  if (expectedCount > 0) {\n    await expect(table).toBeVisible({ timeout });\n  } else {\n    // Just wait for table to exist in DOM\n    await expect(table).toBeAttached({ timeout });\n  }\n\n  // Get all rows in the table body\n  const rows = table.locator('tbody tr, tr').filter({ has: page.locator('td') });\n\n  // Assert count\n  await expect(rows).toHaveCount(expectedCount, { timeout });\n}\n\n/**\n * Get table locator using common strategies\n *\n * Tries data-testid, role, and CSS selector in that order.\n *\n * @param page - Playwright page object\n * @param tableSelector - Table selector\n * @returns Table locator\n */\nfunction getTableLocator(page: Page, tableSelector: string): Locator {\n  // Try data-testid first\n  if (!tableSelector.includes('[') && !tableSelector.includes('.') && !tableSelector.includes('#')) {\n    return page.getByTestId(tableSelector);\n  }\n\n  // Try role if it looks like a role selector\n  if (tableSelector === 'table') {\n    return page.getByRole('table');\n  }\n\n  // Fall back to CSS selector\n  return page.locator(tableSelector);\n}\n\n/**\n * Check if a row matches the expected data\n *\n * @param row - Table row locator\n * @param expectedData - Expected column-value pairs\n * @param exact - Whether to match exactly\n * @returns True if row matches, false otherwise\n */\nasync function rowMatchesData(\n  row: Locator,\n  expectedData: TableRowData,\n  exact: boolean\n): Promise<boolean> {\n  for (const [column, expectedValue] of Object.entries(expectedData)) {\n    // Try to find cell by data-testid first\n    const cell = row.locator(`[data-testid=\"${column}\"], [data-column=\"${column}\"]`);\n\n    // If not found, try finding by column index (assuming header order)\n    if ((await cell.count()) === 0) {\n      // Fall back to all cells - this is less precise but works for simple tables\n      const cells = row.locator('td');\n      const cellCount = await cells.count();\n\n      // Try to match by cell content\n      let foundCell = false;\n      for (let i = 0; i < cellCount; i++) {\n        const cellText = await cells.nth(i).textContent();\n        const expectedStr = String(expectedValue);\n\n        if (exact ? cellText?.trim() === expectedStr : cellText?.includes(expectedStr)) {\n          foundCell = true;\n          break;\n        }\n      }\n\n      if (!foundCell) {\n        return false;\n      }\n    } else {\n      // Found cell by testid/column attribute\n      const cellText = await cell.textContent();\n      const expectedStr = String(expectedValue);\n\n      const matches = exact\n        ? cellText?.trim() === expectedStr\n        : cellText?.includes(expectedStr);\n\n      if (!matches) {\n        return false;\n      }\n    }\n  }\n\n  return true;\n}\n\n/**\n * Assert that a table is empty (has no data rows)\n *\n * @param page - Playwright page object\n * @param tableSelector - Selector for the table element\n * @param options - Table assertion options\n *\n * @example\n * ```typescript\n * // Assert table is empty\n * await expectTableEmpty(page, 'results-table');\n * ```\n */\nexport async function expectTableEmpty(\n  page: Page,\n  tableSelector: string,\n  options: TableAssertionOptions = {}\n): Promise<void> {\n  await expectTableRowCount(page, tableSelector, 0, options);\n}\n","/**\n * Form validation assertion helpers\n *\n * Provides assertions for verifying form validation states and error messages.\n * Implements FR-023: Form validation error assertions\n *\n * @module assertions/form\n */\n\nimport { expect, type Locator, type Page } from '@playwright/test';\nimport type { FormFieldErrorOptions, FormValidityOptions } from './types.js';\nimport type { ARTKConfig } from '../config/types.js';\n\n/**\n * Assert that a form field displays a validation error\n *\n * @param page - Playwright page object\n * @param fieldName - Field name, label, or testid\n * @param expectedError - Expected error message (supports partial match by default)\n * @param options - Form field error options\n * @param config - ARTK configuration (optional)\n *\n * @example\n * ```typescript\n * // Assert email field has required error\n * await expectFormFieldError(page, 'email', 'Email is required');\n *\n * // Exact error message match\n * await expectFormFieldError(page, 'password', 'Password must be at least 8 characters', {\n *   exact: true\n * });\n *\n * // With custom timeout\n * await expectFormFieldError(page, 'username', 'Username taken', { timeout: 10000 });\n * ```\n */\nexport async function expectFormFieldError(\n  page: Page,\n  fieldName: string,\n  expectedError: string,\n  options: FormFieldErrorOptions = {},\n  config?: ARTKConfig\n): Promise<void> {\n  const { timeout = 5000, exact = false } = options;\n\n  // Load config if not provided\n  const formConfig = config?.assertions?.form ?? {\n    errorSelector: '[data-field-error=\"{field}\"], [data-error-for=\"{field}\"], #error-{field}',\n    formErrorSelector: '.form-error, [role=\"alert\"]',\n  };\n\n  const { errorSelector } = formConfig;\n\n  // Replace {field} placeholder with actual field name\n  const fieldErrorSelector = errorSelector.replace(/{field}/g, fieldName);\n\n  // Locate the error element\n  const errorElement = page.locator(fieldErrorSelector);\n\n  // Assert error is visible\n  await expect(errorElement).toBeVisible({ timeout });\n\n  // Check error message\n  if (exact) {\n    await expect(errorElement).toHaveText(expectedError, { timeout });\n  } else {\n    await expect(errorElement).toContainText(expectedError, { timeout });\n  }\n}\n\n/**\n * Assert that a form is valid (no validation errors)\n *\n * @param page - Playwright page object\n * @param formSelector - Form selector (testid, CSS, or role)\n * @param options - Form validity options\n * @param config - ARTK configuration (optional)\n *\n * @example\n * ```typescript\n * // Assert login form is valid\n * await expectFormValid(page, 'login-form');\n *\n * // With custom timeout\n * await expectFormValid(page, 'registration-form', { timeout: 10000 });\n * ```\n */\nexport async function expectFormValid(\n  page: Page,\n  formSelector: string,\n  options: FormValidityOptions = {},\n  config?: ARTKConfig\n): Promise<void> {\n  const { timeout = 5000 } = options;\n\n  // Load config if not provided\n  const formConfig = config?.assertions?.form ?? {\n    errorSelector: '[data-field-error], [data-error-for], [id^=\"error-\"]',\n    formErrorSelector: '.form-error, [role=\"alert\"]',\n  };\n\n  const { formErrorSelector } = formConfig;\n\n  // Locate the form\n  const form = getFormLocator(page, formSelector);\n  await expect(form).toBeVisible({ timeout });\n\n  // Assert no error elements within form\n  const errorElements = form.locator(formErrorSelector);\n  await expect(errorElements).toHaveCount(0, { timeout });\n}\n\n/**\n * Assert that a form field does NOT have a validation error\n *\n * @param page - Playwright page object\n * @param fieldName - Field name, label, or testid\n * @param options - Form field error options\n * @param config - ARTK configuration (optional)\n *\n * @example\n * ```typescript\n * // Assert email field has no error\n * await expectNoFormFieldError(page, 'email');\n * ```\n */\nexport async function expectNoFormFieldError(\n  page: Page,\n  fieldName: string,\n  options: FormFieldErrorOptions = {},\n  config?: ARTKConfig\n): Promise<void> {\n  const { timeout = 5000 } = options;\n\n  // Load config if not provided\n  const formConfig = config?.assertions?.form ?? {\n    errorSelector: '[data-field-error=\"{field}\"], [data-error-for=\"{field}\"], #error-{field}',\n    formErrorSelector: '.form-error, [role=\"alert\"]',\n  };\n\n  const { errorSelector } = formConfig;\n\n  // Replace {field} placeholder with actual field name\n  const fieldErrorSelector = errorSelector.replace(/{field}/g, fieldName);\n\n  // Locate the error element\n  const errorElement = page.locator(fieldErrorSelector);\n\n  // Assert error is not visible\n  await expect(errorElement).not.toBeVisible({ timeout });\n}\n\n/**\n * Assert that a form displays a form-level error message\n *\n * Form-level errors are typically shown at the top of the form and apply\n * to the entire form rather than a specific field.\n *\n * @param page - Playwright page object\n * @param formSelector - Form selector\n * @param expectedError - Expected error message\n * @param options - Form field error options\n * @param config - ARTK configuration (optional)\n *\n * @example\n * ```typescript\n * // Assert form shows general error\n * await expectFormError(page, 'login-form', 'Invalid credentials');\n * ```\n */\nexport async function expectFormError(\n  page: Page,\n  formSelector: string,\n  expectedError: string,\n  options: FormFieldErrorOptions = {},\n  config?: ARTKConfig\n): Promise<void> {\n  const { timeout = 5000, exact = false } = options;\n\n  // Load config if not provided\n  const formConfig = config?.assertions?.form ?? {\n    errorSelector: '[data-field-error], [data-error-for], [id^=\"error-\"]',\n    formErrorSelector: '.form-error, [role=\"alert\"]',\n  };\n\n  const { formErrorSelector } = formConfig;\n\n  // Locate the form\n  const form = getFormLocator(page, formSelector);\n  await expect(form).toBeVisible({ timeout });\n\n  // Find form-level error\n  const formError = form.locator(formErrorSelector);\n  await expect(formError).toBeVisible({ timeout });\n\n  // Check error message\n  if (exact) {\n    await expect(formError).toHaveText(expectedError, { timeout });\n  } else {\n    await expect(formError).toContainText(expectedError, { timeout });\n  }\n}\n\n/**\n * Get form locator using common strategies\n *\n * @param page - Playwright page object\n * @param formSelector - Form selector\n * @returns Form locator\n */\nfunction getFormLocator(page: Page, formSelector: string): Locator {\n  // Try data-testid first\n  if (!formSelector.includes('[') && !formSelector.includes('.') && !formSelector.includes('#')) {\n    return page.getByTestId(formSelector);\n  }\n\n  // Try role if it looks like a role selector\n  if (formSelector === 'form') {\n    return page.getByRole('form');\n  }\n\n  // Fall back to CSS selector\n  return page.locator(formSelector);\n}\n","/**\n * Loading state assertion helpers\n *\n * Provides assertions for verifying loading indicators and waiting for loading completion.\n * Implements FR-024: Loading state assertions with configurable selectors\n *\n * @module assertions/loading\n */\n\nimport { expect, type Page } from '@playwright/test';\nimport type { LoadingStateOptions } from './types.js';\nimport type { ARTKConfig } from '../config/types.js';\n\n/**\n * Default loading indicator selectors\n *\n * Used when config is not provided or custom selectors are not specified.\n */\nconst DEFAULT_LOADING_SELECTORS = [\n  '[data-loading=\"true\"]',\n  '.loading',\n  '.spinner',\n  '[aria-busy=\"true\"]',\n  '.loading-overlay',\n  '[role=\"progressbar\"]',\n];\n\n/**\n * Assert that a loading indicator is visible\n *\n * @param page - Playwright page object\n * @param options - Loading state options\n * @param config - ARTK configuration (optional)\n *\n * @example\n * ```typescript\n * // Assert any configured loading indicator is visible\n * await expectLoading(page);\n *\n * // With custom selectors\n * await expectLoading(page, {\n *   selectors: ['.custom-spinner', '#loading-overlay']\n * });\n *\n * // With custom timeout\n * await expectLoading(page, { timeout: 10000 });\n * ```\n */\nexport async function expectLoading(\n  page: Page,\n  options: LoadingStateOptions = {},\n  config?: ARTKConfig\n): Promise<void> {\n  const { timeout = 5000, selectors } = options;\n\n  // Get loading selectors from options, config, or defaults\n  const loadingSelectors =\n    selectors ??\n    config?.assertions?.loading?.selectors ??\n    DEFAULT_LOADING_SELECTORS;\n\n  // Create a combined selector for any loading indicator\n  const combinedSelector = loadingSelectors.join(', ');\n  const loadingIndicator = page.locator(combinedSelector);\n\n  // Assert at least one loading indicator is visible\n  await expect(loadingIndicator.first()).toBeVisible({ timeout });\n}\n\n/**\n * Assert that no loading indicators are visible\n *\n * @param page - Playwright page object\n * @param options - Loading state options\n * @param config - ARTK configuration (optional)\n *\n * @example\n * ```typescript\n * // Assert no loading indicators are visible\n * await expectNotLoading(page);\n *\n * // With custom selectors\n * await expectNotLoading(page, {\n *   selectors: ['.custom-spinner']\n * });\n * ```\n */\nexport async function expectNotLoading(\n  page: Page,\n  options: LoadingStateOptions = {},\n  config?: ARTKConfig\n): Promise<void> {\n  const { timeout = 5000, selectors } = options;\n\n  // Get loading selectors from options, config, or defaults\n  const loadingSelectors =\n    selectors ??\n    config?.assertions?.loading?.selectors ??\n    DEFAULT_LOADING_SELECTORS;\n\n  // Check each loading selector individually\n  for (const selector of loadingSelectors) {\n    const loadingIndicator = page.locator(selector);\n    await expect(loadingIndicator).not.toBeVisible({ timeout });\n  }\n}\n\n/**\n * Wait for all loading indicators to complete (disappear)\n *\n * This is the most commonly used loading assertion - it waits for the page\n * to finish loading before proceeding with test assertions.\n *\n * @param page - Playwright page object\n * @param options - Loading state options\n * @param config - ARTK configuration (optional)\n *\n * @example\n * ```typescript\n * // Wait for loading to complete\n * await waitForLoadingComplete(page);\n *\n * // With custom timeout (for slow operations)\n * await waitForLoadingComplete(page, { timeout: 30000 });\n *\n * // With custom loading selectors\n * await waitForLoadingComplete(page, {\n *   selectors: ['.data-grid-loading', '.chart-loading']\n * });\n * ```\n */\nexport async function waitForLoadingComplete(\n  page: Page,\n  options: LoadingStateOptions = {},\n  config?: ARTKConfig\n): Promise<void> {\n  const { timeout = 30000, selectors } = options;\n\n  // Get loading selectors from options, config, or defaults\n  const loadingSelectors =\n    selectors ??\n    config?.assertions?.loading?.selectors ??\n    DEFAULT_LOADING_SELECTORS;\n\n  // First, optionally wait for loading to start (prevents race conditions)\n  // We give it a short timeout since loading might already be in progress\n  const combinedSelector = loadingSelectors.join(', ');\n  const loadingIndicator = page.locator(combinedSelector);\n\n  try {\n    await expect(loadingIndicator.first()).toBeVisible({ timeout: 1000 });\n  } catch {\n    // Loading might have already completed or never started - that's OK\n  }\n\n  // Now wait for all loading indicators to disappear\n  for (const selector of loadingSelectors) {\n    const indicator = page.locator(selector);\n    await expect(indicator).not.toBeVisible({ timeout });\n  }\n}\n\n/**\n * Wait for a specific loading operation to start and complete\n *\n * Useful for operations where you want to ensure loading actually occurred\n * (not just that loading is currently complete).\n *\n * @param page - Playwright page object\n * @param operation - Async function that triggers the loading operation\n * @param options - Loading state options\n * @param config - ARTK configuration (optional)\n *\n * @example\n * ```typescript\n * // Wait for save operation to complete\n * await waitForLoadingOperation(page, async () => {\n *   await page.getByRole('button', { name: 'Save' }).click();\n * });\n *\n * // With custom selectors\n * await waitForLoadingOperation(\n *   page,\n *   async () => { await page.getByRole('button', { name: 'Refresh' }).click(); },\n *   { selectors: ['.table-loading'] }\n * );\n * ```\n */\nexport async function waitForLoadingOperation(\n  page: Page,\n  operation: () => Promise<void>,\n  options: LoadingStateOptions = {},\n  config?: ARTKConfig\n): Promise<void> {\n  const { timeout = 30000, selectors } = options;\n\n  // Get loading selectors from options, config, or defaults\n  const loadingSelectors =\n    selectors ??\n    config?.assertions?.loading?.selectors ??\n    DEFAULT_LOADING_SELECTORS;\n\n  const combinedSelector = loadingSelectors.join(', ');\n  const loadingIndicator = page.locator(combinedSelector);\n\n  // Trigger the operation\n  await operation();\n\n  // Wait for loading to appear - use a reasonable timeout that won't exceed test timeout\n  // Use half of the total timeout for waiting to appear, or 3s max\n  const appearTimeout = Math.min(timeout / 2, 3000);\n  await expect(loadingIndicator.first()).toBeVisible({ timeout: appearTimeout });\n\n  // Wait for loading to complete\n  await waitForLoadingComplete(page, { timeout, selectors }, config);\n}\n","/**\n * Data API Client\n *\n * HTTP client for test data operations via API endpoints.\n * Supports authenticated requests and cleanup registration.\n */\n\nimport { createLogger } from '../utils/logger.js';\nimport type { DataApiOptions } from './types.js';\n\nconst logger = createLogger('data', 'DataApiClient');\n\n/**\n * HTTP client for test data creation and cleanup\n *\n * Features:\n * - RESTful API operations (GET, POST, PUT, DELETE)\n * - Automatic authentication header injection\n * - JSON request/response handling\n * - Error handling with detailed logging\n *\n * @example\n * const client = new DataApiClient({\n *   baseUrl: 'https://api.example.com',\n *   headers: { 'Authorization': 'Bearer token123' }\n * });\n *\n * const user = await client.post('/users', {\n *   username: 'testuser',\n *   email: 'test@example.com'\n * });\n *\n * await client.delete(`/users/${user.id}`);\n */\nexport class DataApiClient {\n  private readonly baseUrl: string;\n  private readonly headers: Record<string, string>;\n\n  /**\n   * Create a new data API client\n   *\n   * @param options - Client configuration\n   */\n  constructor(options: DataApiOptions) {\n    this.baseUrl = options.baseUrl.replace(/\\/$/, ''); // Remove trailing slash\n    this.headers = {\n      'Content-Type': 'application/json',\n      ...options.headers,\n    };\n\n    logger.debug('Client initialized', {\n      baseUrl: this.baseUrl,\n      hasAuth: 'Authorization' in this.headers,\n    });\n  }\n\n  /**\n   * Perform GET request\n   *\n   * @param path - API endpoint path (e.g., '/users/123')\n   * @returns Response data\n   */\n  async get<T = unknown>(path: string): Promise<T> {\n    return this.request<T>('GET', path);\n  }\n\n  /**\n   * Perform POST request\n   *\n   * @param path - API endpoint path\n   * @param data - Request body\n   * @returns Response data\n   */\n  async post<T = unknown>(path: string, data: Record<string, unknown>): Promise<T> {\n    return this.request<T>('POST', path, data);\n  }\n\n  /**\n   * Perform PUT request\n   *\n   * @param path - API endpoint path\n   * @param data - Request body\n   * @returns Response data\n   */\n  async put<T = unknown>(path: string, data: Record<string, unknown>): Promise<T> {\n    return this.request<T>('PUT', path, data);\n  }\n\n  /**\n   * Perform DELETE request\n   *\n   * @param path - API endpoint path\n   * @param data - Optional request body\n   * @returns Response data\n   */\n  async delete<T = unknown>(path: string, data?: Record<string, unknown>): Promise<T> {\n    return this.request<T>('DELETE', path, data);\n  }\n\n  /**\n   * Perform HTTP request with error handling\n   *\n   * @param method - HTTP method\n   * @param path - API endpoint path\n   * @param data - Optional request body\n   * @returns Response data\n   * @throws {Error} If request fails\n   */\n  private async request<T>(\n    method: string,\n    path: string,\n    data?: Record<string, unknown>,\n  ): Promise<T> {\n    const url = `${this.baseUrl}${path}`;\n\n    logger.debug(`${method} ${path}`, {\n      url,\n      hasBody: !!data,\n    });\n\n    try {\n      const response = await fetch(url, {\n        method,\n        headers: this.headers,\n        body: data ? JSON.stringify(data) : undefined,\n      });\n\n      if (!response.ok) {\n        const errorText = await response.text();\n        throw new Error(\n          `HTTP ${response.status} ${response.statusText}: ${errorText}`,\n        );\n      }\n\n      // Handle empty responses (e.g., 204 No Content)\n      const contentType = response.headers.get('content-type');\n      if (!contentType || !contentType.includes('application/json')) {\n        logger.debug(`${method} ${path} - non-JSON response`, {\n          status: response.status,\n          contentType,\n        });\n        return undefined as T;\n      }\n\n      const result = await response.json();\n\n      logger.debug(`${method} ${path} - success`, {\n        status: response.status,\n      });\n\n      return result as T;\n    } catch (error) {\n      const errorMessage = error instanceof Error ? error.message : String(error);\n\n      logger.error(`${method} ${path} - failed`, {\n        error: errorMessage,\n      });\n\n      throw new Error(`API request failed: ${method} ${path} - ${errorMessage}`);\n    }\n  }\n\n  /**\n   * Create cleanup function for API-based resource deletion\n   *\n   * @param method - HTTP method (typically 'DELETE')\n   * @param path - API endpoint path\n   * @param matcher - Optional data matcher for conditional deletion\n   * @returns Cleanup function\n   *\n   * @example\n   * const cleanup = client.createCleanup('DELETE', '/users/123');\n   * cleanupManager.register(cleanup, { label: 'Delete test user' });\n   */\n  createCleanup(\n    method: string,\n    path: string,\n    matcher?: Record<string, unknown>,\n  ): () => Promise<void> {\n    return async (): Promise<void> => {\n      await this.request(method, path, matcher);\n    };\n  }\n}\n","/**\n * Journey mapping utilities for ARTK reporters\n *\n * This module provides functions to map Playwright test results back to\n * Journey definitions and calculate aggregated journey status.\n *\n * @module reporters/journey-reporter\n */\n\nimport type { TestCase, TestResult } from '@playwright/test/reporter';\nimport type {\n  JourneyReport,\n  JourneyStatus,\n  JourneyTestMapping,\n  TestArtifacts,\n  TestStatus,\n} from './types.js';\n\n// =============================================================================\n// Journey ID Extraction\n// =============================================================================\n\n/**\n * Extract journey ID from test case\n *\n * Looks for journey ID in:\n * 1. Test annotations (@journey JRN-0001)\n * 2. Test tags (@JRN-0001)\n * 3. Test title (JRN-0001: ...)\n *\n * @param testCase - Playwright test case\n * @returns Journey ID or null if not found\n */\nexport function extractJourneyId(testCase: TestCase): string | null {\n  // Check annotations\n  for (const annotation of testCase.annotations) {\n    if (annotation.type === 'journey') {\n      return annotation.description ?? null;\n    }\n  }\n\n  // Check tags (format: @JRN-0001)\n  const journeyTagRegex = /^@(JRN-\\d+)$/;\n  for (const tag of testCase.tags) {\n    const match = journeyTagRegex.exec(tag);\n    if (match?.[1]) {\n      return match[1];\n    }\n  }\n\n  // Check title (format: \"JRN-0001: Test description\")\n  const titleRegex = /^(JRN-\\d+):/;\n  const titleMatch = titleRegex.exec(testCase.title);\n  if (titleMatch?.[1]) {\n    return titleMatch[1];\n  }\n\n  return null;\n}\n\n// =============================================================================\n// Test to Journey Mapping\n// =============================================================================\n\n/**\n * Map a Playwright test case to a journey test mapping\n *\n * @param testCase - Playwright test case\n * @param result - Test result\n * @returns Journey test mapping\n */\nexport function mapTestToJourney(testCase: TestCase, result: TestResult): JourneyTestMapping {\n  const artifacts = extractTestArtifacts(result);\n\n  return {\n    journeyId: extractJourneyId(testCase) ?? 'UNMAPPED',\n    testTitle: testCase.titlePath().join('  '),\n    testFile: testCase.location.file,\n    status: result.status as TestStatus,\n    duration: result.duration,\n    retries: result.retry,\n    error: result.error?.message,\n    artifacts,\n  };\n}\n\n/**\n * Extract test artifacts from result\n *\n * @param result - Test result\n * @returns Test artifacts\n */\nfunction extractTestArtifacts(result: TestResult): TestArtifacts {\n  const screenshots: string[] = [];\n  let video: string | undefined;\n  let trace: string | undefined;\n\n  for (const attachment of result.attachments) {\n    if (attachment.name === 'screenshot' && attachment.path) {\n      screenshots.push(attachment.path);\n    } else if (attachment.name === 'video' && attachment.path) {\n      video = attachment.path;\n    } else if (attachment.name === 'trace' && attachment.path) {\n      trace = attachment.path;\n    }\n  }\n\n  return {\n    screenshots,\n    video,\n    trace,\n  };\n}\n\n// =============================================================================\n// Group Tests by Journey\n// =============================================================================\n\n/**\n * Group test mappings by journey ID\n *\n * @param mappings - Array of journey test mappings\n * @returns Map of journey ID to test mappings\n */\nexport function groupTestsByJourney(\n  mappings: readonly JourneyTestMapping[]\n): ReadonlyMap<string, readonly JourneyTestMapping[]> {\n  const groups = new Map<string, JourneyTestMapping[]>();\n\n  for (const mapping of mappings) {\n    const existing = groups.get(mapping.journeyId) ?? [];\n    groups.set(mapping.journeyId, [...existing, mapping]);\n  }\n\n  // Convert to readonly\n  const readonlyGroups = new Map<string, readonly JourneyTestMapping[]>();\n  for (const entry of Array.from(groups.entries())) {\n    const [journeyId, tests] = entry;\n    readonlyGroups.set(journeyId, tests);\n  }\n\n  return readonlyGroups;\n}\n\n// =============================================================================\n// Journey Status Calculation\n// =============================================================================\n\n/**\n * Calculate journey status from test results\n *\n * Logic:\n * - 'failed': Any test failed (even after retries)\n * - 'flaky': All tests passed, but some required retries\n * - 'passed': All tests passed on first attempt\n * - 'skipped': All tests skipped\n * - 'not-run': No tests executed\n *\n * @param tests - Test mappings for a journey\n * @returns Journey status\n */\nexport function calculateJourneyStatus(tests: readonly JourneyTestMapping[]): JourneyStatus {\n  if (tests.length === 0) {\n    return 'not-run';\n  }\n\n  let hasFailed = false;\n  let hasFlaky = false;\n  let allSkipped = true;\n\n  for (const test of tests) {\n    if (test.status === 'failed' || test.status === 'timedOut' || test.status === 'interrupted') {\n      hasFailed = true;\n      allSkipped = false;\n    } else if (test.status === 'passed') {\n      allSkipped = false;\n      if (test.retries > 0) {\n        hasFlaky = true;\n      }\n    } else if (test.status !== 'skipped') {\n      allSkipped = false;\n    }\n  }\n\n  if (hasFailed) {\n    return 'failed';\n  }\n\n  if (allSkipped) {\n    return 'skipped';\n  }\n\n  if (hasFlaky) {\n    return 'flaky';\n  }\n\n  return 'passed';\n}\n\n/**\n * Create a journey report from grouped test mappings\n *\n * @param journeyId - Journey ID\n * @param tests - Test mappings for this journey\n * @returns Journey report\n */\nexport function createJourneyReport(\n  journeyId: string,\n  tests: readonly JourneyTestMapping[]\n): JourneyReport {\n  let passedTests = 0;\n  let failedTests = 0;\n  let skippedTests = 0;\n  let flakyTests = 0;\n  let totalDuration = 0;\n\n  for (const test of tests) {\n    totalDuration += test.duration;\n\n    if (test.status === 'passed') {\n      if (test.retries > 0) {\n        flakyTests++;\n      } else {\n        passedTests++;\n      }\n    } else if (test.status === 'failed' || test.status === 'timedOut' || test.status === 'interrupted') {\n      failedTests++;\n    } else if (test.status === 'skipped') {\n      skippedTests++;\n    }\n  }\n\n  const status = calculateJourneyStatus(tests);\n\n  return {\n    journeyId,\n    status,\n    totalTests: tests.length,\n    passedTests,\n    failedTests,\n    skippedTests,\n    flakyTests,\n    totalDuration,\n    tests,\n  };\n}\n","/**\n * ARTK custom reporter for Playwright\n *\n * This reporter maps test results to Journey definitions and generates\n * ARTK-specific reports with journey status aggregation.\n *\n * @module reporters/artk-reporter\n */\n\nimport type {\n  FullConfig,\n  FullResult,\n  Reporter,\n  Suite,\n  TestCase,\n  TestResult,\n} from '@playwright/test/reporter';\nimport type {\n  ARTKReport,\n  ARTKReporterOptions,\n  JourneyTestMapping,\n  RunSummary,\n} from './types.js';\nimport {\n  createJourneyReport,\n  groupTestsByJourney,\n  mapTestToJourney,\n} from './journey-reporter.js';\nimport { promises as fs } from 'fs';\nimport { dirname } from 'path';\n\n/**\n * ARTK Reporter implementation\n *\n * Usage in playwright.config.ts:\n * ```typescript\n * import { ARTKReporter } from '@artk/core/reporters';\n *\n * export default defineConfig({\n *   reporter: [\n *     ['@artk/core/reporters', {\n *       outputFile: './test-results/artk-report.json',\n *       includeJourneyMapping: true\n *     }]\n *   ]\n * });\n * ```\n */\nexport class ARTKReporter implements Reporter {\n  // Note: config is stored for future use (filtering, metadata, etc.)\n  // Currently not used but kept for API compatibility\n  // private _config: FullConfig | undefined;\n\n  private readonly options: ARTKReporterOptions;\n  private readonly testMappings: JourneyTestMapping[] = [];\n  private startTime: number = 0;\n  private endTime: number = 0;\n\n  constructor(options: ARTKReporterOptions) {\n    this.options = options;\n  }\n\n  /**\n   * Called once before running tests\n   */\n  onBegin(_config: FullConfig, _suite: Suite): void {\n    // this._config = config; // Stored for future use\n    this.startTime = Date.now();\n  }\n\n  /**\n   * Called for each test after it finishes\n   */\n  onTestEnd(test: TestCase, result: TestResult): void {\n    const mapping = mapTestToJourney(test, result);\n    this.testMappings.push(mapping);\n  }\n\n  /**\n   * Called after all tests finish\n   */\n  async onEnd(result: FullResult): Promise<void> {\n    this.endTime = Date.now();\n\n    const report = this.generateARTKReport(result);\n    await this.writeARTKReport(report);\n  }\n\n  /**\n   * Generate ARTK report from collected test mappings\n   */\n  private generateARTKReport(result: FullResult): ARTKReport {\n    const summary = this.createRunSummary(result);\n    const { journeys, unmappedTests } = this.createJourneyReports();\n\n    return {\n      timestamp: new Date().toISOString(),\n      summary,\n      journeys,\n      unmappedTests,\n    };\n  }\n\n  /**\n   * Create run summary from full result\n   */\n  private createRunSummary(result: FullResult): RunSummary {\n    let totalTests = 0;\n    let passed = 0;\n    let failed = 0;\n    let skipped = 0;\n    let flaky = 0;\n\n    for (const mapping of this.testMappings) {\n      totalTests++;\n\n      if (mapping.status === 'passed') {\n        if (mapping.retries > 0) {\n          flaky++;\n        } else {\n          passed++;\n        }\n      } else if (mapping.status === 'failed' || mapping.status === 'timedOut' || mapping.status === 'interrupted') {\n        failed++;\n      } else if (mapping.status === 'skipped') {\n        skipped++;\n      }\n    }\n\n    return {\n      totalTests,\n      passed,\n      failed,\n      skipped,\n      flaky,\n      duration: this.endTime - this.startTime,\n      status: result.status,\n    };\n  }\n\n  /**\n   * Create journey reports from test mappings\n   */\n  private createJourneyReports(): {\n    journeys: readonly ReturnType<typeof createJourneyReport>[];\n    unmappedTests: readonly JourneyTestMapping[];\n  } {\n    if (!this.options.includeJourneyMapping) {\n      return {\n        journeys: [],\n        unmappedTests: [],\n      };\n    }\n\n    // Group tests by journey\n    const grouped = groupTestsByJourney(this.testMappings);\n\n    const journeys: ReturnType<typeof createJourneyReport>[] = [];\n    const unmappedTests: JourneyTestMapping[] = [];\n\n    for (const entry of Array.from(grouped.entries())) {\n      const [journeyId, tests] = entry;\n      if (journeyId === 'UNMAPPED') {\n        unmappedTests.push(...tests);\n      } else {\n        journeys.push(createJourneyReport(journeyId, tests));\n      }\n    }\n\n    return {\n      journeys,\n      unmappedTests,\n    };\n  }\n\n  /**\n   * Write ARTK report to file\n   */\n  private async writeARTKReport(report: ARTKReport): Promise<void> {\n    const outputFile = this.options.outputFile;\n\n    // Ensure output directory exists\n    const outputDir = dirname(outputFile);\n    await fs.mkdir(outputDir, { recursive: true });\n\n    // Write report as JSON\n    const reportJson = JSON.stringify(report, null, 2);\n    await fs.writeFile(outputFile, reportJson, 'utf-8');\n\n    // eslint-disable-next-line no-console\n    console.log(`\\nARTK report written to: ${outputFile}`);\n    this.printSummary(report);\n  }\n\n  /**\n   * Print summary to console\n   */\n  private printSummary(report: ARTKReport): void {\n    const { summary, journeys } = report;\n\n    // eslint-disable-next-line no-console\n    console.log('\\n=== ARTK Test Summary ===');\n    // eslint-disable-next-line no-console\n    console.log(`Total Tests: ${summary.totalTests}`);\n    // eslint-disable-next-line no-console\n    console.log(`Passed: ${summary.passed}`);\n    // eslint-disable-next-line no-console\n    console.log(`Failed: ${summary.failed}`);\n    // eslint-disable-next-line no-console\n    console.log(`Skipped: ${summary.skipped}`);\n    // eslint-disable-next-line no-console\n    console.log(`Flaky: ${summary.flaky}`);\n    // eslint-disable-next-line no-console\n    console.log(`Duration: ${(summary.duration / 1000).toFixed(2)}s`);\n    // eslint-disable-next-line no-console\n    console.log(`Status: ${summary.status}`);\n\n    if (journeys.length > 0) {\n      // eslint-disable-next-line no-console\n      console.log('\\n=== Journey Results ===');\n      for (const journey of journeys) {\n        const statusIcon = journey.status === 'passed' ? '' : journey.status === 'failed' ? '' : '';\n        // eslint-disable-next-line no-console\n        console.log(\n          `${statusIcon} ${journey.journeyId}: ${journey.passedTests}/${journey.totalTests} passed (${journey.status})`\n        );\n      }\n    }\n\n    // eslint-disable-next-line no-console\n    console.log('');\n  }\n}\n\n/**\n * Generate ARTK report from test mappings (standalone function)\n *\n * @param mappings - Array of journey test mappings\n * @param includeJourneyMapping - Whether to include journey mapping\n * @returns ARTK report\n */\nexport function generateARTKReport(\n  mappings: readonly JourneyTestMapping[],\n  includeJourneyMapping: boolean = true\n): ARTKReport {\n  const summary = createStandaloneSummary(mappings);\n  const { journeys, unmappedTests } = createStandaloneJourneyReports(mappings, includeJourneyMapping);\n\n  return {\n    timestamp: new Date().toISOString(),\n    summary,\n    journeys,\n    unmappedTests,\n  };\n}\n\n/**\n * Create run summary from mappings (standalone)\n */\nfunction createStandaloneSummary(mappings: readonly JourneyTestMapping[]): RunSummary {\n  let passed = 0;\n  let failed = 0;\n  let skipped = 0;\n  let flaky = 0;\n  let totalDuration = 0;\n\n  for (const mapping of mappings) {\n    totalDuration += mapping.duration;\n\n    if (mapping.status === 'passed') {\n      if (mapping.retries > 0) {\n        flaky++;\n      } else {\n        passed++;\n      }\n    } else if (mapping.status === 'failed' || mapping.status === 'timedOut' || mapping.status === 'interrupted') {\n      failed++;\n    } else if (mapping.status === 'skipped') {\n      skipped++;\n    }\n  }\n\n  return {\n    totalTests: mappings.length,\n    passed,\n    failed,\n    skipped,\n    flaky,\n    duration: totalDuration,\n    status: failed > 0 ? 'failed' : 'passed',\n  };\n}\n\n/**\n * Create journey reports (standalone)\n */\nfunction createStandaloneJourneyReports(\n  mappings: readonly JourneyTestMapping[],\n  includeJourneyMapping: boolean\n): {\n  journeys: readonly ReturnType<typeof createJourneyReport>[];\n  unmappedTests: readonly JourneyTestMapping[];\n} {\n  if (!includeJourneyMapping) {\n    return {\n      journeys: [],\n      unmappedTests: [],\n    };\n  }\n\n  const grouped = groupTestsByJourney(mappings);\n  const journeys: ReturnType<typeof createJourneyReport>[] = [];\n  const unmappedTests: JourneyTestMapping[] = [];\n\n  for (const entry of Array.from(grouped.entries())) {\n    const [journeyId, tests] = entry;\n    if (journeyId === 'UNMAPPED') {\n      unmappedTests.push(...tests);\n    } else {\n      journeys.push(createJourneyReport(journeyId, tests));\n    }\n  }\n\n  return {\n    journeys,\n    unmappedTests,\n  };\n}\n\n/**\n * Write ARTK report to file (standalone function)\n *\n * @param report - ARTK report\n * @param outputFile - Output file path\n * @returns Promise that resolves when report is written\n */\nexport async function writeARTKReport(report: ARTKReport, outputFile: string): Promise<void> {\n  const outputDir = dirname(outputFile);\n  await fs.mkdir(outputDir, { recursive: true });\n\n  const reportJson = JSON.stringify(report, null, 2);\n  await fs.writeFile(outputFile, reportJson, 'utf-8');\n}\n","/**\n * Playwright Project Configuration Helpers (T103)\n *\n * Provides factory functions for creating Playwright project configurations:\n * - createAuthSetupProject: Creates auth setup project for a role\n * - createBrowserProjects: Creates browser projects with auth dependencies\n *\n * @module harness/projects\n */\n\nimport * as path from 'node:path';\n\nimport type { BrowserType } from '../config/types.js';\nimport type { PlaywrightProject } from './types.js';\n\n// =============================================================================\n// Constants\n// =============================================================================\n\n/**\n * Default test match pattern for auth setup\n */\nconst DEFAULT_AUTH_SETUP_PATTERN = '**/auth.setup.ts';\n\n/**\n * Default storage state file pattern\n */\nconst DEFAULT_STORAGE_STATE_PATTERN = '{role}.json';\n\n// =============================================================================\n// Auth Setup Project Factory\n// =============================================================================\n\n/**\n * Create a Playwright project configuration for auth setup\n *\n * Auth setup projects run before browser tests to establish\n * authenticated sessions. Each role gets its own setup project.\n *\n * @param role - Role name (e.g., 'admin', 'standardUser')\n * @param storageStatePath - Path to save storage state file\n * @param testMatch - Test file pattern (default: 'auth.setup.ts' glob pattern)\n * @returns Playwright project configuration\n *\n * @example\n * ```typescript\n * const adminSetup = createAuthSetupProject(\n *   'admin',\n *   '.auth-states/admin.json'\n * );\n * // Returns: { name: 'auth-setup-admin', testMatch: '**\\/auth.setup.ts' }\n * ```\n */\nexport function createAuthSetupProject(\n  role: string,\n  storageStatePath: string,\n  testMatch: string = DEFAULT_AUTH_SETUP_PATTERN\n): PlaywrightProject {\n  if (!role || typeof role !== 'string') {\n    throw new Error('Role must be a non-empty string');\n  }\n\n  if (!storageStatePath || typeof storageStatePath !== 'string') {\n    throw new Error('Storage state path must be a non-empty string');\n  }\n\n  return {\n    name: `auth-setup-${role}`,\n    testMatch,\n    use: {\n      storageState: undefined, // Auth setup starts without storage state\n    },\n  };\n}\n\n/**\n * Create auth setup projects for all roles\n *\n * @param roles - Array of role names\n * @param storageStateDir - Directory for storage state files\n * @param filePattern - File naming pattern (default: '{role}.json')\n * @param testMatch - Test file pattern\n * @returns Array of Playwright project configurations\n */\nexport function createAuthSetupProjects(\n  roles: readonly string[],\n  storageStateDir: string,\n  filePattern: string = DEFAULT_STORAGE_STATE_PATTERN,\n  testMatch: string = DEFAULT_AUTH_SETUP_PATTERN\n): readonly PlaywrightProject[] {\n  return roles.map((role) => {\n    const filename = resolveStorageStateFilename(role, filePattern);\n    const storagePath = path.join(storageStateDir, filename);\n    return createAuthSetupProject(role, storagePath, testMatch);\n  });\n}\n\n// =============================================================================\n// Browser Projects Factory\n// =============================================================================\n\n/**\n * Create Playwright project configurations for browser testing\n *\n * Creates projects for each combination of browser and role.\n * Projects depend on their corresponding auth setup projects.\n *\n * @param browsers - Array of browser types to create projects for\n * @param roles - Array of role names\n * @param storageStateDir - Directory containing storage state files\n * @param filePattern - Storage state file naming pattern\n * @param dependencies - Additional project dependencies\n * @returns Array of Playwright project configurations\n *\n * @example\n * ```typescript\n * const projects = createBrowserProjects(\n *   ['chromium', 'firefox'],\n *   ['admin', 'standardUser'],\n *   '.auth-states',\n *   '{role}.json'\n * );\n * // Creates 4 projects: chromium-admin, chromium-standardUser,\n * // firefox-admin, firefox-standardUser\n * ```\n */\nexport function createBrowserProjects(\n  browsers: readonly BrowserType[],\n  roles: readonly string[],\n  storageStateDir: string,\n  filePattern: string = DEFAULT_STORAGE_STATE_PATTERN,\n  dependencies: readonly string[] = []\n): readonly PlaywrightProject[] {\n  const projects: PlaywrightProject[] = [];\n\n  for (const browser of browsers) {\n    // Create unauthenticated project for public pages\n    projects.push(createBrowserProject(browser));\n\n    // Create authenticated projects for each role\n    for (const role of roles) {\n      const filename = resolveStorageStateFilename(role, filePattern);\n      const storageStatePath = path.join(storageStateDir, filename);\n\n      const authDeps = [`auth-setup-${role}`, ...dependencies];\n\n      projects.push(\n        createBrowserProject(browser, role, storageStatePath, authDeps)\n      );\n    }\n  }\n\n  return projects;\n}\n\n/**\n * Create a single browser project\n *\n * @param browser - Browser type\n * @param role - Optional role for authentication\n * @param storageStatePath - Path to storage state file\n * @param dependencies - Project dependencies\n * @returns Playwright project configuration\n */\nexport function createBrowserProject(\n  browser: BrowserType,\n  role?: string,\n  storageStatePath?: string,\n  dependencies?: readonly string[]\n): PlaywrightProject {\n  const name = role ? `${browser}-${role}` : browser;\n\n  const project: PlaywrightProject = {\n    name,\n    use: {\n      browserName: browser,\n      ...(storageStatePath && { storageState: storageStatePath }),\n    },\n    ...(dependencies && dependencies.length > 0 && { dependencies }),\n  };\n\n  return project;\n}\n\n/**\n * Create browser projects without authentication\n *\n * Useful for testing public pages or auth flows themselves.\n *\n * @param browsers - Array of browser types\n * @returns Array of unauthenticated browser projects\n */\nexport function createUnauthenticatedBrowserProjects(\n  browsers: readonly BrowserType[]\n): readonly PlaywrightProject[] {\n  return browsers.map((browser) => createBrowserProject(browser));\n}\n\n// =============================================================================\n// Storage State Helpers\n// =============================================================================\n\n/**\n * Resolve storage state filename from pattern\n *\n * Replaces {role} and {env} placeholders in the pattern.\n *\n * @param role - Role name\n * @param pattern - File pattern (e.g., '{role}.json', '{role}-{env}.json')\n * @param env - Environment name (default: 'default')\n * @returns Resolved filename\n */\nexport function resolveStorageStateFilename(\n  role: string,\n  pattern: string,\n  env: string = 'default'\n): string {\n  let filename = pattern.replace('{role}', role);\n  filename = filename.replace('{env}', env);\n\n  // Ensure .json extension\n  if (!filename.endsWith('.json')) {\n    filename = `${filename}.json`;\n  }\n\n  return filename;\n}\n\n/**\n * Get storage state path for a role\n *\n * @param role - Role name\n * @param storageStateDir - Base directory\n * @param filePattern - File naming pattern\n * @param env - Environment name\n * @returns Full path to storage state file\n */\nexport function getStorageStatePathForRole(\n  role: string,\n  storageStateDir: string,\n  filePattern: string = DEFAULT_STORAGE_STATE_PATTERN,\n  env?: string\n): string {\n  const filename = resolveStorageStateFilename(role, filePattern, env);\n  return path.join(storageStateDir, filename);\n}\n\n// =============================================================================\n// Project Filtering Helpers\n// =============================================================================\n\n/**\n * Filter projects by browser type\n *\n * @param projects - Array of projects\n * @param browser - Browser type to filter by\n * @returns Filtered projects\n */\nexport function filterProjectsByBrowser(\n  projects: readonly PlaywrightProject[],\n  browser: BrowserType\n): readonly PlaywrightProject[] {\n  return projects.filter((p) =>\n    p.name === browser || p.name.startsWith(`${browser}-`)\n  );\n}\n\n/**\n * Filter projects by role\n *\n * @param projects - Array of projects\n * @param role - Role name to filter by\n * @returns Filtered projects\n */\nexport function filterProjectsByRole(\n  projects: readonly PlaywrightProject[],\n  role: string\n): readonly PlaywrightProject[] {\n  return projects.filter((p) =>\n    p.name.includes(role)\n  );\n}\n\n/**\n * Get auth setup projects only\n *\n * @param projects - Array of all projects\n * @returns Only auth setup projects\n */\nexport function getAuthSetupProjects(\n  projects: readonly PlaywrightProject[]\n): readonly PlaywrightProject[] {\n  return projects.filter((p) => p.name.startsWith('auth-setup-'));\n}\n\n/**\n * Get browser projects only (excludes auth setup)\n *\n * @param projects - Array of all projects\n * @returns Only browser projects\n */\nexport function getBrowserProjects(\n  projects: readonly PlaywrightProject[]\n): readonly PlaywrightProject[] {\n  return projects.filter((p) => !p.name.startsWith('auth-setup-'));\n}\n","/**\n * Reporter Configuration Helper (T104)\n *\n * Generates Playwright reporter configurations from ARTK config.\n *\n * @module harness/reporters\n */\n\nimport type { ReporterDescription } from '@playwright/test';\n\nimport type { ARTKConfig } from '../config/types.js';\nimport type { ReporterArray, ReporterConfigOptions } from './types.js';\n\n// =============================================================================\n// Constants\n// =============================================================================\n\n/**\n * Default reporter settings when not configured\n */\nconst DEFAULT_REPORTER_OPTIONS: Required<ReporterConfigOptions> = {\n  html: true,\n  htmlOutputFolder: 'playwright-report',\n  htmlOpen: 'on-failure',\n  json: false,\n  jsonOutputFile: 'test-results/results.json',\n  junit: false,\n  junitOutputFile: 'test-results/junit.xml',\n  artk: false,\n  artkOutputFile: 'test-results/artk-report.json',\n  includeJourneyMapping: true,\n  list: true,\n  dot: false,\n};\n\n// =============================================================================\n// Reporter Configuration Factory\n// =============================================================================\n\n/**\n * Generate Playwright reporter configuration from ARTK config\n *\n * Creates an array of reporter descriptions based on the reporters\n * section in artk.config.yml.\n *\n * @param config - ARTK configuration\n * @returns Array of Playwright reporter descriptions\n *\n * @example\n * ```typescript\n * import { loadConfig } from '@artk/core/config';\n * import { getReporterConfig } from '@artk/core/harness';\n *\n * const { config } = loadConfig();\n * const reporters = getReporterConfig(config);\n * // [['html', {...}], ['json', {...}], ...]\n * ```\n */\nexport function getReporterConfig(config: ARTKConfig): ReporterArray {\n  const reporters: ReporterArray = [];\n  const reportersConfig = config.reporters;\n\n  // Always add list reporter for console output (unless disabled)\n  reporters.push(['list']);\n\n  // HTML Reporter\n  if (reportersConfig.html?.enabled) {\n    const htmlReporter: ReporterDescription = [\n      'html',\n      {\n        outputFolder: reportersConfig.html.outputFolder,\n        open: reportersConfig.html.open,\n      },\n    ];\n    reporters.push(htmlReporter);\n  }\n\n  // JSON Reporter\n  if (reportersConfig.json?.enabled) {\n    const jsonReporter: ReporterDescription = [\n      'json',\n      {\n        outputFile: reportersConfig.json.outputFile,\n      },\n    ];\n    reporters.push(jsonReporter);\n  }\n\n  // JUnit Reporter\n  if (reportersConfig.junit?.enabled) {\n    const junitReporter: ReporterDescription = [\n      'junit',\n      {\n        outputFile: reportersConfig.junit.outputFile,\n      },\n    ];\n    reporters.push(junitReporter);\n  }\n\n  // ARTK Reporter (custom reporter for journey mapping)\n  if (reportersConfig.artk?.enabled) {\n    const artkReporter: ReporterDescription = [\n      './reporters/artk-reporter.ts',\n      {\n        outputFile: reportersConfig.artk.outputFile,\n        includeJourneyMapping: reportersConfig.artk.includeJourneyMapping,\n      },\n    ];\n    reporters.push(artkReporter);\n  }\n\n  return reporters;\n}\n\n/**\n * Generate reporter configuration from options object\n *\n * Alternative to using ARTK config, useful for testing or custom setups.\n *\n * @param options - Reporter configuration options\n * @returns Array of Playwright reporter descriptions\n */\nexport function getReporterConfigFromOptions(\n  options: Partial<ReporterConfigOptions> = {}\n): ReporterArray {\n  const mergedOptions = { ...DEFAULT_REPORTER_OPTIONS, ...options };\n  const reporters: ReporterArray = [];\n\n  // Console reporters\n  if (mergedOptions.list) {\n    reporters.push(['list']);\n  } else if (mergedOptions.dot) {\n    reporters.push(['dot']);\n  }\n\n  // HTML Reporter\n  if (mergedOptions.html) {\n    reporters.push([\n      'html',\n      {\n        outputFolder: mergedOptions.htmlOutputFolder,\n        open: mergedOptions.htmlOpen,\n      },\n    ]);\n  }\n\n  // JSON Reporter\n  if (mergedOptions.json) {\n    reporters.push([\n      'json',\n      {\n        outputFile: mergedOptions.jsonOutputFile,\n      },\n    ]);\n  }\n\n  // JUnit Reporter\n  if (mergedOptions.junit) {\n    reporters.push([\n      'junit',\n      {\n        outputFile: mergedOptions.junitOutputFile,\n      },\n    ]);\n  }\n\n  // ARTK Reporter\n  if (mergedOptions.artk) {\n    reporters.push([\n      './reporters/artk-reporter.ts',\n      {\n        outputFile: mergedOptions.artkOutputFile,\n        includeJourneyMapping: mergedOptions.includeJourneyMapping,\n      },\n    ]);\n  }\n\n  return reporters;\n}\n\n/**\n * Create minimal reporter configuration\n *\n * Returns just the list reporter for quick local development.\n *\n * @returns Minimal reporter array\n */\nexport function getMinimalReporterConfig(): ReporterArray {\n  return [['list']];\n}\n\n/**\n * Create CI-optimized reporter configuration\n *\n * Includes JUnit for CI integration and JSON for processing.\n *\n * @param junitPath - Path for JUnit output\n * @param jsonPath - Path for JSON output\n * @returns CI-optimized reporter array\n */\nexport function getCIReporterConfig(\n  junitPath: string = 'test-results/junit.xml',\n  jsonPath: string = 'test-results/results.json'\n): ReporterArray {\n  return [\n    ['dot'], // Minimal console output for CI\n    ['junit', { outputFile: junitPath }],\n    ['json', { outputFile: jsonPath }],\n  ];\n}\n\n/**\n * Merge reporter configurations\n *\n * Combines multiple reporter arrays, deduplicating by reporter type.\n *\n * @param configs - Reporter arrays to merge\n * @returns Merged reporter array\n */\nexport function mergeReporterConfigs(\n  ...configs: ReporterArray[]\n): ReporterArray {\n  const seen = new Map<string, ReporterDescription>();\n\n  for (const config of configs) {\n    for (const reporter of config) {\n      const type = Array.isArray(reporter) ? reporter[0] : String(reporter);\n      // Later configs override earlier ones\n      seen.set(type, reporter);\n    }\n  }\n\n  return Array.from(seen.values());\n}\n\n/**\n * Check if a reporter type is enabled in the configuration\n *\n * @param reporters - Reporter array to check\n * @param type - Reporter type (e.g., 'html', 'json')\n * @returns True if the reporter type is in the array\n */\nexport function hasReporter(\n  reporters: ReporterArray,\n  type: string\n): boolean {\n  return reporters.some((r) => {\n    const reporterType = Array.isArray(r) ? r[0] : String(r);\n    return reporterType === type || (typeof reporterType === 'string' && reporterType.includes(type));\n  });\n}\n","/**\n * Playwright Configuration Factory (T102, T105)\n *\n * Creates complete Playwright configurations from ARTK config.\n *\n * Key Features:\n * - createPlaywrightConfig: Main factory function\n * - getTierSettings: Tier-specific settings (smoke, release, regression)\n * - getUseOptions: Shared 'use' configuration\n *\n * @module harness/playwright.config.base\n *\n * @example\n * ```typescript\n * // playwright.config.ts\n * import { loadConfig } from '@artk/core/config';\n * import { createPlaywrightConfig } from '@artk/core/harness';\n *\n * const { config, activeEnvironment } = loadConfig();\n *\n * export default createPlaywrightConfig({\n *   config,\n *   activeEnvironment,\n *   tier: 'regression',\n * });\n * ```\n */\n\nimport * as path from 'node:path';\n\nimport type { ARTKConfig, BrowserChannel, BrowserType } from '../config/types.js';\nimport type {\n  HarnessOptions,\n  PlaywrightConfigOutput,\n  PlaywrightProject,\n  TierName,\n  TierSettings,\n  UseOptions,\n} from './types.js';\nimport { createAuthSetupProjects, createBrowserProjects } from './projects.js';\nimport { getReporterConfig } from './reporters.js';\n\n// =============================================================================\n// Constants\n// =============================================================================\n\n/**\n * Default tier when not specified\n */\nconst DEFAULT_TIER: TierName = 'regression';\n\n/**\n * Default test directory\n */\nconst DEFAULT_TEST_DIR = 'tests';\n\n/**\n * Default output directory\n */\nconst DEFAULT_OUTPUT_DIR = 'test-results';\n\n/**\n * Default expect timeout in ms\n */\nconst DEFAULT_EXPECT_TIMEOUT = 5000;\n\n/**\n * Default tier settings when tier config is missing\n */\nconst DEFAULT_TIER_SETTINGS: Record<TierName, TierSettings> = {\n  smoke: {\n    retries: 0,\n    workers: 1,\n    timeout: 30000,\n    tag: '@smoke',\n  },\n  release: {\n    retries: 1,\n    workers: 2,\n    timeout: 60000,\n    tag: '@release',\n  },\n  regression: {\n    retries: 2,\n    workers: 4,\n    timeout: 120000,\n    tag: '@regression',\n  },\n};\n\n// =============================================================================\n// Tier Settings Factory (T105)\n// =============================================================================\n\n/**\n * Get tier-specific settings from ARTK config\n *\n * Returns configuration values (retries, workers, timeout, tag) for\n * the specified tier. Falls back to defaults if tier not configured.\n *\n * @param config - ARTK configuration\n * @param tier - Tier name ('smoke', 'release', 'regression')\n * @returns Tier settings object\n *\n * @example\n * ```typescript\n * const settings = getTierSettings(config, 'smoke');\n * // { retries: 0, workers: 1, timeout: 30000, tag: '@smoke' }\n * ```\n */\nexport function getTierSettings(\n  config: ARTKConfig,\n  tier: TierName = DEFAULT_TIER\n): TierSettings {\n  const tierConfig = config.tiers[tier];\n\n  if (!tierConfig) {\n    // Fall back to default tier settings\n    return DEFAULT_TIER_SETTINGS[tier] ?? DEFAULT_TIER_SETTINGS.regression;\n  }\n\n  return {\n    retries: tierConfig.retries,\n    workers: tierConfig.workers,\n    timeout: tierConfig.timeout,\n    tag: tierConfig.tag,\n  };\n}\n\n/**\n * Get all tier settings as a map\n *\n * @param config - ARTK configuration\n * @returns Map of tier name to settings\n */\nexport function getAllTierSettings(\n  config: ARTKConfig\n): Record<TierName, TierSettings> {\n  return {\n    smoke: getTierSettings(config, 'smoke'),\n    release: getTierSettings(config, 'release'),\n    regression: getTierSettings(config, 'regression'),\n  };\n}\n\n// =============================================================================\n// Use Options Factory (T105)\n// =============================================================================\n\n/**\n * Map ARTK browser channel to Playwright channel option\n */\nfunction mapBrowserChannel(channel?: BrowserChannel): string | undefined {\n  if (!channel || channel === 'bundled') {\n    return undefined;\n  }\n  return channel;\n}\n\n/**\n * Generate Playwright 'use' configuration from ARTK config\n *\n * Creates the shared settings object that applies to all projects.\n *\n * @param config - ARTK configuration\n * @param activeEnvironment - Optional active environment name\n * @returns UseOptions object for Playwright config\n *\n * @example\n * ```typescript\n * const useOptions = getUseOptions(config, 'staging');\n * // { baseURL: 'https://staging.example.com', viewport: {...}, ... }\n * ```\n */\nexport function getUseOptions(\n  config: ARTKConfig,\n  activeEnvironment?: string\n): UseOptions {\n  // Determine base URL\n  const envName = activeEnvironment ?? config.activeEnvironment;\n  const envConfig = config.environments[envName];\n  const baseURL = envConfig?.baseUrl ?? config.app.baseUrl;\n\n  // Map screenshot mode\n  const screenshotMode = mapScreenshotMode(config.artifacts.screenshots.mode);\n\n  // Map video mode\n  const videoMode = mapCaptureMode(config.artifacts.video.mode);\n\n  // Map trace mode\n  const traceMode = mapCaptureMode(config.artifacts.trace.mode);\n\n  const playwrightChannel = mapBrowserChannel(config.browsers.channel);\n\n  return {\n    baseURL,\n    viewport: {\n      width: config.browsers.viewport.width,\n      height: config.browsers.viewport.height,\n    },\n    headless: config.browsers.headless,\n    ...(config.browsers.slowMo && { slowMo: config.browsers.slowMo }),\n    ...(playwrightChannel && { channel: playwrightChannel }),\n    screenshot: screenshotMode,\n    video: videoMode,\n    trace: traceMode,\n    testIdAttribute: config.selectors.testIdAttribute,\n  };\n}\n\n/**\n * Map ARTK screenshot mode to Playwright mode\n */\nfunction mapScreenshotMode(\n  mode: 'off' | 'on' | 'only-on-failure'\n): 'off' | 'on' | 'only-on-failure' {\n  return mode;\n}\n\n/**\n * Map ARTK capture mode to Playwright mode\n */\nfunction mapCaptureMode(\n  mode: 'off' | 'on' | 'retain-on-failure' | 'on-first-retry'\n): 'off' | 'on' | 'retain-on-failure' | 'on-first-retry' {\n  return mode;\n}\n\n// =============================================================================\n// Playwright Config Factory (T102)\n// =============================================================================\n\n/**\n * Create a complete Playwright configuration from ARTK config\n *\n * This is the main entry point for generating playwright.config.ts\n * contents. It combines all ARTK settings into a valid Playwright\n * configuration object.\n *\n * @param options - Harness configuration options\n * @returns Complete Playwright configuration object\n *\n * @example\n * ```typescript\n * // playwright.config.ts\n * import { loadConfig } from '@artk/core/config';\n * import { createPlaywrightConfig } from '@artk/core/harness';\n *\n * const { config, activeEnvironment } = loadConfig();\n *\n * export default createPlaywrightConfig({\n *   config,\n *   activeEnvironment,\n *   tier: 'smoke', // Optional: defaults to 'regression'\n *   testDir: 'e2e', // Optional: defaults to 'tests'\n * });\n * ```\n */\nexport function createPlaywrightConfig(\n  options: HarnessOptions\n): PlaywrightConfigOutput {\n  const {\n    config,\n    activeEnvironment,\n    tier = DEFAULT_TIER,\n    projectRoot = process.cwd(),\n    includeAuthSetup = true,\n    testDir = DEFAULT_TEST_DIR,\n    outputDir = DEFAULT_OUTPUT_DIR,\n    additionalProjects = [],\n  } = options;\n\n  // Get tier settings\n  const tierSettings = getTierSettings(config, tier);\n\n  // Get use options\n  const useOptions = getUseOptions(config, activeEnvironment);\n\n  // Get reporter config\n  const reporters = getReporterConfig(config);\n\n  // Build projects\n  const projects = buildProjects(\n    config,\n    projectRoot,\n    includeAuthSetup,\n    additionalProjects\n  );\n\n  // Determine if running in CI\n  const isCI = Boolean(process.env.CI);\n\n  return {\n    testDir,\n    outputDir: config.artifacts.outputDir ?? outputDir,\n    fullyParallel: true,\n    forbidOnly: isCI,\n    retries: tierSettings.retries,\n    workers: tierSettings.workers,\n    timeout: tierSettings.timeout,\n    expect: {\n      timeout: DEFAULT_EXPECT_TIMEOUT,\n    },\n    reporter: reporters,\n    use: useOptions,\n    projects,\n  };\n}\n\n/**\n * Build project array from configuration\n */\nfunction buildProjects(\n  config: ARTKConfig,\n  projectRoot: string,\n  includeAuthSetup: boolean,\n  additionalProjects: readonly PlaywrightProject[]\n): readonly PlaywrightProject[] {\n  const projects: PlaywrightProject[] = [];\n\n  // Get roles and browsers from config\n  const roles = Object.keys(config.auth.roles);\n  const browsers = config.browsers.enabled;\n  const storageStateDir = path.join(\n    projectRoot,\n    config.auth.storageState.directory\n  );\n  const filePattern = config.auth.storageState.filePattern;\n\n  // Add auth setup projects\n  if (includeAuthSetup && roles.length > 0) {\n    const authProjects = createAuthSetupProjects(\n      roles,\n      storageStateDir,\n      filePattern\n    );\n    projects.push(...authProjects);\n  }\n\n  // Add browser projects\n  const browserProjects = createBrowserProjects(\n    browsers,\n    roles,\n    storageStateDir,\n    filePattern\n  );\n  projects.push(...browserProjects);\n\n  // Add any additional custom projects\n  projects.push(...additionalProjects);\n\n  return projects;\n}\n\n/**\n * Create minimal Playwright configuration\n *\n * Useful for quick testing or simple setups without full ARTK config.\n *\n * @param baseURL - Base URL for tests\n * @param browsers - Browsers to test (default: ['chromium'])\n * @returns Minimal Playwright configuration\n */\nexport function createMinimalPlaywrightConfig(\n  baseURL: string,\n  browsers: BrowserType[] = ['chromium']\n): Partial<PlaywrightConfigOutput> {\n  const projects: PlaywrightProject[] = browsers.map((browser) => ({\n    name: browser,\n    use: {\n      browserName: browser,\n    },\n  }));\n\n  return {\n    testDir: DEFAULT_TEST_DIR,\n    outputDir: DEFAULT_OUTPUT_DIR,\n    fullyParallel: true,\n    forbidOnly: Boolean(process.env.CI),\n    retries: 0,\n    workers: 1,\n    timeout: 30000,\n    expect: {\n      timeout: DEFAULT_EXPECT_TIMEOUT,\n    },\n    reporter: [['list']],\n    use: {\n      baseURL,\n      viewport: { width: 1280, height: 720 },\n      headless: true,\n      screenshot: 'only-on-failure',\n      video: 'off',\n      trace: 'off',\n      testIdAttribute: 'data-testid',\n    },\n    projects,\n  };\n}\n\n/**\n * Merge Playwright configurations\n *\n * Combines a base configuration with overrides.\n *\n * @param base - Base configuration\n * @param overrides - Configuration overrides\n * @returns Merged configuration\n */\nexport function mergePlaywrightConfigs(\n  base: Partial<PlaywrightConfigOutput>,\n  overrides: Partial<PlaywrightConfigOutput>\n): Partial<PlaywrightConfigOutput> {\n  return {\n    ...base,\n    ...overrides,\n    use: {\n      ...base.use,\n      ...overrides.use,\n    } as UseOptions,\n    projects: overrides.projects ?? base.projects,\n    reporter: overrides.reporter ?? base.reporter ?? [],\n  };\n}\n\n/**\n * Create a config override for a specific tier\n *\n * Useful for running different tiers with the same base config.\n *\n * @param config - ARTK configuration\n * @param tier - Tier to configure for\n * @returns Configuration overrides for the tier\n */\nexport function createTierOverrides(\n  config: ARTKConfig,\n  tier: TierName\n): Partial<PlaywrightConfigOutput> {\n  const settings = getTierSettings(config, tier);\n\n  return {\n    retries: settings.retries,\n    workers: settings.workers,\n    timeout: settings.timeout,\n  };\n}\n","import { exec } from 'node:child_process';\nimport { promisify } from 'node:util';\n\nimport type { BrowserChannel } from '../config/types.js';\n\nconst execAsync = promisify(exec);\n\nexport interface BrowserValidationResult {\n  available: boolean;\n  version?: string;\n  path?: string;\n  reason?: string;\n}\n\nfunction parseCommandPath(command: string): string {\n  const trimmed = command.replace(/\\s+--version$/, '').trim();\n  return trimmed.replace(/^\"(.*)\"$/, '$1');\n}\n\nasync function checkCommands(\n  commands: string[]\n): Promise<Omit<BrowserValidationResult, 'available'>> {\n  for (const cmd of commands) {\n    try {\n      const { stdout } = await execAsync(cmd, { timeout: 5000 });\n      const version = stdout.match(/(\\d+\\.\\d+\\.\\d+\\.\\d+)/)?.[1];\n      return {\n        version,\n        path: parseCommandPath(cmd),\n      };\n    } catch {\n      continue;\n    }\n  }\n\n  return {};\n}\n\n/**\n * Validate that the configured browser channel is available on the system.\n */\nexport async function validateBrowserChannel(\n  channel?: BrowserChannel\n): Promise<BrowserValidationResult> {\n  if (!channel || channel === 'bundled') {\n    return { available: true };\n  }\n\n  try {\n    if (channel === 'msedge') {\n      const edgeCommands = [\n        'microsoft-edge --version',\n        'microsoft-edge-stable --version',\n        '\"/Applications/Microsoft Edge.app/Contents/MacOS/Microsoft Edge\" --version',\n        '\"C:\\\\\\\\Program Files (x86)\\\\\\\\Microsoft\\\\\\\\Edge\\\\\\\\Application\\\\\\\\msedge.exe\" --version',\n        '\"C:\\\\\\\\Program Files\\\\\\\\Microsoft\\\\\\\\Edge\\\\\\\\Application\\\\\\\\msedge.exe\" --version',\n        '\"%LOCALAPPDATA%\\\\\\\\Microsoft\\\\\\\\Edge\\\\\\\\Application\\\\\\\\msedge.exe\" --version',\n        '\"%USERPROFILE%\\\\\\\\AppData\\\\\\\\Local\\\\\\\\Microsoft\\\\\\\\Edge\\\\\\\\Application\\\\\\\\msedge.exe\" --version',\n      ];\n\n      const result = await checkCommands(edgeCommands);\n      if (result.path) {\n        return { available: true, ...result };\n      }\n\n      return {\n        available: false,\n        reason: `Browser \"${channel}\" not found. Install from https://microsoft.com/edge`,\n      };\n    }\n\n    if (channel === 'chrome' || channel === 'chrome-beta' || channel === 'chrome-dev') {\n      const chromeCommands = [\n        'google-chrome --version',\n        'google-chrome-stable --version',\n        'google-chrome-beta --version',\n        'google-chrome-unstable --version',\n        '\"/Applications/Google Chrome.app/Contents/MacOS/Google Chrome\" --version',\n        'chromium --version',\n        '\"C:\\\\\\\\Program Files\\\\\\\\Google\\\\\\\\Chrome\\\\\\\\Application\\\\\\\\chrome.exe\" --version',\n        '\"C:\\\\\\\\Program Files (x86)\\\\\\\\Google\\\\\\\\Chrome\\\\\\\\Application\\\\\\\\chrome.exe\" --version',\n        '\"%LOCALAPPDATA%\\\\\\\\Google\\\\\\\\Chrome\\\\\\\\Application\\\\\\\\chrome.exe\" --version',\n        '\"%USERPROFILE%\\\\\\\\AppData\\\\\\\\Local\\\\\\\\Google\\\\\\\\Chrome\\\\\\\\Application\\\\\\\\chrome.exe\" --version',\n      ];\n\n      const result = await checkCommands(chromeCommands);\n      if (result.path) {\n        return { available: true, ...result };\n      }\n\n      return {\n        available: false,\n        reason: `Browser \"${channel}\" not found. Install from https://google.com/chrome`,\n      };\n    }\n  } catch (error) {\n    return {\n      available: false,\n      reason: `Browser validation error: ${\n        error instanceof Error ? error.message : String(error)\n      }`,\n    };\n  }\n\n  return { available: true };\n}\n","/**\n * AG Grid Helper Module - TypeScript Types\n *\n * This file defines the public API types for the AG Grid helper module.\n *\n * @module grid/types\n */\n\nimport type { Locator, Page } from '@playwright/test';\n\n// ============================================================================\n// Configuration Types\n// ============================================================================\n\n/**\n * AG Grid locator configuration\n */\nexport interface AgGridConfig {\n  /** Grid container selector (testid, CSS, or Locator string) */\n  selector: string;\n\n  /** Column definitions for smart cell location */\n  columns?: AgGridColumnDef[];\n\n  /** Custom cell renderer mappings */\n  cellRenderers?: Record<string, CellRendererConfig>;\n\n  /** Field name used for stable row IDs (maps to getRowId in AG Grid) */\n  rowIdField?: string;\n\n  /** Enterprise feature configuration */\n  enterprise?: EnterpriseConfig;\n\n  /** Custom timeout overrides */\n  timeouts?: TimeoutConfig;\n}\n\n/**\n * Column definition for type-safe cell access\n */\nexport interface AgGridColumnDef {\n  /** Column ID (matches AG Grid col-id attribute) */\n  colId: string;\n\n  /** Human-readable name for error messages */\n  displayName?: string;\n\n  /** Cell value type for smart assertions */\n  type?: ColumnType;\n\n  /** Custom value extraction function for complex cells */\n  valueExtractor?: (cell: Locator) => Promise<string>;\n\n  /** Column pinned position */\n  pinned?: 'left' | 'right' | null;\n}\n\n/**\n * Cell value types\n */\nexport type ColumnType = 'text' | 'number' | 'date' | 'boolean' | 'custom';\n\n/**\n * Custom cell renderer configuration\n */\nexport interface CellRendererConfig {\n  /** CSS selector for the value element within cell */\n  valueSelector: string;\n\n  /** Custom extraction function (defaults to textContent) */\n  extractValue?: (element: Locator) => Promise<string>;\n}\n\n/**\n * AG Grid Enterprise feature configuration\n */\nexport interface EnterpriseConfig {\n  /** Enable row grouping support */\n  rowGrouping?: boolean;\n\n  /** Enable tree data support */\n  treeData?: boolean;\n\n  /** Enable master/detail support */\n  masterDetail?: boolean;\n\n  /** Enable server-side row model handling */\n  serverSide?: boolean;\n}\n\n/**\n * Custom timeout configuration\n */\nexport interface TimeoutConfig {\n  /** Timeout for grid ready state (ms). Default: 30000 */\n  gridReady?: number;\n\n  /** Timeout for row to appear (ms). Default: 10000 */\n  rowLoad?: number;\n\n  /** Timeout for cell edit mode (ms). Default: 5000 */\n  cellEdit?: number;\n\n  /** Interval between scroll operations (ms). Default: 50 */\n  scroll?: number;\n}\n\n/**\n * Default timeout values\n */\nexport const DEFAULT_TIMEOUTS: Required<TimeoutConfig> = {\n  gridReady: 30000,\n  rowLoad: 10000,\n  cellEdit: 5000,\n  scroll: 50,\n};\n\n// ============================================================================\n// Row Matching Types\n// ============================================================================\n\n/**\n * Criteria for finding a specific row in the grid\n */\nexport interface RowMatcher {\n  /** Match by viewport row index (0-based) */\n  rowIndex?: number;\n\n  /** Match by stable row ID (requires rowIdField in config) */\n  rowId?: string;\n\n  /** Match by absolute aria-rowindex (1-based) */\n  ariaRowIndex?: number;\n\n  /** Match by cell value combinations */\n  cellValues?: Record<string, unknown>;\n\n  /** Custom match predicate */\n  predicate?: (row: AgGridRowData) => boolean;\n}\n\n// ============================================================================\n// Data Extraction Types\n// ============================================================================\n\n/**\n * Extracted data from a grid row\n */\nexport interface AgGridRowData {\n  /** Viewport row index (0-based) */\n  rowIndex: number;\n\n  /** Stable row ID if available */\n  rowId?: string;\n\n  /** Absolute row position (1-based, from aria-rowindex) */\n  ariaRowIndex: number;\n\n  /** Cell values keyed by colId */\n  cells: Record<string, unknown>;\n\n  /** True if this is a group row */\n  isGroup?: boolean;\n\n  /** True if group/tree node is expanded */\n  isExpanded?: boolean;\n\n  /** Nesting level for tree/group rows */\n  groupLevel?: number;\n}\n\n/**\n * Current state of the grid\n */\nexport interface AgGridState {\n  /** Total row count (from pagination info or DOM) */\n  totalRows: number;\n\n  /** Currently visible row count in viewport */\n  visibleRows: number;\n\n  /** Selected row count */\n  selectedRows: number;\n\n  /** Current sort state */\n  sortedBy?: SortModel[];\n\n  /** Current filter state */\n  filteredBy?: Record<string, unknown>;\n\n  /** Columns used for grouping */\n  groupedBy?: string[];\n\n  /** True if loading overlay is visible */\n  isLoading: boolean;\n}\n\n/**\n * Sort state for a column\n */\nexport interface SortModel {\n  /** Column being sorted */\n  colId: string;\n\n  /** Sort direction */\n  direction: 'asc' | 'desc';\n}\n\n// ============================================================================\n// Assertion Options\n// ============================================================================\n\n/**\n * Common options for grid assertions\n */\nexport interface AssertionOptions {\n  /** Assertion timeout in ms. Default: 5000 */\n  timeout?: number;\n\n  /** Require exact match vs contains. Default: false */\n  exact?: boolean;\n}\n\n/**\n * Options for row count assertions\n */\nexport interface RowCountOptions extends AssertionOptions {\n  /** Minimum row count (for range assertions) */\n  min?: number;\n\n  /** Maximum row count (for range assertions) */\n  max?: number;\n}\n\n// ============================================================================\n// Helper Interface\n// ============================================================================\n\n/**\n * AG Grid Helper - Main interface for grid interactions\n */\nexport interface AgGridHelper {\n  // \n  // Locators\n  // \n\n  /** Get the root grid container */\n  getGrid(): Locator;\n\n  /** Get a specific row by matcher */\n  getRow(matcher: RowMatcher): Locator;\n\n  /** Get all visible rows */\n  getVisibleRows(): Locator;\n\n  /** Get a specific cell */\n  getCell(rowMatcher: RowMatcher, colId: string): Locator;\n\n  /** Get header cell by column ID */\n  getHeaderCell(colId: string): Locator;\n\n  /** Get filter input for a column (floating filters) */\n  getFilterInput(colId: string): Locator;\n\n  // \n  // Wait Utilities\n  // \n\n  /** Wait for grid to be fully rendered and ready */\n  waitForReady(options?: { timeout?: number }): Promise<void>;\n\n  /** Wait for loading overlay to disappear */\n  waitForDataLoaded(options?: { timeout?: number }): Promise<void>;\n\n  /** Wait for a specific row count */\n  waitForRowCount(count: number, options?: { timeout?: number }): Promise<void>;\n\n  /** Wait for row to appear (handles virtualization) */\n  waitForRow(matcher: RowMatcher, options?: { timeout?: number }): Promise<Locator>;\n\n  // \n  // Assertions\n  // \n\n  /** Assert grid has expected row count */\n  expectRowCount(count: number, options?: RowCountOptions): Promise<void>;\n\n  /** Assert grid contains a row matching criteria */\n  expectRowContains(cellValues: Record<string, unknown>, options?: AssertionOptions): Promise<void>;\n\n  /** Assert grid does NOT contain a row matching criteria */\n  expectRowNotContains(\n    cellValues: Record<string, unknown>,\n    options?: AssertionOptions\n  ): Promise<void>;\n\n  /** Assert cell has expected value */\n  expectCellValue(\n    rowMatcher: RowMatcher,\n    colId: string,\n    expectedValue: unknown,\n    options?: AssertionOptions\n  ): Promise<void>;\n\n  /** Assert grid is sorted by column */\n  expectSortedBy(colId: string, direction: 'asc' | 'desc', options?: AssertionOptions): Promise<void>;\n\n  /** Assert grid is empty (no data rows) */\n  expectEmpty(options?: AssertionOptions): Promise<void>;\n\n  /** Assert row is selected */\n  expectRowSelected(matcher: RowMatcher, options?: AssertionOptions): Promise<void>;\n\n  /** Assert grid shows \"no rows\" overlay */\n  expectNoRowsOverlay(options?: AssertionOptions): Promise<void>;\n\n  // \n  // Actions\n  // \n\n  /** Click on a cell */\n  clickCell(rowMatcher: RowMatcher, colId: string): Promise<void>;\n\n  /** Double-click to edit a cell */\n  editCell(rowMatcher: RowMatcher, colId: string, newValue: string): Promise<void>;\n\n  /** Sort by column (click header) */\n  sortByColumn(colId: string, direction?: 'asc' | 'desc'): Promise<void>;\n\n  /** Filter column using floating filter */\n  filterColumn(colId: string, filterValue: string): Promise<void>;\n\n  /** Clear filter for column */\n  clearFilter(colId: string): Promise<void>;\n\n  /** Clear all filters */\n  clearAllFilters(): Promise<void>;\n\n  /** Select a row (click checkbox or row) */\n  selectRow(matcher: RowMatcher): Promise<void>;\n\n  /** Deselect a row */\n  deselectRow(matcher: RowMatcher): Promise<void>;\n\n  /** Select all rows */\n  selectAllRows(): Promise<void>;\n\n  /** Deselect all rows */\n  deselectAllRows(): Promise<void>;\n\n  /** Scroll to bring row into view */\n  scrollToRow(matcher: RowMatcher): Promise<void>;\n\n  /** Scroll to bring column into view */\n  scrollToColumn(colId: string): Promise<void>;\n\n  // \n  // Enterprise Features\n  // \n\n  /** Expand a group row */\n  expandGroup(matcher: RowMatcher): Promise<void>;\n\n  /** Collapse a group row */\n  collapseGroup(matcher: RowMatcher): Promise<void>;\n\n  /** Expand all groups */\n  expandAllGroups(): Promise<void>;\n\n  /** Collapse all groups */\n  collapseAllGroups(): Promise<void>;\n\n  /** Get group children count */\n  getGroupChildCount(matcher: RowMatcher): Promise<number>;\n\n  /** Expand master row to show detail */\n  expandMasterRow(matcher: RowMatcher): Promise<void>;\n\n  /** Get detail grid for master row */\n  getDetailGrid(masterRowMatcher: RowMatcher): AgGridHelper;\n\n  // \n  // Data Extraction\n  // \n\n  /** Get cell value */\n  getCellValue(rowMatcher: RowMatcher, colId: string): Promise<unknown>;\n\n  /** Get all cell values for a row */\n  getRowData(matcher: RowMatcher): Promise<AgGridRowData>;\n\n  /** Get all visible row data */\n  getAllVisibleRowData(): Promise<AgGridRowData[]>;\n\n  /** Get current grid state */\n  getGridState(): Promise<AgGridState>;\n\n  /** Get selected row IDs */\n  getSelectedRowIds(): Promise<string[]>;\n}\n\n// ============================================================================\n// Factory Function Type\n// ============================================================================\n\n/**\n * Create an AG Grid helper instance\n *\n * @param page - Playwright page object\n * @param config - Grid configuration (string selector or full config)\n * @returns AG Grid helper instance\n *\n * @example\n * ```typescript\n * // Simple usage with test ID\n * const grid = agGrid(page, 'orders-grid');\n *\n * // Full configuration\n * const grid = agGrid(page, {\n *   selector: 'orders-grid',\n *   columns: [\n *     { colId: 'orderId', type: 'text' },\n *     { colId: 'amount', type: 'number' },\n *   ],\n *   enterprise: { rowGrouping: true }\n * });\n * ```\n */\nexport type AgGridFactory = (page: Page, config: string | AgGridConfig) => AgGridHelper;\n\n// ============================================================================\n// Internal Types (used by implementation)\n// ============================================================================\n\n/**\n * Normalized configuration with all defaults applied\n * @internal\n */\nexport interface NormalizedAgGridConfig extends AgGridConfig {\n  timeouts: Required<TimeoutConfig>;\n}\n\n/**\n * Result of finding the closest matching row\n * @internal\n */\nexport interface ClosestMatchResult {\n  /** The row data of the closest match */\n  row: AgGridRowData;\n  /** Number of fields that matched */\n  matchedFields: number;\n  /** Total fields being compared */\n  totalFields: number;\n  /** Fields that didn't match with expected vs actual */\n  mismatches: Array<{\n    field: string;\n    expected: unknown;\n    actual: unknown;\n  }>;\n}\n\n// ============================================================================\n// Server-Side Row Model Types\n// ============================================================================\n\n/**\n * Server-side row model configuration\n */\nexport interface ServerSideConfig {\n  /** Block size for infinite scrolling. Default: 100 */\n  blockSize?: number;\n\n  /** Maximum blocks to keep in cache. Default: 10 */\n  maxBlocksInCache?: number;\n\n  /** Timeout for waiting for block to load (ms). Default: 30000 */\n  blockLoadTimeout?: number;\n}\n\n/**\n * Server-side loading state\n */\nexport interface ServerSideState {\n  /** True if currently loading a block */\n  isLoading: boolean;\n\n  /** Range of loaded row indices */\n  loadedRange: { start: number; end: number } | null;\n\n  /** Total row count from server (-1 if unknown) */\n  totalServerRows: number;\n\n  /** Number of blocks currently cached */\n  cachedBlocks: number;\n}\n\n/**\n * Options for server-side operations\n */\nexport interface ServerSideOptions {\n  /** Timeout for block load (ms) */\n  timeout?: number;\n\n  /** Whether to force refresh cached data */\n  forceRefresh?: boolean;\n\n  /** Block size for server-side loading (default: 100) */\n  blockSize?: number;\n\n  /** Maximum blocks to keep in cache (default: 10) */\n  maxBlocksInCache?: number;\n}\n\n// ============================================================================\n// Column Group Types\n// ============================================================================\n\n/**\n * Column group definition\n */\nexport interface ColumnGroupDef {\n  /** Group ID */\n  groupId: string;\n\n  /** Human-readable group name */\n  displayName?: string;\n\n  /** Child column IDs in this group */\n  children: string[];\n\n  /** Whether group is initially expanded */\n  openByDefault?: boolean;\n}\n\n/**\n * Column group state\n */\nexport interface ColumnGroupState {\n  /** Group ID */\n  groupId: string;\n\n  /** Whether the group is expanded */\n  isExpanded: boolean;\n\n  /** Visible child column IDs */\n  visibleChildren: string[];\n}\n\n// ============================================================================\n// Range Selection Types\n// ============================================================================\n\n/**\n * Cell position in grid\n */\nexport interface CellPosition {\n  /** Row matcher to identify the row */\n  rowMatcher: RowMatcher;\n\n  /** Column ID */\n  colId: string;\n}\n\n/**\n * Cell range for selection\n */\nexport interface CellRange {\n  /** Starting cell (top-left of range) */\n  start: CellPosition;\n\n  /** Ending cell (bottom-right of range) */\n  end: CellPosition;\n}\n\n/**\n * Range selection state\n */\nexport interface RangeSelectionState {\n  /** Currently selected ranges */\n  ranges: CellRange[];\n\n  /** Number of cells selected */\n  cellCount: number;\n\n  /** Number of rows spanned */\n  rowCount: number;\n\n  /** Number of columns spanned */\n  columnCount: number;\n}\n\n/**\n * Options for range selection\n */\nexport interface RangeSelectionOptions {\n  /** Whether to add to existing selection (Ctrl+click behavior) */\n  addToSelection?: boolean;\n\n  /** Whether to extend existing selection (Shift+click behavior) */\n  extendSelection?: boolean;\n}\n\n// ============================================================================\n// Keyboard Navigation Types\n// ============================================================================\n\n/**\n * Navigation direction\n */\nexport type NavigationDirection = 'up' | 'down' | 'left' | 'right';\n\n/**\n * Keyboard navigation options\n */\nexport interface KeyboardNavigationOptions {\n  /** Number of cells to move. Default: 1 */\n  count?: number;\n\n  /** Whether to hold Shift (for range selection) */\n  shiftKey?: boolean;\n\n  /** Whether to hold Ctrl/Cmd (for jump navigation) */\n  ctrlKey?: boolean;\n\n  /** Whether to hold Alt (for special navigation) */\n  altKey?: boolean;\n}\n\n/**\n * Keyboard action type\n */\nexport type KeyboardAction =\n  | 'enter'        // Enter edit mode or confirm\n  | 'escape'       // Exit edit mode or cancel\n  | 'tab'          // Move to next cell\n  | 'shiftTab'     // Move to previous cell\n  | 'space'        // Toggle selection\n  | 'delete'       // Clear cell content\n  | 'copy'         // Copy selected cells\n  | 'paste'        // Paste clipboard content\n  | 'selectAll'    // Select all cells (Ctrl+A)\n  | 'home'         // Jump to first cell in row\n  | 'end'          // Jump to last cell in row\n  | 'ctrlHome'     // Jump to first cell in grid\n  | 'ctrlEnd'      // Jump to last cell in grid\n  | 'pageUp'       // Scroll up one page\n  | 'pageDown';    // Scroll down one page\n\n/**\n * Keyboard navigation state\n */\nexport interface KeyboardNavigationState {\n  /** Currently focused cell position */\n  focusedCell: CellPosition | null;\n\n  /** Whether a cell is currently in edit mode */\n  isEditing: boolean;\n\n  /** Cell currently being edited (if any) */\n  editingCell: CellPosition | null;\n\n  /** Whether header row is focused */\n  isHeaderFocused: boolean;\n}\n\n// ============================================================================\n// Nested Detail Grid Types\n// ============================================================================\n\n/**\n * Detail grid path for nested navigation\n */\nexport interface DetailGridPath {\n  /** Sequence of master row matchers from root to target */\n  path: RowMatcher[];\n}\n\n/**\n * Nested detail grid state\n */\nexport interface NestedDetailState {\n  /** Depth level (0 = root grid, 1 = first detail, etc.) */\n  depth: number;\n\n  /** Path from root to this grid */\n  path: DetailGridPath;\n\n  /** Whether this detail grid has its own details */\n  hasNestedDetails: boolean;\n\n  /** Number of expanded detail rows in this grid */\n  expandedDetailCount: number;\n}\n\n/**\n * Options for nested detail operations\n */\nexport interface NestedDetailOptions {\n  /** Maximum depth to traverse. Default: 5 */\n  maxDepth?: number;\n\n  /** Timeout for each level expansion (ms). Default: 5000 */\n  timeout?: number;\n\n  /** Whether to auto-expand intermediate levels */\n  autoExpand?: boolean;\n}\n\n// ============================================================================\n// Extended Helper Interface\n// ============================================================================\n\n/**\n * Extended AG Grid helper with advanced features\n */\nexport interface AgGridHelperExtended extends AgGridHelper {\n  // \n  // Server-Side Row Model\n  // \n\n  /** Wait for server-side block to load */\n  waitForBlockLoad(rowIndex: number, options?: ServerSideOptions): Promise<void>;\n\n  /** Get server-side loading state */\n  getServerSideState(): Promise<ServerSideState>;\n\n  /** Refresh server-side data */\n  refreshServerSideData(options?: ServerSideOptions): Promise<void>;\n\n  /** Scroll to row with server-side loading */\n  scrollToServerSideRow(rowIndex: number, options?: ServerSideOptions): Promise<void>;\n\n  /** Check if row index is loaded */\n  isRowLoaded(rowIndex: number): Promise<boolean>;\n\n  // \n  // Column Groups\n  // \n\n  /** Get column group header locator */\n  getColumnGroupHeader(groupId: string): Locator;\n\n  /** Expand a column group */\n  expandColumnGroup(groupId: string): Promise<void>;\n\n  /** Collapse a column group */\n  collapseColumnGroup(groupId: string): Promise<void>;\n\n  /** Toggle column group expand/collapse */\n  toggleColumnGroup(groupId: string): Promise<void>;\n\n  /** Check if column group is expanded */\n  isColumnGroupExpanded(groupId: string): Promise<boolean>;\n\n  /** Get all column group states */\n  getColumnGroupStates(): Promise<ColumnGroupState[]>;\n\n  /** Get visible columns in a group */\n  getGroupVisibleColumns(groupId: string): Promise<string[]>;\n\n  // \n  // Range Selection\n  // \n\n  /** Select a range of cells */\n  selectCellRange(range: CellRange, options?: RangeSelectionOptions): Promise<void>;\n\n  /** Select cells by dragging */\n  selectCellsByDrag(start: CellPosition, end: CellPosition): Promise<void>;\n\n  /** Add cell to selection */\n  addCellToSelection(position: CellPosition): Promise<void>;\n\n  /** Clear all range selections */\n  clearRangeSelection(): Promise<void>;\n\n  /** Get current range selection state */\n  getRangeSelectionState(): Promise<RangeSelectionState>;\n\n  /** Get values from selected range */\n  getSelectedRangeValues(): Promise<unknown[][]>;\n\n  /** Assert cells in range are selected */\n  expectRangeSelected(range: CellRange): Promise<void>;\n\n  /** Copy selected cells to clipboard */\n  copySelectedCells(): Promise<void>;\n\n  /** Paste from clipboard to selected cells */\n  pasteToSelectedCells(): Promise<void>;\n\n  // \n  // Keyboard Navigation\n  // \n\n  /** Navigate using arrow keys */\n  navigateCell(direction: NavigationDirection, options?: KeyboardNavigationOptions): Promise<void>;\n\n  /** Perform keyboard action */\n  performKeyboardAction(action: KeyboardAction): Promise<void>;\n\n  /** Navigate to first cell in grid */\n  navigateToFirstCell(): Promise<void>;\n\n  /** Navigate to last cell in grid */\n  navigateToLastCell(): Promise<void>;\n\n  /** Navigate to first cell in current row */\n  navigateToRowStart(): Promise<void>;\n\n  /** Navigate to last cell in current row */\n  navigateToRowEnd(): Promise<void>;\n\n  /** Navigate to specific cell and focus it */\n  focusCell(position: CellPosition): Promise<void>;\n\n  /** Get currently focused cell position */\n  getFocusedCell(): Promise<CellPosition | null>;\n\n  /** Assert cell is focused */\n  expectCellFocused(position: CellPosition): Promise<void>;\n\n  /** Enter edit mode on focused cell */\n  enterEditMode(): Promise<void>;\n\n  /** Exit edit mode */\n  exitEditMode(confirm?: boolean): Promise<void>;\n\n  /** Tab to next editable cell */\n  tabToNextCell(): Promise<void>;\n\n  /** Tab to previous editable cell */\n  tabToPreviousCell(): Promise<void>;\n\n  // \n  // Nested Detail Grids\n  // \n\n  /** Get detail grid by path */\n  getDetailGridByPath(path: DetailGridPath): AgGridHelperExtended;\n\n  /** Get nested detail state */\n  getNestedDetailState(): Promise<NestedDetailState>;\n\n  /** Expand nested detail row at path */\n  expandNestedDetail(path: DetailGridPath, options?: NestedDetailOptions): Promise<void>;\n\n  /** Collapse nested detail row at path */\n  collapseNestedDetail(path: DetailGridPath): Promise<void>;\n\n  /** Get all expanded detail paths */\n  getExpandedDetailPaths(): Promise<DetailGridPath[]>;\n\n  /** Find detail grid containing specific data */\n  findDetailGridWithData(\n    cellValues: Record<string, unknown>,\n    options?: NestedDetailOptions\n  ): Promise<AgGridHelperExtended | null>;\n\n  /** Get depth of current grid (0 = root) */\n  getGridDepth(): number;\n\n  /** Get parent grid (null if root) */\n  getParentGrid(): AgGridHelperExtended | null;\n\n  /** Get root grid */\n  getRootGrid(): AgGridHelperExtended;\n}\n","/**\n * AG Grid Configuration Utilities\n *\n * Handles normalization and merging of grid configuration options.\n *\n * @module grid/ag-grid/config\n */\n\nimport type {\n  AgGridConfig,\n  NormalizedAgGridConfig,\n  TimeoutConfig,\n  EnterpriseConfig,\n} from '../types.js';\nimport { DEFAULT_TIMEOUTS } from '../types.js';\n\n/**\n * Normalize a grid configuration, converting string selector to full config\n * and applying default values.\n *\n * @param config - String selector or full configuration object\n * @returns Normalized configuration with all defaults applied\n *\n * @example\n * ```typescript\n * // String selector\n * const config = normalizeConfig('orders-grid');\n * // Result: { selector: 'orders-grid', timeouts: { gridReady: 30000, ... } }\n *\n * // Full config with overrides\n * const config = normalizeConfig({\n *   selector: 'orders-grid',\n *   timeouts: { gridReady: 60000 }\n * });\n * // Result: { selector: 'orders-grid', timeouts: { gridReady: 60000, rowLoad: 10000, ... } }\n * ```\n */\nexport function normalizeConfig(config: string | AgGridConfig): NormalizedAgGridConfig {\n  // Handle string shorthand\n  if (typeof config === 'string') {\n    return {\n      selector: config,\n      timeouts: { ...DEFAULT_TIMEOUTS },\n    };\n  }\n\n  // Merge timeouts with defaults\n  return {\n    ...config,\n    timeouts: mergeTimeouts(config.timeouts),\n  };\n}\n\n/**\n * Merge custom timeouts with default values\n *\n * @param custom - Custom timeout values (partial)\n * @returns Complete timeout configuration\n */\nexport function mergeTimeouts(custom?: TimeoutConfig): Required<TimeoutConfig> {\n  return {\n    ...DEFAULT_TIMEOUTS,\n    ...custom,\n  };\n}\n\n/**\n * Validate that a configuration is valid\n *\n * @param config - Configuration to validate\n * @throws Error if configuration is invalid\n */\nexport function validateConfig(config: AgGridConfig): void {\n  if (!config.selector || typeof config.selector !== 'string') {\n    throw new Error('AG Grid config requires a valid selector string');\n  }\n\n  if (config.selector.trim() === '') {\n    throw new Error('AG Grid config selector cannot be empty');\n  }\n\n  // Validate column definitions if provided\n  if (config.columns) {\n    for (const col of config.columns) {\n      if (!col.colId || typeof col.colId !== 'string') {\n        throw new Error(`AG Grid column definition requires a valid colId`);\n      }\n    }\n  }\n\n  // Validate timeouts if provided\n  if (config.timeouts) {\n    const timeoutKeys: (keyof TimeoutConfig)[] = ['gridReady', 'rowLoad', 'cellEdit', 'scroll'];\n    for (const key of timeoutKeys) {\n      const value = config.timeouts[key];\n      if (value !== undefined && (typeof value !== 'number' || value < 0)) {\n        throw new Error(`AG Grid timeout \"${key}\" must be a positive number`);\n      }\n    }\n  }\n}\n\n/**\n * Get the display name for a column\n *\n * @param config - Grid configuration\n * @param colId - Column ID to look up\n * @returns Display name or column ID if not found\n */\nexport function getColumnDisplayName(config: NormalizedAgGridConfig, colId: string): string {\n  const column = config.columns?.find((c) => c.colId === colId);\n  return column?.displayName ?? colId;\n}\n\n/**\n * Check if enterprise features are enabled\n *\n * @param config - Grid configuration\n * @returns Object indicating which enterprise features are enabled\n */\nexport function getEnterpriseFeatures(config: NormalizedAgGridConfig): Required<EnterpriseConfig> {\n  return {\n    rowGrouping: config.enterprise?.rowGrouping ?? false,\n    treeData: config.enterprise?.treeData ?? false,\n    masterDetail: config.enterprise?.masterDetail ?? false,\n    serverSide: config.enterprise?.serverSide ?? false,\n  };\n}\n\n/**\n * Check if any enterprise features are enabled\n *\n * @param config - Grid configuration\n * @returns True if any enterprise feature is enabled\n */\nexport function hasEnterpriseFeatures(config: NormalizedAgGridConfig): boolean {\n  const features = getEnterpriseFeatures(config);\n  return features.rowGrouping || features.treeData || features.masterDetail || features.serverSide;\n}\n\n/**\n * Get the pinned position for a column\n *\n * @param config - Grid configuration\n * @param colId - Column ID to look up\n * @returns Pinned position ('left', 'right') or null if not pinned\n */\nexport function getColumnPinnedPosition(\n  config: NormalizedAgGridConfig,\n  colId: string\n): 'left' | 'right' | null {\n  const column = config.columns?.find((c) => c.colId === colId);\n  return column?.pinned ?? null;\n}\n\n/**\n * Create a config with updated values\n *\n * @param config - Original configuration\n * @param updates - Partial updates to apply\n * @returns New configuration with updates applied\n */\nexport function updateConfig(\n  config: NormalizedAgGridConfig,\n  updates: Partial<AgGridConfig>\n): NormalizedAgGridConfig {\n  return {\n    ...config,\n    ...updates,\n    timeouts: updates.timeouts ? mergeTimeouts(updates.timeouts) : config.timeouts,\n  };\n}\n","/**\n * AG Grid DOM Selector Utilities\n *\n * Provides stable DOM selectors for AG Grid elements based on ARIA attributes\n * and AG Grid's internal class/attribute patterns.\n *\n * @module grid/ag-grid/selectors\n */\n\nimport type { Locator, Page } from '@playwright/test';\nimport type { RowMatcher } from '../types.js';\n\n/**\n * AG Grid CSS class and attribute selectors\n * These are stable across AG Grid versions 30-33\n */\nexport const AG_GRID_SELECTORS = {\n  // Grid structure\n  ROOT_WRAPPER: '.ag-root-wrapper',\n  HEADER: '.ag-header',\n  HEADER_ROW: '.ag-header-row',\n  HEADER_CELL: '.ag-header-cell',\n  BODY_VIEWPORT: '.ag-body-viewport',\n  CENTER_COLS_CONTAINER: '.ag-center-cols-container',\n  PINNED_LEFT_CONTAINER: '.ag-pinned-left-cols-container',\n  PINNED_RIGHT_CONTAINER: '.ag-pinned-right-cols-container',\n\n  // Row and cell\n  ROW: '.ag-row',\n  CELL: '.ag-cell',\n  ROW_GROUP: '.ag-row-group',\n  ROW_SELECTED: '.ag-row-selected',\n  CELL_FOCUS: '.ag-cell-focus',\n\n  // Overlays\n  LOADING_OVERLAY: '.ag-overlay-loading-center',\n  NO_ROWS_OVERLAY: '.ag-overlay-no-rows-center',\n\n  // Enterprise features\n  GROUP_EXPANDED: '.ag-group-expanded',\n  GROUP_CONTRACTED: '.ag-group-contracted',\n  DETAILS_ROW: '.ag-details-row',\n  FULL_WIDTH_ROW: '.ag-full-width-row',\n\n  // Floating filter\n  FLOATING_FILTER: '.ag-floating-filter',\n  FLOATING_FILTER_INPUT: '.ag-floating-filter-input',\n\n  // Selection checkbox\n  SELECTION_CHECKBOX: '.ag-selection-checkbox',\n  HEADER_SELECT_ALL: '.ag-header-select-all',\n\n  // Attributes\n  ATTR_COL_ID: 'col-id',\n  ATTR_ROW_INDEX: 'row-index',\n  ATTR_ROW_ID: 'row-id',\n  ATTR_ARIA_ROW_INDEX: 'aria-rowindex',\n  ATTR_ARIA_COL_INDEX: 'aria-colindex',\n  ATTR_ARIA_SORT: 'aria-sort',\n  ATTR_ARIA_SELECTED: 'aria-selected',\n} as const;\n\n/**\n * Get the root grid container element\n *\n * @param page - Playwright page object\n * @param selector - Grid selector (test-id, CSS selector, or custom)\n * @returns Locator for the grid root wrapper\n *\n * @example\n * ```typescript\n * // By test ID\n * const grid = getGridRoot(page, 'orders-grid');\n *\n * // By CSS selector\n * const grid = getGridRoot(page, '#my-grid');\n *\n * // By custom CSS\n * const grid = getGridRoot(page, '.custom-grid-container');\n * ```\n */\nexport function getGridRoot(page: Page, selector: string): Locator {\n  // Try data-testid first (most common pattern)\n  const byTestId = page.locator(`[data-testid=\"${selector}\"]`);\n\n  // If selector starts with special characters, treat as CSS selector\n  if (selector.startsWith('#') || selector.startsWith('.') || selector.startsWith('[')) {\n    return page.locator(selector).locator(AG_GRID_SELECTORS.ROOT_WRAPPER).or(page.locator(selector));\n  }\n\n  // Default: use data-testid, but fall back to finding root wrapper with that testid\n  return byTestId.locator(AG_GRID_SELECTORS.ROOT_WRAPPER).or(byTestId);\n}\n\n/**\n * Build a CSS selector for a cell by column ID\n *\n * @param colId - Column ID (col-id attribute value)\n * @returns CSS selector string\n */\nexport function buildCellSelector(colId: string): string {\n  return `${AG_GRID_SELECTORS.CELL}[${AG_GRID_SELECTORS.ATTR_COL_ID}=\"${colId}\"]`;\n}\n\n/**\n * Build a CSS selector for a header cell by column ID\n *\n * @param colId - Column ID (col-id attribute value)\n * @returns CSS selector string\n */\nexport function buildHeaderCellSelector(colId: string): string {\n  return `${AG_GRID_SELECTORS.HEADER_CELL}[${AG_GRID_SELECTORS.ATTR_COL_ID}=\"${colId}\"]`;\n}\n\n/**\n * Build a CSS selector for a row based on various matching criteria\n *\n * @param options - Row matching options\n * @returns CSS selector string\n */\nexport function buildRowSelector(options: {\n  rowIndex?: number;\n  rowId?: string;\n  ariaRowIndex?: number;\n}): string {\n  const { rowIndex, rowId, ariaRowIndex } = options;\n\n  if (ariaRowIndex !== undefined) {\n    return `${AG_GRID_SELECTORS.ROW}[${AG_GRID_SELECTORS.ATTR_ARIA_ROW_INDEX}=\"${ariaRowIndex}\"]`;\n  }\n\n  if (rowId !== undefined) {\n    return `${AG_GRID_SELECTORS.ROW}[${AG_GRID_SELECTORS.ATTR_ROW_ID}=\"${rowId}\"]`;\n  }\n\n  if (rowIndex !== undefined) {\n    return `${AG_GRID_SELECTORS.ROW}[${AG_GRID_SELECTORS.ATTR_ROW_INDEX}=\"${rowIndex}\"]`;\n  }\n\n  // Default: all rows\n  return AG_GRID_SELECTORS.ROW;\n}\n\n/**\n * Build a CSS selector for a floating filter input by column ID\n *\n * @param colId - Column ID (col-id attribute value)\n * @returns CSS selector string\n */\nexport function buildFilterInputSelector(colId: string): string {\n  return `${AG_GRID_SELECTORS.FLOATING_FILTER}[${AG_GRID_SELECTORS.ATTR_COL_ID}=\"${colId}\"] input`;\n}\n\n/**\n * Get all container locators for pinned and center columns\n *\n * @param gridLocator - The grid root locator\n * @returns Object with locators for each container\n */\nexport function getColumnContainers(gridLocator: Locator): {\n  left: Locator;\n  center: Locator;\n  right: Locator;\n} {\n  return {\n    left: gridLocator.locator(AG_GRID_SELECTORS.PINNED_LEFT_CONTAINER),\n    center: gridLocator.locator(AG_GRID_SELECTORS.CENTER_COLS_CONTAINER),\n    right: gridLocator.locator(AG_GRID_SELECTORS.PINNED_RIGHT_CONTAINER),\n  };\n}\n\n/**\n * Find a cell across all column containers (handles pinned columns)\n *\n * @param gridLocator - The grid root locator\n * @param rowSelector - CSS selector for the row\n * @param colId - Column ID\n * @returns Locator for the cell\n */\nexport function findCellAcrossContainers(\n  gridLocator: Locator,\n  rowSelector: string,\n  colId: string\n): Locator {\n  const cellSelector = buildCellSelector(colId);\n\n  // Use first() to return the first matching cell across all containers\n  return gridLocator\n    .locator(`${rowSelector} ${cellSelector}`)\n    .first();\n}\n\n/**\n * Check if a row is a group row (enterprise feature)\n *\n * @param rowLocator - The row locator\n * @returns Promise resolving to true if it's a group row\n */\nexport async function isGroupRow(rowLocator: Locator): Promise<boolean> {\n  const classAttr = await rowLocator.getAttribute('class');\n  return classAttr?.includes('ag-row-group') ?? false;\n}\n\n/**\n * Check if a row is expanded (group or tree node)\n *\n * @param rowLocator - The row locator\n * @returns Promise resolving to true if expanded\n */\nexport async function isRowExpanded(rowLocator: Locator): Promise<boolean> {\n  const ariaExpanded = await rowLocator.getAttribute('aria-expanded');\n  return ariaExpanded === 'true';\n}\n\n/**\n * Check if a row is selected\n *\n * @param rowLocator - The row locator\n * @returns Promise resolving to true if selected\n */\nexport async function isRowSelected(rowLocator: Locator): Promise<boolean> {\n  const classAttr = await rowLocator.getAttribute('class');\n  const ariaSelected = await rowLocator.getAttribute('aria-selected');\n\n  return classAttr?.includes('ag-row-selected') || ariaSelected === 'true';\n}\n\n/**\n * Get the aria-rowindex value from a row element\n *\n * @param rowLocator - The row locator\n * @returns Promise resolving to the aria-rowindex value (1-based)\n */\nexport async function getAriaRowIndex(rowLocator: Locator): Promise<number> {\n  const ariaRowIndex = await rowLocator.getAttribute(AG_GRID_SELECTORS.ATTR_ARIA_ROW_INDEX);\n  return ariaRowIndex ? parseInt(ariaRowIndex, 10) : -1;\n}\n\n/**\n * Get the row-index value from a row element (viewport index)\n *\n * @param rowLocator - The row locator\n * @returns Promise resolving to the row-index value (0-based)\n */\nexport async function getRowIndex(rowLocator: Locator): Promise<number> {\n  const rowIndex = await rowLocator.getAttribute(AG_GRID_SELECTORS.ATTR_ROW_INDEX);\n  return rowIndex ? parseInt(rowIndex, 10) : -1;\n}\n\n/**\n * Get the row-id value from a row element\n *\n * @param rowLocator - The row locator\n * @returns Promise resolving to the row-id value\n */\nexport async function getRowId(rowLocator: Locator): Promise<string | null> {\n  return rowLocator.getAttribute(AG_GRID_SELECTORS.ATTR_ROW_ID);\n}\n\n/**\n * Get the sort direction of a header cell\n *\n * @param headerCellLocator - The header cell locator\n * @returns Promise resolving to sort direction or undefined if not sorted\n */\nexport async function getSortDirection(\n  headerCellLocator: Locator\n): Promise<'asc' | 'desc' | undefined> {\n  const ariaSort = await headerCellLocator.getAttribute(AG_GRID_SELECTORS.ATTR_ARIA_SORT);\n\n  if (ariaSort === 'ascending') return 'asc';\n  if (ariaSort === 'descending') return 'desc';\n  return undefined;\n}\n\n/**\n * Build a row selector from a RowMatcher using priority order.\n * Priority: ariaRowIndex > rowId > rowIndex > (fallback to all rows)\n *\n * @param matcher - Row matching criteria\n * @returns CSS selector string or null if only predicate/cellValues matching\n */\nexport function buildRowSelectorFromMatcher(matcher: RowMatcher): string | null {\n  if (matcher.ariaRowIndex !== undefined) {\n    return `${AG_GRID_SELECTORS.ROW}[${AG_GRID_SELECTORS.ATTR_ARIA_ROW_INDEX}=\"${matcher.ariaRowIndex}\"]`;\n  }\n\n  if (matcher.rowId !== undefined) {\n    return `${AG_GRID_SELECTORS.ROW}[${AG_GRID_SELECTORS.ATTR_ROW_ID}=\"${matcher.rowId}\"]`;\n  }\n\n  if (matcher.rowIndex !== undefined) {\n    return `${AG_GRID_SELECTORS.ROW}[${AG_GRID_SELECTORS.ATTR_ROW_INDEX}=\"${matcher.rowIndex}\"]`;\n  }\n\n  // For cellValues or predicate, we need to iterate - return null\n  if (matcher.cellValues || matcher.predicate) {\n    return null;\n  }\n\n  // No criteria specified - fallback to all rows\n  return AG_GRID_SELECTORS.ROW;\n}\n\n/**\n * Check if a matcher can be resolved directly via CSS selector (fast path)\n *\n * @param matcher - Row matching criteria\n * @returns True if matcher can be resolved with CSS selector\n */\nexport function isDirectMatcher(matcher: RowMatcher): boolean {\n  return (\n    matcher.ariaRowIndex !== undefined ||\n    matcher.rowId !== undefined ||\n    matcher.rowIndex !== undefined\n  );\n}\n\n/**\n * Format a RowMatcher for error messages with meaningful context\n *\n * @param matcher - Row matching criteria\n * @returns Human-readable string describing the matcher\n */\nexport function formatRowMatcher(matcher: RowMatcher): string {\n  const parts: string[] = [];\n\n  if (matcher.ariaRowIndex !== undefined) {\n    parts.push(`ariaRowIndex=${matcher.ariaRowIndex}`);\n  }\n  if (matcher.rowId !== undefined) {\n    parts.push(`rowId=\"${matcher.rowId}\"`);\n  }\n  if (matcher.rowIndex !== undefined) {\n    parts.push(`rowIndex=${matcher.rowIndex}`);\n  }\n  if (matcher.cellValues) {\n    const cellParts = Object.entries(matcher.cellValues)\n      .map(([key, val]) => `${key}=\"${val}\"`)\n      .join(', ');\n    parts.push(`cellValues={${cellParts}}`);\n  }\n  if (matcher.predicate) {\n    parts.push('predicate=[function]');\n  }\n\n  if (parts.length === 0) {\n    return '(empty matcher)';\n  }\n\n  return parts.join(', ');\n}\n","/**\n * AG Grid Locators\n *\n * Provides locator factories for AG Grid elements.\n *\n * @module grid/ag-grid/locators\n */\n\nimport type { Locator, Page } from '@playwright/test';\nimport type { NormalizedAgGridConfig, RowMatcher } from '../types.js';\nimport {\n  AG_GRID_SELECTORS,\n  buildCellSelector,\n  buildHeaderCellSelector,\n  buildFilterInputSelector,\n  buildRowSelectorFromMatcher,\n  getGridRoot,\n} from './selectors.js';\nimport { getColumnPinnedPosition } from './config.js';\n\n/**\n * Locator context for a grid instance\n */\nexport interface GridLocatorContext {\n  page: Page;\n  config: NormalizedAgGridConfig;\n  gridLocator: Locator;\n}\n\n/**\n * Create the grid locator context\n *\n * @param page - Playwright page\n * @param config - Normalized grid configuration\n * @returns Grid locator context\n */\nexport function createLocatorContext(\n  page: Page,\n  config: NormalizedAgGridConfig\n): GridLocatorContext {\n  return {\n    page,\n    config,\n    gridLocator: getGridRoot(page, config.selector),\n  };\n}\n\n/**\n * Get the root grid container locator\n *\n * @param ctx - Grid locator context\n * @returns Grid root locator\n */\nexport function getGrid(ctx: GridLocatorContext): Locator {\n  return ctx.gridLocator;\n}\n\n/**\n * Get a specific row by matcher criteria\n *\n * @param ctx - Grid locator context\n * @param matcher - Row matching criteria\n * @returns Row locator\n */\nexport function getRow(ctx: GridLocatorContext, matcher: RowMatcher): Locator {\n  const { gridLocator } = ctx;\n\n  // Use shared row matcher logic with consistent priority order\n  const selector = buildRowSelectorFromMatcher(matcher);\n\n  if (selector) {\n    return gridLocator.locator(selector);\n  }\n\n  // For cellValues/predicate, return all rows (filtering will be done async)\n  return gridLocator.locator(AG_GRID_SELECTORS.ROW);\n}\n\n/**\n * Get all visible rows in the grid\n *\n * @param ctx - Grid locator context\n * @returns Locator for all visible rows\n */\nexport function getVisibleRows(ctx: GridLocatorContext): Locator {\n  return ctx.gridLocator.locator(AG_GRID_SELECTORS.ROW);\n}\n\n/**\n * Get a specific cell by row matcher and column ID\n *\n * @param ctx - Grid locator context\n * @param rowMatcher - Row matching criteria\n * @param colId - Column ID\n * @returns Cell locator\n */\nexport function getCell(\n  ctx: GridLocatorContext,\n  rowMatcher: RowMatcher,\n  colId: string\n): Locator {\n  const { gridLocator, config } = ctx;\n\n  // Check if column is pinned (if column config is provided)\n  const pinnedPosition = getColumnPinnedPosition(config, colId);\n\n  if (pinnedPosition) {\n    // For pinned columns, search in the appropriate container\n    const containerSelector = pinnedPosition === 'left'\n      ? AG_GRID_SELECTORS.PINNED_LEFT_CONTAINER\n      : AG_GRID_SELECTORS.PINNED_RIGHT_CONTAINER;\n\n    const rowSelector = buildRowSelectorFromMatcher(rowMatcher) ?? AG_GRID_SELECTORS.ROW;\n    return gridLocator\n      .locator(containerSelector)\n      .locator(rowSelector)\n      .locator(buildCellSelector(colId));\n  }\n\n  // Standard path: use row locator then find cell\n  const rowLocator = getRow(ctx, rowMatcher);\n  return rowLocator.locator(buildCellSelector(colId));\n}\n\n/**\n * Get a header cell by column ID\n *\n * @param ctx - Grid locator context\n * @param colId - Column ID\n * @returns Header cell locator\n */\nexport function getHeaderCell(ctx: GridLocatorContext, colId: string): Locator {\n  return ctx.gridLocator.locator(buildHeaderCellSelector(colId));\n}\n\n/**\n * Get the floating filter input for a column\n *\n * @param ctx - Grid locator context\n * @param colId - Column ID\n * @returns Filter input locator\n */\nexport function getFilterInput(ctx: GridLocatorContext, colId: string): Locator {\n  return ctx.gridLocator.locator(buildFilterInputSelector(colId));\n}\n\n/**\n * Get the loading overlay locator\n *\n * @param ctx - Grid locator context\n * @returns Loading overlay locator\n */\nexport function getLoadingOverlay(ctx: GridLocatorContext): Locator {\n  return ctx.gridLocator.locator(AG_GRID_SELECTORS.LOADING_OVERLAY);\n}\n\n/**\n * Get the \"no rows\" overlay locator\n *\n * @param ctx - Grid locator context\n * @returns No rows overlay locator\n */\nexport function getNoRowsOverlay(ctx: GridLocatorContext): Locator {\n  return ctx.gridLocator.locator(AG_GRID_SELECTORS.NO_ROWS_OVERLAY);\n}\n\n/**\n * Get the header select-all checkbox\n *\n * @param ctx - Grid locator context\n * @returns Select-all checkbox locator\n */\nexport function getSelectAllCheckbox(ctx: GridLocatorContext): Locator {\n  return ctx.gridLocator.locator(AG_GRID_SELECTORS.HEADER_SELECT_ALL);\n}\n\n/**\n * Get the selection checkbox for a row\n *\n * @param ctx - Grid locator context\n * @param rowMatcher - Row matching criteria\n * @returns Row selection checkbox locator\n */\nexport function getRowSelectionCheckbox(\n  ctx: GridLocatorContext,\n  rowMatcher: RowMatcher\n): Locator {\n  const rowLocator = getRow(ctx, rowMatcher);\n  return rowLocator.locator(AG_GRID_SELECTORS.SELECTION_CHECKBOX);\n}\n\n/**\n * Get the group expand/collapse icon for a row\n *\n * @param ctx - Grid locator context\n * @param rowMatcher - Row matching criteria\n * @returns Group icon locator\n */\nexport function getGroupIcon(ctx: GridLocatorContext, rowMatcher: RowMatcher): Locator {\n  const rowLocator = getRow(ctx, rowMatcher);\n  return rowLocator.locator(\n    `${AG_GRID_SELECTORS.GROUP_EXPANDED}, ${AG_GRID_SELECTORS.GROUP_CONTRACTED}`\n  );\n}\n\n/**\n * Get the body viewport (scrollable container)\n *\n * @param ctx - Grid locator context\n * @returns Body viewport locator\n */\nexport function getBodyViewport(ctx: GridLocatorContext): Locator {\n  return ctx.gridLocator.locator(AG_GRID_SELECTORS.BODY_VIEWPORT);\n}\n\n/**\n * Get the detail row for a master row (enterprise)\n *\n * @param ctx - Grid locator context\n * @param masterRowMatcher - Master row matching criteria\n * @returns Detail row locator\n */\nexport function getDetailRow(\n  ctx: GridLocatorContext,\n  masterRowMatcher: RowMatcher\n): Locator {\n  const masterRow = getRow(ctx, masterRowMatcher);\n\n  // Detail row is typically a sibling or following row with .ag-details-row class\n  // In AG Grid, detail rows follow their master row\n  if (masterRowMatcher.ariaRowIndex !== undefined) {\n    // Detail row has aria-rowindex = master + 1 for detail\n    return ctx.gridLocator.locator(\n      `${AG_GRID_SELECTORS.DETAILS_ROW}, ${AG_GRID_SELECTORS.FULL_WIDTH_ROW}`\n    ).filter({\n      has: masterRow.page().locator(`[aria-rowindex=\"${masterRowMatcher.ariaRowIndex + 1}\"]`),\n    });\n  }\n\n  // Fallback: find detail row near the master row\n  return ctx.gridLocator.locator(AG_GRID_SELECTORS.DETAILS_ROW);\n}\n","/**\n * AG Grid Wait Utilities\n *\n * Provides wait functions for grid ready states and data loading.\n *\n * @module grid/ag-grid/wait\n */\n\nimport type { Locator } from '@playwright/test';\nimport { expect } from '@playwright/test';\nimport type { NormalizedAgGridConfig, RowMatcher } from '../types.js';\nimport { AG_GRID_SELECTORS } from './selectors.js';\n\n/**\n * Wait for the grid to be fully rendered and ready for interaction\n *\n * @param gridLocator - The grid root locator\n * @param config - Normalized grid configuration\n * @param options - Wait options\n */\nexport async function waitForReady(\n  gridLocator: Locator,\n  config: NormalizedAgGridConfig,\n  options?: { timeout?: number }\n): Promise<void> {\n  const timeout = options?.timeout ?? config.timeouts.gridReady;\n\n  // Wait for root wrapper to be visible\n  await expect(gridLocator.locator(AG_GRID_SELECTORS.ROOT_WRAPPER).or(gridLocator))\n    .toBeVisible({ timeout });\n\n  // Wait for header to be visible (indicates grid structure is rendered)\n  await expect(gridLocator.locator(AG_GRID_SELECTORS.HEADER))\n    .toBeVisible({ timeout });\n\n  // Wait for loading overlay to disappear (if present)\n  await waitForDataLoaded(gridLocator, config, { timeout });\n}\n\n/**\n * Wait for the loading overlay to disappear\n *\n * @param gridLocator - The grid root locator\n * @param config - Normalized grid configuration\n * @param options - Wait options\n */\nexport async function waitForDataLoaded(\n  gridLocator: Locator,\n  config: NormalizedAgGridConfig,\n  options?: { timeout?: number }\n): Promise<void> {\n  const timeout = options?.timeout ?? config.timeouts.gridReady;\n  const loadingOverlay = gridLocator.locator(AG_GRID_SELECTORS.LOADING_OVERLAY);\n\n  // Check if loading overlay exists\n  const overlayCount = await loadingOverlay.count();\n  if (overlayCount > 0) {\n    // Check if it has the .visible class (our test fixture pattern)\n    const visibleOverlay = loadingOverlay.locator('.visible');\n    const visibleCount = await visibleOverlay.count();\n\n    if (visibleCount > 0) {\n      // Wait for .visible class to be removed\n      await expect(visibleOverlay).toHaveCount(0, { timeout });\n    }\n    // If no .visible class, assume it's hidden (display: none is the default in our fixture)\n  }\n}\n\n/**\n * Wait for a specific number of rows to be visible\n *\n * @param gridLocator - The grid root locator\n * @param count - Expected row count\n * @param config - Normalized grid configuration\n * @param options - Wait options\n */\nexport async function waitForRowCount(\n  gridLocator: Locator,\n  count: number,\n  config: NormalizedAgGridConfig,\n  options?: { timeout?: number }\n): Promise<void> {\n  const timeout = options?.timeout ?? config.timeouts.rowLoad;\n  const rows = gridLocator.locator(AG_GRID_SELECTORS.ROW);\n\n  await expect(rows).toHaveCount(count, { timeout });\n}\n\n/**\n * Wait for at least one row to be visible\n *\n * @param gridLocator - The grid root locator\n * @param config - Normalized grid configuration\n * @param options - Wait options\n */\nexport async function waitForAnyRows(\n  gridLocator: Locator,\n  config: NormalizedAgGridConfig,\n  options?: { timeout?: number }\n): Promise<void> {\n  const timeout = options?.timeout ?? config.timeouts.rowLoad;\n  const rows = gridLocator.locator(AG_GRID_SELECTORS.ROW);\n\n  // Wait for at least one row\n  await expect(rows.first()).toBeVisible({ timeout });\n}\n\n/**\n * Wait for a specific row to appear in the DOM\n *\n * @param gridLocator - The grid root locator\n * @param matcher - Row matching criteria\n * @param config - Normalized grid configuration\n * @param options - Wait options\n * @returns Locator for the found row\n */\nexport async function waitForRow(\n  gridLocator: Locator,\n  matcher: RowMatcher,\n  config: NormalizedAgGridConfig,\n  options?: { timeout?: number }\n): Promise<Locator> {\n  const timeout = options?.timeout ?? config.timeouts.rowLoad;\n\n  // Build row selector based on matcher\n  let rowLocator: Locator;\n\n  if (matcher.ariaRowIndex !== undefined) {\n    rowLocator = gridLocator.locator(\n      `${AG_GRID_SELECTORS.ROW}[${AG_GRID_SELECTORS.ATTR_ARIA_ROW_INDEX}=\"${matcher.ariaRowIndex}\"]`\n    );\n  } else if (matcher.rowId !== undefined) {\n    rowLocator = gridLocator.locator(\n      `${AG_GRID_SELECTORS.ROW}[${AG_GRID_SELECTORS.ATTR_ROW_ID}=\"${matcher.rowId}\"]`\n    );\n  } else if (matcher.rowIndex !== undefined) {\n    rowLocator = gridLocator.locator(\n      `${AG_GRID_SELECTORS.ROW}[${AG_GRID_SELECTORS.ATTR_ROW_INDEX}=\"${matcher.rowIndex}\"]`\n    );\n  } else {\n    // For cellValues matcher, we need more complex logic (handled elsewhere)\n    // Default to first row\n    rowLocator = gridLocator.locator(AG_GRID_SELECTORS.ROW).first();\n  }\n\n  await expect(rowLocator).toBeVisible({ timeout });\n  return rowLocator;\n}\n\n/**\n * Wait for the grid to show the \"no rows\" overlay\n *\n * @param gridLocator - The grid root locator\n * @param config - Normalized grid configuration\n * @param options - Wait options\n */\nexport async function waitForNoRowsOverlay(\n  gridLocator: Locator,\n  config: NormalizedAgGridConfig,\n  options?: { timeout?: number }\n): Promise<void> {\n  const timeout = options?.timeout ?? config.timeouts.gridReady;\n  const noRowsOverlay = gridLocator.locator(AG_GRID_SELECTORS.NO_ROWS_OVERLAY);\n\n  // Wait for no rows overlay to be visible (either by .visible class or actual visibility)\n  await expect(\n    noRowsOverlay.filter({ has: gridLocator.page().locator('.visible') })\n      .or(noRowsOverlay)\n  ).toBeVisible({ timeout });\n}\n\n/**\n * Wait for a cell to be in edit mode\n *\n * @param cellLocator - The cell locator\n * @param config - Normalized grid configuration\n * @param options - Wait options\n */\nexport async function waitForCellEditing(\n  cellLocator: Locator,\n  config: NormalizedAgGridConfig,\n  options?: { timeout?: number }\n): Promise<void> {\n  const timeout = options?.timeout ?? config.timeouts.cellEdit;\n\n  // AG Grid adds specific classes when a cell is being edited\n  await expect(\n    cellLocator.locator('.ag-cell-edit-wrapper').or(cellLocator.locator('input, textarea'))\n  ).toBeVisible({ timeout });\n}\n","/**\n * AG Grid Cell Value Extraction\n *\n * Provides utilities for extracting values from cells, including\n * support for custom cell renderers.\n *\n * @module grid/ag-grid/cell-renderers\n */\n\nimport type { Locator } from '@playwright/test';\nimport type { CellRendererConfig, NormalizedAgGridConfig } from '../types.js';\n\n/**\n * Built-in cell renderer extractors for common patterns\n */\nexport const BUILT_IN_EXTRACTORS: Record<string, CellRendererConfig> = {\n  // Checkbox cell\n  checkbox: {\n    valueSelector: 'input[type=\"checkbox\"]',\n    extractValue: async (el: Locator) => String(await el.isChecked()),\n  },\n\n  // Link/anchor cell\n  link: {\n    valueSelector: 'a',\n    extractValue: async (el: Locator) => (await el.textContent())?.trim() ?? '',\n  },\n\n  // Input cell (for inline editing)\n  input: {\n    valueSelector: 'input:not([type=\"checkbox\"])',\n    extractValue: async (el: Locator) => await el.inputValue(),\n  },\n\n  // Select/dropdown cell\n  select: {\n    valueSelector: 'select',\n    extractValue: async (el: Locator) => await el.inputValue(),\n  },\n\n  // Badge/tag cell\n  badge: {\n    valueSelector: '.badge, .tag, .chip, .label',\n    extractValue: async (el: Locator) => (await el.textContent())?.trim() ?? '',\n  },\n\n  // Button cell\n  button: {\n    valueSelector: 'button',\n    extractValue: async (el: Locator) => (await el.textContent())?.trim() ?? '',\n  },\n};\n\n/**\n * Extract the value from a cell, handling custom renderers\n *\n * @param cellLocator - The cell locator\n * @param config - Normalized grid configuration\n * @param colId - Column ID (for column-specific extractors)\n * @returns The extracted cell value\n */\nexport async function extractCellValue(\n  cellLocator: Locator,\n  config: NormalizedAgGridConfig,\n  colId?: string\n): Promise<string> {\n  // Check for column-specific custom renderer\n  if (colId && config.cellRenderers?.[colId]) {\n    const renderer = config.cellRenderers[colId];\n    return extractWithRenderer(cellLocator, renderer);\n  }\n\n  // Check for column definition with valueExtractor\n  if (colId && config.columns) {\n    const column = config.columns.find((c) => c.colId === colId);\n    if (column?.valueExtractor) {\n      return column.valueExtractor(cellLocator);\n    }\n  }\n\n  // Try built-in extractors based on cell content\n  for (const [, extractor] of Object.entries(BUILT_IN_EXTRACTORS)) {\n    const element = cellLocator.locator(extractor.valueSelector);\n    const count = await element.count();\n    if (count > 0 && extractor.extractValue) {\n      return extractor.extractValue(element.first());\n    }\n  }\n\n  // Fall back to text content with whitespace normalization\n  return normalizeText(await cellLocator.textContent());\n}\n\n/**\n * Extract value using a specific renderer configuration\n *\n * @param cellLocator - The cell locator\n * @param renderer - The renderer configuration\n * @returns The extracted value\n */\nasync function extractWithRenderer(\n  cellLocator: Locator,\n  renderer: CellRendererConfig\n): Promise<string> {\n  const element = cellLocator.locator(renderer.valueSelector);\n\n  if (renderer.extractValue) {\n    return renderer.extractValue(element.first());\n  }\n\n  // Default to text content\n  return normalizeText(await element.first().textContent());\n}\n\n/**\n * Normalize text content by trimming and collapsing whitespace\n *\n * @param text - Raw text content\n * @returns Normalized text\n */\nexport function normalizeText(text: string | null): string {\n  if (!text) return '';\n  return text.replace(/\\s+/g, ' ').trim();\n}\n\n/**\n * Get a cell value by column ID from a row\n *\n * @param rowLocator - The row locator\n * @param colId - Column ID\n * @param config - Normalized grid configuration\n * @returns The cell value\n */\nexport async function getCellValueByColId(\n  rowLocator: Locator,\n  colId: string,\n  config: NormalizedAgGridConfig\n): Promise<string> {\n  const cellLocator = rowLocator.locator(`.ag-cell[col-id=\"${colId}\"]`);\n  return extractCellValue(cellLocator, config, colId);\n}\n\n/**\n * Get all cell values for a row\n *\n * @param rowLocator - The row locator\n * @param config - Normalized grid configuration\n * @returns Object mapping column IDs to values\n */\nexport async function getAllCellValues(\n  rowLocator: Locator,\n  config: NormalizedAgGridConfig\n): Promise<Record<string, unknown>> {\n  const cells = rowLocator.locator('.ag-cell');\n  const cellCount = await cells.count();\n  const values: Record<string, unknown> = {};\n\n  for (let i = 0; i < cellCount; i++) {\n    const cell = cells.nth(i);\n    const colId = await cell.getAttribute('col-id');\n    if (colId) {\n      values[colId] = await extractCellValue(cell, config, colId);\n    }\n  }\n\n  return values;\n}\n\n/**\n * Parse a cell value based on column type\n *\n * @param value - The string value\n * @param type - The column type\n * @returns Parsed value\n */\nexport function parseValueByType(\n  value: string,\n  type?: 'text' | 'number' | 'date' | 'boolean' | 'custom'\n): unknown {\n  if (!type || type === 'text' || type === 'custom') {\n    return value;\n  }\n\n  if (type === 'number') {\n    // Handle formatted numbers (remove currency symbols, commas)\n    const numStr = value.replace(/[^0-9.-]/g, '');\n    const parsed = parseFloat(numStr);\n    return isNaN(parsed) ? value : parsed;\n  }\n\n  if (type === 'boolean') {\n    const lower = value.toLowerCase();\n    if (lower === 'true' || lower === 'yes' || lower === '1') return true;\n    if (lower === 'false' || lower === 'no' || lower === '0') return false;\n    return value;\n  }\n\n  if (type === 'date') {\n    const date = new Date(value);\n    return isNaN(date.getTime()) ? value : date;\n  }\n\n  return value;\n}\n","/**\n * AG Grid Row Data Extraction\n *\n * Provides utilities for extracting and finding row data.\n *\n * @module grid/ag-grid/row-data\n */\n\nimport type { Locator } from '@playwright/test';\nimport type { AgGridRowData, ClosestMatchResult, NormalizedAgGridConfig, RowMatcher } from '../types.js';\nimport {\n  AG_GRID_SELECTORS,\n  buildRowSelectorFromMatcher,\n  getAriaRowIndex,\n  getRowId,\n  getRowIndex,\n  isDirectMatcher,\n  isGroupRow,\n  isRowExpanded,\n} from './selectors.js';\nimport { getAllCellValues } from './cell-renderers.js';\n\n/**\n * Extract data from a row element\n *\n * @param rowLocator - The row locator\n * @param config - Normalized grid configuration\n * @returns Extracted row data\n */\nexport async function getRowData(\n  rowLocator: Locator,\n  config: NormalizedAgGridConfig\n): Promise<AgGridRowData> {\n  const [ariaRowIndex, rowIndex, rowId, isGroup, isExpanded, cells] = await Promise.all([\n    getAriaRowIndex(rowLocator),\n    getRowIndex(rowLocator),\n    getRowId(rowLocator),\n    isGroupRow(rowLocator),\n    isRowExpanded(rowLocator),\n    getAllCellValues(rowLocator, config),\n  ]);\n\n  const rowData: AgGridRowData = {\n    rowIndex,\n    ariaRowIndex,\n    cells,\n  };\n\n  if (rowId) {\n    rowData.rowId = rowId;\n  }\n\n  if (isGroup) {\n    rowData.isGroup = true;\n    rowData.isExpanded = isExpanded;\n\n    // Try to get group level from aria attribute or class\n    const level = await rowLocator.getAttribute('aria-level');\n    if (level) {\n      rowData.groupLevel = parseInt(level, 10);\n    }\n  }\n\n  return rowData;\n}\n\n/**\n * Extract data from all visible rows\n *\n * @param gridLocator - The grid root locator\n * @param config - Normalized grid configuration\n * @returns Array of row data\n */\nexport async function getAllVisibleRowData(\n  gridLocator: Locator,\n  config: NormalizedAgGridConfig\n): Promise<AgGridRowData[]> {\n  const rows = gridLocator.locator(AG_GRID_SELECTORS.ROW);\n  const rowCount = await rows.count();\n  const results: AgGridRowData[] = [];\n\n  for (let i = 0; i < rowCount; i++) {\n    const rowLocator = rows.nth(i);\n    const rowData = await getRowData(rowLocator, config);\n    results.push(rowData);\n  }\n\n  return results;\n}\n\n/**\n * Find a row by matching criteria\n *\n * @param gridLocator - The grid root locator\n * @param matcher - Row matching criteria\n * @param config - Normalized grid configuration\n * @returns Locator for the matching row, or null if not found\n */\nexport async function findRowByMatcher(\n  gridLocator: Locator,\n  matcher: RowMatcher,\n  config: NormalizedAgGridConfig\n): Promise<{ row: Locator; data: AgGridRowData } | null> {\n  // Fast path: Direct CSS selector matchers (ariaRowIndex, rowId, rowIndex)\n  if (isDirectMatcher(matcher)) {\n    const selector = buildRowSelectorFromMatcher(matcher);\n    if (selector) {\n      const row = gridLocator.locator(selector);\n      const count = await row.count();\n      if (count > 0) {\n        return { row: row.first(), data: await getRowData(row.first(), config) };\n      }\n    }\n    return null;\n  }\n\n  // Slow path: Cell values or predicate matching (requires iterating)\n  if (matcher.cellValues || matcher.predicate) {\n    const allRows = await getAllVisibleRowData(gridLocator, config);\n\n    for (let i = 0; i < allRows.length; i++) {\n      const rowData = allRows[i];\n      if (!rowData) {continue;}\n\n      const matches = matcher.cellValues\n        ? matchesCellValues(rowData, matcher.cellValues)\n        : matcher.predicate?.(rowData);\n\n      if (matches) {\n        const row = gridLocator.locator(AG_GRID_SELECTORS.ROW).nth(i);\n        return { row, data: rowData };\n      }\n    }\n    return null;\n  }\n\n  return null;\n}\n\n/**\n * Check if a row's cell values match the expected values\n *\n * @param rowData - Row data to check\n * @param expectedValues - Expected cell values\n * @returns True if all expected values match\n */\nexport function matchesCellValues(\n  rowData: AgGridRowData,\n  expectedValues: Record<string, unknown>\n): boolean {\n  for (const [colId, expectedValue] of Object.entries(expectedValues)) {\n    const actualValue = rowData.cells[colId];\n\n    // Normalize both values for comparison\n    const normalizedExpected = normalizeForComparison(expectedValue);\n    const normalizedActual = normalizeForComparison(actualValue);\n\n    if (normalizedExpected !== normalizedActual) {\n      return false;\n    }\n  }\n  return true;\n}\n\n/**\n * Find the closest matching row for error messages\n *\n * @param gridLocator - The grid root locator\n * @param expectedValues - Expected cell values\n * @param config - Normalized grid configuration\n * @returns Closest match result\n */\nexport async function findClosestMatch(\n  gridLocator: Locator,\n  expectedValues: Record<string, unknown>,\n  config: NormalizedAgGridConfig\n): Promise<ClosestMatchResult | null> {\n  const allRows = await getAllVisibleRowData(gridLocator, config);\n\n  if (allRows.length === 0) {\n    return null;\n  }\n\n  let bestMatch: ClosestMatchResult | null = null;\n  let bestMatchCount = -1;\n\n  const expectedKeys = Object.keys(expectedValues);\n  const totalFields = expectedKeys.length;\n\n  for (const rowData of allRows) {\n    let matchedFields = 0;\n    const mismatches: ClosestMatchResult['mismatches'] = [];\n\n    for (const colId of expectedKeys) {\n      const expectedValue = expectedValues[colId];\n      const actualValue = rowData.cells[colId];\n\n      const normalizedExpected = normalizeForComparison(expectedValue);\n      const normalizedActual = normalizeForComparison(actualValue);\n\n      if (normalizedExpected === normalizedActual) {\n        matchedFields++;\n      } else {\n        mismatches.push({\n          field: colId,\n          expected: expectedValue,\n          actual: actualValue,\n        });\n      }\n    }\n\n    if (matchedFields > bestMatchCount) {\n      bestMatchCount = matchedFields;\n      bestMatch = {\n        row: rowData,\n        matchedFields,\n        totalFields,\n        mismatches,\n      };\n    }\n  }\n\n  return bestMatch;\n}\n\n/**\n * Normalize a value for comparison\n *\n * @param value - Value to normalize\n * @returns Normalized string value\n */\nfunction normalizeForComparison(value: unknown): string {\n  if (value === null || value === undefined) {\n    return '';\n  }\n\n  if (typeof value === 'string') {\n    return value.trim().toLowerCase();\n  }\n\n  return String(value).trim().toLowerCase();\n}\n\n/**\n * Count visible rows in the grid\n *\n * @param gridLocator - The grid root locator\n * @returns Number of visible rows\n */\nexport async function countVisibleRows(gridLocator: Locator): Promise<number> {\n  return gridLocator.locator(AG_GRID_SELECTORS.ROW).count();\n}\n\n/**\n * Count selected rows in the grid\n *\n * @param gridLocator - The grid root locator\n * @returns Number of selected rows\n */\nexport async function countSelectedRows(gridLocator: Locator): Promise<number> {\n  return gridLocator.locator(AG_GRID_SELECTORS.ROW_SELECTED).count();\n}\n","/**\n * AG Grid State Extraction\n *\n * Provides utilities for extracting the current grid state.\n *\n * @module grid/ag-grid/state\n */\n\nimport type { Locator } from '@playwright/test';\nimport type { AgGridState, NormalizedAgGridConfig, SortModel } from '../types.js';\nimport { AG_GRID_SELECTORS, getSortDirection } from './selectors.js';\nimport { countSelectedRows, countVisibleRows } from './row-data.js';\n\n/**\n * Extract the current state of the grid\n *\n * @param gridLocator - The grid root locator\n * @param config - Normalized grid configuration\n * @returns Current grid state\n */\nexport async function getGridState(\n  gridLocator: Locator,\n  _config: NormalizedAgGridConfig\n): Promise<AgGridState> {\n  const [visibleRows, selectedRows, sortedBy, isLoading, totalRows] = await Promise.all([\n    countVisibleRows(gridLocator),\n    countSelectedRows(gridLocator),\n    getSortState(gridLocator),\n    checkIsLoading(gridLocator),\n    getTotalRowCount(gridLocator),\n  ]);\n\n  const state: AgGridState = {\n    totalRows,\n    visibleRows,\n    selectedRows,\n    isLoading,\n  };\n\n  if (sortedBy.length > 0) {\n    state.sortedBy = sortedBy;\n  }\n\n  // TODO: Extract filter state (more complex, depends on filter type)\n  // TODO: Extract groupedBy (enterprise feature)\n\n  return state;\n}\n\n/**\n * Get the current sort state from header cells\n *\n * @param gridLocator - The grid root locator\n * @returns Array of sort models\n */\nexport async function getSortState(gridLocator: Locator): Promise<SortModel[]> {\n  const headerCells = gridLocator.locator(AG_GRID_SELECTORS.HEADER_CELL);\n  const cellCount = await headerCells.count();\n  const sortedColumns: SortModel[] = [];\n\n  for (let i = 0; i < cellCount; i++) {\n    const cell = headerCells.nth(i);\n    const colId = await cell.getAttribute(AG_GRID_SELECTORS.ATTR_COL_ID);\n    const direction = await getSortDirection(cell);\n\n    if (colId && direction) {\n      sortedColumns.push({ colId, direction });\n    }\n  }\n\n  return sortedColumns;\n}\n\n/**\n * Check if an overlay element is visible\n * Handles AG Grid's overlay visibility patterns (CSS class and display)\n *\n * @param overlayLocator - Locator for the overlay element\n * @returns True if overlay is visible\n */\nasync function isOverlayVisible(overlayLocator: Locator): Promise<boolean> {\n  const count = await overlayLocator.count();\n\n  if (count === 0) {\n    return false;\n  }\n\n  // Check if the overlay has the .visible class (AG Grid pattern)\n  const visibleOverlay = overlayLocator.locator('.visible');\n  const visibleCount = await visibleOverlay.count();\n\n  if (visibleCount > 0) {\n    return true;\n  }\n\n  // Check if it's actually visible (not display: none)\n  try {\n    const isVisible = await overlayLocator.first().isVisible({ timeout: 100 });\n    return isVisible;\n  } catch {\n    return false;\n  }\n}\n\n/**\n * Check if the grid is in a loading state\n *\n * @param gridLocator - The grid root locator\n * @returns True if loading overlay is visible\n */\nexport async function checkIsLoading(gridLocator: Locator): Promise<boolean> {\n  const loadingOverlay = gridLocator.locator(AG_GRID_SELECTORS.LOADING_OVERLAY);\n  return isOverlayVisible(loadingOverlay);\n}\n\n/**\n * Get the total row count\n *\n * This tries multiple strategies:\n * 1. Read from pagination info if available\n * 2. Count visible rows if no pagination\n *\n * @param gridLocator - The grid root locator\n * @returns Total row count\n */\nexport async function getTotalRowCount(gridLocator: Locator): Promise<number> {\n  // Strategy 1: Check for pagination info\n  // AG Grid typically has pagination info like \"1 to 10 of 100\"\n  const paginationPanel = gridLocator.locator('.ag-paging-panel');\n  const paginationCount = await paginationPanel.count();\n\n  if (paginationCount > 0) {\n    const paginationText = await paginationPanel.textContent();\n    if (paginationText) {\n      // Try to extract \"of X\" pattern\n      const match = paginationText.match(/of\\s*(\\d+)/i);\n      const matchedValue = match?.[1];\n      if (matchedValue) {\n        return parseInt(matchedValue, 10);\n      }\n    }\n  }\n\n  // Strategy 2: Check for row count in status bar\n  const statusBar = gridLocator.locator('.ag-status-bar');\n  const statusBarCount = await statusBar.count();\n\n  if (statusBarCount > 0) {\n    const statusText = await statusBar.textContent();\n    if (statusText) {\n      const match = statusText.match(/(\\d+)\\s*(rows?|records?|items?)/i);\n      const matchedValue = match?.[1];\n      if (matchedValue) {\n        return parseInt(matchedValue, 10);\n      }\n    }\n  }\n\n  // Strategy 3: Count visible rows (fallback)\n  return countVisibleRows(gridLocator);\n}\n\n/**\n * Check if the \"no rows\" overlay is visible\n *\n * @param gridLocator - The grid root locator\n * @returns True if no rows overlay is visible\n */\nexport async function isNoRowsOverlayVisible(gridLocator: Locator): Promise<boolean> {\n  const noRowsOverlay = gridLocator.locator(AG_GRID_SELECTORS.NO_ROWS_OVERLAY);\n  return isOverlayVisible(noRowsOverlay);\n}\n\n/**\n * Get the columns that are currently grouped (enterprise feature)\n *\n * @param gridLocator - The grid root locator\n * @returns Array of column IDs used for grouping\n */\nexport async function getGroupedColumns(gridLocator: Locator): Promise<string[]> {\n  // AG Grid shows grouped columns in a row group panel\n  const rowGroupPanel = gridLocator.locator('.ag-column-drop-row-group');\n  const count = await rowGroupPanel.count();\n\n  if (count === 0) {\n    return [];\n  }\n\n  // Extract column IDs from the chips in the panel\n  const chips = rowGroupPanel.locator('.ag-column-drop-cell');\n  const chipCount = await chips.count();\n  const groupedColumns: string[] = [];\n\n  for (let i = 0; i < chipCount; i++) {\n    const chip = chips.nth(i);\n    const colId = await chip.getAttribute('col-id');\n    if (colId) {\n      groupedColumns.push(colId);\n    }\n  }\n\n  return groupedColumns;\n}\n","/**\n * AG Grid Assertions\n *\n * Provides assertion functions for grid state verification.\n *\n * @module grid/ag-grid/assertions\n */\n\nimport { expect, type Locator } from '@playwright/test';\nimport type {\n  AssertionOptions,\n  NormalizedAgGridConfig,\n  RowCountOptions,\n  RowMatcher,\n} from '../types.js';\nimport { AG_GRID_SELECTORS, isRowSelected } from './selectors.js';\nimport { getColumnDisplayName } from './config.js';\nimport {\n  countVisibleRows,\n  findClosestMatch,\n  findRowByMatcher,\n  getAllVisibleRowData,\n  matchesCellValues,\n} from './row-data.js';\nimport { getSortState, isNoRowsOverlayVisible } from './state.js';\n\n/**\n * Assert that the grid has the expected row count\n *\n * @param gridLocator - The grid root locator\n * @param count - Expected row count\n * @param config - Normalized grid configuration\n * @param options - Assertion options\n */\nexport async function expectRowCount(\n  gridLocator: Locator,\n  count: number,\n  config: NormalizedAgGridConfig,\n  options?: RowCountOptions\n): Promise<void> {\n  const timeout = options?.timeout ?? 5000;\n  const rows = gridLocator.locator(AG_GRID_SELECTORS.ROW);\n\n  // Handle range assertions\n  if (options?.min !== undefined || options?.max !== undefined) {\n    const actualCount = await rows.count();\n\n    if (options.min !== undefined && actualCount < options.min) {\n      throw new Error(\n        `Grid \"${config.selector}\" has ${actualCount} rows, expected at least ${options.min}`\n      );\n    }\n\n    if (options.max !== undefined && actualCount > options.max) {\n      throw new Error(\n        `Grid \"${config.selector}\" has ${actualCount} rows, expected at most ${options.max}`\n      );\n    }\n\n    return;\n  }\n\n  // Exact count assertion\n  await expect(rows).toHaveCount(count, { timeout });\n}\n\n/**\n * Assert that the grid contains a row matching the given cell values\n *\n * @param gridLocator - The grid root locator\n * @param cellValues - Expected cell values\n * @param config - Normalized grid configuration\n * @param options - Assertion options\n */\nexport async function expectRowContains(\n  gridLocator: Locator,\n  cellValues: Record<string, unknown>,\n  config: NormalizedAgGridConfig,\n  options?: AssertionOptions\n): Promise<void> {\n  const timeout = options?.timeout ?? 5000;\n  const startTime = Date.now();\n\n  // Poll until timeout\n  while (Date.now() - startTime < timeout) {\n    const match = await findRowByMatcher(gridLocator, { cellValues }, config);\n\n    if (match) {\n      return; // Found a matching row\n    }\n\n    // Small delay before retry\n    await gridLocator.page().waitForTimeout(100);\n  }\n\n  // No match found - build detailed error message\n  const visibleRowCount = await countVisibleRows(gridLocator);\n  const closestMatch = await findClosestMatch(gridLocator, cellValues, config);\n\n  let errorMessage = `Grid \"${config.selector}\" does not contain a row matching:\\n`;\n  errorMessage += `   Expected: ${formatCellValues(cellValues, config)}\\n\\n`;\n  errorMessage += `   Visible rows checked: ${visibleRowCount}\\n`;\n\n  if (closestMatch && closestMatch.matchedFields > 0) {\n    errorMessage += `   Closest match: ${formatCellValues(closestMatch.row.cells, config)}\\n`;\n    errorMessage += `   Mismatched fields:\\n`;\n    for (const mismatch of closestMatch.mismatches) {\n      const displayName = getColumnDisplayName(config, mismatch.field);\n      errorMessage += `     - ${displayName}: expected \"${String(mismatch.expected)}\", got \"${String(mismatch.actual)}\"\\n`;\n    }\n  } else {\n    errorMessage += `   No similar rows found\\n`;\n  }\n\n  errorMessage += `\\n   Tip: If the row exists but isn't visible, it may require scrolling.\\n`;\n  errorMessage += `   The helper automatically scrolls for you - check if the data exists.`;\n\n  throw new Error(errorMessage);\n}\n\n/**\n * Assert that the grid does NOT contain a row matching the given cell values\n *\n * @param gridLocator - The grid root locator\n * @param cellValues - Cell values that should NOT match any row\n * @param config - Normalized grid configuration\n * @param options - Assertion options\n */\nexport async function expectRowNotContains(\n  gridLocator: Locator,\n  cellValues: Record<string, unknown>,\n  config: NormalizedAgGridConfig,\n  options?: AssertionOptions\n): Promise<void> {\n  const timeout = options?.timeout ?? 5000;\n  const startTime = Date.now();\n\n  // Poll until timeout to ensure row doesn't appear\n  while (Date.now() - startTime < timeout) {\n    const allRows = await getAllVisibleRowData(gridLocator, config);\n\n    let foundMatch = false;\n    for (const rowData of allRows) {\n      if (matchesCellValues(rowData, cellValues)) {\n        foundMatch = true;\n        break;\n      }\n    }\n\n    if (foundMatch) {\n      // Found a match - this is a failure, wait a bit and check again\n      // (the row might be about to be removed)\n      await gridLocator.page().waitForTimeout(100);\n    } else {\n      // No match - success\n      return;\n    }\n  }\n\n  // Timeout reached and row still exists\n  throw new Error(\n    `Grid \"${config.selector}\" contains a row matching:\\n` +\n      `   ${formatCellValues(cellValues, config)}\\n\\n` +\n      `   Expected this row to NOT exist.`\n  );\n}\n\n/**\n * Assert that a specific cell has the expected value\n *\n * @param gridLocator - The grid root locator\n * @param rowMatcher - Row matching criteria\n * @param colId - Column ID\n * @param expectedValue - Expected cell value\n * @param config - Normalized grid configuration\n * @param options - Assertion options\n */\nexport async function expectCellValue(\n  gridLocator: Locator,\n  rowMatcher: RowMatcher,\n  colId: string,\n  expectedValue: unknown,\n  config: NormalizedAgGridConfig,\n  options?: AssertionOptions\n): Promise<void> {\n  const _timeout = options?.timeout ?? 5000;\n  void _timeout; // Reserved for future retry logic\n  const exact = options?.exact ?? false;\n\n  const match = await findRowByMatcher(gridLocator, rowMatcher, config);\n\n  if (!match) {\n    throw new Error(\n      `Grid \"${config.selector}\": Could not find row matching ${formatMatcher(rowMatcher)}`\n    );\n  }\n\n  const actualValue = match.data.cells[colId];\n  const displayName = getColumnDisplayName(config, colId);\n\n  if (exact) {\n    // Exact match\n    if (actualValue !== expectedValue) {\n      throw new Error(\n        `Grid \"${config.selector}\": Cell \"${displayName}\" has value \"${String(actualValue)}\", expected exactly \"${String(expectedValue)}\"`\n      );\n    }\n  } else {\n    // Normalized comparison\n    const normalizedExpected = normalizeForComparison(expectedValue);\n    const normalizedActual = normalizeForComparison(actualValue);\n\n    if (normalizedExpected !== normalizedActual) {\n      throw new Error(\n        `Grid \"${config.selector}\": Cell \"${displayName}\" has value \"${String(actualValue)}\", expected \"${String(expectedValue)}\"`\n      );\n    }\n  }\n}\n\n/**\n * Assert that the grid is sorted by a specific column\n *\n * @param gridLocator - The grid root locator\n * @param colId - Column ID\n * @param direction - Expected sort direction\n * @param config - Normalized grid configuration\n * @param options - Assertion options\n */\nexport async function expectSortedBy(\n  gridLocator: Locator,\n  colId: string,\n  direction: 'asc' | 'desc',\n  config: NormalizedAgGridConfig,\n  _options?: AssertionOptions\n): Promise<void> {\n  const sortState = await getSortState(gridLocator);\n  const columnSort = sortState.find((s) => s.colId === colId);\n  const displayName = getColumnDisplayName(config, colId);\n\n  if (!columnSort) {\n    const sortedCols = sortState.map((s) => `${s.colId} (${s.direction})`).join(', ') || 'none';\n    throw new Error(\n      `Grid \"${config.selector}\": Column \"${displayName}\" is not sorted. Currently sorted: ${sortedCols}`\n    );\n  }\n\n  if (columnSort.direction !== direction) {\n    throw new Error(\n      `Grid \"${config.selector}\": Column \"${displayName}\" is sorted \"${columnSort.direction}\", expected \"${direction}\"`\n    );\n  }\n}\n\n/**\n * Assert that the grid is empty (no data rows)\n *\n * @param gridLocator - The grid root locator\n * @param config - Normalized grid configuration\n * @param options - Assertion options\n */\nexport async function expectEmpty(\n  gridLocator: Locator,\n  _config: NormalizedAgGridConfig,\n  options?: AssertionOptions\n): Promise<void> {\n  const timeout = options?.timeout ?? 5000;\n  const rows = gridLocator.locator(AG_GRID_SELECTORS.ROW);\n\n  await expect(rows).toHaveCount(0, { timeout });\n}\n\n/**\n * Assert that the \"no rows\" overlay is visible\n *\n * @param gridLocator - The grid root locator\n * @param config - Normalized grid configuration\n * @param options - Assertion options\n */\nexport async function expectNoRowsOverlay(\n  gridLocator: Locator,\n  config: NormalizedAgGridConfig,\n  _options?: AssertionOptions\n): Promise<void> {\n  const isVisible = await isNoRowsOverlayVisible(gridLocator);\n\n  if (!isVisible) {\n    const rowCount = await countVisibleRows(gridLocator);\n    throw new Error(\n      `Grid \"${config.selector}\": \"No rows\" overlay is not visible. Grid has ${rowCount} rows.`\n    );\n  }\n}\n\n/**\n * Assert that a row is selected\n *\n * @param gridLocator - The grid root locator\n * @param matcher - Row matching criteria\n * @param config - Normalized grid configuration\n * @param options - Assertion options\n */\nexport async function expectRowSelected(\n  gridLocator: Locator,\n  matcher: RowMatcher,\n  config: NormalizedAgGridConfig,\n  _options?: AssertionOptions\n): Promise<void> {\n  const match = await findRowByMatcher(gridLocator, matcher, config);\n\n  if (!match) {\n    throw new Error(\n      `Grid \"${config.selector}\": Could not find row matching ${formatMatcher(matcher)}`\n    );\n  }\n\n  const selected = await isRowSelected(match.row);\n\n  if (!selected) {\n    throw new Error(\n      `Grid \"${config.selector}\": Row matching ${formatMatcher(matcher)} is not selected`\n    );\n  }\n}\n\n// ============================================================================\n// Helper Functions\n// ============================================================================\n\n/**\n * Format cell values for error messages\n */\nfunction formatCellValues(\n  values: Record<string, unknown>,\n  config: NormalizedAgGridConfig\n): string {\n  const parts: string[] = [];\n  for (const [colId, value] of Object.entries(values)) {\n    const displayName = getColumnDisplayName(config, colId);\n    parts.push(`${displayName}: \"${String(value)}\"`);\n  }\n  return `{ ${parts.join(', ')} }`;\n}\n\n/**\n * Format a row matcher for error messages\n */\nfunction formatMatcher(matcher: RowMatcher): string {\n  if (matcher.ariaRowIndex !== undefined) {\n    return `aria-rowindex=${matcher.ariaRowIndex}`;\n  }\n  if (matcher.rowId !== undefined) {\n    return `row-id=\"${matcher.rowId}\"`;\n  }\n  if (matcher.rowIndex !== undefined) {\n    return `row-index=${matcher.rowIndex}`;\n  }\n  if (matcher.cellValues) {\n    return JSON.stringify(matcher.cellValues);\n  }\n  return '<custom predicate>';\n}\n\n/**\n * Normalize a value for comparison\n */\nfunction normalizeForComparison(value: unknown): string {\n  if (value === null || value === undefined) {\n    return '';\n  }\n  if (typeof value === 'string') {\n    return value.trim().toLowerCase();\n  }\n  return String(value).trim().toLowerCase();\n}\n","/**\n * AG Grid Helper Class\n *\n * Main class implementing the AgGridHelper interface.\n *\n * @module grid/ag-grid/helper\n */\n\nimport type { Locator, Page } from '@playwright/test';\nimport type {\n  AgGridHelper as IAgGridHelper,\n  AgGridConfig,\n  NormalizedAgGridConfig,\n  RowMatcher,\n  AgGridRowData,\n  AgGridState,\n  AssertionOptions,\n  RowCountOptions,\n} from '../types.js';\nimport { normalizeConfig, validateConfig } from './config.js';\nimport {\n  createLocatorContext,\n  getGrid as getGridLocator,\n  getRow as getRowLocator,\n  getVisibleRows as getVisibleRowsLocator,\n  getCell as getCellLocator,\n  getHeaderCell as getHeaderCellLocator,\n  getFilterInput as getFilterInputLocator,\n  type GridLocatorContext,\n} from './locators.js';\nimport { formatRowMatcher, isRowSelected } from './selectors.js';\nimport {\n  waitForReady as waitForReadyFn,\n  waitForDataLoaded as waitForDataLoadedFn,\n  waitForRowCount as waitForRowCountFn,\n  waitForRow as waitForRowFn,\n} from './wait.js';\nimport {\n  expectRowCount as expectRowCountFn,\n  expectRowContains as expectRowContainsFn,\n  expectRowNotContains as expectRowNotContainsFn,\n  expectCellValue as expectCellValueFn,\n  expectSortedBy as expectSortedByFn,\n  expectEmpty as expectEmptyFn,\n  expectRowSelected as expectRowSelectedFn,\n  expectNoRowsOverlay as expectNoRowsOverlayFn,\n} from './assertions.js';\nimport {\n  getAllVisibleRowData as getAllVisibleRowDataFn,\n  findRowByMatcher,\n} from './row-data.js';\nimport { getGridState as getGridStateFn } from './state.js';\n\n/**\n * AG Grid Helper implementation\n */\nexport class AgGridHelperImpl implements IAgGridHelper {\n  private page: Page;\n  private config: NormalizedAgGridConfig;\n  private ctx: GridLocatorContext;\n\n  constructor(page: Page, config: string | AgGridConfig) {\n    this.page = page;\n\n    // Validate config before normalizing (skip validation for string selectors)\n    if (typeof config !== 'string') {\n      validateConfig(config);\n    }\n\n    this.config = normalizeConfig(config);\n    this.ctx = createLocatorContext(page, this.config);\n  }\n\n  // \n  // Locators\n  // \n\n  getGrid(): Locator {\n    return getGridLocator(this.ctx);\n  }\n\n  getRow(matcher: RowMatcher): Locator {\n    return getRowLocator(this.ctx, matcher);\n  }\n\n  getVisibleRows(): Locator {\n    return getVisibleRowsLocator(this.ctx);\n  }\n\n  getCell(rowMatcher: RowMatcher, colId: string): Locator {\n    return getCellLocator(this.ctx, rowMatcher, colId);\n  }\n\n  getHeaderCell(colId: string): Locator {\n    return getHeaderCellLocator(this.ctx, colId);\n  }\n\n  getFilterInput(colId: string): Locator {\n    return getFilterInputLocator(this.ctx, colId);\n  }\n\n  // \n  // Wait Utilities\n  // \n\n  async waitForReady(options?: { timeout?: number }): Promise<void> {\n    await waitForReadyFn(this.getGrid(), this.config, options);\n  }\n\n  async waitForDataLoaded(options?: { timeout?: number }): Promise<void> {\n    await waitForDataLoadedFn(this.getGrid(), this.config, options);\n  }\n\n  async waitForRowCount(count: number, options?: { timeout?: number }): Promise<void> {\n    await waitForRowCountFn(this.getGrid(), count, this.config, options);\n  }\n\n  async waitForRow(matcher: RowMatcher, options?: { timeout?: number }): Promise<Locator> {\n    return waitForRowFn(this.getGrid(), matcher, this.config, options);\n  }\n\n  // \n  // Assertions\n  // \n\n  async expectRowCount(count: number, options?: RowCountOptions): Promise<void> {\n    await expectRowCountFn(this.getGrid(), count, this.config, options);\n  }\n\n  async expectRowContains(\n    cellValues: Record<string, unknown>,\n    options?: AssertionOptions\n  ): Promise<void> {\n    await expectRowContainsFn(this.getGrid(), cellValues, this.config, options);\n  }\n\n  async expectRowNotContains(\n    cellValues: Record<string, unknown>,\n    options?: AssertionOptions\n  ): Promise<void> {\n    await expectRowNotContainsFn(this.getGrid(), cellValues, this.config, options);\n  }\n\n  async expectCellValue(\n    rowMatcher: RowMatcher,\n    colId: string,\n    expectedValue: unknown,\n    options?: AssertionOptions\n  ): Promise<void> {\n    await expectCellValueFn(this.getGrid(), rowMatcher, colId, expectedValue, this.config, options);\n  }\n\n  async expectSortedBy(\n    colId: string,\n    direction: 'asc' | 'desc',\n    options?: AssertionOptions\n  ): Promise<void> {\n    await expectSortedByFn(this.getGrid(), colId, direction, this.config, options);\n  }\n\n  async expectEmpty(options?: AssertionOptions): Promise<void> {\n    await expectEmptyFn(this.getGrid(), this.config, options);\n  }\n\n  async expectRowSelected(matcher: RowMatcher, options?: AssertionOptions): Promise<void> {\n    await expectRowSelectedFn(this.getGrid(), matcher, this.config, options);\n  }\n\n  async expectNoRowsOverlay(options?: AssertionOptions): Promise<void> {\n    await expectNoRowsOverlayFn(this.getGrid(), this.config, options);\n  }\n\n  // \n  // Actions (stubs - implemented in Phase 4)\n  // \n\n  async clickCell(rowMatcher: RowMatcher, colId: string): Promise<void> {\n    const cell = this.getCell(rowMatcher, colId);\n    await cell.click();\n  }\n\n  async editCell(rowMatcher: RowMatcher, colId: string, newValue: string): Promise<void> {\n    const cell = this.getCell(rowMatcher, colId);\n    await cell.dblclick();\n    await cell.locator('input, textarea').fill(newValue);\n    await cell.press('Enter');\n  }\n\n  async sortByColumn(colId: string, direction?: 'asc' | 'desc'): Promise<void> {\n    const header = this.getHeaderCell(colId);\n    // Click until desired direction is reached\n    if (!direction) {\n      await header.click();\n      return;\n    }\n\n    // Click up to 3 times to cycle through sort states\n    for (let i = 0; i < 3; i++) {\n      const currentSort = await header.getAttribute('aria-sort');\n      if (\n        (direction === 'asc' && currentSort === 'ascending') ||\n        (direction === 'desc' && currentSort === 'descending')\n      ) {\n        return;\n      }\n      await header.click();\n      await this.page.waitForTimeout(100);\n    }\n  }\n\n  async filterColumn(colId: string, filterValue: string): Promise<void> {\n    const filterInput = this.getFilterInput(colId);\n    await filterInput.fill(filterValue);\n  }\n\n  async clearFilter(colId: string): Promise<void> {\n    const filterInput = this.getFilterInput(colId);\n    await filterInput.clear();\n  }\n\n  async clearAllFilters(): Promise<void> {\n    // Find all filter inputs and clear them\n    const filterInputs = this.getGrid().locator('.ag-floating-filter input');\n    const count = await filterInputs.count();\n    for (let i = 0; i < count; i++) {\n      await filterInputs.nth(i).clear();\n    }\n  }\n\n  async selectRow(matcher: RowMatcher): Promise<void> {\n    const row = this.getRow(matcher);\n    const checkbox = row.locator('.ag-selection-checkbox input');\n    const checkboxCount = await checkbox.count();\n\n    if (checkboxCount > 0) {\n      await checkbox.check();\n    } else {\n      await row.click();\n    }\n\n    // Wait briefly for selection state to update\n    await this.page.waitForTimeout(50);\n\n    // Verify selection succeeded (post-action verification)\n    // Note: Only fails if row exists but selection didn't register\n    // Some grids may not support selection or may have custom selection handlers\n    const rowCount = await row.count();\n    if (rowCount > 0) {\n      const selected = await isRowSelected(row.first());\n      // Log warning but don't fail - fixture may not have JS selection support\n      if (!selected && checkboxCount > 0) {\n        // Only throw if we explicitly used checkbox (indicates broken selection)\n        throw new Error(\n          `Failed to select row matching: ${formatRowMatcher(matcher)}. ` +\n          `Checkbox was checked but selection state did not change.`\n        );\n      }\n    }\n  }\n\n  async deselectRow(matcher: RowMatcher): Promise<void> {\n    const row = this.getRow(matcher);\n    const checkbox = row.locator('.ag-selection-checkbox input');\n    const checkboxCount = await checkbox.count();\n\n    if (checkboxCount > 0) {\n      await checkbox.uncheck();\n    }\n  }\n\n  async selectAllRows(): Promise<void> {\n    const selectAll = this.getGrid().locator('.ag-header-select-all input');\n    await selectAll.check();\n  }\n\n  async deselectAllRows(): Promise<void> {\n    const selectAll = this.getGrid().locator('.ag-header-select-all input');\n    await selectAll.uncheck();\n  }\n\n  async scrollToRow(matcher: RowMatcher): Promise<void> {\n    // Basic scroll - will be enhanced in Phase 5\n    const row = this.getRow(matcher);\n    await row.scrollIntoViewIfNeeded();\n  }\n\n  async scrollToColumn(colId: string): Promise<void> {\n    const cell = this.getGrid().locator(`.ag-cell[col-id=\"${colId}\"]`).first();\n    await cell.scrollIntoViewIfNeeded();\n  }\n\n  // \n  // Enterprise Features (stubs - implemented in Phase 6)\n  // \n\n  async expandGroup(matcher: RowMatcher): Promise<void> {\n    const row = this.getRow(matcher);\n    const expandIcon = row.locator('.ag-group-contracted');\n    await expandIcon.click();\n  }\n\n  async collapseGroup(matcher: RowMatcher): Promise<void> {\n    const row = this.getRow(matcher);\n    const collapseIcon = row.locator('.ag-group-expanded');\n    await collapseIcon.click();\n  }\n\n  async expandAllGroups(): Promise<void> {\n    // Optimized: Keep expanding until no more contracted groups exist\n    // This handles dynamically appearing nested groups\n    const maxIterations = 100; // Safety limit\n    let iterations = 0;\n\n    while (iterations < maxIterations) {\n      const contractedGroup = this.getGrid().locator('.ag-group-contracted').first();\n      const count = await contractedGroup.count();\n\n      if (count === 0) {\n        break; // No more contracted groups\n      }\n\n      await contractedGroup.click();\n      await this.page.waitForTimeout(50);\n      iterations++;\n    }\n  }\n\n  async collapseAllGroups(): Promise<void> {\n    // Optimized: Keep collapsing until no more expanded groups exist\n    // Process from deepest level first by collapsing outermost first\n    const maxIterations = 100; // Safety limit\n    let iterations = 0;\n\n    while (iterations < maxIterations) {\n      const expandedGroup = this.getGrid().locator('.ag-group-expanded').first();\n      const count = await expandedGroup.count();\n\n      if (count === 0) {\n        break; // No more expanded groups\n      }\n\n      await expandedGroup.click();\n      await this.page.waitForTimeout(50);\n      iterations++;\n    }\n  }\n\n  async getGroupChildCount(matcher: RowMatcher): Promise<number> {\n    const row = this.getRow(matcher);\n    const childCountEl = row.locator('.ag-group-child-count');\n    const count = await childCountEl.count();\n\n    if (count > 0) {\n      const text = await childCountEl.textContent();\n      const match = text?.match(/\\d+/);\n      return match ? parseInt(match[0], 10) : 0;\n    }\n\n    return 0;\n  }\n\n  async expandMasterRow(matcher: RowMatcher): Promise<void> {\n    const row = this.getRow(matcher);\n    const expandIcon = row.locator('.ag-group-contracted, .ag-row-group-expand');\n    await expandIcon.click();\n  }\n\n  getDetailGrid(_masterRowMatcher: RowMatcher): IAgGridHelper {\n    // Find the detail grid for this master row\n    // TODO: Use masterRowMatcher to find the specific detail grid when needed\n    const detailSelector = '.ag-details-row .ag-root-wrapper';\n    return new AgGridHelperImpl(this.page, {\n      ...this.config,\n      selector: detailSelector,\n    });\n  }\n\n  // \n  // Data Extraction\n  // \n\n  async getCellValue(rowMatcher: RowMatcher, colId: string): Promise<unknown> {\n    const match = await findRowByMatcher(this.getGrid(), rowMatcher, this.config);\n    if (!match) {\n      const visibleCount = await this.getVisibleRows().count();\n      throw new Error(\n        `Could not find row matching: ${formatRowMatcher(rowMatcher)}. ` +\n        `Grid has ${visibleCount} visible row(s).`\n      );\n    }\n    return match.data.cells[colId];\n  }\n\n  async getRowData(matcher: RowMatcher): Promise<AgGridRowData> {\n    const match = await findRowByMatcher(this.getGrid(), matcher, this.config);\n    if (!match) {\n      const visibleCount = await this.getVisibleRows().count();\n      throw new Error(\n        `Could not find row matching: ${formatRowMatcher(matcher)}. ` +\n        `Grid has ${visibleCount} visible row(s).`\n      );\n    }\n    return match.data;\n  }\n\n  async getAllVisibleRowData(): Promise<AgGridRowData[]> {\n    return getAllVisibleRowDataFn(this.getGrid(), this.config);\n  }\n\n  async getGridState(): Promise<AgGridState> {\n    return getGridStateFn(this.getGrid(), this.config);\n  }\n\n  async getSelectedRowIds(): Promise<string[]> {\n    const selectedRows = this.getGrid().locator('.ag-row-selected');\n    const count = await selectedRows.count();\n    const ids: string[] = [];\n\n    for (let i = 0; i < count; i++) {\n      const rowId = await selectedRows.nth(i).getAttribute('row-id');\n      if (rowId) {\n        ids.push(rowId);\n      }\n    }\n\n    return ids;\n  }\n}\n","/**\n * AG Grid Factory Function\n *\n * Creates AG Grid helper instances.\n *\n * @module grid/ag-grid/factory\n */\n\nimport type { Page } from '@playwright/test';\nimport type { AgGridConfig, AgGridHelper, AgGridFactory } from '../types.js';\nimport { AgGridHelperImpl } from './helper.js';\n\n/**\n * Create an AG Grid helper instance\n *\n * @param page - Playwright page object\n * @param config - Grid configuration (string selector or full config)\n * @returns AG Grid helper instance\n *\n * @example\n * ```typescript\n * // Simple usage with test ID\n * const grid = agGrid(page, 'orders-grid');\n *\n * // Full configuration\n * const grid = agGrid(page, {\n *   selector: 'orders-grid',\n *   columns: [\n *     { colId: 'orderId', type: 'text', displayName: 'Order ID' },\n *     { colId: 'amount', type: 'number', displayName: 'Amount' },\n *   ],\n *   enterprise: { rowGrouping: true }\n * });\n *\n * // Usage in tests\n * await grid.waitForReady();\n * await grid.expectRowCount(10);\n * await grid.expectRowContains({ orderId: 'ORD-001', status: 'Active' });\n * ```\n */\nexport const agGrid: AgGridFactory = (\n  page: Page,\n  config: string | AgGridConfig\n): AgGridHelper => {\n  return new AgGridHelperImpl(page, config);\n};\n","/**\n * ARTK Core v1 Error Types\n *\n * This module exports custom error classes for ARTK Core with detailed\n * context for debugging and remediation.\n */\n\nexport { ARTKConfigError } from './config-error.js';\nexport { ARTKAuthError } from './auth-error.js';\nexport { ARTKStorageStateError } from './storage-state-error.js';\n","/**\n * ARTK Core v1 Utility Functions\n *\n * This module exports common utilities for logging, retry logic, and other\n * cross-cutting concerns.\n */\n\nexport {\n  createLogger,\n  configureLogger,\n  getLoggerConfig,\n  parseLogLevel,\n  type Logger,\n  type LogEntry,\n  type LogLevel,\n  type LoggerConfig,\n} from './logger.js';\n\nexport {\n  withRetry,\n  createRetryWrapper,\n  RetryPredicates,\n  type RetryOptions,\n} from './retry.js';\n","/**\n * Retry utility with exponential backoff\n *\n * Provides retry logic with exponential backoff as required by NFR-010, NFR-011, and NFR-012.\n *\n * - NFR-010: System MUST retry authentication failures up to 2 times with exponential backoff\n * - NFR-011: After retry exhaustion, fail with actionable error message\n * - NFR-012: Log each retry attempt at warn level\n *\n * @example\n * ```typescript\n * import { withRetry } from './retry.js';\n *\n * const result = await withRetry(\n *   async () => authenticateUser(page, credentials),\n *   {\n *     maxAttempts: 3,\n *     initialDelayMs: 1000,\n *     maxDelayMs: 10000,\n *     onRetry: (attempt, delay, error) => {\n *       logger.warn(`Retry attempt ${attempt} after ${delay}ms`, { error: error.message });\n *     }\n *   }\n * );\n * ```\n */\n\nimport { createLogger } from './logger.js';\n\nconst logger = createLogger('utils', 'retry');\n\n/**\n * Retry configuration options\n */\nexport interface RetryOptions {\n  /**\n   * Maximum number of attempts (including initial attempt)\n   * @default 3\n   */\n  maxAttempts?: number;\n\n  /**\n   * Initial delay in milliseconds before first retry\n   * @default 1000\n   */\n  initialDelayMs?: number;\n\n  /**\n   * Maximum delay in milliseconds (caps exponential growth)\n   * @default 30000\n   */\n  maxDelayMs?: number;\n\n  /**\n   * Backoff multiplier (delay *= multiplier after each retry)\n   * @default 2\n   */\n  backoffMultiplier?: number;\n\n  /**\n   * Whether to add jitter to delay (randomizes delay by 10%)\n   * @default true\n   */\n  jitter?: boolean;\n\n  /**\n   * Predicate function to determine if error is retryable\n   * @default () => true (retry all errors)\n   */\n  shouldRetry?: (error: Error, attempt: number) => boolean;\n\n  /**\n   * Callback invoked before each retry\n   * @param attempt - Current attempt number (1-indexed)\n   * @param delayMs - Delay before this retry in milliseconds\n   * @param error - Error from previous attempt\n   */\n  onRetry?: (attempt: number, delayMs: number, error: Error) => void;\n}\n\n/**\n * Default retry options\n */\nconst DEFAULT_RETRY_OPTIONS: Required<RetryOptions> = {\n  maxAttempts: 3,\n  initialDelayMs: 1000,\n  maxDelayMs: 30000,\n  backoffMultiplier: 2,\n  jitter: true,\n  shouldRetry: (): boolean => true,\n  onRetry: (): void => {},\n};\n\n/**\n * Calculate delay for next retry with exponential backoff\n *\n * @param attempt - Current attempt number (0-indexed)\n * @param options - Retry options\n * @returns Delay in milliseconds\n */\nfunction calculateDelay(attempt: number, options: Required<RetryOptions>): number {\n  // Exponential backoff: initialDelay * (multiplier ^ attempt)\n  let delay = options.initialDelayMs * Math.pow(options.backoffMultiplier, attempt);\n\n  // Cap at maximum delay\n  delay = Math.min(delay, options.maxDelayMs);\n\n  // Add jitter (10%)\n  if (options.jitter) {\n    const jitterFactor = 0.9 + Math.random() * 0.2; // Random between 0.9 and 1.1\n    delay = Math.floor(delay * jitterFactor);\n  }\n\n  return delay;\n}\n\n/**\n * Sleep for specified duration\n *\n * @param ms - Duration in milliseconds\n * @returns Promise that resolves after duration\n */\nfunction sleep(ms: number): Promise<void> {\n  return new Promise((resolve) => setTimeout(resolve, ms));\n}\n\n/**\n * Execute an async function with retry and exponential backoff\n *\n * @param fn - Async function to execute\n * @param options - Retry configuration\n * @returns Promise resolving to function result\n * @throws Last error if all retries are exhausted\n *\n * @example\n * ```typescript\n * const result = await withRetry(\n *   async () => {\n *     const response = await fetch('https://api.example.com/data');\n *     if (!response.ok) throw new Error('Request failed');\n *     return response.json();\n *   },\n *   {\n *     maxAttempts: 3,\n *     initialDelayMs: 1000,\n *     shouldRetry: (error) => error.message.includes('timeout'),\n *   }\n * );\n * ```\n */\nexport async function withRetry<T>(\n  fn: () => Promise<T>,\n  options: RetryOptions = {}\n): Promise<T> {\n  const opts: Required<RetryOptions> = { ...DEFAULT_RETRY_OPTIONS, ...options };\n\n  let lastError: Error | undefined;\n\n  for (let attempt = 0; attempt < opts.maxAttempts; attempt++) {\n    try {\n      // Execute function\n      return await fn();\n    } catch (error) {\n      const err = error instanceof Error ? error : new Error(String(error));\n      lastError = err;\n\n      // Check if we should retry\n      const isLastAttempt = attempt === opts.maxAttempts - 1;\n      const shouldRetry = !isLastAttempt && opts.shouldRetry(err, attempt + 1);\n\n      if (!shouldRetry) {\n        // Don't retry - throw error\n        throw err;\n      }\n\n      // Calculate delay and log retry\n      const delay = calculateDelay(attempt, opts);\n      const attemptNumber = attempt + 1;\n\n      logger.warn(`Retry attempt ${attemptNumber}/${opts.maxAttempts - 1} after ${delay}ms`, {\n        attempt: attemptNumber,\n        delayMs: delay,\n        error: err.message,\n      });\n\n      // Invoke callback\n      opts.onRetry(attemptNumber, delay, err);\n\n      // Wait before retry\n      await sleep(delay);\n    }\n  }\n\n  // All retries exhausted - throw last error\n  throw lastError || new Error('All retry attempts failed');\n}\n\n/**\n * Create a retry wrapper for a specific function with fixed options\n *\n * @param fn - Async function to wrap\n * @param options - Retry configuration\n * @returns Wrapped function that retries on failure\n *\n * @example\n * ```typescript\n * const authenticateWithRetry = createRetryWrapper(\n *   async (page, creds) => oidcProvider.login(page, creds),\n *   { maxAttempts: 3, initialDelayMs: 2000 }\n * );\n *\n * await authenticateWithRetry(page, credentials);\n * ```\n */\nexport function createRetryWrapper<TArgs extends unknown[], TResult>(\n  fn: (...args: TArgs) => Promise<TResult>,\n  options: RetryOptions = {}\n): (...args: TArgs) => Promise<TResult> {\n  return async (...args: TArgs): Promise<TResult> => {\n    return withRetry(() => fn(...args), options);\n  };\n}\n\n/**\n * Predefined shouldRetry predicates for common scenarios\n */\nexport const RetryPredicates = {\n  /**\n   * Retry all errors\n   */\n  always: (): boolean => true,\n\n  /**\n   * Never retry\n   */\n  never: (): boolean => false,\n\n  /**\n   * Retry only network errors\n   */\n  networkErrors: (error: Error): boolean => {\n    const message = error.message.toLowerCase();\n    return (\n      message.includes('network') ||\n      message.includes('timeout') ||\n      message.includes('econnrefused') ||\n      message.includes('enotfound')\n    );\n  },\n\n  /**\n   * Retry only specific error messages\n   */\n  messageIncludes: (substring: string): ((error: Error) => boolean) => {\n    return (error: Error): boolean => error.message.includes(substring);\n  },\n\n  /**\n   * Retry based on error name\n   */\n  errorName: (name: string): ((error: Error) => boolean) => {\n    return (error: Error): boolean => error.name === name;\n  },\n};\n"]}