{"version":3,"sources":["../../harness/projects.ts","../../harness/reporters.ts","../../harness/playwright.config.base.ts","../../harness/browser-validator.ts"],"names":["path","path2","promisify","exec"],"mappings":"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","file":"index.cjs","sourcesContent":["/**\n * Playwright Project Configuration Helpers (T103)\n *\n * Provides factory functions for creating Playwright project configurations:\n * - createAuthSetupProject: Creates auth setup project for a role\n * - createBrowserProjects: Creates browser projects with auth dependencies\n *\n * @module harness/projects\n */\n\nimport * as path from 'node:path';\n\nimport type { BrowserType } from '../config/types.js';\nimport type { PlaywrightProject } from './types.js';\n\n// =============================================================================\n// Constants\n// =============================================================================\n\n/**\n * Default test match pattern for auth setup\n */\nconst DEFAULT_AUTH_SETUP_PATTERN = '**/auth.setup.ts';\n\n/**\n * Default storage state file pattern\n */\nconst DEFAULT_STORAGE_STATE_PATTERN = '{role}.json';\n\n// =============================================================================\n// Auth Setup Project Factory\n// =============================================================================\n\n/**\n * Create a Playwright project configuration for auth setup\n *\n * Auth setup projects run before browser tests to establish\n * authenticated sessions. Each role gets its own setup project.\n *\n * @param role - Role name (e.g., 'admin', 'standardUser')\n * @param storageStatePath - Path to save storage state file\n * @param testMatch - Test file pattern (default: 'auth.setup.ts' glob pattern)\n * @returns Playwright project configuration\n *\n * @example\n * ```typescript\n * const adminSetup = createAuthSetupProject(\n *   'admin',\n *   '.auth-states/admin.json'\n * );\n * // Returns: { name: 'auth-setup-admin', testMatch: '**\\/auth.setup.ts' }\n * ```\n */\nexport function createAuthSetupProject(\n  role: string,\n  storageStatePath: string,\n  testMatch: string = DEFAULT_AUTH_SETUP_PATTERN\n): PlaywrightProject {\n  if (!role || typeof role !== 'string') {\n    throw new Error('Role must be a non-empty string');\n  }\n\n  if (!storageStatePath || typeof storageStatePath !== 'string') {\n    throw new Error('Storage state path must be a non-empty string');\n  }\n\n  return {\n    name: `auth-setup-${role}`,\n    testMatch,\n    use: {\n      storageState: undefined, // Auth setup starts without storage state\n    },\n  };\n}\n\n/**\n * Create auth setup projects for all roles\n *\n * @param roles - Array of role names\n * @param storageStateDir - Directory for storage state files\n * @param filePattern - File naming pattern (default: '{role}.json')\n * @param testMatch - Test file pattern\n * @returns Array of Playwright project configurations\n */\nexport function createAuthSetupProjects(\n  roles: readonly string[],\n  storageStateDir: string,\n  filePattern: string = DEFAULT_STORAGE_STATE_PATTERN,\n  testMatch: string = DEFAULT_AUTH_SETUP_PATTERN\n): readonly PlaywrightProject[] {\n  return roles.map((role) => {\n    const filename = resolveStorageStateFilename(role, filePattern);\n    const storagePath = path.join(storageStateDir, filename);\n    return createAuthSetupProject(role, storagePath, testMatch);\n  });\n}\n\n// =============================================================================\n// Browser Projects Factory\n// =============================================================================\n\n/**\n * Create Playwright project configurations for browser testing\n *\n * Creates projects for each combination of browser and role.\n * Projects depend on their corresponding auth setup projects.\n *\n * @param browsers - Array of browser types to create projects for\n * @param roles - Array of role names\n * @param storageStateDir - Directory containing storage state files\n * @param filePattern - Storage state file naming pattern\n * @param dependencies - Additional project dependencies\n * @returns Array of Playwright project configurations\n *\n * @example\n * ```typescript\n * const projects = createBrowserProjects(\n *   ['chromium', 'firefox'],\n *   ['admin', 'standardUser'],\n *   '.auth-states',\n *   '{role}.json'\n * );\n * // Creates 4 projects: chromium-admin, chromium-standardUser,\n * // firefox-admin, firefox-standardUser\n * ```\n */\nexport function createBrowserProjects(\n  browsers: readonly BrowserType[],\n  roles: readonly string[],\n  storageStateDir: string,\n  filePattern: string = DEFAULT_STORAGE_STATE_PATTERN,\n  dependencies: readonly string[] = []\n): readonly PlaywrightProject[] {\n  const projects: PlaywrightProject[] = [];\n\n  for (const browser of browsers) {\n    // Create unauthenticated project for public pages\n    projects.push(createBrowserProject(browser));\n\n    // Create authenticated projects for each role\n    for (const role of roles) {\n      const filename = resolveStorageStateFilename(role, filePattern);\n      const storageStatePath = path.join(storageStateDir, filename);\n\n      const authDeps = [`auth-setup-${role}`, ...dependencies];\n\n      projects.push(\n        createBrowserProject(browser, role, storageStatePath, authDeps)\n      );\n    }\n  }\n\n  return projects;\n}\n\n/**\n * Create a single browser project\n *\n * @param browser - Browser type\n * @param role - Optional role for authentication\n * @param storageStatePath - Path to storage state file\n * @param dependencies - Project dependencies\n * @returns Playwright project configuration\n */\nexport function createBrowserProject(\n  browser: BrowserType,\n  role?: string,\n  storageStatePath?: string,\n  dependencies?: readonly string[]\n): PlaywrightProject {\n  const name = role ? `${browser}-${role}` : browser;\n\n  const project: PlaywrightProject = {\n    name,\n    use: {\n      browserName: browser,\n      ...(storageStatePath && { storageState: storageStatePath }),\n    },\n    ...(dependencies && dependencies.length > 0 && { dependencies }),\n  };\n\n  return project;\n}\n\n/**\n * Create browser projects without authentication\n *\n * Useful for testing public pages or auth flows themselves.\n *\n * @param browsers - Array of browser types\n * @returns Array of unauthenticated browser projects\n */\nexport function createUnauthenticatedBrowserProjects(\n  browsers: readonly BrowserType[]\n): readonly PlaywrightProject[] {\n  return browsers.map((browser) => createBrowserProject(browser));\n}\n\n// =============================================================================\n// Storage State Helpers\n// =============================================================================\n\n/**\n * Resolve storage state filename from pattern\n *\n * Replaces {role} and {env} placeholders in the pattern.\n *\n * @param role - Role name\n * @param pattern - File pattern (e.g., '{role}.json', '{role}-{env}.json')\n * @param env - Environment name (default: 'default')\n * @returns Resolved filename\n */\nexport function resolveStorageStateFilename(\n  role: string,\n  pattern: string,\n  env: string = 'default'\n): string {\n  let filename = pattern.replace('{role}', role);\n  filename = filename.replace('{env}', env);\n\n  // Ensure .json extension\n  if (!filename.endsWith('.json')) {\n    filename = `${filename}.json`;\n  }\n\n  return filename;\n}\n\n/**\n * Get storage state path for a role\n *\n * @param role - Role name\n * @param storageStateDir - Base directory\n * @param filePattern - File naming pattern\n * @param env - Environment name\n * @returns Full path to storage state file\n */\nexport function getStorageStatePathForRole(\n  role: string,\n  storageStateDir: string,\n  filePattern: string = DEFAULT_STORAGE_STATE_PATTERN,\n  env?: string\n): string {\n  const filename = resolveStorageStateFilename(role, filePattern, env);\n  return path.join(storageStateDir, filename);\n}\n\n// =============================================================================\n// Project Filtering Helpers\n// =============================================================================\n\n/**\n * Filter projects by browser type\n *\n * @param projects - Array of projects\n * @param browser - Browser type to filter by\n * @returns Filtered projects\n */\nexport function filterProjectsByBrowser(\n  projects: readonly PlaywrightProject[],\n  browser: BrowserType\n): readonly PlaywrightProject[] {\n  return projects.filter((p) =>\n    p.name === browser || p.name.startsWith(`${browser}-`)\n  );\n}\n\n/**\n * Filter projects by role\n *\n * @param projects - Array of projects\n * @param role - Role name to filter by\n * @returns Filtered projects\n */\nexport function filterProjectsByRole(\n  projects: readonly PlaywrightProject[],\n  role: string\n): readonly PlaywrightProject[] {\n  return projects.filter((p) =>\n    p.name.includes(role)\n  );\n}\n\n/**\n * Get auth setup projects only\n *\n * @param projects - Array of all projects\n * @returns Only auth setup projects\n */\nexport function getAuthSetupProjects(\n  projects: readonly PlaywrightProject[]\n): readonly PlaywrightProject[] {\n  return projects.filter((p) => p.name.startsWith('auth-setup-'));\n}\n\n/**\n * Get browser projects only (excludes auth setup)\n *\n * @param projects - Array of all projects\n * @returns Only browser projects\n */\nexport function getBrowserProjects(\n  projects: readonly PlaywrightProject[]\n): readonly PlaywrightProject[] {\n  return projects.filter((p) => !p.name.startsWith('auth-setup-'));\n}\n","/**\n * Reporter Configuration Helper (T104)\n *\n * Generates Playwright reporter configurations from ARTK config.\n *\n * @module harness/reporters\n */\n\nimport type { ReporterDescription } from '@playwright/test';\n\nimport type { ARTKConfig } from '../config/types.js';\nimport type { ReporterArray, ReporterConfigOptions } from './types.js';\n\n// =============================================================================\n// Constants\n// =============================================================================\n\n/**\n * Default reporter settings when not configured\n */\nconst DEFAULT_REPORTER_OPTIONS: Required<ReporterConfigOptions> = {\n  html: true,\n  htmlOutputFolder: 'playwright-report',\n  htmlOpen: 'on-failure',\n  json: false,\n  jsonOutputFile: 'test-results/results.json',\n  junit: false,\n  junitOutputFile: 'test-results/junit.xml',\n  artk: false,\n  artkOutputFile: 'test-results/artk-report.json',\n  includeJourneyMapping: true,\n  list: true,\n  dot: false,\n};\n\n// =============================================================================\n// Reporter Configuration Factory\n// =============================================================================\n\n/**\n * Generate Playwright reporter configuration from ARTK config\n *\n * Creates an array of reporter descriptions based on the reporters\n * section in artk.config.yml.\n *\n * @param config - ARTK configuration\n * @returns Array of Playwright reporter descriptions\n *\n * @example\n * ```typescript\n * import { loadConfig } from '@artk/core/config';\n * import { getReporterConfig } from '@artk/core/harness';\n *\n * const { config } = loadConfig();\n * const reporters = getReporterConfig(config);\n * // [['html', {...}], ['json', {...}], ...]\n * ```\n */\nexport function getReporterConfig(config: ARTKConfig): ReporterArray {\n  const reporters: ReporterArray = [];\n  const reportersConfig = config.reporters;\n\n  // Always add list reporter for console output (unless disabled)\n  reporters.push(['list']);\n\n  // HTML Reporter\n  if (reportersConfig.html?.enabled) {\n    const htmlReporter: ReporterDescription = [\n      'html',\n      {\n        outputFolder: reportersConfig.html.outputFolder,\n        open: reportersConfig.html.open,\n      },\n    ];\n    reporters.push(htmlReporter);\n  }\n\n  // JSON Reporter\n  if (reportersConfig.json?.enabled) {\n    const jsonReporter: ReporterDescription = [\n      'json',\n      {\n        outputFile: reportersConfig.json.outputFile,\n      },\n    ];\n    reporters.push(jsonReporter);\n  }\n\n  // JUnit Reporter\n  if (reportersConfig.junit?.enabled) {\n    const junitReporter: ReporterDescription = [\n      'junit',\n      {\n        outputFile: reportersConfig.junit.outputFile,\n      },\n    ];\n    reporters.push(junitReporter);\n  }\n\n  // ARTK Reporter (custom reporter for journey mapping)\n  if (reportersConfig.artk?.enabled) {\n    const artkReporter: ReporterDescription = [\n      './reporters/artk-reporter.ts',\n      {\n        outputFile: reportersConfig.artk.outputFile,\n        includeJourneyMapping: reportersConfig.artk.includeJourneyMapping,\n      },\n    ];\n    reporters.push(artkReporter);\n  }\n\n  return reporters;\n}\n\n/**\n * Generate reporter configuration from options object\n *\n * Alternative to using ARTK config, useful for testing or custom setups.\n *\n * @param options - Reporter configuration options\n * @returns Array of Playwright reporter descriptions\n */\nexport function getReporterConfigFromOptions(\n  options: Partial<ReporterConfigOptions> = {}\n): ReporterArray {\n  const mergedOptions = { ...DEFAULT_REPORTER_OPTIONS, ...options };\n  const reporters: ReporterArray = [];\n\n  // Console reporters\n  if (mergedOptions.list) {\n    reporters.push(['list']);\n  } else if (mergedOptions.dot) {\n    reporters.push(['dot']);\n  }\n\n  // HTML Reporter\n  if (mergedOptions.html) {\n    reporters.push([\n      'html',\n      {\n        outputFolder: mergedOptions.htmlOutputFolder,\n        open: mergedOptions.htmlOpen,\n      },\n    ]);\n  }\n\n  // JSON Reporter\n  if (mergedOptions.json) {\n    reporters.push([\n      'json',\n      {\n        outputFile: mergedOptions.jsonOutputFile,\n      },\n    ]);\n  }\n\n  // JUnit Reporter\n  if (mergedOptions.junit) {\n    reporters.push([\n      'junit',\n      {\n        outputFile: mergedOptions.junitOutputFile,\n      },\n    ]);\n  }\n\n  // ARTK Reporter\n  if (mergedOptions.artk) {\n    reporters.push([\n      './reporters/artk-reporter.ts',\n      {\n        outputFile: mergedOptions.artkOutputFile,\n        includeJourneyMapping: mergedOptions.includeJourneyMapping,\n      },\n    ]);\n  }\n\n  return reporters;\n}\n\n/**\n * Create minimal reporter configuration\n *\n * Returns just the list reporter for quick local development.\n *\n * @returns Minimal reporter array\n */\nexport function getMinimalReporterConfig(): ReporterArray {\n  return [['list']];\n}\n\n/**\n * Create CI-optimized reporter configuration\n *\n * Includes JUnit for CI integration and JSON for processing.\n *\n * @param junitPath - Path for JUnit output\n * @param jsonPath - Path for JSON output\n * @returns CI-optimized reporter array\n */\nexport function getCIReporterConfig(\n  junitPath: string = 'test-results/junit.xml',\n  jsonPath: string = 'test-results/results.json'\n): ReporterArray {\n  return [\n    ['dot'], // Minimal console output for CI\n    ['junit', { outputFile: junitPath }],\n    ['json', { outputFile: jsonPath }],\n  ];\n}\n\n/**\n * Merge reporter configurations\n *\n * Combines multiple reporter arrays, deduplicating by reporter type.\n *\n * @param configs - Reporter arrays to merge\n * @returns Merged reporter array\n */\nexport function mergeReporterConfigs(\n  ...configs: ReporterArray[]\n): ReporterArray {\n  const seen = new Map<string, ReporterDescription>();\n\n  for (const config of configs) {\n    for (const reporter of config) {\n      const type = Array.isArray(reporter) ? reporter[0] : String(reporter);\n      // Later configs override earlier ones\n      seen.set(type, reporter);\n    }\n  }\n\n  return Array.from(seen.values());\n}\n\n/**\n * Check if a reporter type is enabled in the configuration\n *\n * @param reporters - Reporter array to check\n * @param type - Reporter type (e.g., 'html', 'json')\n * @returns True if the reporter type is in the array\n */\nexport function hasReporter(\n  reporters: ReporterArray,\n  type: string\n): boolean {\n  return reporters.some((r) => {\n    const reporterType = Array.isArray(r) ? r[0] : String(r);\n    return reporterType === type || (typeof reporterType === 'string' && reporterType.includes(type));\n  });\n}\n","/**\n * Playwright Configuration Factory (T102, T105)\n *\n * Creates complete Playwright configurations from ARTK config.\n *\n * Key Features:\n * - createPlaywrightConfig: Main factory function\n * - getTierSettings: Tier-specific settings (smoke, release, regression)\n * - getUseOptions: Shared 'use' configuration\n *\n * @module harness/playwright.config.base\n *\n * @example\n * ```typescript\n * // playwright.config.ts\n * import { loadConfig } from '@artk/core/config';\n * import { createPlaywrightConfig } from '@artk/core/harness';\n *\n * const { config, activeEnvironment } = loadConfig();\n *\n * export default createPlaywrightConfig({\n *   config,\n *   activeEnvironment,\n *   tier: 'regression',\n * });\n * ```\n */\n\nimport * as path from 'node:path';\n\nimport type { ARTKConfig, BrowserChannel, BrowserType } from '../config/types.js';\nimport type {\n  HarnessOptions,\n  PlaywrightConfigOutput,\n  PlaywrightProject,\n  TierName,\n  TierSettings,\n  UseOptions,\n} from './types.js';\nimport { createAuthSetupProjects, createBrowserProjects } from './projects.js';\nimport { getReporterConfig } from './reporters.js';\n\n// =============================================================================\n// Constants\n// =============================================================================\n\n/**\n * Default tier when not specified\n */\nconst DEFAULT_TIER: TierName = 'regression';\n\n/**\n * Default test directory\n */\nconst DEFAULT_TEST_DIR = 'tests';\n\n/**\n * Default output directory\n */\nconst DEFAULT_OUTPUT_DIR = 'test-results';\n\n/**\n * Default expect timeout in ms\n */\nconst DEFAULT_EXPECT_TIMEOUT = 5000;\n\n/**\n * Default tier settings when tier config is missing\n */\nconst DEFAULT_TIER_SETTINGS: Record<TierName, TierSettings> = {\n  smoke: {\n    retries: 0,\n    workers: 1,\n    timeout: 30000,\n    tag: '@smoke',\n  },\n  release: {\n    retries: 1,\n    workers: 2,\n    timeout: 60000,\n    tag: '@release',\n  },\n  regression: {\n    retries: 2,\n    workers: 4,\n    timeout: 120000,\n    tag: '@regression',\n  },\n};\n\n// =============================================================================\n// Tier Settings Factory (T105)\n// =============================================================================\n\n/**\n * Get tier-specific settings from ARTK config\n *\n * Returns configuration values (retries, workers, timeout, tag) for\n * the specified tier. Falls back to defaults if tier not configured.\n *\n * @param config - ARTK configuration\n * @param tier - Tier name ('smoke', 'release', 'regression')\n * @returns Tier settings object\n *\n * @example\n * ```typescript\n * const settings = getTierSettings(config, 'smoke');\n * // { retries: 0, workers: 1, timeout: 30000, tag: '@smoke' }\n * ```\n */\nexport function getTierSettings(\n  config: ARTKConfig,\n  tier: TierName = DEFAULT_TIER\n): TierSettings {\n  const tierConfig = config.tiers[tier];\n\n  if (!tierConfig) {\n    // Fall back to default tier settings\n    return DEFAULT_TIER_SETTINGS[tier] ?? DEFAULT_TIER_SETTINGS.regression;\n  }\n\n  return {\n    retries: tierConfig.retries,\n    workers: tierConfig.workers,\n    timeout: tierConfig.timeout,\n    tag: tierConfig.tag,\n  };\n}\n\n/**\n * Get all tier settings as a map\n *\n * @param config - ARTK configuration\n * @returns Map of tier name to settings\n */\nexport function getAllTierSettings(\n  config: ARTKConfig\n): Record<TierName, TierSettings> {\n  return {\n    smoke: getTierSettings(config, 'smoke'),\n    release: getTierSettings(config, 'release'),\n    regression: getTierSettings(config, 'regression'),\n  };\n}\n\n// =============================================================================\n// Use Options Factory (T105)\n// =============================================================================\n\n/**\n * Map ARTK browser channel to Playwright channel option\n */\nfunction mapBrowserChannel(channel?: BrowserChannel): string | undefined {\n  if (!channel || channel === 'bundled') {\n    return undefined;\n  }\n  return channel;\n}\n\n/**\n * Generate Playwright 'use' configuration from ARTK config\n *\n * Creates the shared settings object that applies to all projects.\n *\n * @param config - ARTK configuration\n * @param activeEnvironment - Optional active environment name\n * @returns UseOptions object for Playwright config\n *\n * @example\n * ```typescript\n * const useOptions = getUseOptions(config, 'staging');\n * // { baseURL: 'https://staging.example.com', viewport: {...}, ... }\n * ```\n */\nexport function getUseOptions(\n  config: ARTKConfig,\n  activeEnvironment?: string\n): UseOptions {\n  // Determine base URL\n  const envName = activeEnvironment ?? config.activeEnvironment;\n  const envConfig = config.environments[envName];\n  const baseURL = envConfig?.baseUrl ?? config.app.baseUrl;\n\n  // Map screenshot mode\n  const screenshotMode = mapScreenshotMode(config.artifacts.screenshots.mode);\n\n  // Map video mode\n  const videoMode = mapCaptureMode(config.artifacts.video.mode);\n\n  // Map trace mode\n  const traceMode = mapCaptureMode(config.artifacts.trace.mode);\n\n  const playwrightChannel = mapBrowserChannel(config.browsers.channel);\n\n  return {\n    baseURL,\n    viewport: {\n      width: config.browsers.viewport.width,\n      height: config.browsers.viewport.height,\n    },\n    headless: config.browsers.headless,\n    ...(config.browsers.slowMo && { slowMo: config.browsers.slowMo }),\n    ...(playwrightChannel && { channel: playwrightChannel }),\n    screenshot: screenshotMode,\n    video: videoMode,\n    trace: traceMode,\n    testIdAttribute: config.selectors.testIdAttribute,\n  };\n}\n\n/**\n * Map ARTK screenshot mode to Playwright mode\n */\nfunction mapScreenshotMode(\n  mode: 'off' | 'on' | 'only-on-failure'\n): 'off' | 'on' | 'only-on-failure' {\n  return mode;\n}\n\n/**\n * Map ARTK capture mode to Playwright mode\n */\nfunction mapCaptureMode(\n  mode: 'off' | 'on' | 'retain-on-failure' | 'on-first-retry'\n): 'off' | 'on' | 'retain-on-failure' | 'on-first-retry' {\n  return mode;\n}\n\n// =============================================================================\n// Playwright Config Factory (T102)\n// =============================================================================\n\n/**\n * Create a complete Playwright configuration from ARTK config\n *\n * This is the main entry point for generating playwright.config.ts\n * contents. It combines all ARTK settings into a valid Playwright\n * configuration object.\n *\n * @param options - Harness configuration options\n * @returns Complete Playwright configuration object\n *\n * @example\n * ```typescript\n * // playwright.config.ts\n * import { loadConfig } from '@artk/core/config';\n * import { createPlaywrightConfig } from '@artk/core/harness';\n *\n * const { config, activeEnvironment } = loadConfig();\n *\n * export default createPlaywrightConfig({\n *   config,\n *   activeEnvironment,\n *   tier: 'smoke', // Optional: defaults to 'regression'\n *   testDir: 'e2e', // Optional: defaults to 'tests'\n * });\n * ```\n */\nexport function createPlaywrightConfig(\n  options: HarnessOptions\n): PlaywrightConfigOutput {\n  const {\n    config,\n    activeEnvironment,\n    tier = DEFAULT_TIER,\n    projectRoot = process.cwd(),\n    includeAuthSetup = true,\n    testDir = DEFAULT_TEST_DIR,\n    outputDir = DEFAULT_OUTPUT_DIR,\n    additionalProjects = [],\n  } = options;\n\n  // Get tier settings\n  const tierSettings = getTierSettings(config, tier);\n\n  // Get use options\n  const useOptions = getUseOptions(config, activeEnvironment);\n\n  // Get reporter config\n  const reporters = getReporterConfig(config);\n\n  // Build projects\n  const projects = buildProjects(\n    config,\n    projectRoot,\n    includeAuthSetup,\n    additionalProjects\n  );\n\n  // Determine if running in CI\n  const isCI = Boolean(process.env.CI);\n\n  return {\n    testDir,\n    outputDir: config.artifacts.outputDir ?? outputDir,\n    fullyParallel: true,\n    forbidOnly: isCI,\n    retries: tierSettings.retries,\n    workers: tierSettings.workers,\n    timeout: tierSettings.timeout,\n    expect: {\n      timeout: DEFAULT_EXPECT_TIMEOUT,\n    },\n    reporter: reporters,\n    use: useOptions,\n    projects,\n  };\n}\n\n/**\n * Build project array from configuration\n */\nfunction buildProjects(\n  config: ARTKConfig,\n  projectRoot: string,\n  includeAuthSetup: boolean,\n  additionalProjects: readonly PlaywrightProject[]\n): readonly PlaywrightProject[] {\n  const projects: PlaywrightProject[] = [];\n\n  // Get roles and browsers from config\n  const roles = Object.keys(config.auth.roles);\n  const browsers = config.browsers.enabled;\n  const storageStateDir = path.join(\n    projectRoot,\n    config.auth.storageState.directory\n  );\n  const filePattern = config.auth.storageState.filePattern;\n\n  // Add auth setup projects\n  if (includeAuthSetup && roles.length > 0) {\n    const authProjects = createAuthSetupProjects(\n      roles,\n      storageStateDir,\n      filePattern\n    );\n    projects.push(...authProjects);\n  }\n\n  // Add browser projects\n  const browserProjects = createBrowserProjects(\n    browsers,\n    roles,\n    storageStateDir,\n    filePattern\n  );\n  projects.push(...browserProjects);\n\n  // Add any additional custom projects\n  projects.push(...additionalProjects);\n\n  return projects;\n}\n\n/**\n * Create minimal Playwright configuration\n *\n * Useful for quick testing or simple setups without full ARTK config.\n *\n * @param baseURL - Base URL for tests\n * @param browsers - Browsers to test (default: ['chromium'])\n * @returns Minimal Playwright configuration\n */\nexport function createMinimalPlaywrightConfig(\n  baseURL: string,\n  browsers: BrowserType[] = ['chromium']\n): Partial<PlaywrightConfigOutput> {\n  const projects: PlaywrightProject[] = browsers.map((browser) => ({\n    name: browser,\n    use: {\n      browserName: browser,\n    },\n  }));\n\n  return {\n    testDir: DEFAULT_TEST_DIR,\n    outputDir: DEFAULT_OUTPUT_DIR,\n    fullyParallel: true,\n    forbidOnly: Boolean(process.env.CI),\n    retries: 0,\n    workers: 1,\n    timeout: 30000,\n    expect: {\n      timeout: DEFAULT_EXPECT_TIMEOUT,\n    },\n    reporter: [['list']],\n    use: {\n      baseURL,\n      viewport: { width: 1280, height: 720 },\n      headless: true,\n      screenshot: 'only-on-failure',\n      video: 'off',\n      trace: 'off',\n      testIdAttribute: 'data-testid',\n    },\n    projects,\n  };\n}\n\n/**\n * Merge Playwright configurations\n *\n * Combines a base configuration with overrides.\n *\n * @param base - Base configuration\n * @param overrides - Configuration overrides\n * @returns Merged configuration\n */\nexport function mergePlaywrightConfigs(\n  base: Partial<PlaywrightConfigOutput>,\n  overrides: Partial<PlaywrightConfigOutput>\n): Partial<PlaywrightConfigOutput> {\n  return {\n    ...base,\n    ...overrides,\n    use: {\n      ...base.use,\n      ...overrides.use,\n    } as UseOptions,\n    projects: overrides.projects ?? base.projects,\n    reporter: overrides.reporter ?? base.reporter ?? [],\n  };\n}\n\n/**\n * Create a config override for a specific tier\n *\n * Useful for running different tiers with the same base config.\n *\n * @param config - ARTK configuration\n * @param tier - Tier to configure for\n * @returns Configuration overrides for the tier\n */\nexport function createTierOverrides(\n  config: ARTKConfig,\n  tier: TierName\n): Partial<PlaywrightConfigOutput> {\n  const settings = getTierSettings(config, tier);\n\n  return {\n    retries: settings.retries,\n    workers: settings.workers,\n    timeout: settings.timeout,\n  };\n}\n","import { exec } from 'node:child_process';\nimport { promisify } from 'node:util';\n\nimport type { BrowserChannel } from '../config/types.js';\n\nconst execAsync = promisify(exec);\n\nexport interface BrowserValidationResult {\n  available: boolean;\n  version?: string;\n  path?: string;\n  reason?: string;\n}\n\nfunction parseCommandPath(command: string): string {\n  const trimmed = command.replace(/\\s+--version$/, '').trim();\n  return trimmed.replace(/^\"(.*)\"$/, '$1');\n}\n\nasync function checkCommands(\n  commands: string[]\n): Promise<Omit<BrowserValidationResult, 'available'>> {\n  for (const cmd of commands) {\n    try {\n      const { stdout } = await execAsync(cmd, { timeout: 5000 });\n      const version = stdout.match(/(\\d+\\.\\d+\\.\\d+\\.\\d+)/)?.[1];\n      return {\n        version,\n        path: parseCommandPath(cmd),\n      };\n    } catch {\n      continue;\n    }\n  }\n\n  return {};\n}\n\n/**\n * Validate that the configured browser channel is available on the system.\n */\nexport async function validateBrowserChannel(\n  channel?: BrowserChannel\n): Promise<BrowserValidationResult> {\n  if (!channel || channel === 'bundled') {\n    return { available: true };\n  }\n\n  try {\n    if (channel === 'msedge') {\n      const edgeCommands = [\n        'microsoft-edge --version',\n        'microsoft-edge-stable --version',\n        '\"/Applications/Microsoft Edge.app/Contents/MacOS/Microsoft Edge\" --version',\n        '\"C:\\\\\\\\Program Files (x86)\\\\\\\\Microsoft\\\\\\\\Edge\\\\\\\\Application\\\\\\\\msedge.exe\" --version',\n        '\"C:\\\\\\\\Program Files\\\\\\\\Microsoft\\\\\\\\Edge\\\\\\\\Application\\\\\\\\msedge.exe\" --version',\n        '\"%LOCALAPPDATA%\\\\\\\\Microsoft\\\\\\\\Edge\\\\\\\\Application\\\\\\\\msedge.exe\" --version',\n        '\"%USERPROFILE%\\\\\\\\AppData\\\\\\\\Local\\\\\\\\Microsoft\\\\\\\\Edge\\\\\\\\Application\\\\\\\\msedge.exe\" --version',\n      ];\n\n      const result = await checkCommands(edgeCommands);\n      if (result.path) {\n        return { available: true, ...result };\n      }\n\n      return {\n        available: false,\n        reason: `Browser \"${channel}\" not found. Install from https://microsoft.com/edge`,\n      };\n    }\n\n    if (channel === 'chrome' || channel === 'chrome-beta' || channel === 'chrome-dev') {\n      const chromeCommands = [\n        'google-chrome --version',\n        'google-chrome-stable --version',\n        'google-chrome-beta --version',\n        'google-chrome-unstable --version',\n        '\"/Applications/Google Chrome.app/Contents/MacOS/Google Chrome\" --version',\n        'chromium --version',\n        '\"C:\\\\\\\\Program Files\\\\\\\\Google\\\\\\\\Chrome\\\\\\\\Application\\\\\\\\chrome.exe\" --version',\n        '\"C:\\\\\\\\Program Files (x86)\\\\\\\\Google\\\\\\\\Chrome\\\\\\\\Application\\\\\\\\chrome.exe\" --version',\n        '\"%LOCALAPPDATA%\\\\\\\\Google\\\\\\\\Chrome\\\\\\\\Application\\\\\\\\chrome.exe\" --version',\n        '\"%USERPROFILE%\\\\\\\\AppData\\\\\\\\Local\\\\\\\\Google\\\\\\\\Chrome\\\\\\\\Application\\\\\\\\chrome.exe\" --version',\n      ];\n\n      const result = await checkCommands(chromeCommands);\n      if (result.path) {\n        return { available: true, ...result };\n      }\n\n      return {\n        available: false,\n        reason: `Browser \"${channel}\" not found. Install from https://google.com/chrome`,\n      };\n    }\n  } catch (error) {\n    return {\n      available: false,\n      reason: `Browser validation error: ${\n        error instanceof Error ? error.message : String(error)\n      }`,\n    };\n  }\n\n  return { available: true };\n}\n"]}